  SUBROUTINE jval_cal_MGLYOX

    ! MGLYOX -> products Koch + Moortgat (1998), Meller et al. (1991)

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_MGLYOX

    REAL :: f6, f7
    REAL :: prel

    ! T-const parameters:
    REAL, PARAMETER :: a2_MGLYOX(dim55) = (/ &
      6.3800E-22, 5.2200E-22, 3.9880E-22, 2.8800E-22, 1.9840E-22, 1.3200E-22, &
      8.6000E-23, 5.5200E-23, 3.5200E-23, 2.1999E-23, 1.4000E-23, 8.8004E-24, &
      5.1996E-24, 3.2002E-24, 2.4001E-24, 1.1994E-24, 8.0004E-25, 4.0067E-25, &
      0.0000E+00, 0.0000E+00, 0.0000E+00, 0.0000E+00, 0.0000E+00, 0.0000E+00, &
      0.0000E+00, 0.0000E+00, 0.0000E+00, 0.0000E+00, 0.0000E+00, 0.0000E+00, &
      0.0000E+00, 0.0000E+00, 0.0000E+00, 0.0000E+00, 0.0000E+00, 0.0000E+00, &
      0.0000E+00, 0.0000E+00, 0.0000E+00, 0.0000E+00, 0.0000E+00, 0.0000E+00, &
      0.0000E+00, 0.0000E+00, 0.0000E+00, 0.0000E+00, 0.0000E+00, 0.0000E+00, &
      0.0000E+00, 0.0000E+00, 0.0000E+00, 0.0000E+00, 0.0000E+00, 0.0000E+00, &
      0.0000E+00 /)
    REAL, PARAMETER :: b2_MGLYOX(dim55) = (/ &
      2.3144E-20, 2.3492E-20, 2.4170E-20, 2.5056E-20, 2.5997E-20, 2.6860E-20, &
      2.7573E-20, 2.8127E-20, 2.8537E-20, 2.8841E-20, 2.9045E-20, 2.9191E-20, &
      2.9300E-20, 2.9366E-20, 2.9395E-20, 2.9440E-20, 2.9457E-20, 2.9474E-20, &
      2.9492E-20, 2.9473E-20, 2.9493E-20, 2.9493E-20, 2.9493E-20, 2.9493E-20, &
      2.9493E-20, 2.9493E-20, 2.9493E-20, 2.9493E-20, 2.9465E-20, 2.9494E-20, &
      2.9494E-20, 2.9494E-20, 2.9494E-20, 2.9461E-20, 2.9495E-20, 2.9495E-20, &
      2.9495E-20, 2.9495E-20, 2.9457E-20, 2.9496E-20, 2.9488E-20, 2.9488E-20, &
      2.9498E-20, 2.9487E-20, 2.9499E-20, 2.9499E-20, 2.9485E-20, 2.9500E-20, &
      2.9500E-20, 2.9500E-20, 2.9500E-20, 2.9500E-20, 2.9500E-20, 2.9500E-20, &
      2.9500E-20 /)
    REAL, PARAMETER :: a3_MGLYOX(dim55) = (/ &
      -3.9314E-23, -2.1567E-23, -1.0662E-23, -5.8360E-24, -3.7488E-24, -2.7725E-24, &
      -2.2591E-24, -1.9514E-24, -1.7457E-24, -1.6087E-24, -1.5064E-24, -1.4034E-24, &
      -1.3349E-24, -1.2495E-24, -1.1980E-24, -1.1297E-24, -1.0782E-24, -1.0265E-24, &
      -9.7599E-25, -9.2470E-25, -8.8888E-25, -8.3905E-25, -8.0475E-25, -7.5346E-25, &
      -7.1793E-25, -7.0206E-25, -6.5066E-25, -6.3356E-25, -5.9829E-25, -5.6507E-25, &
      -5.3082E-25, -5.1372E-25, -4.7866E-25, -4.6232E-25, -4.4517E-25, -4.1028E-25, &
      -4.1098E-25, -3.7668E-25, -3.4248E-25, -3.4190E-25, -2.9099E-25, -2.2252E-25, &
      -1.6770E-25, -1.3010E-25, -9.9280E-26, -7.5283E-26, -5.8208E-26, -4.4502E-26, &
      -3.4225E-26, -2.7389E-26, -2.0531E-26, -1.3690E-26, -1.0276E-26, -1.0265E-26, &
      -6.8450E-27 /)
    REAL, PARAMETER :: b3_MGLYOX(dim55) = (/ &
      4.0886E-20, 3.9840E-20, 3.8560E-20, 3.7712E-20, 3.7223E-20, 3.6937E-20, &
      3.6757E-20, 3.6631E-20, 3.6535E-20, 3.6463E-20, 3.6403E-20, 3.6337E-20, &
      3.6289E-20, 3.6224E-20, 3.6182E-20, 3.6122E-20, 3.6073E-20, 3.6022E-20, &
      3.5969E-20, 3.5912E-20, 3.5870E-20, 3.5809E-20, 3.5765E-20, 3.5696E-20, &
      3.5646E-20, 3.5623E-20, 3.5545E-20, 3.5518E-20, 3.5460E-20, 3.5404E-20, &
      3.5344E-20, 3.5313E-20, 3.5247E-20, 3.5216E-20, 3.5182E-20, 3.5110E-20, &
      3.5112E-20, 3.5037E-20, 3.4962E-20, 3.4960E-20, 3.4841E-20, 3.4661E-20, &
      3.4501E-20, 3.4380E-20, 3.4272E-20, 3.4181E-20, 3.4111E-20, 3.4051E-20, &
      3.4003E-20, 3.3969E-20, 3.3933E-20, 3.3895E-20, 3.3875E-20, 3.3875E-20, &
      3.3853E-20 /)
    REAL, PARAMETER :: a4_MGLYOX(3) = (/ 2.3571E-20, -1.4561E-24, 1.4153E-28 /)
    REAL, PARAMETER :: a5_MGLYOX(3) = (/ 9.5590E-21, -1.0975E-24, 8.9459E-29 /)
    REAL, PARAMETER :: a6_MGLYOX(1) = (/ 2.1329E-21 /)
    REAL, PARAMETER :: a7_MGLYOX(2) = (/ 3.8083E-23, 2.6202E-27 /)

    jval_2d(ip_MGLYOX)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        PREL = (MIN(1.E5,PRESS(J,K))/PRESS_REF)  !relative pressure
        sig_MGLYOX(2) = &
          p1(b2_MGLYOX(i2(j,k)), a2_MGLYOX(i2(j,k)), &
          v3_du1(j,k))
        sig_MGLYOX(3) = &
          p1(b3_MGLYOX(i3(j,k)), a3_MGLYOX(i3(j,k)), &
          v3_du2(j,k))
        sig_MGLYOX(4) = &
          p2(a4_MGLYOX(1),a4_MGLYOX(2),a4_MGLYOX(3),v3_du2(j,k))
        sig_MGLYOX(5) = &
          p2(a5_MGLYOX(1),a5_MGLYOX(2),a5_MGLYOX(3),v3_du2(j,k))
        sig_MGLYOX(6) = &
          a6_MGLYOX(1)
        sig_MGLYOX(7) = &
          p1(a7_MGLYOX(1),a7_MGLYOX(2),v3_du2(j,k))
        F6 = 1./p1(8.7005E-02, 9.1257E-02, PREL)
        F7 = 1./p1(5.3416E-02, 9.4662E-02, PREL)
        dj = 0. &
          + sig_MGLYOX(2) * fint(j,k,2) &
          + sig_MGLYOX(3) * fint(j,k,3) &
          + sig_MGLYOX(4) * fint(j,k,4) &
          + sig_MGLYOX(5) * fint(j,k,5) &
          + sig_MGLYOX(6) * F6 * fint(j,k,6) &
          + sig_MGLYOX(7) * F7 * fint(j,k,7)

        jval_2d(ip_MGLYOX)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,6)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_MGLYOX
