  SUBROUTINE jval_cal_NO

    ! NO -> N + O
    ! Allen + Frederick, J. Atmos. Sci. 39, 2066-2075, 1982

    ! mz_rs_20111006+
    ! \cite{2355}
    ! mz_rs_20111006-

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_NO 

    ! T-const parameters:
    REAL, PARAMETER :: a0_1_1_NO(dim58) = (/ &
      4.8294E-22, -2.6705E-22, -9.2287E-21, -2.1578E-20, -3.3937E-20, -4.4211E-20, &
      -5.1449E-20, -5.5561E-20, -5.7027E-20, -5.6724E-20, -5.5524E-20, -5.4432E-20, &
      -5.4184E-20, -5.5477E-20, -5.8313E-20, -6.3064E-20, -6.9663E-20, -7.7493E-20, &
      -8.6285E-20, -9.5515E-20, -1.0416E-19, -1.1214E-19, -1.1911E-19, -1.2427E-19, &
      -1.2818E-19, -1.3032E-19, -1.3125E-19, -1.3095E-19, -1.2923E-19, -1.2599E-19, &
      -1.2103E-19, -1.1422E-19, -1.0559E-19, -9.5234E-20, -8.3749E-20, -7.1719E-20, &
      -6.0169E-20, -4.9868E-20, -4.1403E-20, -3.4915E-20, -3.0102E-20, -2.6464E-20, &
      -2.3508E-20, -2.0890E-20, -1.8457E-20, -1.6152E-20, -1.3968E-20, -1.1999E-20, &
      -1.0344E-20, -9.1571E-21, -8.5636E-21, -8.5562E-21, -1.8846E-20, -1.3122E-20, &
      -6.0916E-21, -2.2562E-21, -6.2901E-22, -1.7769E-22 /)
    REAL, PARAMETER :: a0_1_2_NO(dim58) = (/ &
      6.2919E-19, 6.6234E-19, 1.0602E-18, 1.6110E-18, 2.1647E-18, 2.6270E-18, &
      2.9542E-18, 3.1409E-18, 3.2077E-18, 3.1938E-18, 3.1386E-18, 3.0882E-18, &
      3.0767E-18, 3.1370E-18, 3.2697E-18, 3.4930E-18, 3.8044E-18, 4.1756E-18, &
      4.5941E-18, 5.0353E-18, 5.4504E-18, 5.8346E-18, 6.1720E-18, 6.4230E-18, &
      6.6139E-18, 6.7186E-18, 6.7645E-18, 6.7497E-18, 6.6642E-18, 6.5028E-18, &
      6.2548E-18, 5.9133E-18, 5.4780E-18, 4.9541E-18, 4.3707E-18, 3.7571E-18, &
      3.1658E-18, 2.6363E-18, 2.1995E-18, 1.8634E-18, 1.6132E-18, 1.4233E-18, &
      1.2684E-18, 1.1307E-18, 1.0022E-18, 8.8004E-19, 7.6384E-19, 6.5871E-19, &
      5.6999E-19, 5.0613E-19, 4.7408E-19, 4.7367E-19, 1.0335E-18, 7.2090E-19, &
      3.3564E-19, 1.2470E-19, 3.4875E-20, 9.8725E-21 /)
    REAL, PARAMETER :: a0_2_1_NO(dim58) = (/ &
      -6.4112E-23, -8.3731E-23, -3.0543E-23, 5.6217E-23, 1.4808E-22, 2.2765E-22, &
      2.8591E-22, 3.2067E-22, 3.3430E-22, 3.3354E-22, 3.2478E-22, 3.1683E-22, &
      3.1700E-22, 3.3876E-22, 3.5573E-22, 3.9035E-22, 4.4412E-22, 4.9511E-22, &
      5.5721E-22, 6.2827E-22, 6.7845E-22, 7.2876E-22, 7.7624E-22, 7.9450E-22, &
      8.0973E-22, 8.0051E-22, 7.9258E-22, 7.8430E-22, 7.6869E-22, 7.4528E-22, &
      7.1196E-22, 6.6676E-22, 6.0960E-22, 5.3949E-22, 4.6097E-22, 3.7810E-22, &
      2.9876E-22, 2.2961E-22, 1.7558E-22, 1.3782E-22, 1.1363E-22, 9.8481E-23, &
      8.8190E-23, 7.9500E-23, 7.1498E-23, 6.3480E-23, 5.5503E-23, 4.7936E-23, &
      4.1291E-23, 3.6288E-23, 3.3633E-23, 3.3452E-23, 7.4318E-23, 5.1959E-23, &
      2.4218E-23, 9.0038E-24, 2.5179E-24, 7.1284E-25 /)
    REAL, PARAMETER :: a0_2_2_NO(dim58) = (/ &
      -8.8093E-22, -1.3754E-23, -2.3753E-21, -6.2448E-21, -1.0360E-20, -1.3941E-20, &
      -1.6574E-20, -1.8153E-20, -1.8774E-20, -1.8739E-20, -1.8336E-20, -1.7969E-20, &
      -1.7977E-20, -1.8991E-20, -1.9785E-20, -2.1412E-20, -2.3950E-20, -2.6367E-20, &
      -2.9323E-20, -3.2720E-20, -3.5128E-20, -3.7553E-20, -3.9851E-20, -4.0738E-20, &
      -4.1482E-20, -4.1030E-20, -4.0640E-20, -4.0231E-20, -3.9457E-20, -3.8291E-20, &
      -3.6625E-20, -3.4356E-20, -3.1475E-20, -2.7928E-20, -2.3939E-20, -1.9712E-20, &
      -1.5650E-20, -1.2095E-20, -9.3080E-21, -7.3518E-21, -6.0937E-21, -5.3031E-21, &
      -4.7638E-21, -4.3068E-21, -3.8842E-21, -3.4593E-21, -3.0349E-21, -2.6308E-21, &
      -2.2747E-21, -2.0055E-21, -1.8621E-21, -1.8523E-21, -4.0754E-21, -2.8546E-21, &
      -1.3344E-21, -4.9763E-22, -1.3960E-22, -3.9604E-23 /)
    REAL, PARAMETER :: a0_3_1_NO(dim58) = (/ &
      4.5919E-25, 5.7344E-25, 4.4437E-25, 1.9326E-25, -7.8876E-26, -3.2715E-25, &
      -5.1782E-25, -6.3429E-25, -6.7988E-25, -6.8079E-25, -6.5417E-25, -6.4150E-25, &
      -6.9416E-25, -9.4519E-25, -9.7579E-25, -1.1093E-24, -1.3672E-24, -1.4870E-24, &
      -1.6994E-24, -2.0044E-24, -2.0934E-24, -2.2478E-24, -2.4448E-24, -2.4161E-24, &
      -2.4352E-24, -2.2822E-24, -2.2060E-24, -2.1810E-24, -2.1364E-24, -2.0720E-24, &
      -1.9787E-24, -1.8478E-24, -1.6814E-24, -1.4701E-24, -1.2311E-24, -9.7562E-25, &
      -7.2985E-25, -5.1717E-25, -3.5557E-25, -2.4897E-25, -1.8826E-25, -1.5740E-25, &
      -1.4269E-25, -1.3135E-25, -1.2187E-25, -1.1072E-25, -9.8618E-26, -8.6156E-26, &
      -7.4548E-26, -6.5189E-26, -5.9951E-26, -5.9530E-26, -1.3382E-25, -9.4018E-26, &
      -4.4026E-26, -1.6438E-26, -4.6123E-27, -1.3090E-27 /)
    REAL, PARAMETER :: a0_3_2_NO(dim58) = (/ &
      -1.0611E-23, -1.5661E-23, -9.9299E-24, 1.2695E-24, 1.3461E-23, 2.4634E-23, &
      3.3252E-23, 3.8539E-23, 4.0619E-23, 4.0660E-23, 3.9436E-23, 3.8850E-23, &
      4.1294E-23, 5.2992E-23, 5.4424E-23, 6.0700E-23, 7.2873E-23, 7.8551E-23, &
      8.8659E-23, 1.0324E-22, 1.0751E-22, 1.1495E-22, 1.2449E-22, 1.2310E-22, &
      1.2403E-22, 1.1653E-22, 1.1278E-22, 1.1154E-22, 1.0933E-22, 1.0613E-22, &
      1.0146E-22, 9.4890E-23, 8.6503E-23, 7.5812E-23, 6.3667E-23, 5.0640E-23, &
      3.8057E-23, 2.7125E-23, 1.8786E-23, 1.3264E-23, 1.0108E-23, 8.4964E-24, &
      7.7258E-24, 7.1294E-24, 6.6286E-24, 6.0377E-24, 5.3941E-24, 4.7286E-24, &
      4.1064E-24, 3.6029E-24, 3.3200E-24, 3.2972E-24, 7.3386E-24, 5.1654E-24, &
      2.4259E-24, 9.0852E-25, 2.5573E-25, 7.2728E-26 /)
    REAL, PARAMETER :: a0_4_1_NO(dim58) = (/ &
      -9.8346E-28, -1.1835E-27, -1.0679E-27, -7.7518E-28, -4.7363E-28, -1.6377E-28, &
      8.9875E-29, 2.4372E-28, 2.9444E-28, 3.0025E-28, 2.6214E-28, 2.7906E-28, &
      5.2042E-28, 1.4125E-27, 1.3483E-27, 1.5636E-27, 2.1065E-27, 2.1079E-27, &
      2.3933E-27, 2.9482E-27, 2.8697E-27, 3.0409E-27, 3.3819E-27, 3.1568E-27, &
      3.1247E-27, 2.6968E-27, 2.5134E-27, 2.4933E-27, 2.4503E-27, 2.3853E-27, &
      2.2845E-27, 2.1347E-27, 1.9430E-27, 1.6905E-27, 1.4028E-27, 1.0915E-27, &
      7.8994E-28, 5.2857E-28, 3.3235E-28, 2.0616E-28, 1.3869E-28, 1.0889E-28, &
      1.0042E-28, 9.4681E-29, 9.1792E-29, 8.5801E-29, 7.8177E-29, 6.9375E-29, &
      6.0582E-29, 5.2845E-29, 4.8318E-29, 4.8101E-29, 1.0946E-28, 7.7243E-29, &
      3.6330E-29, 1.3616E-29, 3.8317E-30, 1.0900E-30 /)
    REAL, PARAMETER :: a0_4_2_NO(dim58) = (/ &
      3.2681E-26, 4.1522E-26, 3.6391E-26, 2.3334E-26, 9.8250E-27, -4.1188E-27, &
      -1.5584E-26, -2.2568E-26, -2.4881E-26, -2.5147E-26, -2.3394E-26, -2.4176E-26, &
      -3.5375E-26, -7.6945E-26, -7.3940E-26, -8.4059E-26, -1.0968E-25, -1.0975E-25, &
      -1.2334E-25, -1.4986E-25, -1.4610E-25, -1.5434E-25, -1.7085E-25, -1.5991E-25, &
      -1.5834E-25, -1.3737E-25, -1.2835E-25, -1.2736E-25, -1.2522E-25, -1.2199E-25, &
      -1.1695E-25, -1.0943E-25, -9.9769E-26, -8.6994E-26, -7.2374E-26, -5.6502E-26, &
      -4.1060E-26, -2.7625E-26, -1.7501E-26, -1.0964E-26, -7.4555E-27, -5.9003E-27, &
      -5.4565E-27, -5.1545E-27, -5.0019E-27, -4.6844E-27, -4.2788E-27, -3.8087E-27, &
      -3.3375E-27, -2.9212E-27, -2.6767E-27, -2.6650E-27, -6.0028E-27, -4.2438E-27, &
      -2.0018E-27, -7.5254E-28, -2.1245E-28, -6.0560E-29 /)

    jval_2d(ip_NO)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_NO(0) = p3(a0_1_1_NO(i0(j,k))*dlv2(j,k) + a0_1_2_NO(i0(j,k)), &
          a0_2_1_NO(i0(j,k))*dlv2(j,k) + a0_2_2_NO(i0(j,k)), &
          a0_3_1_NO(i0(j,k))*dlv2(j,k) + a0_3_2_NO(i0(j,k)), &
          a0_4_1_NO(i0(j,k))*dlv2(j,k) + a0_4_2_NO(i0(j,k)), &
          v3_du1(j,k))
        dj = 0. &
          + sig_NO(0) * fint(j,k,0)
        jval_2d(ip_NO)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,8)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_NO
