  ! -*- f90 -*-

  ! **************************************************************************

  ! This file contains the subroutines jval_cal and jval_cal_*. They are
  ! generated automatically by jvpp. Do not edit this file!

  ! Based on f90 files:
  ! -rw------- 1 sander sander   1399 2011-10-26 13:55 jvpp.f90
  ! -rw------- 1 sander sander   4735 2013-03-02 16:36 jvpp_mem.f90
  ! -rw------- 1 sander sander  13139 2012-03-13 16:03 jvpp_step1.f90
  ! -rw------- 1 sander sander  36586 2013-03-05 11:47 jvpp_step2.f90
  ! -rw------- 1 sander sander  63934 2013-03-11 13:33 jvpp_step3.f90
  ! lrwxrwxrwx 1 sander sander     38 2013-02-05 17:32 messy_cmn_photol_mem.f90 -> ../../../smcl/messy_cmn_photol_mem.f90
  ! lrwxrwxrwx 1 sander sander     42 2013-02-05 17:31 messy_main_constants_mem.f90 -> ../../../smcl/messy_main_constants_mem.f90
  ! -rw------- 1 sander sander  28599 2009-02-09 13:37 messy_main_lsq.f90
  ! -rw------- 1 sander sander 147010 2011-03-17 13:56 messy_main_spline.f90
  ! Input is from:
  ! /home/sander/e2/messy_d2.41i_rs/messy/mbm/jval/jvpp/dat_lit/spectra
  ! total 604
  ! -rw------- 1 sander sander   328 2011-11-07 16:29 Br2.nml
  ! -rw------- 1 sander sander  1513 2011-11-07 16:36 Br2.sig
  ! -rw------- 1 sander sander   517 2012-01-03 17:08 BrCl.nml
  ! -rw------- 1 sander sander  1379 2011-11-09 14:44 BrCl.sig
  ! -rw------- 1 sander sander   330 2011-10-28 13:58 BrNO2.nml
  ! -rw------- 1 sander sander  1110 2011-10-28 13:53 BrNO2.sig
  ! -rw------- 1 sander sander   330 2011-11-02 16:19 BrNO3.nml
  ! -rw------- 1 sander sander  2626 2011-11-02 16:19 BrNO3.sig
  ! -rw------- 1 sander sander  4502 2011-11-09 13:45 BrNO3.tc2
  ! -rw------- 1 sander sander   324 2011-10-28 19:19 BrO.nml
  ! -rw------- 1 sander sander  3819 2008-11-05 17:57 BrO.sig
  ! -rw------- 1 sander sander   331 2011-11-07 17:26 C3H7I.nml
  ! -rw------- 1 sander sander   749 2011-11-07 17:26 C3H7I.sig
  ! -rw------- 1 sander sander  1046 2011-11-09 13:39 C3H7I.tc2
  ! -rw------- 1 sander sander   329 2011-11-07 16:37 CCl4.nml
  ! -rw------- 1 sander sander  1013 2011-11-07 16:37 CCl4.sig
  ! -rw------- 1 sander sander   393 2012-01-03 17:10 CF2Cl2.nml
  ! -rw------- 1 sander sander   757 2011-11-07 16:48 CF2Cl2.sig
  ! -rw------- 1 sander sander   332 2011-11-07 16:52 CF2ClBr.nml
  ! -rw------- 1 sander sander  1535 2011-11-07 16:52 CF2ClBr.sig
  ! -rw------- 1 sander sander   330 2011-11-07 16:53 CF3Br.nml
  ! -rw------- 1 sander sander  1023 2011-11-07 16:54 CF3Br.sig
  ! -rw------- 1 sander sander   391 2012-01-03 17:09 CFCl3.nml
  ! -rw------- 1 sander sander   753 2011-11-07 16:46 CFCl3.sig
  ! -rw------- 1 sander sander   332 2011-11-07 18:02 CH2Br2.nml
  ! -rw------- 1 sander sander   763 2011-11-07 18:03 CH2Br2.sig
  ! -rw------- 1 sander sander   327 2011-11-07 18:04 CH2Br2.tc1
  ! -rw------- 1 sander sander   332 2011-11-07 18:01 CH2ClBr.nml
  ! -rw------- 1 sander sander   898 2011-11-07 18:01 CH2ClBr.sig
  ! -rw------- 1 sander sander   400 2012-01-03 17:13 CH2ClI.nml
  ! -rw------- 1 sander sander   662 2011-11-07 17:31 CH2ClI.sig
  ! -rw------- 1 sander sander   400 2012-01-03 17:14 CH2I2.nml
  ! -rw------- 1 sander sander   762 2011-11-07 17:36 CH2I2.sig
  ! -rw------- 1 sander sander   330 2011-11-07 16:49 CH3Br.nml
  ! -rw------- 1 sander sander  1156 2011-11-07 16:49 CH3Br.sig
  ! -rw------- 1 sander sander   333 2011-11-02 18:17 CH3CCl3.nml
  ! -rw------- 1 sander sander   343 2011-11-02 18:17 CH3CCl3.sig
  ! -rw------- 1 sander sander   332 2011-11-07 14:55 CH3CHO.nml
  ! -rw------- 1 sander sander   510 2011-11-07 15:15 CH3CHO.phi
  ! -rw------- 1 sander sander  1753 2011-11-07 15:07 CH3CHO.sig
  ! -rw------- 1 sander sander   330 2011-11-02 17:08 CH3Cl.nml
  ! -rw------- 1 sander sander   597 2011-11-02 17:08 CH3Cl.sig
  ! -rw------- 1 sander sander   333 2011-11-07 14:37 CH3CO3H.nml
  ! -rw------- 1 sander sander  1351 2011-11-07 14:49 CH3CO3H.sig
  ! -rw------- 1 sander sander   146 2011-10-10 13:34 CH3COCH3.nml
  ! -rw------- 1 sander sander   425 2012-01-03 17:13 CH3I.nml
  ! -rw------- 1 sander sander   572 2011-11-07 16:56 CH3I.sig
  ! -rw------- 1 sander sander   331 2011-10-24 13:14 CH3OOH.nml
  ! -rw------- 1 sander sander   740 2011-10-25 13:17 CH3OOH.sig
  ! -rw------- 1 sander sander   401 2011-10-10 13:34 CH4.nml
  ! -rw------- 1 sander sander   435 2012-01-03 17:15 CHBr3.nml
  ! -rw------- 1 sander sander  1728 2008-11-05 16:54 CHBr3.sig
  ! -rw------- 1 sander sander   332 2011-11-03 15:53 CHCl2Br.nml
  ! -rw------- 1 sander sander  1057 2011-11-03 15:53 CHCl2Br.sig
  ! -rw------- 1 sander sander   332 2011-11-03 15:58 CHClBr2.nml
  ! -rw------- 1 sander sander  1054 2011-11-04 11:17 CHClBr2.sig
  ! -rw------- 1 sander sander   371 2012-01-03 17:11 CHOH.nml
  ! -rw------- 1 sander sander  1067 2011-10-24 18:07 CHOH.phi
  ! lrwxrwxrwx 1 sander sander     8 2011-07-26 18:16 CHOH.sig -> HCHO.sig
  ! lrwxrwxrwx 1 sander sander     8 2011-07-26 18:16 CHOH.tc1 -> HCHO.tc1
  ! -rw------- 1 sander sander   323 2011-11-07 15:49 Cl2.nml
  ! -rw------- 1 sander sander   332 2011-10-22 23:32 Cl2O2.nml
  ! -rw------- 1 sander sander  2859 2011-10-25 13:17 Cl2O2.sig
  ! -rw------- 1 sander sander   572 2011-11-07 15:55 Cl2.sig
  ! -rw------- 1 sander sander   330 2012-05-23 17:35 ClNO2.nml
  ! -rw------- 1 sander sander  8950 2012-05-23 17:48 ClNO2.sig
  ! -rw------- 1 sander sander 13143 2012-09-07 11:02 ClNO2.tc2
  ! -rw------- 1 sander sander   331 2011-10-28 15:44 ClNO3.nml
  ! -rw------- 1 sander sander  1725 2011-10-28 16:31 ClNO3.sig
  ! -rw------- 1 sander sander  3461 2011-10-28 16:30 ClNO3.tc2
  ! -rw------- 1 sander sander   332 2011-10-28 16:36 ClONO2.nml
  ! lrwxrwxrwx 1 sander sander     9 2011-07-26 18:16 ClONO2.sig -> ClNO3.sig
  ! lrwxrwxrwx 1 sander sander     9 2011-10-28 16:38 ClONO2.tc2 -> ClNO3.tc2
  ! -rw------- 1 sander sander   408 2013-03-07 17:23 CO2.nml
  ! -rw------- 1 sander sander  5697 2013-03-05 16:48 CO2.sig
  ! -rw------- 1 sander sander   372 2012-01-03 17:11 COH2.nml
  ! -rw------- 1 sander sander  1333 2011-10-24 18:10 COH2.phi
  ! lrwxrwxrwx 1 sander sander     8 2011-07-26 18:16 COH2.sig -> HCHO.sig
  ! lrwxrwxrwx 1 sander sander     8 2011-07-26 18:16 COH2.tc1 -> HCHO.tc1
  ! -rw------- 1 sander sander   138 2011-10-10 13:34 GLYOX.nml
  ! -rw------- 1 sander sander   328 2011-11-04 12:22 H2O2.nml
  ! -rw------- 1 sander sander   586 2011-11-04 12:22 H2O2.sig
  ! -rw------- 1 sander sander   370 2011-10-21 15:39 H2O.nml
  ! -rw------- 1 sander sander  1719 2011-11-09 16:32 H2O.sig
  ! -rw------- 1 sander sander   145 2011-10-10 13:34 H2SO4.nml
  ! -rw------- 1 sander sander  2608 2011-10-24 19:15 HCHO.sig
  ! -rw------- 1 sander sander  1975 2011-10-25 13:17 HCHO.tc1
  ! -rw------- 1 sander sander   324 2011-11-07 17:58 HCl.nml
  ! -rw------- 1 sander sander   534 2011-11-07 17:58 HCl.sig
  ! -rw------- 1 sander sander   329 2011-11-04 13:07 HNO3.nml
  ! -rw------- 1 sander sander  1620 2011-11-04 13:07 HNO3.sig
  ! -rw------- 1 sander sander  1478 2011-11-09 12:23 HNO3.tc1
  ! -rw------- 1 sander sander   399 2011-11-04 13:10 HNO4.nml
  ! -rw------- 1 sander sander  1125 2011-11-04 13:10 HNO4.sig
  ! -rw------- 1 sander sander   326 2011-11-07 15:58 HOBr.nml
  ! -rw------- 1 sander sander  1026 2011-11-07 16:04 HOBr.sig
  ! -rw------- 1 sander sander   333 2011-10-24 13:05 HOCH2CHO.nml
  ! -rw------- 1 sander sander  1133 2011-10-25 13:17 HOCH2CHO.sig
  ! -rw------- 1 sander sander   326 2011-11-07 15:21 HOCl.nml
  ! -rw------- 1 sander sander  1834 2011-11-07 15:21 HOCl.sig
  ! -rw------- 1 sander sander   327 2011-11-07 17:46 HOI.nml
  ! -rw------- 1 sander sander  1673 2011-11-07 17:46 HOI.sig
  ! -rw------- 1 sander sander   328 2011-11-04 13:27 HONO.nml
  ! -rw------- 1 sander sander  3547 2011-11-04 13:27 HONO.sig
  ! -rw------- 1 sander sander   343 2011-10-25 15:06 I2.nml
  ! -rw------- 1 sander sander  1978 2008-11-05 18:02 I2.sig
  ! -rw------- 1 sander sander   327 2011-11-07 17:52 IBr.nml
  ! -rw------- 1 sander sander   681 2011-11-07 17:52 IBr.sig
  ! -rw------- 1 sander sander   376 2012-01-03 17:14 ICl.nml
  ! -rw------- 1 sander sander   741 2011-10-25 13:17 ICl.sig
  ! -rw------- 1 sander sander   329 2011-11-07 17:54 INO2.nml
  ! -rw------- 1 sander sander   618 2011-11-07 17:55 INO2.sig
  ! -rw------- 1 sander sander   329 2011-11-07 17:56 INO3.nml
  ! -rw------- 1 sander sander   618 2011-11-07 17:56 INO3.sig
  ! -rw------- 1 sander sander   322 2011-11-07 17:40 IO.nml
  ! -rw------- 1 sander sander  2317 2011-11-07 17:41 IO.sig
  ! -rw------- 1 sander sander   140 2011-10-10 13:34 MACR.nml
  ! -rw------- 1 sander sander   143 2011-10-10 13:34 MGLYOX.nml
  ! -rw------- 1 sander sander   139 2011-10-10 13:34 MVK.nml
  ! -rw------- 1 sander sander   332 2011-11-04 12:24 N2O5.nml
  ! -rw------- 1 sander sander  1703 2011-11-04 12:24 N2O5.sig
  ! -rw------- 1 sander sander   484 2011-10-26 16:50 N2O5.tc2
  ! -rw------- 1 sander sander   331 2011-10-26 15:35 N2O.nml
  ! -rw------- 1 sander sander   325 2011-10-28 14:28 NO2.nml
  ! -rw------- 1 sander sander   328 2011-10-28 14:49 NO2O.nml
  ! -rw------- 1 sander sander   822 2009-02-09 16:02 NO2O.phi
  ! lrwxrwxrwx 1 sander sander     7 2011-07-26 18:16 NO2O.sig -> NO3.sig
  ! -rw------- 1 sander sander   368 2011-10-28 14:22 NO2.phi
  ! -rw------- 1 sander sander  3631 2011-10-28 14:27 NO2.s2t
  ! -rw------- 1 sander sander  4681 2009-02-09 17:20 NO3.sig
  ! -rw------- 1 sander sander   134 2011-10-10 13:34 NO.nml
  ! -rw------- 1 sander sander   328 2011-10-28 14:48 NOO2.nml
  ! -rw------- 1 sander sander   819 2009-02-09 16:02 NOO2.phi
  ! lrwxrwxrwx 1 sander sander     7 2011-07-26 18:16 NOO2.sig -> NO3.sig
  ! -rw------- 1 sander sander   334 2013-02-05 13:12 O1D.nml
  ! lrwxrwxrwx 1 sander sander     6 2013-02-05 13:09 O1D.s2t -> O3.s2t
  ! -rw------- 1 sander sander   472 2012-01-03 17:12 O2.nml
  ! -rw------- 1 sander sander   753 2011-10-24 19:05 O2.sig
  ! -rw------- 1 sander sander   334 2013-02-05 13:12 O3P.nml
  ! lrwxrwxrwx 1 sander sander     6 2013-02-05 13:09 O3P.s2t -> O3.s2t
  ! -rw------- 1 sander sander  6735 2013-02-05 12:20 O3.s2t
  ! -rw------- 1 sander sander   356 2011-11-07 15:28 OClO.nml
  ! -rw------- 1 sander sander  4243 2011-11-07 15:39 OClO.sig
  ! -rw------- 1 sander sander   327 2011-11-02 18:52 OCS.nml
  ! -rw------- 1 sander sander  1355 2011-11-02 18:59 OCS.s2t
  ! -rw------- 1 sander sander   327 2011-11-07 14:19 PAN.nml
  ! -rw------- 1 sander sander  1584 2011-11-07 14:30 PAN.sig
  ! -rw------- 1 sander sander  1253 2011-11-09 12:22 PAN.tc1
  ! -rw------- 1 sander sander   390 2011-10-10 13:34 SF6.nml
  ! -rw------- 1 sander sander   328 2011-11-02 18:36 SO3.nml
  ! -rw------- 1 sander sander  1177 2011-11-09 16:01 SO3.sig
  ! /home/sander/e2/messy_d2.41i_rs/messy/mbm/jval/jvpp/dat_lit/hardcoded
  ! total 0
  ! lrwxrwxrwx 1 sander sander 45 2011-10-06 15:23 jval_cal_CH3COCH3.f90 -> ../../dat_m17/hardcoded/jval_cal_CH3COCH3.f90
  ! lrwxrwxrwx 1 sander sander 42 2011-10-06 15:23 jval_cal_GLYOX.f90 -> ../../dat_m17/hardcoded/jval_cal_GLYOX.f90
  ! lrwxrwxrwx 1 sander sander 42 2011-10-06 15:24 jval_cal_H2SO4.f90 -> ../../dat_m17/hardcoded/jval_cal_H2SO4.f90
  ! lrwxrwxrwx 1 sander sander 41 2011-10-06 15:23 jval_cal_MACR.f90 -> ../../dat_m17/hardcoded/jval_cal_MACR.f90
  ! lrwxrwxrwx 1 sander sander 43 2011-10-06 15:23 jval_cal_MGLYOX.f90 -> ../../dat_m17/hardcoded/jval_cal_MGLYOX.f90
  ! lrwxrwxrwx 1 sander sander 40 2011-10-06 15:23 jval_cal_MVK.f90 -> ../../dat_m17/hardcoded/jval_cal_MVK.f90
  ! lrwxrwxrwx 1 sander sander 39 2011-10-06 15:23 jval_cal_NO.f90 -> ../../dat_m17/hardcoded/jval_cal_NO.f90
  ! Contents of jvpp.log:
  !  inputdir = dat_lit
  ! ************************************************************************
  ! *** STEP 1
  ! ************************************************************************
  ! 
  ! sigma up to 7.35E-24 in  41 data points from 205.00-245.00 nm for O2
  ! s2t   up to 1.14E-17 in 167 data points from 186.05-825.00 nm for O3P
  ! s2t   up to 1.14E-17 in 167 data points from 186.05-825.00 nm for O1D
  ! sigma up to 6.72E-19 in  33 data points from 190.00-350.00 nm for H2O2
  ! s2t   up to 6.44E-19 in  89 data points from 242.43-660.00 nm for NO2
  !   - quantum yields phi:  27 data points from 100.00-850.00 nm
  ! sigma up to 2.25E-17 in 289 data points from 403.00-691.00 nm for NO2O
  !   - quantum yields phi:  60 data points from 100.00-850.00 nm
  ! sigma up to 2.25E-17 in 289 data points from 403.00-691.00 nm for NOO2
  !   - quantum yields phi:  60 data points from 100.00-850.00 nm
  ! sigma up to 9.10E-18 in 103 data points from 200.00-420.00 nm for N2O5
  !   - T-dep with 2 coeff:  16 data points from 260.00-410.00 nm
  ! sigma up to 1.23E-17 in  80 data points from 192.00-350.00 nm for HNO3
  !   - T-dep with 1 coeff:  80 data points from 192.00-350.00 nm
  ! sigma up to 1.01E-17 in  54 data points from 190.00-350.00 nm for HNO4
  ! sigma up to 4.29E-18 in  78 data points from 196.00-350.00 nm for PAN
  !   - T-dep with 1 coeff:  75 data points from 196.00-344.00 nm
  ! sigma up to 2.24E-18 in 192 data points from 184.00-396.00 nm for HONO
  ! sigma up to 3.12E-19 in  40 data points from 210.00-405.00 nm for CH3OOH
  ! sigma up to 7.23E-20 in 150 data points from 226.00-375.00 nm for COH2
  !   - quantum yields phi: 112 data points from 250.00-361.00 nm
  !   - T-dep with 1 coeff: 107 data points from 250.00-356.00 nm
  ! sigma up to 7.23E-20 in 150 data points from 226.00-375.00 nm for CHOH
  !   - quantum yields phi:  90 data points from 250.00-339.00 nm
  !   - T-dep with 1 coeff: 107 data points from 250.00-356.00 nm
  ! sigma up to 3.81E-19 in  66 data points from 210.00-340.00 nm for CH3CO3H
  ! sigma up to 4.86E-20 in 101 data points from 202.00-360.00 nm for CH3CHO
  !   - quantum yields phi:  39 data points from 256.00-332.00 nm
  ! ----------------------------------------------------------------- CH3COCH3
  ! ----------------------------------------------------------------- MGLYOX
  ! sigma up to 2.06E-19 in 111 data points from 200.00-420.00 nm for HOCl
  ! sigma up to 1.21E-17 in 226 data points from 247.00-472.00 nm for OClO
  ! sigma up to 7.58E-18 in 141 data points from 200.00-570.00 nm for Cl2O2
  ! sigma up to 3.45E-18 in 119 data points from 196.00-432.00 nm for ClNO3
  !   - T-dep with 2 coeff: 119 data points from 196.00-432.00 nm
  ! sigma up to 4.01E-18 in 456 data points from 200.00-475.00 nm for ClNO2
  !   - T-dep with 2 coeff: 456 data points from 200.00-475.00 nm
  ! sigma up to 2.56E-19 in  30 data points from 260.00-550.00 nm for Cl2
  ! sigma up to 1.30E-17 in 198 data points from 286.50-385.00 nm for BrO
  ! sigma up to 2.50E-19 in  61 data points from 250.00-550.00 nm for HOBr
  ! sigma up to 4.00E-19 in  81 data points from 200.00-600.00 nm for BrCl
  ! sigma up to 6.80E-18 in 151 data points from 200.00-500.00 nm for BrNO3
  !   - T-dep with 2 coeff: 151 data points from 200.00-500.00 nm
  ! sigma up to 5.39E-17 in  75 data points from 185.00-580.00 nm for BrNO2
  ! sigma up to 6.51E-19 in  91 data points from 200.00-650.00 nm for Br2
  ! sigma up to 1.01E-17 in  44 data points from 174.00-275.00 nm for CCl4
  ! sigma up to 1.10E-18 in  32 data points from 174.00-236.00 nm for CH3Cl
  ! sigma up to 4.24E-18 in  18 data points from 170.00-255.00 nm for CH3CCl3
  ! sigma up to 3.24E-18 in  35 data points from 174.00-260.00 nm for CFCl3
  ! sigma up to 1.89E-18 in  36 data points from 170.00-240.00 nm for CF2Cl2
  ! sigma up to 1.28E-17 in  56 data points from 174.00-290.00 nm for CH3Br
  ! sigma up to 3.23E-18 in  76 data points from 170.00-320.00 nm for CF2ClBr
  ! sigma up to 1.25E-19 in  61 data points from 168.00-300.00 nm for CF3Br
  ! sigma up to 1.20E-18 in  32 data points from 210.00-365.00 nm for CH3I
  ! sigma up to 1.48E-18 in  36 data points from 205.00-380.00 nm for C3H7I
  !   - T-dep with 2 coeff:  36 data points from 205.00-380.00 nm
  ! sigma up to 1.32E-18 in  38 data points from 205.00-390.00 nm for CH2ClI
  ! sigma up to 4.07E-18 in  37 data points from 205.00-385.00 nm for CH2I2
  ! sigma up to 2.05E-17 in 133 data points from 339.00-471.00 nm for IO
  ! sigma up to 3.92E-19 in 101 data points from 280.00-480.00 nm for HOI
  ! sigma up to 2.01E-17 in 113 data points from 185.00-745.00 nm for I2
  ! sigma up to 5.00E-19 in  42 data points from 210.00-600.00 nm for ICl
  ! sigma up to 1.22E-18 in  39 data points from 220.00-600.00 nm for IBr
  ! sigma up to 4.22E-18 in  35 data points from 210.00-380.00 nm for INO2
  ! sigma up to 1.21E-17 in  35 data points from 245.00-415.00 nm for INO3
  ! ----------------------------------------------------------------- SO2
  ! sigma up to 1.14E-18 in  76 data points from 180.00-330.00 nm for SO3
  ! s2t   up to 2.95E-19 in  41 data points from 186.10-296.30 nm for OCS
  ! ----------------------------------------------------------------- CS2
  ! sigma up to 1.69E-17 in  98 data points from 121.00-198.00 nm for H2O
  ! ----------------------------------------------------------------- N2O
  ! ----------------------------------------------------------------- NO
  ! sigma up to 2.47E-20 in 297 data points from 169.57-300.00 nm for CO2
  ! sigma up to 3.43E-18 in  31 data points from 135.00-230.00 nm for HCl
  ! sigma up to 1.15E-18 in  69 data points from 200.00-320.00 nm for CHCl2Br
  ! sigma up to 3.25E-18 in  62 data points from 200.00-310.00 nm for CHClBr2
  ! sigma up to 1.51E-18 in  53 data points from 187.00-290.00 nm for CH2ClBr
  ! sigma up to 1.17E-17 in  34 data points from 174.00-300.00 nm for CH2Br2
  !   - T-dep with 1 coeff:  18 data points from 215.00-300.00 nm
  ! sigma up to 1.60E-17 in  97 data points from 170.00-362.00 nm for CHBr3
  ! ----------------------------------------------------------------- SF6
  ! ----------------------------------------------------------------- NO3NOO
  ! sigma up to 3.45E-18 in 119 data points from 196.00-432.00 nm for ClONO2
  !   - T-dep with 2 coeff: 119 data points from 196.00-432.00 nm
  ! ----------------------------------------------------------------- MACR
  ! ----------------------------------------------------------------- MVK
  ! ----------------------------------------------------------------- GLYOX
  ! sigma up to 2.06E-19 in  63 data points from 208.00-332.00 nm for HOCH2CHO
  ! ----------------------------------------------------------------- CH4
  ! ----------------------------------------------------------------- O2_b1b2
  ! ----------------------------------------------------------------- O2_b1
  ! ----------------------------------------------------------------- O2_b2
  ! ----------------------------------------------------------------- O3PO1D
  ! ----------------------------------------------------------------- O3Pp
  ! ----------------------------------------------------------------- H2O1D
  ! ----------------------------------------------------------------- N2
  ! ----------------------------------------------------------------- N2_b1
  ! ----------------------------------------------------------------- N2_b2
  ! ----------------------------------------------------------------- N2_b3
  ! ----------------------------------------------------------------- NN2D
  ! ----------------------------------------------------------------- NOp
  ! ----------------------------------------------------------------- Op_em
  ! ----------------------------------------------------------------- O2p_em
  ! ----------------------------------------------------------------- Op_O_em
  ! ----------------------------------------------------------------- N2p_em
  ! ----------------------------------------------------------------- Np_N_em
  ! ----------------------------------------------------------------- Np_N2D_em
  ! ----------------------------------------------------------------- N_N2D_em
  ! ----------------------------------------------------------------- Op_em_b
  ! ----------------------------------------------------------------- se_O2_b1
  ! ----------------------------------------------------------------- se_O2_b2
  ! ----------------------------------------------------------------- se_N2_b1
  ! ----------------------------------------------------------------- se_N2_b2
  ! ----------------------------------------------------------------- se_N2_b3
  ! ----------------------------------------------------------------- se_N2_b4
  ! ----------------------------------------------------------------- se_Op_em
  ! ----------------------------------------------------------------- O2_aurq
  ! ----------------------------------------------------------------- N2_aurq
  ! ----------------------------------------------------------------- H2SO4
  ! ----------------------------------------------------------------- C3O2
  ! 
  ! ************************************************************************
  ! *** STEP 2
  ! ************************************************************************
  ! 
  ! ------------------------------------------------------------------------
  ! Calculations at a fixed reference temperature:
  ! ------------------------------------------------------------------------
  ! # T_ref   wave_i wave_f flx_sum  v2min   v2max  v3min v3max 
  ! ------------------------------------------------------------------------
  !                         photons   mcl     mcl               
  !      K      nm     nm   -------   ---     ---    DU    DU   
  !                          cm2*s    cm3     cm3               
  ! ------------------------------------------------------------------------
  ! 1  240.00 179.37 201.01 9.5E+12 1.3E+19 1.3E+24 0.00   300.
  ! 2  250.00 203.05 239.52 1.7E+14 2.7E+22 1.3E+24 0.50   300.
  ! 3  250.00 242.42 287.77 1.1E+15                 0.50   300.
  ! 4  250.00 291.97 305.00 1.3E+15                 0.50  7000.
  ! 5  250.00 306.00 313.00 8.0E+14                 0.50  7000.
  ! 6  250.00 314.00 335.00 3.4E+15                 0.50  7000.
  ! 7  250.00 340.00 420.00 2.1E+16                 0.50  7000.
  ! 8  250.00 425.00 680.00 1.3E+17                 0.50  7000.
  ! ------------------------------------------------------------------------
  ! 
  ! ------------------------------------------------------------------------
  ! Calculations at several temperatures:
  ! ------------------------------------------------------------------------
  ! # T_ref   wave_i wave_f flx_sum  v2min   v2max  v3min v3max 
  ! ------------------------------------------------------------------------
  !                         photons   mcl     mcl               
  !      K      nm     nm   -------   ---     ---    DU    DU   
  !                          cm2*s    cm3     cm3               
  ! ------------------------------------------------------------------------
  ! 1 180-320 179.37 201.01 9.5E+12 1.3E+19 1.3E+24 0.01   180.
  ! 2 180-320 203.05 239.52 1.7E+14 5.3E+22 5.3E+23 0.50   300.
  ! 3 180-320 242.42 287.77 1.1E+15                 0.50   300.
  ! 4 180-320 291.97 305.00 1.3E+15                 0.50  7000.
  ! 5 180-320 306.00 313.00 8.0E+14                 0.50  7000.
  ! 6 180-320 314.00 335.00 3.4E+15                 0.50  7000.
  ! 7 180-320 340.00 420.00 2.1E+16                 0.50  7000.
  ! 8 180-320 425.00 680.00 1.3E+17                 0.50  7000.
  ! ------------------------------------------------------------------------
  ! 
  ! O2        (other Tdep)     workdir_176/O2.sig_176
  ! O3P       (Tdep from file) workdir_176/O3P.s2t_176
  ! O1D       (Tdep from file) workdir_176/O1D.s2t_176
  ! H2O2      (other Tdep)     workdir_176/H2O2.sig_176
  ! NO2       (Tdep from file) workdir_176/NO2.s2t_176
  ! NO2O      (other Tdep)     workdir_176/NO2O.sig_176
  ! NOO2      (other Tdep)     workdir_176/NOO2.sig_176
  ! N2O5      (other Tdep)     workdir_176/N2O5.sig_176
  ! HNO3      (other Tdep)     workdir_176/HNO3.sig_176
  ! HNO4      (no Tdep)        workdir_176/HNO4.sig_176
  ! PAN       (other Tdep)     workdir_176/PAN.sig_176
  ! HONO      (no Tdep)        workdir_176/HONO.sig_176
  ! CH3OOH    (no Tdep)        workdir_176/CH3OOH.sig_176
  ! COH2      (other Tdep)     workdir_176/COH2.sig_176
  ! CHOH      (other Tdep)     workdir_176/CHOH.sig_176
  ! CH3CO3H   (no Tdep)        workdir_176/CH3CO3H.sig_176
  ! CH3CHO    (no Tdep)        workdir_176/CH3CHO.sig_176
  ! CH3COCH3  ---              ---
  ! MGLYOX    ---              ---
  ! HOCl      (no Tdep)        workdir_176/HOCl.sig_176
  ! OClO      (no Tdep)        workdir_176/OClO.sig_176
  ! Cl2O2     (no Tdep)        workdir_176/Cl2O2.sig_176
  ! ClNO3     (other Tdep)     workdir_176/ClNO3.sig_176
  ! ClNO2     (other Tdep)     workdir_176/ClNO2.sig_176
  ! Cl2       (no Tdep)        workdir_176/Cl2.sig_176
  ! BrO       (no Tdep)        workdir_176/BrO.sig_176
  ! HOBr      (no Tdep)        workdir_176/HOBr.sig_176
  ! BrCl      (no Tdep)        workdir_176/BrCl.sig_176
  ! BrNO3     (other Tdep)     workdir_176/BrNO3.sig_176
  ! BrNO2     (no Tdep)        workdir_176/BrNO2.sig_176
  ! Br2       (no Tdep)        workdir_176/Br2.sig_176
  ! CCl4      (no Tdep)        workdir_176/CCl4.sig_176
  ! CH3Cl     (other Tdep)     workdir_176/CH3Cl.sig_176
  ! CH3CCl3   (other Tdep)     workdir_176/CH3CCl3.sig_176
  ! CFCl3     (other Tdep)     workdir_176/CFCl3.sig_176
  ! CF2Cl2    (other Tdep)     workdir_176/CF2Cl2.sig_176
  ! CH3Br     (no Tdep)        workdir_176/CH3Br.sig_176
  ! CF2ClBr   (no Tdep)        workdir_176/CF2ClBr.sig_176
  ! CF3Br     (no Tdep)        workdir_176/CF3Br.sig_176
  ! CH3I      (no Tdep)        workdir_176/CH3I.sig_176
  ! C3H7I     (other Tdep)     workdir_176/C3H7I.sig_176
  ! CH2ClI    (no Tdep)        workdir_176/CH2ClI.sig_176
  ! CH2I2     (no Tdep)        workdir_176/CH2I2.sig_176
  ! IO        (no Tdep)        workdir_176/IO.sig_176
  ! HOI       (no Tdep)        workdir_176/HOI.sig_176
  ! I2        (no Tdep)        workdir_176/I2.sig_176
  ! ICl       (no Tdep)        workdir_176/ICl.sig_176
  ! IBr       (no Tdep)        workdir_176/IBr.sig_176
  ! INO2      (no Tdep)        workdir_176/INO2.sig_176
  ! INO3      (no Tdep)        workdir_176/INO3.sig_176
  ! SO2       ---              ---
  ! SO3       (no Tdep)        workdir_176/SO3.sig_176
  ! OCS       (Tdep from file) workdir_176/OCS.s2t_176
  ! CS2       ---              ---
  ! H2O       (no Tdep)        workdir_176/H2O.sig_176
  ! N2O       (other Tdep)     calculated spectrum
  ! NO        ---              ---
  ! CO2       (no Tdep)        workdir_176/CO2.sig_176
  ! HCl       (no Tdep)        workdir_176/HCl.sig_176
  ! CHCl2Br   (no Tdep)        workdir_176/CHCl2Br.sig_176
  ! CHClBr2   (no Tdep)        workdir_176/CHClBr2.sig_176
  ! CH2ClBr   (no Tdep)        workdir_176/CH2ClBr.sig_176
  ! CH2Br2    (other Tdep)     workdir_176/CH2Br2.sig_176
  ! CHBr3     (other Tdep)     workdir_176/CHBr3.sig_176
  ! SF6       ---              ---
  ! NO3NOO    ---              ---
  ! ClONO2    (other Tdep)     workdir_176/ClONO2.sig_176
  ! MACR      ---              ---
  ! MVK       ---              ---
  ! GLYOX     ---              ---
  ! HOCH2CHO  (no Tdep)        workdir_176/HOCH2CHO.sig_176
  ! CH4       ---              ---
  ! O2_b1b2   ---              ---
  ! O2_b1     ---              ---
  ! O2_b2     ---              ---
  ! O3PO1D    ---              ---
  ! O3Pp      ---              ---
  ! H2O1D     ---              ---
  ! N2        ---              ---
  ! N2_b1     ---              ---
  ! N2_b2     ---              ---
  ! N2_b3     ---              ---
  ! NN2D      ---              ---
  ! NOp       ---              ---
  ! Op_em     ---              ---
  ! O2p_em    ---              ---
  ! Op_O_em   ---              ---
  ! N2p_em    ---              ---
  ! Np_N_em   ---              ---
  ! Np_N2D_em ---              ---
  ! N_N2D_em  ---              ---
  ! Op_em_b   ---              ---
  ! se_O2_b1  ---              ---
  ! se_O2_b2  ---              ---
  ! se_N2_b1  ---              ---
  ! se_N2_b2  ---              ---
  ! se_N2_b3  ---              ---
  ! se_N2_b4  ---              ---
  ! se_Op_em  ---              ---
  ! O2_aurq   ---              ---
  ! N2_aurq   ---              ---
  ! H2SO4     ---              ---
  ! C3O2      ---              ---
  ! 
  ! ************************************************************************
  ! *** STEP 3
  ! ************************************************************************
  ! 
  ! ------------------------------------------------------------------------
  !    species        deg_tconst           deg_tdep   Lyman-alpha or IR
  !              1 2 3 4 5 6 7 8    1 2 3 4 5 6 7 8   addition
  ! ------------------------------------------------------------------------
  !         O2   1 1 1 _ _ _ _ _    2 2 2 _ _ _ _ _   "r_O2(j,k) * phi_la"
  !        O3P   1 1 1 1 3 3 3 3    2 2 2 2 2 2 2 _   ""
  !        O1D   1 1 1 1 3 3 3 _    2 2 2 2 2 2 2 _   ""
  !       H2O2   1 1 1 1 3 3 3 _    2 2 2 2 2 2 2 _   ""
  !        NO2   _ _ 1 1 3 3 3 3    _ _ 2 2 2 2 2 2   ""
  !       NO2O   _ _ _ _ _ _ 3 3    _ _ _ _ _ _ 2 2   ""
  !       NOO2   _ _ _ _ _ _ _ 3    _ _ _ _ _ _ _ 2   ""
  !       N2O5   1 1 1 1 3 3 3 _    2 2 2 2 2 2 2 _   ""
  !       HNO3   1 1 1 1 3 3 3 _    2 2 2 2 2 2 2 _   ""
  !       HNO4   1 1 1 1 3 3 3 _                      "1.E-5"
  !        PAN   1 1 1 1 3 3 3 _    2 2 2 2 2 2 2 _   ""
  !       HONO   1 1 1 1 3 3 3 _                      ""
  !     CH3OOH   _ 1 1 1 3 3 3 _                      ""
  !       COH2   _ _ 1 1 3 3 3 _    _ _ 2 2 2 2 2 _   ""
  !       CHOH   _ _ 1 1 3 3 _ _    _ _ 2 2 2 2 _ _   ""
  !    CH3CO3H   _ 1 1 1 3 3 3 _                      ""
  !     CH3CHO   _ _ 1 1 3 3 _ _                      ""
  !   CH3COCH3   hardcoded
  !     MGLYOX   hardcoded
  !       HOCl   1 1 1 1 3 3 3 _                      ""
  !       OClO   _ _ 1 1 3 3 3 3                      ""
  !      Cl2O2   1 1 1 1 3 3 3 3                      ""
  !      ClNO3   1 1 1 1 3 3 3 3    2 2 2 2 2 2 2 2   ""
  !      ClNO2   1 1 1 1 3 3 3 3    2 2 2 2 2 2 2 2   ""
  !        Cl2   _ _ 1 1 3 3 3 3                      ""
  !        BrO   _ _ 1 1 3 3 3 _                      ""
  !       HOBr   _ _ 1 1 3 3 3 3                      ""
  !       BrCl   1 1 1 1 3 3 3 3                      ""
  !      BrNO3   1 1 1 1 3 3 3 3    2 2 2 2 2 2 2 2   ""
  !      BrNO2   1 1 1 1 3 3 3 3                      ""
  !        Br2   1 1 1 1 3 3 3 3                      ""
  !       CCl4   1 1 1 _ _ _ _ _                      ""
  !      CH3Cl   1 1 _ _ _ _ _ _    2 2 _ _ _ _ _ _   ""
  !    CH3CCl3   1 1 1 _ _ _ _ _    2 2 2 _ _ _ _ _   ""
  !      CFCl3   1 1 1 _ _ _ _ _    2 2 2 _ _ _ _ _   ""
  !     CF2Cl2   1 1 _ _ _ _ _ _    2 2 _ _ _ _ _ _   ""
  !      CH3Br   1 1 1 _ _ _ _ _                      ""
  !    CF2ClBr   1 1 1 1 3 3 _ _                      ""
  !      CF3Br   1 1 1 1 _ _ _ _                      ""
  !       CH3I   _ 1 1 1 3 3 3 _                      ""
  !      C3H7I   _ 1 1 1 3 3 3 _    _ 2 2 2 2 2 2 _   ""
  !     CH2ClI   _ 1 1 1 3 3 3 _                      ""
  !      CH2I2   _ 1 1 1 3 3 3 _                      ""
  !         IO   _ _ _ _ _ _ 3 3                      ""
  !        HOI   _ _ 1 1 3 3 3 3                      ""
  !         I2   1 1 1 1 3 3 3 3                      ""
  !        ICl   _ 1 1 1 3 _ 3 3                      ""
  !        IBr   _ 1 1 1 3 3 3 3                      ""
  !       INO2   _ 1 1 1 3 3 3 _                      ""
  !       INO3   _ _ 1 1 3 3 3 _                      ""
  !        SO2   no nml file
  !        SO3   1 1 1 1 3 3 _ _                      ""
  !        OCS   1 1 1 1 _ _ _ _    2 2 2 2 _ _ _ _   ""
  !        CS2   no nml file
  !        H2O   1 _ _ _ _ _ _ _                      "1.48E-17 * r_m(j,k) * phi_la"
  !        N2O   1 1 _ _ _ _ _ _    2 2 _ _ _ _ _ _   ""
  !         NO   hardcoded
  !        CO2   1 1 1 1 _ _ _ _                      "7.3E-20 * r_m(j,k) * phi_la"
  !        HCl   1 1 _ _ _ _ _ _                      ""
  !    CHCl2Br   1 1 1 1 3 3 _ _                      ""
  !    CHClBr2   1 1 1 1 3 _ _ _                      ""
  !    CH2ClBr   1 1 1 _ _ _ _ _                      ""
  !     CH2Br2   1 1 1 1 _ _ _ _    2 2 2 2 _ _ _ _   ""
  !      CHBr3   1 1 1 1 3 3 3 3    2 2 2 2 2 2 2 2   ""
  !        SF6                                        "1.76E-18 * r_m(j,k) * phi_la"
  !     NO3NOO   no nml file
  !     ClONO2   1 1 1 1 3 3 3 _    2 2 2 2 2 2 2 _   ""
  !       MACR   hardcoded
  !        MVK   hardcoded
  !      GLYOX   hardcoded
  !   HOCH2CHO   _ 1 1 1 3 3 _ _                      ""
  !        CH4                                        "1.8E-17 * r_m(j,k) * phi_la"
  !    O2_b1b2   no nml file
  !      O2_b1   no nml file
  !      O2_b2   no nml file
  !     O3PO1D   no nml file
  !       O3Pp   no nml file
  !      H2O1D   no nml file
  !         N2   no nml file
  !      N2_b1   no nml file
  !      N2_b2   no nml file
  !      N2_b3   no nml file
  !       NN2D   no nml file
  !        NOp   no nml file
  !      Op_em   no nml file
  !     O2p_em   no nml file
  !    Op_O_em   no nml file
  !     N2p_em   no nml file
  !    Np_N_em   no nml file
  !  Np_N2D_em   no nml file
  !   N_N2D_em   no nml file
  !    Op_em_b   no nml file
  !   se_O2_b1   no nml file
  !   se_O2_b2   no nml file
  !   se_N2_b1   no nml file
  !   se_N2_b2   no nml file
  !   se_N2_b3   no nml file
  !   se_N2_b4   no nml file
  !   se_Op_em   no nml file
  !    O2_aurq   no nml file
  !    N2_aurq   no nml file
  !      H2SO4   hardcoded
  !       C3O2   no nml file
  ! ------------------------------------------------------------------------
  ! 
  ! To view results with ferret, type:
  ! cd workdir_jnl ; ls -la *.jnl ; ferret

  ! **************************************************************************

  SUBROUTINE jval_cal

    ! CALLs to individual jval_cal_* subroutines:
    IF (lp(ip_O2))       CALL jval_cal_O2
    IF (lp(ip_O3P))      CALL jval_cal_O3P
    IF (lp(ip_O1D))      CALL jval_cal_O1D
    IF (lp(ip_H2O2))     CALL jval_cal_H2O2
    IF (lp(ip_NO2))      CALL jval_cal_NO2
    IF (lp(ip_NO2O))     CALL jval_cal_NO2O
    IF (lp(ip_NOO2))     CALL jval_cal_NOO2
    IF (lp(ip_N2O5))     CALL jval_cal_N2O5
    IF (lp(ip_HNO3))     CALL jval_cal_HNO3
    IF (lp(ip_HNO4))     CALL jval_cal_HNO4
    IF (lp(ip_PAN))      CALL jval_cal_PAN
    IF (lp(ip_HONO))     CALL jval_cal_HONO
    IF (lp(ip_CH3OOH))   CALL jval_cal_CH3OOH
    IF (lp(ip_COH2))     CALL jval_cal_COH2
    IF (lp(ip_CHOH))     CALL jval_cal_CHOH
    IF (lp(ip_CH3CO3H))  CALL jval_cal_CH3CO3H
    IF (lp(ip_CH3CHO))   CALL jval_cal_CH3CHO
    IF (lp(ip_CH3COCH3)) CALL jval_cal_CH3COCH3
    IF (lp(ip_MGLYOX))   CALL jval_cal_MGLYOX
    IF (lp(ip_HOCl))     CALL jval_cal_HOCl
    IF (lp(ip_OClO))     CALL jval_cal_OClO
    IF (lp(ip_Cl2O2))    CALL jval_cal_Cl2O2
    IF (lp(ip_ClNO3))    CALL jval_cal_ClNO3
    IF (lp(ip_ClNO2))    CALL jval_cal_ClNO2
    IF (lp(ip_Cl2))      CALL jval_cal_Cl2
    IF (lp(ip_BrO))      CALL jval_cal_BrO
    IF (lp(ip_HOBr))     CALL jval_cal_HOBr
    IF (lp(ip_BrCl))     CALL jval_cal_BrCl
    IF (lp(ip_BrNO3))    CALL jval_cal_BrNO3
    IF (lp(ip_BrNO2))    CALL jval_cal_BrNO2
    IF (lp(ip_Br2))      CALL jval_cal_Br2
    IF (lp(ip_CCl4))     CALL jval_cal_CCl4
    IF (lp(ip_CH3Cl))    CALL jval_cal_CH3Cl
    IF (lp(ip_CH3CCl3))  CALL jval_cal_CH3CCl3
    IF (lp(ip_CFCl3))    CALL jval_cal_CFCl3
    IF (lp(ip_CF2Cl2))   CALL jval_cal_CF2Cl2
    IF (lp(ip_CH3Br))    CALL jval_cal_CH3Br
    IF (lp(ip_CF2ClBr))  CALL jval_cal_CF2ClBr
    IF (lp(ip_CF3Br))    CALL jval_cal_CF3Br
    IF (lp(ip_CH3I))     CALL jval_cal_CH3I
    IF (lp(ip_C3H7I))    CALL jval_cal_C3H7I
    IF (lp(ip_CH2ClI))   CALL jval_cal_CH2ClI
    IF (lp(ip_CH2I2))    CALL jval_cal_CH2I2
    IF (lp(ip_IO))       CALL jval_cal_IO
    IF (lp(ip_HOI))      CALL jval_cal_HOI
    IF (lp(ip_I2))       CALL jval_cal_I2
    IF (lp(ip_ICl))      CALL jval_cal_ICl
    IF (lp(ip_IBr))      CALL jval_cal_IBr
    IF (lp(ip_INO2))     CALL jval_cal_INO2
    IF (lp(ip_INO3))     CALL jval_cal_INO3
    IF (lp(ip_SO3))      CALL jval_cal_SO3
    IF (lp(ip_OCS))      CALL jval_cal_OCS
    IF (lp(ip_H2O))      CALL jval_cal_H2O
    IF (lp(ip_N2O))      CALL jval_cal_N2O
    IF (lp(ip_NO))       CALL jval_cal_NO
    IF (lp(ip_CO2))      CALL jval_cal_CO2
    IF (lp(ip_HCl))      CALL jval_cal_HCl
    IF (lp(ip_CHCl2Br))  CALL jval_cal_CHCl2Br
    IF (lp(ip_CHClBr2))  CALL jval_cal_CHClBr2
    IF (lp(ip_CH2ClBr))  CALL jval_cal_CH2ClBr
    IF (lp(ip_CH2Br2))   CALL jval_cal_CH2Br2
    IF (lp(ip_CHBr3))    CALL jval_cal_CHBr3
    IF (lp(ip_SF6))      CALL jval_cal_SF6
    IF (lp(ip_ClONO2))   CALL jval_cal_ClONO2
    IF (lp(ip_MACR))     CALL jval_cal_MACR
    IF (lp(ip_MVK))      CALL jval_cal_MVK
    IF (lp(ip_GLYOX))    CALL jval_cal_GLYOX
    IF (lp(ip_HOCH2CHO)) CALL jval_cal_HOCH2CHO
    IF (lp(ip_CH4))      CALL jval_cal_CH4
    IF (lp(ip_H2SO4))    CALL jval_cal_H2SO4

  END SUBROUTINE jval_cal

  ! **************************************************************************

  SUBROUTINE jval_cal_O2

    ! O_2 \TOHV\ O + O

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_O2

    ! T-const parameters:
    REAL, PARAMETER :: a0_1_1_O2(dim58) = (/ &
      -7.4744E-22, -6.8691E-22, -6.2987E-22, -5.7600E-22, -5.2445E-22, -4.7504E-22, &
      -4.2787E-22, -3.8300E-22, -3.4100E-22, -3.0224E-22, -2.6704E-22, -2.3568E-22, &
      -2.1318E-22, -2.0223E-22, -1.7332E-22, -1.5237E-22, -1.3740E-22, -1.1650E-22, &
      -1.0119E-22, -9.0143E-23, -7.4196E-23, -6.2644E-23, -5.4627E-23, -4.3046E-23, &
      -3.5235E-23, -2.5305E-23, -1.9228E-23, -1.5983E-23, -1.3516E-23, -1.1651E-23, &
      -1.0224E-23, -9.1018E-24, -8.1782E-24, -7.3702E-24, -6.6312E-24, -5.9254E-24, &
      -5.2527E-24, -4.6139E-24, -4.0240E-24, -3.4939E-24, -3.0284E-24, -2.6326E-24, &
      -2.3011E-24, -2.0245E-24, -1.7911E-24, -1.5875E-24, -1.3999E-24, -1.2239E-24, &
      -1.0557E-24, -8.9737E-25, -7.5129E-25, -6.1817E-25, -4.9896E-25, -3.9403E-25, &
      -3.0754E-25, -2.4917E-25, -2.3373E-25, -2.5523E-25 /)
    REAL, PARAMETER :: a0_1_2_O2(dim58) = (/ &
       3.4340E-20,  3.1665E-20,  2.9132E-20,  2.6729E-20,  2.4420E-20,  2.2196E-20, &
       2.0064E-20,  1.8027E-20,  1.6112E-20,  1.4337E-20,  1.2718E-20,  1.1269E-20, &
       1.0225E-20,  9.7147E-21,  8.3614E-21,  7.3767E-21,  6.6701E-21,  5.6797E-21, &
       4.9510E-21,  4.4229E-21,  3.6574E-21,  3.1006E-21,  2.7126E-21,  2.1497E-21, &
       1.7686E-21,  1.2820E-21,  9.8300E-22,  8.2270E-22,  7.0034E-22,  6.0749E-22, &
       5.3612E-22,  4.7979E-22,  4.3324E-22,  3.9235E-22,  3.5481E-22,  3.1882E-22, &
       2.8437E-22,  2.5154E-22,  2.2110E-22,  1.9364E-22,  1.6943E-22,  1.4878E-22, &
       1.3140E-22,  1.1685E-22,  1.0453E-22,  9.3737E-23,  8.3761E-23,  7.4362E-23, &
       6.5346E-23,  5.6827E-23,  4.8939E-23,  4.1724E-23,  3.5239E-23,  2.9510E-23, &
       2.4770E-23,  2.1559E-23,  2.0707E-23,  2.1898E-23 /)
    REAL, PARAMETER :: a0_2_1_O2(dim58) = (/ &
      -9.2476E-24, -8.3984E-24, -7.6148E-24, -6.8893E-24, -6.2171E-24, -5.5842E-24, &
      -4.9903E-24, -4.4331E-24, -3.9121E-24, -3.4348E-24, -3.0005E-24, -2.6148E-24, &
      -2.1972E-24, -1.7075E-24, -1.5696E-24, -1.3846E-24, -1.1774E-24, -1.0936E-24, &
      -9.7369E-25, -8.3351E-25, -7.7658E-25, -6.8987E-25, -5.8563E-25, -5.3808E-25, &
      -4.6883E-25, -4.3782E-25, -3.8469E-25, -3.1951E-25, -2.6142E-25, -2.1036E-25, &
      -1.6595E-25, -1.2776E-25, -9.5410E-26, -6.8576E-26, -4.7035E-26, -3.0338E-26, &
      -1.8031E-26, -9.3895E-27, -3.6705E-27, -1.7068E-28,  1.7176E-27,  2.5151E-27, &
       2.6567E-27,  2.4521E-27,  2.1281E-27,  1.7881E-27,  1.4692E-27,  1.1801E-27, &
       9.2664E-28,  7.1309E-28,  5.4210E-28,  4.0951E-28,  3.1054E-28,  2.3553E-28, &
       1.7779E-28,  1.3409E-28,  1.0251E-28,  8.5292E-29 /)
    REAL, PARAMETER :: a0_2_2_O2(dim58) = (/ &
       4.2339E-22,  3.8586E-22,  3.5107E-22,  3.1871E-22,  2.8860E-22,  2.6012E-22, &
       2.3327E-22,  2.0797E-22,  1.8421E-22,  1.6235E-22,  1.4238E-22,  1.2456E-22, &
       1.0518E-22,  8.2363E-23,  7.5910E-23,  6.7211E-23,  5.7430E-23,  5.3459E-23, &
       4.7753E-23,  4.1052E-23,  3.8320E-23,  3.4140E-23,  2.9095E-23,  2.6784E-23, &
       2.3405E-23,  2.1885E-23,  1.9271E-23,  1.6051E-23,  1.3170E-23,  1.0627E-23, &
       8.4069E-24,  6.4897E-24,  4.8592E-24,  3.5015E-24,  2.4072E-24,  1.5556E-24, &
       9.2551E-25,  4.8134E-25,  1.8624E-25,  4.9454E-27, -9.3243E-26, -1.3487E-25, &
      -1.4229E-25, -1.3153E-25, -1.1443E-25, -9.6408E-26, -7.9439E-26, -6.4004E-26, &
      -5.0417E-26, -3.8928E-26, -2.9694E-26, -2.2508E-26, -1.7124E-26, -1.3028E-26, &
      -9.8645E-27, -7.4608E-27, -5.7177E-27, -4.7636E-27 /)
    REAL, PARAMETER :: a1_1_O2(dim55) = (/ &
       1.0982E-25,  1.0294E-25,  9.6415E-26,  8.6839E-26,  7.8036E-26,  6.9131E-26, &
       6.0774E-26,  5.3952E-26,  4.7108E-26,  4.2389E-26,  3.7056E-26,  3.3953E-26, &
       2.9848E-26,  2.7798E-26,  2.4614E-26,  2.3297E-26,  2.0705E-26,  1.9864E-26, &
       1.7740E-26,  1.7223E-26,  1.5420E-26,  1.5099E-26,  1.3538E-26,  1.3404E-26, &
       1.2033E-26,  1.1995E-26,  1.0777E-26,  1.0827E-26,  9.7361E-27,  9.8391E-27, &
       8.8272E-27,  9.0075E-27,  8.0799E-27,  8.2669E-27,  7.4349E-27,  7.6468E-27, &
       6.8651E-27,  7.1031E-27,  6.3718E-27,  6.6225E-27,  5.7505E-27,  5.0333E-27, &
       4.3363E-27,  3.9220E-27,  3.4559E-27,  3.1912E-27,  2.8476E-27,  2.6696E-27, &
       2.2770E-27,  2.0967E-27,  1.9343E-27,  1.7857E-27,  1.6512E-27,  1.5279E-27, &
       1.4162E-27 /)
    REAL, PARAMETER :: b1_1_O2(dim55) = (/ &
       3.4444E-24,  3.4650E-24,  3.5009E-24,  3.5775E-24,  3.6700E-24,  3.7857E-24, &
       3.9153E-24,  4.0381E-24,  4.1784E-24,  4.2869E-24,  4.4229E-24,  4.5098E-24, &
       4.6350E-24,  4.7026E-24,  4.8156E-24,  4.8657E-24,  4.9707E-24,  5.0068E-24, &
       5.1035E-24,  5.1283E-24,  5.2193E-24,  5.2363E-24,  5.3230E-24,  5.3308E-24, &
       5.4137E-24,  5.4161E-24,  5.4959E-24,  5.4925E-24,  5.5694E-24,  5.5619E-24, &
       5.6383E-24,  5.6242E-24,  5.6989E-24,  5.6834E-24,  5.7545E-24,  5.7359E-24, &
       5.8066E-24,  5.7845E-24,  5.8543E-24,  5.8297E-24,  5.9174E-24,  5.9984E-24, &
       6.0859E-24,  6.1431E-24,  6.2132E-24,  6.2564E-24,  6.3167E-24,  6.3501E-24, &
       6.4288E-24,  6.4672E-24,  6.5038E-24,  6.5392E-24,  6.5729E-24,  6.6053E-24, &
       6.6361E-24 /)
    REAL, PARAMETER :: a1_2_O2(dim55) = (/ &
      -1.2941E-28, -2.0973E-29,  1.6836E-29,  8.5902E-29,  1.1436E-28,  1.3837E-28, &
       1.5325E-28,  1.4674E-28,  1.5335E-28,  1.3267E-28,  1.3640E-28,  1.1203E-28, &
       1.1544E-28,  9.2415E-29,  9.6206E-29,  7.5590E-29,  8.0487E-29,  6.2545E-29, &
       6.7720E-29,  5.2153E-29,  5.7558E-29,  4.4186E-29,  4.9720E-29,  3.7675E-29, &
       4.3131E-29,  3.2570E-29,  3.7842E-29,  2.8292E-29,  3.3311E-29,  2.4823E-29, &
       2.9785E-29,  2.1863E-29,  2.6508E-29,  1.9466E-29,  2.3814E-29,  1.7384E-29, &
       2.1492E-29,  1.5549E-29,  1.9480E-29,  1.4010E-29,  1.4575E-29,  1.1000E-29, &
       9.6006E-30,  7.4895E-30,  6.8251E-30,  5.4633E-30,  5.1679E-30,  4.2115E-30, &
       4.8035E-30,  4.3542E-30,  3.9908E-30,  3.6903E-30,  3.4353E-30,  3.2159E-30, &
       3.0153E-30 /)
    REAL, PARAMETER :: b1_2_O2(dim55) = (/ &
      -7.4182E-27, -7.7435E-27, -7.9515E-27, -8.5040E-27, -8.8028E-27, -9.1149E-27, &
      -9.3456E-27, -9.2283E-27, -9.3638E-27, -8.8882E-27, -8.9834E-27, -8.3010E-27, &
      -8.4049E-27, -7.6452E-27, -7.7798E-27, -6.9964E-27, -7.1947E-27, -6.4232E-27, &
      -6.6586E-27, -5.9114E-27, -6.1844E-27, -5.4757E-27, -5.7828E-27, -5.0842E-27, &
      -5.4143E-27, -4.7489E-27, -5.0943E-27, -4.4448E-27, -4.7987E-27, -4.1791E-27, &
      -4.5537E-27, -3.9358E-27, -4.3097E-27, -3.7252E-27, -4.0970E-27, -3.5311E-27, &
      -3.9029E-27, -3.3502E-27, -3.7256E-27, -3.1895E-27, -3.2463E-27, -2.8425E-27, &
      -2.6668E-27, -2.3754E-27, -2.2754E-27, -2.0535E-27, -2.0016E-27, -1.8218E-27, &
      -1.9405E-27, -1.8448E-27, -1.7629E-27, -1.6914E-27, -1.6275E-27, -1.5698E-27, &
      -1.5145E-27 /)
    REAL, PARAMETER :: a2_O2(dim55) = (/ &
      -9.5720E-28, -8.9420E-28, -7.6428E-28, -6.0744E-28, -4.5592E-28, -3.2760E-28, &
      -2.2776E-28, -1.5462E-28, -1.0309E-28, -6.7824E-29, -4.4184E-29, -2.8564E-29, &
      -1.8360E-29, -1.1746E-29, -7.4864E-30, -4.7568E-30, -3.0152E-30, -1.9068E-30, &
      -1.2038E-30, -7.5872E-31, -4.7752E-31, -3.0020E-31, -1.8848E-31, -1.1824E-31, &
      -7.4108E-32, -4.6412E-32, -2.9040E-32, -1.8162E-32, -1.1350E-32, -7.0888E-33, &
      -4.4256E-33, -2.7612E-33, -1.7223E-33, -1.0736E-33, -6.6904E-34, -4.1680E-34, &
      -2.5952E-34, -1.6156E-34, -1.0055E-34, -6.2556E-35, -1.8664E-35, -1.7300E-36, &
      -1.5971E-37, -1.4701E-38,  0.0000E+00,  0.0000E+00,  0.0000E+00,  0.0000E+00, &
       0.0000E+00,  0.0000E+00,  0.0000E+00,  0.0000E+00,  0.0000E+00,  0.0000E+00, &
       0.0000E+00 /)
    REAL, PARAMETER :: b2_O2(dim55) = (/ &
       1.2187E-26,  1.1998E-26,  1.1283E-26,  1.0028E-26,  8.4374E-27,  6.7692E-27, &
       5.2217E-27,  3.9052E-27,  2.8487E-27,  2.0377E-27,  1.4349E-27,  9.9749E-28, &
       6.8628E-28,  4.6799E-28,  3.1679E-28,  2.1307E-28,  1.4253E-28,  9.4870E-29, &
       6.2883E-29,  4.1521E-29,  2.7321E-29,  1.7923E-29,  1.1722E-29,  7.6486E-30, &
       4.9783E-30,  3.2335E-30,  2.0956E-30,  1.3559E-30,  8.7566E-31,  5.6459E-31, &
       3.6352E-31,  2.3370E-31,  1.5007E-31,  9.6225E-32,  6.1635E-32,  3.9438E-32, &
       2.5204E-32,  1.6094E-32,  1.0268E-32,  6.5440E-33,  2.1328E-33,  2.1932E-34, &
       2.2242E-35,  2.2310E-36,  2.2178E-37,  2.1886E-38,  0.0000E+00,  0.0000E+00, &
       0.0000E+00,  0.0000E+00,  0.0000E+00,  0.0000E+00,  0.0000E+00,  0.0000E+00, &
       0.0000E+00 /)
    ! T-dep parameters:
    REAL, PARAMETER :: c0_1_1_O2(dim58) = (/ &
       2.1690E-01,  2.1690E-01,  2.1690E-01,  1.8909E-01,  1.4356E-01,  8.2702E-02, &
       1.2219E-02, -6.0334E-02, -1.2813E-01, -1.8483E-01, -2.2541E-01, -2.4686E-01, &
      -2.4855E-01, -2.3162E-01, -1.9961E-01, -1.5830E-01, -1.1342E-01, -7.3216E-02, &
      -4.4512E-02, -3.3304E-02, -4.0741E-02, -6.8716E-02, -1.0843E-01, -1.5375E-01, &
      -1.9071E-01, -2.0636E-01, -1.8987E-01, -1.3527E-01, -4.3143E-02,  7.9474E-02, &
       2.1633E-01,  3.4730E-01,  4.4778E-01,  4.9782E-01,  4.8460E-01,  4.0885E-01, &
       2.8343E-01,  1.2743E-01, -3.6616E-02, -1.8833E-01, -3.0814E-01, -3.9059E-01, &
      -4.2671E-01, -4.2228E-01, -3.8761E-01, -3.3633E-01, -2.8220E-01, -2.3561E-01, &
      -1.9909E-01, -1.7092E-01, -1.4580E-01, -1.1686E-01, -7.8638E-02, -3.0995E-02, &
       1.6002E-02,  4.0032E-02,  1.2957E-02, -5.1449E-02 /)
    REAL, PARAMETER :: c0_1_2_O2(dim58) = (/ &
      -8.9626E+00, -8.9626E+00, -8.9626E+00, -7.7222E+00, -5.6825E+00, -2.9437E+00, &
       2.4217E-01,  3.5361E+00,  6.6276E+00,  9.2246E+00,  1.1091E+01,  1.2082E+01, &
       1.2161E+01,  1.1372E+01,  9.8734E+00,  7.9321E+00,  5.8134E+00,  3.9079E+00, &
       2.5416E+00,  2.0058E+00,  2.3628E+00,  3.7113E+00,  5.6336E+00,  7.8359E+00, &
       9.6396E+00,  1.0406E+01,  9.5953E+00,  6.8980E+00,  2.3284E+00, -3.7780E+00, &
      -1.0620E+01, -1.7196E+01, -2.2260E+01, -2.4792E+01, -2.4120E+01, -2.0257E+01, &
      -1.3835E+01, -5.8170E+00,  2.6478E+00,  1.0506E+01,  1.6737E+01,  2.1041E+01, &
       2.2933E+01,  2.2701E+01,  2.0870E+01,  1.8152E+01,  1.5272E+01,  1.2784E+01, &
       1.0827E+01,  9.3112E+00,  7.9550E+00,  6.3860E+00,  4.3070E+00,  1.7057E+00, &
      -8.6975E-01, -2.1914E+00, -6.9687E-01,  2.8712E+00 /)
    REAL, PARAMETER :: c0_2_1_O2(dim58) = (/ &
       1.2769E-01,  1.2769E-01,  1.2769E-01,  1.1084E-01,  5.9678E-02, -2.1805E-03, &
      -6.9283E-02, -1.4272E-01, -1.9851E-01, -2.4064E-01, -2.6223E-01, -2.6594E-01, &
      -2.5149E-01, -2.2806E-01, -1.9537E-01, -1.6197E-01, -1.2237E-01, -7.9117E-02, &
      -4.2157E-02, -1.4072E-02,  1.8344E-02,  3.9300E-02,  5.3830E-02,  8.9381E-02, &
       1.3974E-01,  2.1529E-01,  3.0193E-01,  3.7343E-01,  4.0541E-01,  3.8880E-01, &
       3.1638E-01,  2.3579E-01,  1.4836E-01,  7.1385E-02,  8.3911E-03, -6.0952E-02, &
      -1.4241E-01, -2.3215E-01, -3.1473E-01, -3.4672E-01, -3.3149E-01, -2.5424E-01, &
      -1.5436E-01, -6.7815E-02, -2.4347E-02, -1.5799E-02, -2.0672E-02, -1.8161E-02, &
      -3.0574E-04,  3.2359E-02,  6.8680E-02,  9.7266E-02,  9.8648E-02,  6.1718E-02, &
       3.0062E-03, -5.2773E-02, -8.3116E-02, -1.0724E-01 /)
    REAL, PARAMETER :: c0_2_2_O2(dim58) = (/ &
      -5.4665E+00, -5.4665E+00, -5.4665E+00, -4.7146E+00, -2.4228E+00,  3.6086E-01, &
       3.3939E+00,  6.7280E+00,  9.2720E+00,  1.1201E+01,  1.2195E+01,  1.2366E+01, &
       1.1696E+01,  1.0604E+01,  9.0741E+00,  7.5039E+00,  5.6348E+00,  3.5848E+00, &
       1.8254E+00,  4.8298E-01, -1.0730E+00, -2.0831E+00, -2.7863E+00, -4.5141E+00, &
      -6.9716E+00, -1.0673E+01, -1.4936E+01, -1.8468E+01, -2.0054E+01, -1.9227E+01, &
      -1.5606E+01, -1.1561E+01, -7.1543E+00, -3.2594E+00, -5.9274E-02,  3.4772E+00, &
       7.6477E+00,  1.2261E+01,  1.6521E+01,  1.8179E+01,  1.7387E+01,  1.3354E+01, &
       8.1205E+00,  3.5683E+00,  1.2732E+00,  8.2017E-01,  1.0794E+00,  9.4534E-01, &
      -1.1711E-02, -1.7691E+00, -3.7304E+00, -5.2798E+00, -5.3549E+00, -3.3386E+00, &
      -1.2117E-01,  2.9467E+00,  4.6216E+00,  5.9580E+00 /)
    REAL, PARAMETER :: c1_O2(3) = (/  1.0000E+00,  1.0426E-02,  3.4715E-04 /)
    REAL, PARAMETER :: c2_O2(3) = (/  9.9998E-01, -1.7221E-01,  1.3812E-02 /)

    jval_2d(ip_O2)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_O2(0) = &
          p2(1.,c0_1_1_O2(i0(j,k))*dlv2(j,k) + &
          c0_1_2_O2(i0(j,k)), &
          c0_2_1_O2(i0(j,k))*dlv2(j,k) + &
          c0_2_2_O2(i0(j,k)), tnorm_sr(j,k)) * &
          p1(a0_1_1_O2(i0(j,k))*dlv2(j,k) + &
          a0_1_2_O2(i0(j,k)), &
          a0_2_1_O2(i0(j,k))*dlv2(j,k) + &
          a0_2_2_O2(i0(j,k)),v3_du1(j,k))
        sig_O2(1) = &
          p2(c1_O2(1),c1_O2(2), &
          c1_O2(3),tnorm(j,k)) * &
          (p1(b1_1_O2(i1(j,k)),a1_1_O2(i1(j,k)), &
          v3_du1(j,k)) + &
          p1(b1_2_O2(i1(j,k)),a1_2_O2(i1(j,k)), &
          v3_du1(j,k)) * v2s_m(j,k))
        sig_O2(2) = &
          p2(c2_O2(1),c2_O2(2),c2_O2(3),tnorm(j,k))* &
          p1(b2_O2(i2(j,k)), a2_O2(i2(j,k)), &
          v3_du1(j,k))
        dj = 0. &
          + r_O2(j,k) * phi_la &
          + sig_O2(0) * fint(j,k,0) &
          + sig_O2(1) * fint(j,k,1) &
          + sig_O2(2) * fint(j,k,2)

        jval_2d(ip_O2)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,8)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_O2

  ! **************************************************************************

  SUBROUTINE jval_cal_O3P

    ! O_3 \TOHV\ O(^3P) + O_2

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_O3P

    ! T-const parameters:
    REAL, PARAMETER :: a0_1_1_O3P(dim58) = (/ &
       2.6664E-21,  2.8286E-21,  2.9854E-21,  3.1370E-21,  3.2733E-21,  3.4006E-21, &
       3.5131E-21,  3.5873E-21,  3.6547E-21,  3.7045E-21,  3.7313E-21,  3.7267E-21, &
       3.9757E-21,  4.8450E-21,  4.5900E-21,  4.5680E-21,  4.8519E-21,  4.4044E-21, &
       4.2031E-21,  4.3029E-21,  3.5192E-21,  2.9766E-21,  2.7813E-21,  1.5368E-21, &
       5.7739E-22, -1.5232E-21, -3.1767E-21, -4.2713E-21, -5.2657E-21, -6.1339E-21, &
      -6.8418E-21, -7.3568E-21, -7.6889E-21, -7.8469E-21, -7.8758E-21, -7.7876E-21, &
      -7.6731E-21, -7.5415E-21, -7.4231E-21, -7.3281E-21, -7.2502E-21, -7.1881E-21, &
      -7.1116E-21, -6.9858E-21, -6.7994E-21, -6.5224E-21, -6.1802E-21, -5.7601E-21, &
      -5.3125E-21, -4.8358E-21, -4.3961E-21, -3.9627E-21, -3.5385E-21, -3.1312E-21, &
      -2.7205E-21, -2.3181E-21, -1.8849E-21, -1.5930E-21 /)
    REAL, PARAMETER :: a0_1_2_O3P(dim58) = (/ &
       4.2537E-20,  3.5367E-20,  2.8408E-20,  2.1647E-20,  1.5541E-20,  9.8080E-21, &
       4.7269E-21,  1.3554E-21, -1.7157E-21, -3.9962E-21, -5.2300E-21, -5.0193E-21, &
      -1.6570E-20, -5.7083E-20, -4.5148E-20, -4.4112E-20, -5.7514E-20, -3.6301E-20, &
      -2.6717E-20, -3.1491E-20,  6.1265E-21,  3.2279E-20,  4.1734E-20,  1.0222E-19, &
       1.4903E-19,  2.5196E-19,  3.3332E-19,  3.8739E-19,  4.3671E-19,  4.7995E-19, &
       5.1535E-19,  5.4119E-19,  5.5793E-19,  5.6593E-19,  5.6739E-19,  5.6290E-19, &
       5.5704E-19,  5.5027E-19,  5.4416E-19,  5.3924E-19,  5.3519E-19,  5.3195E-19, &
       5.2794E-19,  5.2132E-19,  5.1148E-19,  4.9680E-19,  4.7860E-19,  4.5616E-19, &
       4.3217E-19,  4.0653E-19,  3.8278E-19,  3.5929E-19,  3.3621E-19,  3.1397E-19, &
       2.9147E-19,  2.6934E-19,  2.4542E-19,  2.2925E-19 /)
    REAL, PARAMETER :: a0_2_1_O3P(dim58) = (/ &
       1.0983E-23,  1.2416E-23,  1.4068E-23,  1.5834E-23,  1.7844E-23,  1.9984E-23, &
       2.2315E-23,  2.4982E-23,  2.7812E-23,  3.0892E-23,  3.4129E-23,  3.7827E-23, &
       3.7628E-23,  2.8538E-23,  3.6046E-23,  3.9750E-23,  3.9330E-23,  4.7885E-23, &
       5.2481E-23,  5.2620E-23,  6.2270E-23,  6.7593E-23,  6.7909E-23,  7.8124E-23, &
       8.3432E-23,  9.8689E-23,  1.0767E-22,  1.0960E-22,  1.0935E-22,  1.0676E-22, &
       1.0177E-22,  9.4388E-23,  8.5069E-23,  7.4355E-23,  6.3146E-23,  5.1907E-23, &
       4.1791E-23,  3.3022E-23,  2.6019E-23,  2.0831E-23,  1.7219E-23,  1.5049E-23, &
       1.3740E-23,  1.2818E-23,  1.2054E-23,  1.1143E-23,  1.0211E-23,  9.0776E-24, &
       8.0120E-24,  6.8566E-24,  5.9068E-24,  5.0325E-24,  4.2043E-24,  3.4652E-24, &
       2.7480E-24,  2.1729E-24,  1.5699E-24,  1.4492E-24 /)
    REAL, PARAMETER :: a0_2_2_O3P(dim58) = (/ &
      -9.3281E-22, -9.9615E-22, -1.0695E-21, -1.1483E-21, -1.2383E-21, -1.3346E-21, &
      -1.4400E-21, -1.5610E-21, -1.6901E-21, -1.8312E-21, -1.9801E-21, -2.1509E-21, &
      -2.1417E-21, -1.7181E-21, -2.0695E-21, -2.2436E-21, -2.2237E-21, -2.6293E-21, &
      -2.8480E-21, -2.8547E-21, -3.3179E-21, -3.5744E-21, -3.5897E-21, -4.0862E-21, &
      -4.3452E-21, -5.0928E-21, -5.5346E-21, -5.6298E-21, -5.6174E-21, -5.4884E-21, &
      -5.2390E-21, -4.8685E-21, -4.3989E-21, -3.8567E-21, -3.2873E-21, -2.7141E-21, &
      -2.1962E-21, -1.7455E-21, -1.3841E-21, -1.1154E-21, -9.2756E-22, -8.1430E-22, &
      -7.4567E-22, -6.9721E-22, -6.5685E-22, -6.0859E-22, -5.5899E-22, -4.9846E-22, &
      -4.4134E-22, -3.7918E-22, -3.2789E-22, -2.8051E-22, -2.3545E-22, -1.9510E-22, &
      -1.5579E-22, -1.2417E-22, -9.0880E-23, -8.4192E-23 /)
    REAL, PARAMETER :: a1_1_O3P(dim55) = (/ &
      -1.1945E-20, -1.0678E-20, -9.3362E-21, -8.0138E-21, -6.6945E-21, -5.6689E-21, &
      -4.6283E-21, -3.9544E-21, -3.2254E-21, -2.8211E-21, -2.3342E-21, -2.1028E-21, &
      -1.7752E-21, -1.6439E-21, -1.4162E-21, -1.3435E-21, -1.1771E-21, -1.1316E-21, &
      -1.0100E-21, -9.8133E-22, -8.8221E-22, -8.6666E-22, -7.8541E-22, -7.7603E-22, &
      -7.0442E-22, -7.0117E-22, -6.3870E-22, -6.3870E-22, -5.8126E-22, -5.8704E-22, &
      -5.3312E-22, -5.3960E-22, -4.9106E-22, -4.9897E-22, -4.5434E-22, -4.6438E-22, &
      -4.2076E-22, -4.3308E-22, -3.9127E-22, -4.0423E-22, -3.5280E-22, -3.0824E-22, &
      -2.6358E-22, -2.3680E-22, -2.0601E-22, -1.8909E-22, -1.6607E-22, -1.5504E-22, &
      -1.2842E-22, -1.1708E-22, -1.0682E-22, -9.7780E-23, -8.9897E-23, -8.2303E-23, &
      -7.5993E-23 /)
    REAL, PARAMETER :: b1_1_O3P(dim55) = (/ &
       4.1599E-19,  4.1219E-19,  4.0481E-19,  3.9423E-19,  3.8037E-19,  3.6704E-19, &
       3.5091E-19,  3.3878E-19,  3.2384E-19,  3.1454E-19,  3.0212E-19,  2.9564E-19, &
       2.8565E-19,  2.8132E-19,  2.7323E-19,  2.7047E-19,  2.6373E-19,  2.6178E-19, &
       2.5624E-19,  2.5487E-19,  2.4986E-19,  2.4904E-19,  2.4453E-19,  2.4398E-19, &
       2.3965E-19,  2.3945E-19,  2.3536E-19,  2.3536E-19,  2.3131E-19,  2.3173E-19, &
       2.2766E-19,  2.2816E-19,  2.2426E-19,  2.2491E-19,  2.2110E-19,  2.2198E-19, &
       2.1803E-19,  2.1918E-19,  2.1518E-19,  2.1645E-19,  2.1129E-19,  2.0625E-19, &
       2.0065E-19,  1.9695E-19,  1.9232E-19,  1.8956E-19,  1.8552E-19,  1.8345E-19, &
       1.7811E-19,  1.7569E-19,  1.7338E-19,  1.7123E-19,  1.6925E-19,  1.6725E-19, &
       1.6552E-19 /)
    REAL, PARAMETER :: a1_2_O3P(dim55) = (/ &
      -4.2522E-24, -1.3145E-23, -1.8687E-23, -2.1507E-23, -2.4315E-23, -2.2289E-23, &
      -2.2971E-23, -1.8864E-23, -1.8572E-23, -1.4405E-23, -1.3919E-23, -1.0471E-23, &
      -1.0133E-23, -7.5223E-24, -7.3990E-24, -5.4572E-24, -5.5014E-24, -4.0963E-24, &
      -4.1972E-24, -3.1554E-24, -3.3390E-24, -2.5128E-24, -2.7231E-24, -2.0625E-24, &
      -2.3031E-24, -1.7409E-24, -1.9862E-24, -1.5009E-24, -1.7539E-24, -1.3091E-24, &
      -1.5668E-24, -1.1673E-24, -1.4098E-24, -1.0496E-24, -1.2891E-24, -9.4250E-25, &
      -1.1839E-24, -8.5573E-25, -1.0936E-24, -7.8857E-25, -8.4009E-25, -6.5714E-25, &
      -5.9441E-25, -4.7343E-25, -4.4167E-25, -3.5590E-25, -3.4163E-25, -2.7767E-25, &
      -3.2188E-25, -2.9047E-25, -2.6477E-25, -2.4294E-25, -2.2252E-25, -2.0681E-25, &
      -1.9096E-25 /)
    REAL, PARAMETER :: b1_2_O3P(dim55) = (/ &
       8.1813E-22,  8.4481E-22,  8.7529E-22,  8.9785E-22,  9.2733E-22,  9.0100E-22, &
       9.1158E-22,  8.3765E-22,  8.3166E-22,  7.3582E-22,  7.2341E-22,  6.2689E-22, &
       6.1656E-22,  5.3041E-22,  5.2604E-22,  4.5225E-22,  4.5404E-22,  3.9362E-22, &
       3.9821E-22,  3.4820E-22,  3.5747E-22,  3.1368E-22,  3.2536E-22,  2.8704E-22, &
       3.0160E-22,  2.6618E-22,  2.8224E-22,  2.4925E-22,  2.6708E-22,  2.3461E-22, &
       2.5407E-22,  2.2291E-22,  2.4243E-22,  2.1253E-22,  2.3301E-22,  2.0251E-22, &
       2.2436E-22,  1.9384E-22,  2.1655E-22,  1.8666E-22,  1.9184E-22,  1.7116E-22, &
       1.6329E-22,  1.4660E-22,  1.4182E-22,  1.2784E-22,  1.2533E-22,  1.1331E-22, &
       1.2217E-22,  1.1548E-22,  1.0969E-22,  1.0449E-22,  9.9376E-23,  9.5244E-23, &
       9.0877E-23 /)
    REAL, PARAMETER :: a2_O3P(dim55) = (/ &
      -2.8848E-20, -2.6088E-20, -2.2184E-20, -1.7964E-20, -1.4056E-20, -1.0776E-20, &
      -8.1840E-21, -6.2280E-21, -4.7680E-21, -3.7000E-21, -2.9120E-21, -2.3360E-21, &
      -1.9040E-21, -1.5760E-21, -1.3240E-21, -1.1320E-21, -9.7600E-22, -8.5600E-22, &
      -7.5600E-22, -6.6800E-22, -6.0400E-22, -5.4000E-22, -4.9200E-22, -4.4800E-22, &
      -4.1200E-22, -3.7600E-22, -3.4800E-22, -3.2000E-22, -2.9600E-22, -2.7600E-22, &
      -2.5200E-22, -2.3600E-22, -2.2400E-22, -2.0400E-22, -1.9200E-22, -1.8000E-22, &
      -1.6400E-22, -1.5600E-22, -1.4800E-22, -1.3600E-22, -1.1280E-22, -8.0800E-23, &
      -5.9200E-23, -4.2400E-23, -3.1200E-23, -2.2400E-23, -1.6800E-23, -1.1200E-23, &
      -8.8000E-24, -6.4000E-24, -4.8000E-24, -3.2000E-24, -2.4000E-24, -1.6000E-24, &
      -8.0000E-25 /)
    REAL, PARAMETER :: b2_O3P(dim55) = (/ &
       6.1122E-19,  6.0294E-19,  5.8147E-19,  5.4771E-19,  5.0668E-19,  4.6404E-19, &
       4.2386E-19,  3.8865E-19,  3.5872E-19,  3.3416E-19,  3.1407E-19,  2.9794E-19, &
       2.8476E-19,  2.7394E-19,  2.6499E-19,  2.5770E-19,  2.5138E-19,  2.4622E-19, &
       2.4167E-19,  2.3744E-19,  2.3421E-19,  2.3082E-19,  2.2816E-19,  2.2560E-19, &
       2.2343E-19,  2.2116E-19,  2.1932E-19,  2.1742E-19,  2.1573E-19,  2.1427E-19, &
       2.1246E-19,  2.1121E-19,  2.1024E-19,  2.0858E-19,  2.0756E-19,  2.0650E-19, &
       2.0505E-19,  2.0431E-19,  2.0354E-19,  2.0237E-19,  2.0004E-19,  1.9642E-19, &
       1.9371E-19,  1.9139E-19,  1.8971E-19,  1.8827E-19,  1.8729E-19,  1.8624E-19, &
       1.8575E-19,  1.8524E-19,  1.8488E-19,  1.8450E-19,  1.8430E-19,  1.8409E-19, &
       1.8387E-19 /)
    REAL, PARAMETER :: a3_O3P(dim55) = (/ &
      -2.8393E-22, -1.6808E-22, -8.8465E-23, -4.8742E-23, -2.9682E-23, -1.9801E-23, &
      -1.4171E-23, -1.0716E-23, -8.4203E-24, -6.8287E-24, -5.7001E-24, -4.8263E-24, &
      -4.1759E-24, -3.6460E-24, -3.2004E-24, -2.8757E-24, -2.5672E-24, -2.3097E-24, &
      -2.1062E-24, -1.9178E-24, -1.7436E-24, -1.6267E-24, -1.4897E-24, -1.3699E-24, &
      -1.2821E-24, -1.1815E-24, -1.0959E-24, -1.0445E-24, -9.5726E-25, -8.9041E-25, &
      -8.5616E-25, -7.8767E-25, -7.5214E-25, -6.8493E-25, -6.6781E-25, -6.1538E-25, &
      -5.8219E-25, -5.4795E-25, -5.3082E-25, -4.7863E-25, -4.1767E-25, -3.1496E-25, &
      -2.4298E-25, -1.8487E-25, -1.4379E-25, -1.1294E-25, -8.5587E-26, -6.8470E-26, &
      -5.4757E-26, -4.1082E-26, -3.4235E-26, -2.3956E-26, -2.0541E-26, -1.7117E-26, &
      -1.0267E-26 /)
    REAL, PARAMETER :: b3_O3P(dim55) = (/ &
       6.2511E-20,  5.5685E-20,  4.6341E-20,  3.9359E-20,  3.4895E-20,  3.2004E-20, &
       3.0027E-20,  2.8612E-20,  2.7538E-20,  2.6700E-20,  2.6040E-20,  2.5478E-20, &
       2.5022E-20,  2.4619E-20,  2.4254E-20,  2.3970E-20,  2.3681E-20,  2.3425E-20, &
       2.3211E-20,  2.3002E-20,  2.2798E-20,  2.2655E-20,  2.2479E-20,  2.2318E-20, &
       2.2194E-20,  2.2047E-20,  2.1917E-20,  2.1836E-20,  2.1693E-20,  2.1580E-20, &
       2.1520E-20,  2.1396E-20,  2.1330E-20,  2.1200E-20,  2.1166E-20,  2.1059E-20, &
       2.0989E-20,  2.0915E-20,  2.0877E-20,  2.0758E-20,  2.0615E-20,  2.0345E-20, &
       2.0135E-20,  1.9948E-20,  1.9804E-20,  1.9687E-20,  1.9575E-20,  1.9500E-20, &
       1.9436E-20,  1.9368E-20,  1.9332E-20,  1.9275E-20,  1.9255E-20,  1.9234E-20, &
       1.9190E-20 /)
    REAL, PARAMETER :: a4_O3P(4) = (/  4.5914E-20,  8.3446E-24, -2.0870E-27,  1.5677E-31 /)
    REAL, PARAMETER :: a5_O3P(4) = (/  1.3143E-20, -4.0163E-24,  7.1865E-28, -4.6249E-32 /)
    REAL, PARAMETER :: a6_O3P(4) = (/  1.1959E-22, -2.1537E-27,  2.6468E-32, -1.9303E-37 /)
    REAL, PARAMETER :: a7_O3P(4) = (/  2.4851E-21, -6.9883E-26,  8.3112E-32,  2.5623E-35 /)
    ! T-dep parameters:
    REAL, PARAMETER :: c0_1_1_O3P(dim58) = (/ &
       2.3077E-02,  2.3077E-02,  2.3077E-02,  2.5716E-02,  2.9170E-02,  3.0961E-02, &
       3.3189E-02,  3.3289E-02,  3.3626E-02,  3.3046E-02,  3.1246E-02,  2.8822E-02, &
       2.6210E-02,  2.3536E-02,  1.9630E-02,  1.6357E-02,  1.1670E-02,  7.9333E-03, &
       2.8404E-03, -3.7713E-03, -1.0922E-02, -1.9993E-02, -2.8692E-02, -4.0012E-02, &
      -5.0769E-02, -6.0172E-02, -6.9675E-02, -7.6154E-02, -8.0595E-02, -8.1796E-02, &
      -8.0200E-02, -7.7491E-02, -7.3283E-02, -6.8577E-02, -6.4826E-02, -6.1190E-02, &
      -5.8415E-02, -5.4592E-02, -4.9700E-02, -4.3641E-02, -3.3198E-02, -2.2014E-02, &
      -9.4673E-03,  3.5282E-03,  1.4781E-02,  2.2263E-02,  2.8446E-02,  2.9349E-02, &
       2.9611E-02,  2.9164E-02,  3.0668E-02,  3.5577E-02,  4.4139E-02,  5.4014E-02, &
       6.3326E-02,  6.9761E-02,  7.6281E-02,  8.5317E-02 /)
    REAL, PARAMETER :: c0_1_2_O3P(dim58) = (/ &
      -1.0152E+00, -1.0152E+00, -1.0152E+00, -1.1329E+00, -1.2876E+00, -1.3682E+00, &
      -1.4689E+00, -1.4735E+00, -1.4888E+00, -1.4622E+00, -1.3794E+00, -1.2675E+00, &
      -1.1463E+00, -1.0217E+00, -8.3883E-01, -6.8504E-01, -4.6381E-01, -2.8667E-01, &
      -4.4248E-02,  2.7179E-01,  6.1503E-01,  1.0523E+00,  1.4733E+00,  2.0235E+00, &
       2.5484E+00,  3.0091E+00,  3.4767E+00,  3.7967E+00,  4.0170E+00,  4.0768E+00, &
       3.9970E+00,  3.8610E+00,  3.6489E+00,  3.4108E+00,  3.2203E+00,  3.0348E+00, &
       2.8928E+00,  2.6963E+00,  2.4438E+00,  2.1299E+00,  1.5869E+00,  1.0031E+00, &
       3.4567E-01, -3.3789E-01, -9.3202E-01, -1.3286E+00, -1.6575E+00, -1.7058E+00, &
      -1.7198E+00, -1.6958E+00, -1.7770E+00, -2.0430E+00, -2.5088E+00, -3.0480E+00, &
      -3.5583E+00, -3.9122E+00, -4.2721E+00, -4.7727E+00 /)
    REAL, PARAMETER :: c0_2_1_O3P(dim58) = (/ &
       6.4128E-03,  6.4128E-03,  6.4128E-03,  8.8479E-03,  9.9641E-03,  9.2928E-03, &
       1.2107E-02,  9.1711E-03,  8.9934E-03,  4.2153E-03, -4.5226E-03,  1.4617E-03, &
      -3.2947E-03, -1.0481E-02, -1.4676E-02, -2.1486E-02, -2.2191E-02, -2.9583E-02, &
      -3.2319E-02, -4.3963E-02, -4.1836E-02, -4.9075E-02, -5.2371E-02, -5.8210E-02, &
      -4.9187E-02, -5.3852E-02, -4.0357E-02, -2.3485E-02, -1.1221E-02,  2.9168E-03, &
       1.9482E-02,  2.8878E-02,  3.3905E-02,  3.6183E-02,  3.7575E-02,  3.9974E-02, &
       3.8968E-02,  3.4857E-02,  4.4014E-02,  4.1601E-02,  4.8284E-02,  5.1664E-02, &
       4.4112E-02,  3.9936E-02,  2.6435E-02,  1.6891E-02,  2.0276E-02,  1.0428E-02, &
       1.5101E-02,  1.9816E-02,  8.3085E-03,  4.5335E-03, -2.8952E-02, -5.6245E-02, &
      -7.8788E-02, -7.6720E-02, -4.9229E-02, -2.0687E-02 /)
    REAL, PARAMETER :: c0_2_2_O3P(dim58) = (/ &
      -2.7780E-01, -2.7780E-01, -2.7780E-01, -3.8640E-01, -4.3641E-01, -4.0620E-01, &
      -5.3338E-01, -4.0011E-01, -3.9201E-01, -1.7317E-01,  2.2877E-01, -4.7702E-02, &
       1.7299E-01,  5.0787E-01,  7.0422E-01,  1.0243E+00,  1.0575E+00,  1.4080E+00, &
       1.5382E+00,  2.0948E+00,  1.9926E+00,  2.3416E+00,  2.5011E+00,  2.7848E+00, &
       2.3445E+00,  2.5731E+00,  1.9092E+00,  1.0757E+00,  4.6739E-01, -2.3665E-01, &
      -1.0649E+00, -1.5366E+00, -1.7900E+00, -1.9052E+00, -1.9759E+00, -2.0983E+00, &
      -2.0468E+00, -1.8355E+00, -2.3080E+00, -2.1830E+00, -2.5305E+00, -2.7069E+00, &
      -2.3112E+00, -2.0915E+00, -1.3787E+00, -8.7286E-01, -1.0529E+00, -5.2707E-01, &
      -7.7754E-01, -1.0312E+00, -4.0980E-01, -2.0519E-01,  1.6164E+00,  3.1066E+00, &
       4.3420E+00,  4.2282E+00,  2.7107E+00,  1.1295E+00 /)
    REAL, PARAMETER :: c1_O3P(3) = (/  1.0000E+00,  1.8019E-03, -3.0208E-04 /)
    REAL, PARAMETER :: c2_O3P(3) = (/  1.0000E+00, -1.2536E-01, -4.1262E-04 /)
    REAL, PARAMETER :: c3_O3P(3) = (/  9.9999E-01, -3.9329E-01, -1.4331E-03 /)
    REAL, PARAMETER :: c4_O3P(3) = (/  9.9972E-01, -1.1343E+00, -5.9454E-01 /)
    REAL, PARAMETER :: c5_O3P(3) = (/  9.9979E-01, -1.0081E+00, -4.4087E-01 /)
    REAL, PARAMETER :: c6_O3P(3) = (/  1.0000E+00, -7.1500E-01, -2.3108E-02 /)

    jval_2d(ip_O3P)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_O3P(0) = &
          p2(1.,c0_1_1_O3P(i0(j,k))*dlv2(j,k) + &
          c0_1_2_O3P(i0(j,k)), &
          c0_2_1_O3P(i0(j,k))*dlv2(j,k) + &
          c0_2_2_O3P(i0(j,k)), tnorm_sr(j,k)) * &
          p1(a0_1_1_O3P(i0(j,k))*dlv2(j,k) + &
          a0_1_2_O3P(i0(j,k)), &
          a0_2_1_O3P(i0(j,k))*dlv2(j,k) + &
          a0_2_2_O3P(i0(j,k)),v3_du1(j,k))
        sig_O3P(1) = &
          p2(c1_O3P(1),c1_O3P(2), &
          c1_O3P(3),tnorm(j,k)) * &
          (p1(b1_1_O3P(i1(j,k)),a1_1_O3P(i1(j,k)), &
          v3_du1(j,k)) + &
          p1(b1_2_O3P(i1(j,k)),a1_2_O3P(i1(j,k)), &
          v3_du1(j,k)) * v2s_m(j,k))
        sig_O3P(2) = &
          p2(c2_O3P(1),c2_O3P(2),c2_O3P(3),tnorm(j,k))* &
          p1(b2_O3P(i2(j,k)), a2_O3P(i2(j,k)), &
          v3_du1(j,k))
        sig_O3P(3) = &
          p2(c3_O3P(1),c3_O3P(2),c3_O3P(3),tnorm(j,k))* &
          p1(b3_O3P(i3(j,k)), a3_O3P(i3(j,k)), &
          v3_du2(j,k))
        sig_O3P(4) = &
          p2(c4_O3P(1),c4_O3P(2),c4_O3P(3),tnorm(j,k))* &
          p3(a4_O3P(1),a4_O3P(2),a4_O3P(3), &
          a4_O3P(4),v3_du2(j,k))
        sig_O3P(5) = &
          p2(c5_O3P(1),c5_O3P(2),c5_O3P(3),tnorm(j,k))* &
          p3(a5_O3P(1),a5_O3P(2),a5_O3P(3), &
          a5_O3P(4),v3_du2(j,k))
        sig_O3P(6) = &
          p2(c6_O3P(1),c6_O3P(2),c6_O3P(3),tnorm(j,k))* &
          p3(a6_O3P(1),a6_O3P(2),a6_O3P(3), &
          a6_O3P(4),v3_du2(j,k))
        sig_O3P(7) = &
          p3(a7_O3P(1),a7_O3P(2),a7_O3P(3), &
          a7_O3P(4),v3_du2(j,k))
        dj = 0. &
          + sig_O3P(0) * fint(j,k,0) &
          + sig_O3P(1) * fint(j,k,1) &
          + sig_O3P(2) * fint(j,k,2) &
          + sig_O3P(3) * fint(j,k,3) &
          + sig_O3P(4) * fint(j,k,4) &
          + sig_O3P(5) * fint(j,k,5) &
          + sig_O3P(6) * fint(j,k,6) &
          + sig_O3P(7) * fint(j,k,7)

        jval_2d(ip_O3P)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,1)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_O3P

  ! **************************************************************************

  SUBROUTINE jval_cal_O1D

    ! O_3 \TOHV\ O(^1D) + O_2

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_O1D

    ! T-const parameters:
    REAL, PARAMETER :: a0_1_1_O1D(dim58) = (/ &
       3.0630E-21,  3.2674E-21,  3.4701E-21,  3.6668E-21,  3.8613E-21,  4.0449E-21, &
       4.2110E-21,  4.3551E-21,  4.5059E-21,  4.6019E-21,  4.7167E-21,  4.7925E-21, &
       5.2936E-21,  6.7220E-21,  6.4223E-21,  6.5238E-21,  7.0893E-21,  6.5881E-21, &
       6.4873E-21,  6.8920E-21,  6.0111E-21,  5.5656E-21,  5.6694E-21,  4.2648E-21, &
       3.3934E-21,  9.2558E-22, -8.6691E-22, -1.8746E-21, -2.7674E-21, -3.5179E-21, &
      -4.0851E-21, -4.4465E-21, -4.6194E-21, -4.5880E-21, -4.4555E-21, -4.2075E-21, &
      -3.9274E-21, -3.6489E-21, -3.4043E-21, -3.1858E-21, -3.0195E-21, -2.8619E-21, &
      -2.7317E-21, -2.5764E-21, -2.4017E-21, -2.1994E-21, -1.9770E-21, -1.7333E-21, &
      -1.5038E-21, -1.2854E-21, -1.0877E-21, -9.1591E-22, -7.6329E-22, -6.1960E-22, &
      -4.9120E-22, -3.7646E-22, -2.7873E-22, -2.2641E-22 /)
    REAL, PARAMETER :: a0_1_2_O1D(dim58) = (/ &
       3.9525E-20,  3.0490E-20,  2.1493E-20,  1.2721E-20,  4.0076E-21, -4.2576E-21, &
      -1.1762E-20, -1.8307E-20, -2.5181E-20, -2.9580E-20, -3.4862E-20, -3.8364E-20, &
      -6.1612E-20, -1.2818E-19, -1.1415E-19, -1.1892E-19, -1.4561E-19, -1.2186E-19, &
      -1.1706E-19, -1.3640E-19, -9.4121E-20, -7.2648E-20, -7.7668E-20, -9.4080E-21, &
       3.3118E-20,  1.5404E-19,  2.4223E-19,  2.9201E-19,  3.3630E-19,  3.7367E-19, &
       4.0203E-19,  4.2017E-19,  4.2889E-19,  4.2729E-19,  4.2056E-19,  4.0792E-19, &
       3.9358E-19,  3.7926E-19,  3.6664E-19,  3.5532E-19,  3.4667E-19,  3.3845E-19, &
       3.3163E-19,  3.2345E-19,  3.1423E-19,  3.0351E-19,  2.9168E-19,  2.7867E-19, &
       2.6637E-19,  2.5461E-19,  2.4394E-19,  2.3463E-19,  2.2632E-19,  2.1848E-19, &
       2.1144E-19,  2.0513E-19,  1.9974E-19,  1.9684E-19 /)
    REAL, PARAMETER :: a0_2_1_O1D(dim58) = (/ &
       1.2813E-23,  1.4414E-23,  1.6251E-23,  1.8257E-23,  2.0446E-23,  2.2832E-23, &
       2.5446E-23,  2.8359E-23,  3.1370E-23,  3.4871E-23,  3.8470E-23,  4.2534E-23, &
       4.0347E-23,  2.4877E-23,  3.5196E-23,  3.9403E-23,  3.7418E-23,  4.8926E-23, &
       5.4266E-23,  5.3033E-23,  6.5825E-23,  7.2033E-23,  7.1071E-23,  8.4600E-23, &
       9.0823E-23,  1.1116E-22,  1.2272E-22,  1.2480E-22,  1.2430E-22,  1.2106E-22, &
       1.1487E-22,  1.0586E-22,  9.4547E-23,  8.1383E-23,  6.7692E-23,  5.4002E-23, &
       4.1491E-23,  3.0628E-23,  2.1942E-23,  1.5407E-23,  1.1033E-23,  8.2503E-24, &
       6.7368E-24,  5.8265E-24,  5.2089E-24,  4.6390E-24,  4.0650E-24,  3.4358E-24, &
       2.8914E-24,  2.3835E-24,  1.9254E-24,  1.5523E-24,  1.2330E-24,  9.4168E-25, &
       7.0769E-25,  4.9915E-25,  3.4625E-25,  2.7125E-25 /)
    REAL, PARAMETER :: a0_2_2_O1D(dim58) = (/ &
      -1.0275E-21, -1.0983E-21, -1.1799E-21, -1.2693E-21, -1.3674E-21, -1.4747E-21, &
      -1.5929E-21, -1.7252E-21, -1.8625E-21, -2.0228E-21, -2.1883E-21, -2.3761E-21, &
      -2.2746E-21, -1.5537E-21, -2.0367E-21, -2.2344E-21, -2.1407E-21, -2.6862E-21, &
      -2.9404E-21, -2.8814E-21, -3.4954E-21, -3.7946E-21, -3.7481E-21, -4.4056E-21, &
      -4.7093E-21, -5.7058E-21, -6.2747E-21, -6.3772E-21, -6.3523E-21, -6.1914E-21, &
      -5.8819E-21, -5.4293E-21, -4.8592E-21, -4.1931E-21, -3.4976E-21, -2.7994E-21, &
      -2.1588E-21, -1.6005E-21, -1.1523E-21, -8.1373E-22, -5.8629E-22, -4.4105E-22, &
      -3.6174E-22, -3.1386E-22, -2.8125E-22, -2.5105E-22, -2.2051E-22, -1.8691E-22, &
      -1.5773E-22, -1.3041E-22, -1.0567E-22, -8.5446E-23, -6.8077E-23, -5.2171E-23, &
      -3.9348E-23, -2.7878E-23, -1.9438E-23, -1.5283E-23 /)
    REAL, PARAMETER :: a1_1_O1D(dim55) = (/ &
      -1.3881E-19, -1.2608E-19, -1.1240E-19, -9.8007E-20, -8.3347E-20, -7.1453E-20, &
      -5.9091E-20, -5.0911E-20, -4.1600E-20, -3.6543E-20, -2.9801E-20, -2.6872E-20, &
      -2.2005E-20, -2.0363E-20, -1.6778E-20, -1.5893E-20, -1.3161E-20, -1.2735E-20, &
      -1.0582E-20, -1.0426E-20, -8.6875E-21, -8.6916E-21, -7.2459E-21, -7.3548E-21, &
      -6.1294E-21, -6.3024E-21, -5.2466E-21, -5.4603E-21, -4.5403E-21, -4.7758E-21, &
      -3.9631E-21, -4.2161E-21, -3.4880E-21, -3.7482E-21, -3.0958E-21, -3.3557E-21, &
      -2.7668E-21, -3.0224E-21, -2.4893E-21, -2.7408E-21, -2.1918E-21, -1.8337E-21, &
      -1.4733E-21, -1.2950E-21, -1.0766E-21, -9.7830E-22, -8.3047E-22, -7.7243E-22, &
      -6.0630E-22, -5.5162E-22, -5.0268E-22, -4.5904E-22, -4.2022E-22, -3.8499E-22, &
      -3.5338E-22 /)
    REAL, PARAMETER :: b1_1_O1D(dim55) = (/ &
       3.2572E-18,  3.2190E-18,  3.1437E-18,  3.0286E-18,  2.8747E-18,  2.7200E-18, &
       2.5284E-18,  2.3812E-18,  2.1903E-18,  2.0740E-18,  1.9021E-18,  1.8201E-18, &
       1.6716E-18,  1.6175E-18,  1.4902E-18,  1.4566E-18,  1.3459E-18,  1.3276E-18, &
       1.2296E-18,  1.2221E-18,  1.1343E-18,  1.1346E-18,  1.0543E-18,  1.0606E-18, &
       9.8649E-19,  9.9739E-19,  9.2824E-19,  9.4277E-19,  8.7791E-19,  8.9510E-19, &
       8.3374E-19,  8.5347E-19,  7.9486E-19,  8.1646E-19,  7.6068E-19,  7.8355E-19, &
       7.3026E-19,  7.5403E-19,  7.0312E-19,  7.2777E-19,  6.7258E-19,  6.3212E-19, &
       5.8689E-19,  5.6229E-19,  5.2943E-19,  5.1340E-19,  4.8745E-19,  4.7654E-19, &
       4.4323E-19,  4.3158E-19,  4.2055E-19,  4.1016E-19,  4.0044E-19,  3.9117E-19, &
       3.8246E-19 /)
    REAL, PARAMETER :: a1_2_O1D(dim55) = (/ &
       1.3260E-23, -1.0155E-22, -1.6942E-22, -2.1790E-22, -2.6046E-22, -2.5023E-22, &
      -2.6956E-22, -2.2768E-22, -2.3531E-22, -1.8556E-22, -1.8959E-22, -1.4370E-22, &
      -1.4766E-22, -1.0952E-22, -1.1441E-22, -8.3757E-23, -8.9370E-23, -6.4931E-23, &
      -7.0851E-23, -5.1113E-23, -5.7006E-23, -4.0963E-23, -4.6695E-23, -3.3338E-23, &
      -3.8775E-23, -2.7525E-23, -3.2606E-23, -2.2993E-23, -2.7702E-23, -1.9414E-23, &
      -2.3772E-23, -1.6525E-23, -2.0561E-23, -1.4198E-23, -1.7896E-23, -1.2284E-23, &
      -1.5680E-23, -1.0698E-23, -1.3817E-23, -9.3612E-24, -9.6868E-24, -6.8187E-24, &
      -5.6920E-24, -4.1727E-24, -3.6622E-24, -2.7691E-24, -2.5347E-24, -1.9618E-24, &
      -2.1890E-24, -1.8807E-24, -1.6394E-24, -1.4459E-24, -1.2872E-24, -1.1571E-24, &
      -1.0474E-24 /)
    REAL, PARAMETER :: b1_2_O1D(dim55) = (/ &
       9.4448E-21,  9.7892E-21,  1.0162E-20,  1.0550E-20,  1.0997E-20,  1.0864E-20, &
       1.1164E-20,  1.0410E-20,  1.0567E-20,  9.4222E-21,  9.5248E-21,  8.2401E-21, &
       8.3609E-21,  7.1023E-21,  7.2759E-21,  6.1109E-21,  6.3383E-21,  5.2873E-21, &
       5.5567E-21,  4.6093E-21,  4.9069E-21,  4.0566E-21,  4.3747E-21,  3.6000E-21, &
       3.9290E-21,  3.2202E-21,  3.5530E-21,  2.8994E-21,  3.2313E-21,  2.6263E-21, &
       2.9553E-21,  2.3901E-21,  2.7149E-21,  2.1869E-21,  2.5030E-21,  2.0091E-21, &
       2.3165E-21,  1.8532E-21,  2.1510E-21,  1.7144E-21,  1.7471E-21,  1.4230E-21, &
       1.2816E-21,  1.0719E-21,  9.9510E-22,  8.4952E-22,  8.0839E-22,  7.0068E-22, &
       7.4624E-22,  6.8057E-22,  6.2617E-22,  5.8011E-22,  5.4036E-22,  5.0615E-22, &
       4.7592E-22 /)
    REAL, PARAMETER :: a2_O1D(dim55) = (/ &
      -2.5964E-19, -2.3476E-19, -1.9968E-19, -1.6168E-19, -1.2648E-19, -9.7000E-20, &
      -7.3680E-20, -5.6000E-20, -4.2960E-20, -3.3280E-20, -2.6240E-20, -2.1000E-20, &
      -1.7120E-20, -1.4200E-20, -1.1920E-20, -1.0200E-20, -8.8000E-21, -7.6800E-21, &
      -6.7600E-21, -6.0400E-21, -5.4400E-21, -4.8800E-21, -4.4400E-21, -4.0000E-21, &
      -3.7200E-21, -3.3600E-21, -3.1600E-21, -2.8800E-21, -2.6400E-21, -2.4800E-21, &
      -2.2800E-21, -2.1600E-21, -1.9600E-21, -1.8400E-21, -1.7600E-21, -1.6000E-21, &
      -1.4800E-21, -1.4000E-21, -1.3200E-21, -1.2400E-21, -1.0160E-21, -7.2800E-22, &
      -5.2800E-22, -3.8400E-22, -2.8000E-22, -2.0800E-22, -1.4400E-22, -1.0400E-22, &
      -8.0000E-23, -5.6000E-23, -4.0000E-23, -3.2000E-23, -1.6000E-23, -1.6000E-23, &
      -1.6000E-23 /)
    REAL, PARAMETER :: b2_O1D(dim55) = (/ &
       5.5010E-18,  5.4264E-18,  5.2334E-18,  4.9294E-18,  4.5598E-18,  4.1766E-18, &
       3.8151E-18,  3.4969E-18,  3.2296E-18,  3.0069E-18,  2.8274E-18,  2.6807E-18, &
       2.5624E-18,  2.4660E-18,  2.3851E-18,  2.3197E-18,  2.2630E-18,  2.2148E-18, &
       2.1730E-18,  2.1384E-18,  2.1081E-18,  2.0784E-18,  2.0540E-18,  2.0285E-18, &
       2.0116E-18,  1.9889E-18,  1.9758E-18,  1.9567E-18,  1.9398E-18,  1.9281E-18, &
       1.9130E-18,  1.9037E-18,  1.8876E-18,  1.8776E-18,  1.8708E-18,  1.8567E-18, &
       1.8458E-18,  1.8384E-18,  1.8308E-18,  1.8229E-18,  1.8004E-18,  1.7679E-18, &
       1.7428E-18,  1.7229E-18,  1.7072E-18,  1.6955E-18,  1.6843E-18,  1.6768E-18, &
       1.6719E-18,  1.6668E-18,  1.6632E-18,  1.6613E-18,  1.6573E-18,  1.6573E-18, &
       1.6573E-18 /)
    REAL, PARAMETER :: a3_O1D(dim55) = (/ &
      -2.5553E-21, -1.5128E-21, -7.9617E-22, -4.3864E-22, -2.6720E-22, -1.7816E-22, &
      -1.2767E-22, -9.6371E-23, -7.5646E-23, -6.1612E-23, -5.1181E-23, -4.3471E-23, &
      -3.7652E-23, -3.2694E-23, -2.8923E-23, -2.5847E-23, -2.3105E-23, -2.0701E-23, &
      -1.9007E-23, -1.7295E-23, -1.5726E-23, -1.4555E-23, -1.3356E-23, -1.2500E-23, &
      -1.1453E-23, -1.0616E-23, -9.9315E-24, -9.2466E-24, -8.7179E-24, -8.0479E-24, &
      -7.7055E-24, -7.0205E-24, -6.6667E-24, -6.3356E-24, -5.9932E-24, -5.4701E-24, &
      -5.3082E-24, -4.9658E-24, -4.6233E-24, -4.4444E-24, -3.7316E-24, -2.8757E-24, &
      -2.1561E-24, -1.6775E-24, -1.3009E-24, -1.0267E-24, -7.5317E-25, -6.1623E-25, &
      -4.7912E-25, -3.7658E-25, -3.0811E-25, -2.3956E-25, -1.7117E-25, -1.3694E-25, &
      -1.0267E-25 /)
    REAL, PARAMETER :: b3_O1D(dim55) = (/ &
       5.6260E-19,  5.0116E-19,  4.1707E-19,  3.5422E-19,  3.1407E-19,  2.8802E-19, &
       2.7029E-19,  2.5747E-19,  2.4778E-19,  2.4039E-19,  2.3429E-19,  2.2933E-19, &
       2.2525E-19,  2.2148E-19,  2.1839E-19,  2.1570E-19,  2.1313E-19,  2.1074E-19, &
       2.0896E-19,  2.0706E-19,  2.0522E-19,  2.0379E-19,  2.0224E-19,  2.0109E-19, &
       1.9963E-19,  1.9840E-19,  1.9736E-19,  1.9628E-19,  1.9542E-19,  1.9428E-19, &
       1.9368E-19,  1.9244E-19,  1.9178E-19,  1.9114E-19,  1.9046E-19,  1.8939E-19, &
       1.8905E-19,  1.8831E-19,  1.8755E-19,  1.8714E-19,  1.8547E-19,  1.8322E-19, &
       1.8112E-19,  1.7958E-19,  1.7826E-19,  1.7722E-19,  1.7610E-19,  1.7550E-19, &
       1.7486E-19,  1.7435E-19,  1.7399E-19,  1.7361E-19,  1.7321E-19,  1.7300E-19, &
       1.7278E-19 /)
    REAL, PARAMETER :: a4_O1D(4) = (/  5.8206E-20, -3.0944E-23,  6.8266E-27, -4.8927E-31 /)
    REAL, PARAMETER :: a5_O1D(4) = (/  1.5975E-21, -6.0790E-25,  1.1449E-28, -7.5260E-33 /)
    REAL, PARAMETER :: a6_O1D(4) = (/  4.3108E-24, -1.3770E-28,  2.0664E-33, -1.7289E-38 /)
    ! T-dep parameters:
    REAL, PARAMETER :: c0_1_1_O1D(dim58) = (/ &
       2.3547E-02,  2.3547E-02,  2.3547E-02,  2.7274E-02,  2.9502E-02,  3.2795E-02, &
       3.4510E-02,  3.5942E-02,  3.5706E-02,  3.5786E-02,  3.3848E-02,  3.2097E-02, &
       2.9967E-02,  2.6884E-02,  2.4277E-02,  2.1300E-02,  1.7171E-02,  1.3853E-02, &
       9.5772E-03,  4.2937E-03, -1.7488E-03, -8.2448E-03, -1.7607E-02, -2.5776E-02, &
      -3.5812E-02, -4.5419E-02, -5.4306E-02, -6.0571E-02, -6.5653E-02, -6.7590E-02, &
      -6.6626E-02, -6.4068E-02, -5.8456E-02, -5.3086E-02, -4.6061E-02, -4.0877E-02, &
      -3.4682E-02, -2.8572E-02, -2.2640E-02, -1.6064E-02, -9.3892E-03, -2.1329E-03, &
       3.5616E-03,  8.6876E-03,  1.2457E-02,  1.4185E-02,  1.4656E-02,  1.3814E-02, &
       1.2081E-02,  1.1394E-02,  9.3332E-03,  8.9120E-03,  9.3132E-03,  9.0506E-03, &
       9.0806E-03,  7.9237E-03,  6.7042E-03,  5.8824E-03 /)
    REAL, PARAMETER :: c0_1_2_O1D(dim58) = (/ &
      -1.0362E+00, -1.0362E+00, -1.0362E+00, -1.2025E+00, -1.3022E+00, -1.4505E+00, &
      -1.5280E+00, -1.5930E+00, -1.5822E+00, -1.5859E+00, -1.4967E+00, -1.4158E+00, &
      -1.3170E+00, -1.1733E+00, -1.0513E+00, -9.1139E-01, -7.1649E-01, -5.5925E-01, &
      -3.5571E-01, -1.0316E-01,  1.8688E-01,  4.9999E-01,  9.5311E-01,  1.3501E+00, &
       1.8399E+00,  2.3106E+00,  2.7478E+00,  3.0574E+00,  3.3094E+00,  3.4059E+00, &
       3.3577E+00,  3.2293E+00,  2.9464E+00,  2.6747E+00,  2.3179E+00,  2.0535E+00, &
       1.7363E+00,  1.4222E+00,  1.1161E+00,  7.7547E-01,  4.2840E-01,  4.9626E-02, &
      -2.4877E-01, -5.1839E-01, -7.1740E-01, -8.0901E-01, -8.3407E-01, -7.8910E-01, &
      -6.9621E-01, -6.5926E-01, -5.4796E-01, -5.2514E-01, -5.4696E-01, -5.3262E-01, &
      -5.3426E-01, -4.7064E-01, -4.0332E-01, -3.5779E-01 /)
    REAL, PARAMETER :: c0_2_1_O1D(dim58) = (/ &
       8.2852E-03,  8.2852E-03,  8.2852E-03,  8.8353E-03,  1.0050E-02,  1.3467E-02, &
       6.5191E-03,  1.5006E-02,  3.5176E-03,  1.1228E-02, -1.0801E-03,  3.1579E-03, &
      -9.8207E-03, -8.9515E-04, -1.5352E-02, -1.9947E-02, -1.8709E-02, -2.6873E-02, &
      -3.1781E-02, -2.9884E-02, -3.9028E-02, -4.7504E-02, -4.2388E-02, -5.0144E-02, &
      -4.8943E-02, -4.1819E-02, -3.4460E-02, -2.3943E-02, -1.0534E-02,  2.6048E-03, &
       1.8596E-02,  2.7833E-02,  3.3765E-02,  3.4959E-02,  3.8411E-02,  3.9292E-02, &
       3.3771E-02,  3.5541E-02,  3.3852E-02,  3.5572E-02,  3.2697E-02,  2.7848E-02, &
       2.0816E-02,  1.6064E-02,  6.5906E-03,  7.3355E-03, -2.0472E-03,  4.4477E-03, &
      -1.1703E-03,  2.9828E-03,  7.3436E-05, -1.0283E-03, -9.0419E-03, -1.3609E-02, &
      -1.5814E-02, -1.1460E-02, -8.7385E-03, -1.8204E-02 /)
    REAL, PARAMETER :: c0_2_2_O1D(dim58) = (/ &
      -3.6092E-01, -3.6092E-01, -3.6092E-01, -3.8545E-01, -4.3985E-01, -5.9365E-01, &
      -2.7959E-01, -6.6490E-01, -1.4103E-01, -4.9416E-01,  7.2012E-02, -1.2378E-01, &
       4.7842E-01,  6.2494E-02,  7.3905E-01,  9.5502E-01,  8.9660E-01,  1.2836E+00, &
       1.5172E+00,  1.4265E+00,  1.8654E+00,  2.2740E+00,  2.0264E+00,  2.4033E+00, &
       2.3447E+00,  1.9956E+00,  1.6336E+00,  1.1140E+00,  4.4893E-01, -2.0538E-01, &
      -1.0049E+00, -1.4687E+00, -1.7676E+00, -1.8280E+00, -2.0034E+00, -2.0483E+00, &
      -1.7656E+00, -1.8566E+00, -1.7695E+00, -1.8586E+00, -1.7090E+00, -1.4559E+00, &
      -1.0875E+00, -8.3751E-01, -3.3732E-01, -3.7680E-01,  1.2236E-01, -2.2447E-01, &
       7.6659E-02, -1.4678E-01,  1.0326E-02,  7.0039E-02,  5.0598E-01,  7.5534E-01, &
       8.7616E-01,  6.3673E-01,  4.8648E-01,  1.0108E+00 /)
    REAL, PARAMETER :: c1_O1D(3) = (/  1.0000E+00, -5.2317E-03, -2.7083E-16 /)
    REAL, PARAMETER :: c2_O1D(3) = (/  1.0000E+00, -1.2538E-01, -1.9124E-04 /)
    REAL, PARAMETER :: c3_O1D(3) = (/  9.9998E-01, -3.9330E-01, -1.3876E-03 /)
    REAL, PARAMETER :: c4_O1D(3) = (/  1.0004E+00,  3.0443E-01,  7.5448E-01 /)
    REAL, PARAMETER :: c5_O1D(3) = (/  1.0016E+00,  9.9546E-01,  2.9607E+00 /)
    REAL, PARAMETER :: c6_O1D(3) = (/  1.0000E+00, -1.5255E+00, -5.4875E-02 /)

    jval_2d(ip_O1D)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_O1D(0) = &
          p2(1.,c0_1_1_O1D(i0(j,k))*dlv2(j,k) + &
          c0_1_2_O1D(i0(j,k)), &
          c0_2_1_O1D(i0(j,k))*dlv2(j,k) + &
          c0_2_2_O1D(i0(j,k)), tnorm_sr(j,k)) * &
          p1(a0_1_1_O1D(i0(j,k))*dlv2(j,k) + &
          a0_1_2_O1D(i0(j,k)), &
          a0_2_1_O1D(i0(j,k))*dlv2(j,k) + &
          a0_2_2_O1D(i0(j,k)),v3_du1(j,k))
        sig_O1D(1) = &
          p2(c1_O1D(1),c1_O1D(2), &
          c1_O1D(3),tnorm(j,k)) * &
          (p1(b1_1_O1D(i1(j,k)),a1_1_O1D(i1(j,k)), &
          v3_du1(j,k)) + &
          p1(b1_2_O1D(i1(j,k)),a1_2_O1D(i1(j,k)), &
          v3_du1(j,k)) * v2s_m(j,k))
        sig_O1D(2) = &
          p2(c2_O1D(1),c2_O1D(2),c2_O1D(3),tnorm(j,k))* &
          p1(b2_O1D(i2(j,k)), a2_O1D(i2(j,k)), &
          v3_du1(j,k))
        sig_O1D(3) = &
          p2(c3_O1D(1),c3_O1D(2),c3_O1D(3),tnorm(j,k))* &
          p1(b3_O1D(i3(j,k)), a3_O1D(i3(j,k)), &
          v3_du2(j,k))
        sig_O1D(4) = &
          p2(c4_O1D(1),c4_O1D(2),c4_O1D(3),tnorm(j,k))* &
          p3(a4_O1D(1),a4_O1D(2),a4_O1D(3), &
          a4_O1D(4),v3_du2(j,k))
        sig_O1D(5) = &
          p2(c5_O1D(1),c5_O1D(2),c5_O1D(3),tnorm(j,k))* &
          p3(a5_O1D(1),a5_O1D(2),a5_O1D(3), &
          a5_O1D(4),v3_du2(j,k))
        sig_O1D(6) = &
          p2(c6_O1D(1),c6_O1D(2),c6_O1D(3),tnorm(j,k))* &
          p3(a6_O1D(1),a6_O1D(2),a6_O1D(3), &
          a6_O1D(4),v3_du2(j,k))
        dj = 0. &
          + sig_O1D(0) * fint(j,k,0) &
          + sig_O1D(1) * fint(j,k,1) &
          + sig_O1D(2) * fint(j,k,2) &
          + sig_O1D(3) * fint(j,k,3) &
          + sig_O1D(4) * fint(j,k,4) &
          + sig_O1D(5) * fint(j,k,5) &
          + sig_O1D(6) * fint(j,k,6)

        jval_2d(ip_O1D)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,6)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_O1D

  ! **************************************************************************

  SUBROUTINE jval_cal_H2O2

    ! H_2O_2 \TOHV\ OH + OH

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_H2O2

    ! T-const parameters:
    REAL, PARAMETER :: a0_1_1_H2O2(dim58) = (/ &
       8.2711E-21,  8.9631E-21,  9.6501E-21,  1.0352E-20,  1.1055E-20,  1.1753E-20, &
       1.2430E-20,  1.3085E-20,  1.3725E-20,  1.4340E-20,  1.4937E-20,  1.5495E-20, &
       1.7706E-20,  2.3479E-20,  2.2523E-20,  2.3177E-20,  2.5616E-20,  2.4184E-20, &
       2.4426E-20,  2.6515E-20,  2.4232E-20,  2.3677E-20,  2.5075E-20,  2.1622E-20, &
       2.0063E-20,  1.3474E-20,  9.2186E-21,  7.4248E-21,  5.8626E-21,  4.5661E-21, &
       3.6289E-21,  3.0367E-21,  2.7900E-21,  2.8113E-21,  2.9942E-21,  3.2218E-21, &
       3.3954E-21,  3.3778E-21,  3.1521E-21,  2.6562E-21,  1.8879E-21,  8.5261E-22, &
      -3.6244E-22, -1.7149E-21, -3.0894E-21, -4.3975E-21, -5.5287E-21, -6.3575E-21, &
      -6.8524E-21, -6.9888E-21, -6.8298E-21, -6.4578E-21, -5.9592E-21, -5.3830E-21, &
      -4.7908E-21, -4.1492E-21, -3.4793E-21, -2.8627E-21 /)
    REAL, PARAMETER :: a0_1_2_H2O2(dim58) = (/ &
       2.9657E-20, -9.2921E-22, -3.1431E-20, -6.2751E-20, -9.4210E-20, -1.2564E-19, &
      -1.5626E-19, -1.8597E-19, -2.1517E-19, -2.4334E-19, -2.7079E-19, -2.9658E-19, &
      -3.9916E-19, -6.6819E-19, -6.2344E-19, -6.5419E-19, -7.6932E-19, -7.0142E-19, &
      -7.1294E-19, -8.1281E-19, -7.0322E-19, -6.7646E-19, -7.4414E-19, -5.7631E-19, &
      -5.0021E-19, -1.7736E-19,  3.1996E-20,  1.2061E-19,  1.9809E-19,  2.6266E-19, &
       3.0952E-19,  3.3925E-19,  3.5168E-19,  3.5060E-19,  3.4131E-19,  3.2971E-19, &
       3.2082E-19,  3.2172E-19,  3.3337E-19,  3.5906E-19,  3.9901E-19,  4.5305E-19, &
       5.1672E-19,  5.8785E-19,  6.6043E-19,  7.2976E-19,  7.8994E-19,  8.3420E-19, &
       8.6072E-19,  8.6806E-19,  8.5948E-19,  8.3931E-19,  8.1219E-19,  7.8073E-19, &
       7.4827E-19,  7.1299E-19,  6.7601E-19,  6.4185E-19 /)
    REAL, PARAMETER :: a0_2_1_H2O2(dim58) = (/ &
       2.9777E-23,  3.3128E-23,  3.6951E-23,  4.1208E-23,  4.5850E-23,  5.0955E-23, &
       5.6544E-23,  6.2779E-23,  6.9391E-23,  7.6800E-23,  8.4762E-23,  9.3728E-23, &
       7.8253E-23,  1.2447E-23,  4.7278E-23,  5.7977E-23,  4.5319E-23,  8.2417E-23, &
       9.5977E-23,  8.6101E-23,  1.2564E-22,  1.4134E-22,  1.3312E-22,  1.7343E-22, &
       1.8908E-22,  2.5049E-22,  2.8318E-22,  2.8671E-22,  2.8372E-22,  2.7388E-22, &
       2.5655E-22,  2.3234E-22,  2.0223E-22,  1.6805E-22,  1.3237E-22,  9.7421E-23, &
       6.5679E-23,  3.8922E-23,  1.8013E-23,  3.4301E-24, -5.2105E-24, -8.7654E-24, &
      -8.7619E-24, -6.5049E-24, -3.3074E-24,  8.7994E-26,  3.2252E-24,  5.5419E-24, &
       7.1568E-24,  7.8728E-24,  7.8288E-24,  7.2723E-24,  6.4264E-24,  5.4065E-24, &
       4.5151E-24,  3.4664E-24,  2.7599E-24,  2.1289E-24 /)
    REAL, PARAMETER :: a0_2_2_H2O2(dim58) = (/ &
      -2.2324E-21, -2.3805E-21, -2.5503E-21, -2.7401E-21, -2.9481E-21, -3.1778E-21, &
      -3.4304E-21, -3.7135E-21, -4.0150E-21, -4.3544E-21, -4.7206E-21, -5.1348E-21, &
      -4.4168E-21, -1.3502E-21, -2.9803E-21, -3.4832E-21, -2.8857E-21, -4.6442E-21, &
      -5.2896E-21, -4.8175E-21, -6.7155E-21, -7.4723E-21, -7.0745E-21, -9.0333E-21, &
      -9.7972E-21, -1.2806E-20, -1.4415E-20, -1.4589E-20, -1.4440E-20, -1.3950E-20, &
      -1.3084E-20, -1.1869E-20, -1.0351E-20, -8.6219E-21, -6.8093E-21, -5.0267E-21, &
      -3.4015E-21, -2.0262E-21, -9.4732E-22, -1.9193E-22,  2.5738E-22,  4.4294E-22, &
       4.4276E-22,  3.2404E-22,  1.5521E-22, -2.4741E-23, -1.9164E-22, -3.1535E-22, &
      -4.0191E-22, -4.4043E-22, -4.3805E-22, -4.0789E-22, -3.6188E-22, -3.0619E-22, &
      -2.5734E-22, -1.9966E-22, -1.6066E-22, -1.2571E-22 /)
    REAL, PARAMETER :: a1_1_H2O2(dim55) = (/ &
       4.5520E-21,  4.2939E-21,  4.0683E-21,  3.6907E-21,  3.3633E-21,  3.0027E-21, &
       2.6837E-21,  2.4024E-21,  2.1361E-21,  1.9341E-21,  1.7266E-21,  1.5873E-21, &
       1.4263E-21,  1.3306E-21,  1.2028E-21,  1.1378E-21,  1.0339E-21,  9.8967E-22, &
       9.0295E-22,  8.7225E-22,  7.9872E-22,  7.7747E-22,  7.1364E-22,  6.9914E-22, &
       6.4384E-22,  6.3446E-22,  5.8512E-22,  5.8006E-22,  5.3407E-22,  5.3362E-22, &
       4.9100E-22,  4.9429E-22,  4.5353E-22,  4.5946E-22,  4.2278E-22,  4.2879E-22, &
       3.9575E-22,  4.0070E-22,  3.7058E-22,  3.7719E-22,  3.3731E-22,  2.9975E-22, &
       2.6466E-22,  2.4202E-22,  2.1808E-22,  2.0284E-22,  1.8506E-22,  1.7446E-22, &
       1.5456E-22,  1.4399E-22,  1.3428E-22,  1.2554E-22,  1.1728E-22,  1.1001E-22, &
       1.0316E-22 /)
    REAL, PARAMETER :: b1_1_H2O2(dim55) = (/ &
       2.2339E-19,  2.2417E-19,  2.2541E-19,  2.2843E-19,  2.3186E-19,  2.3655E-19, &
       2.4150E-19,  2.4656E-19,  2.5202E-19,  2.5666E-19,  2.6196E-19,  2.6586E-19, &
       2.7077E-19,  2.7392E-19,  2.7846E-19,  2.8093E-19,  2.8514E-19,  2.8704E-19, &
       2.9099E-19,  2.9246E-19,  2.9618E-19,  2.9730E-19,  3.0084E-19,  3.0168E-19, &
       3.0503E-19,  3.0562E-19,  3.0885E-19,  3.0920E-19,  3.1244E-19,  3.1247E-19, &
       3.1569E-19,  3.1543E-19,  3.1872E-19,  3.1822E-19,  3.2136E-19,  3.2083E-19, &
       3.2382E-19,  3.2336E-19,  3.2624E-19,  3.2559E-19,  3.2960E-19,  3.3384E-19, &
       3.3824E-19,  3.4137E-19,  3.4497E-19,  3.4746E-19,  3.5058E-19,  3.5257E-19, &
       3.5656E-19,  3.5881E-19,  3.6100E-19,  3.6308E-19,  3.6515E-19,  3.6706E-19, &
       3.6895E-19 /)
    REAL, PARAMETER :: a1_2_H2O2(dim55) = (/ &
      -6.4582E-24, -1.8603E-24, -6.2909E-25,  2.5190E-24,  3.4727E-24,  4.8377E-24, &
       5.3055E-24,  5.3918E-24,  5.5525E-24,  5.0247E-24,  5.0772E-24,  4.3371E-24, &
       4.3936E-24,  3.6504E-24,  3.7441E-24,  3.0537E-24,  3.1823E-24,  2.5736E-24, &
       2.7284E-24,  2.1888E-24,  2.3570E-24,  1.8758E-24,  2.0613E-24,  1.6396E-24, &
       1.8116E-24,  1.4331E-24,  1.6095E-24,  1.2591E-24,  1.4421E-24,  1.1173E-24, &
       1.3025E-24,  9.8735E-25,  1.1773E-24,  8.8743E-25,  1.0606E-24,  8.0190E-25, &
       9.5643E-25,  7.3308E-25,  8.7567E-25,  6.6496E-25,  6.7370E-25,  5.2206E-25, &
       4.5778E-25,  3.6486E-25,  3.3340E-25,  2.7335E-25,  2.5777E-25,  2.1511E-25, &
       2.4056E-25,  2.2189E-25,  2.0659E-25,  1.9411E-25,  1.8333E-25,  1.7395E-25, &
       1.6506E-25 /)
    REAL, PARAMETER :: b1_2_H2O2(dim55) = (/ &
      -3.0753E-22, -3.2132E-22, -3.2810E-22, -3.5328E-22, -3.6329E-22, -3.8104E-22, &
      -3.8829E-22, -3.8984E-22, -3.9314E-22, -3.8100E-22, -3.8234E-22, -3.6161E-22, &
      -3.6334E-22, -3.3881E-22, -3.4214E-22, -3.1590E-22, -3.2111E-22, -2.9494E-22, &
      -3.0198E-22, -2.7608E-22, -2.8457E-22, -2.5907E-22, -2.6937E-22, -2.4491E-22, &
      -2.5532E-22, -2.3147E-22, -2.4302E-22, -2.1919E-22, -2.3210E-22, -2.0838E-22, &
      -2.2237E-22, -1.9779E-22, -2.1308E-22, -1.8902E-22, -2.0382E-22, -1.8106E-22, &
      -1.9504E-22, -1.7427E-22, -1.8789E-22, -1.6724E-22, -1.6812E-22, -1.5098E-22, &
      -1.4292E-22, -1.3009E-22, -1.2536E-22, -1.1557E-22, -1.1284E-22, -1.0482E-22, &
      -1.0992E-22, -1.0594E-22, -1.0249E-22, -9.9523E-23, -9.6821E-23, -9.4355E-23, &
      -9.1904E-23 /)
    REAL, PARAMETER :: a2_H2O2(dim55) = (/ &
      -1.5640E-21, -1.3620E-21, -1.1144E-21, -8.6720E-22, -6.5160E-22, -4.7840E-22, &
      -3.4800E-22, -2.5320E-22, -1.8640E-22, -1.3880E-22, -1.0560E-22, -8.2000E-23, &
      -6.5200E-23, -5.2800E-23, -4.3600E-23, -3.6800E-23, -3.1600E-23, -2.7200E-23, &
      -2.4400E-23, -2.1200E-23, -1.9200E-23, -1.7200E-23, -1.5600E-23, -1.4000E-23, &
      -1.3200E-23, -1.2000E-23, -1.0800E-23, -1.0400E-23, -9.2000E-24, -8.8000E-24, &
      -8.4000E-24, -7.2000E-24, -7.2000E-24, -6.4000E-24, -6.4000E-24, -5.6000E-24, &
      -5.2000E-24, -5.2000E-24, -4.4000E-24, -4.4000E-24, -3.6000E-24, -2.6400E-24, &
      -1.8400E-24, -1.4400E-24, -9.6000E-25, -7.2000E-25, -5.6000E-25, -3.2000E-25, &
      -3.2000E-25, -1.6000E-25, -1.6000E-25, -8.0000E-26, -8.0000E-26, -8.0000E-26, &
      -8.0000E-26 /)
    REAL, PARAMETER :: b2_H2O2(dim55) = (/ &
       3.2670E-20,  3.2064E-20,  3.0702E-20,  2.8725E-20,  2.6461E-20,  2.4209E-20, &
       2.2188E-20,  2.0482E-20,  1.9112E-20,  1.8017E-20,  1.7171E-20,  1.6510E-20, &
       1.5998E-20,  1.5588E-20,  1.5262E-20,  1.5003E-20,  1.4793E-20,  1.4604E-20, &
       1.4476E-20,  1.4323E-20,  1.4222E-20,  1.4116E-20,  1.4027E-20,  1.3934E-20, &
       1.3886E-20,  1.3810E-20,  1.3731E-20,  1.3704E-20,  1.3620E-20,  1.3590E-20, &
       1.3560E-20,  1.3467E-20,  1.3467E-20,  1.3400E-20,  1.3400E-20,  1.3330E-20, &
       1.3294E-20,  1.3294E-20,  1.3217E-20,  1.3217E-20,  1.3137E-20,  1.3028E-20, &
       1.2928E-20,  1.2873E-20,  1.2800E-20,  1.2761E-20,  1.2733E-20,  1.2688E-20, &
       1.2688E-20,  1.2654E-20,  1.2654E-20,  1.2635E-20,  1.2635E-20,  1.2635E-20, &
       1.2635E-20 /)
    REAL, PARAMETER :: a3_H2O2(dim55) = (/ &
      -1.5631E-23, -9.6349E-24, -5.3620E-24, -3.1542E-24, -2.0472E-24, -1.4496E-24, &
      -1.0902E-24, -8.5929E-25, -6.9998E-25, -5.8703E-25, -4.9983E-25, -4.3129E-25, &
      -3.7994E-25, -3.3550E-25, -2.9950E-25, -2.7046E-25, -2.4303E-25, -2.2070E-25, &
      -2.0205E-25, -1.8493E-25, -1.6923E-25, -1.5582E-25, -1.4555E-25, -1.3356E-25, &
      -1.2479E-25, -1.1644E-25, -1.0788E-25, -1.0103E-25, -9.4017E-26, -8.9041E-26, &
      -8.3904E-26, -7.7055E-26, -7.3504E-26, -6.8493E-26, -6.5068E-26, -5.9829E-26, &
      -5.8219E-26, -5.4795E-26, -5.1370E-26, -4.7863E-26, -4.0739E-26, -3.0811E-26, &
      -2.3956E-26, -1.8144E-26, -1.4036E-26, -1.0951E-26, -8.2164E-27, -6.5046E-27, &
      -5.4757E-27, -3.7658E-27, -3.4235E-27, -2.3956E-27, -1.7117E-27, -1.7117E-27, &
      -1.0267E-27 /)
    REAL, PARAMETER :: b3_H2O2(dim55) = (/ &
       7.3609E-21,  7.0076E-21,  6.5061E-21,  6.1180E-21,  5.8588E-21,  5.6839E-21, &
       5.5577E-21,  5.4632E-21,  5.3886E-21,  5.3292E-21,  5.2782E-21,  5.2341E-21, &
       5.1981E-21,  5.1643E-21,  5.1348E-21,  5.1094E-21,  5.0837E-21,  5.0615E-21, &
       5.0419E-21,  5.0229E-21,  5.0045E-21,  4.9881E-21,  4.9749E-21,  4.9587E-21, &
       4.9464E-21,  4.9342E-21,  4.9212E-21,  4.9104E-21,  4.8989E-21,  4.8905E-21, &
       4.8815E-21,  4.8691E-21,  4.8625E-21,  4.8528E-21,  4.8460E-21,  4.8353E-21, &
       4.8319E-21,  4.8245E-21,  4.8169E-21,  4.8089E-21,  4.7922E-21,  4.7661E-21, &
       4.7461E-21,  4.7274E-21,  4.7130E-21,  4.7013E-21,  4.6901E-21,  4.6826E-21, &
       4.6778E-21,  4.6693E-21,  4.6675E-21,  4.6618E-21,  4.6578E-21,  4.6578E-21, &
       4.6534E-21 /)
    REAL, PARAMETER :: a4_H2O2(4) = (/  3.4593E-21, -3.5544E-25,  7.2788E-29, -5.0428E-33 /)
    REAL, PARAMETER :: a5_H2O2(4) = (/  1.2873E-21, -1.8271E-25,  3.0346E-29, -1.8987E-33 /)
    REAL, PARAMETER :: a6_H2O2(4) = (/  5.0948E-23, -1.0484E-27,  1.2091E-32, -8.0690E-38 /)
    ! T-dep parameters:
    REAL, PARAMETER :: c0_1_1_H2O2(dim58) = (/ &
       2.6118E-02,  2.6118E-02,  2.6118E-02,  2.9442E-02,  3.2919E-02,  3.6365E-02, &
       3.9085E-02,  4.1216E-02,  4.2115E-02,  4.2542E-02,  4.2283E-02,  4.0833E-02, &
       3.9376E-02,  3.7661E-02,  3.5208E-02,  3.3127E-02,  3.0346E-02,  2.8058E-02, &
       2.4891E-02,  2.1500E-02,  1.6366E-02,  1.0659E-02,  2.6871E-03, -6.2589E-03, &
      -1.6940E-02, -2.8679E-02, -4.0306E-02, -5.1102E-02, -6.0416E-02, -6.7263E-02, &
      -7.1183E-02, -7.1865E-02, -7.0293E-02, -6.6277E-02, -6.0974E-02, -5.5698E-02, &
      -5.0326E-02, -4.6262E-02, -4.3062E-02, -4.0872E-02, -3.8951E-02, -3.7120E-02, &
      -3.4788E-02, -3.0704E-02, -2.5257E-02, -1.8545E-02, -1.0994E-02, -4.3218E-03, &
       1.1310E-03,  5.6277E-03,  9.8098E-03,  1.4767E-02,  2.0642E-02,  2.6751E-02, &
       3.2682E-02,  3.6682E-02,  4.1788E-02,  4.8269E-02 /)
    REAL, PARAMETER :: c0_1_2_H2O2(dim58) = (/ &
      -1.1271E+00, -1.1271E+00, -1.1271E+00, -1.2753E+00, -1.4311E+00, -1.5862E+00, &
      -1.7091E+00, -1.8058E+00, -1.8469E+00, -1.8664E+00, -1.8545E+00, -1.7875E+00, &
      -1.7199E+00, -1.6400E+00, -1.5252E+00, -1.4274E+00, -1.2961E+00, -1.1877E+00, &
      -1.0369E+00, -8.7484E-01, -6.2841E-01, -3.5331E-01,  3.2526E-02,  4.6730E-01, &
       9.8856E-01,  1.5638E+00,  2.1358E+00,  2.6691E+00,  3.1311E+00,  3.4721E+00, &
       3.6681E+00,  3.7023E+00,  3.6231E+00,  3.4199E+00,  3.1505E+00,  2.8814E+00, &
       2.6064E+00,  2.3975E+00,  2.2323E+00,  2.1189E+00,  2.0190E+00,  1.9234E+00, &
       1.8012E+00,  1.5864E+00,  1.2988E+00,  9.4309E-01,  5.4138E-01,  1.8507E-01, &
      -1.0720E-01, -3.4912E-01, -5.7495E-01, -8.4362E-01, -1.1632E+00, -1.4968E+00, &
      -1.8218E+00, -2.0418E+00, -2.3237E+00, -2.6827E+00 /)
    REAL, PARAMETER :: c0_2_1_H2O2(dim58) = (/ &
       9.1214E-03,  9.1214E-03,  9.1214E-03,  1.0999E-02,  1.1172E-02,  1.0934E-02, &
       1.5904E-02,  1.4692E-02,  1.1443E-02,  1.2048E-02,  6.3340E-03,  8.1731E-03, &
      -1.2527E-03, -2.0082E-03, -6.7099E-03, -9.7612E-03, -1.4862E-02, -1.6822E-02, &
      -2.3250E-02, -2.6310E-02, -3.0009E-02, -3.2593E-02, -3.7624E-02, -4.1523E-02, &
      -4.4568E-02, -4.3983E-02, -4.2108E-02, -3.3370E-02, -2.5085E-02, -1.3027E-02, &
      -1.9877E-03,  7.8902E-03,  1.1184E-02,  1.6767E-02,  1.5527E-02,  1.4758E-02, &
       1.3378E-02,  1.1102E-02,  9.6291E-03,  9.0794E-03,  1.3487E-02,  1.5011E-02, &
       1.8257E-02,  2.5322E-02,  3.0881E-02,  3.0276E-02,  3.0496E-02,  2.5461E-02, &
       2.3670E-02,  1.8170E-02,  1.2284E-02,  5.4472E-03, -8.9724E-03, -2.4109E-02, &
      -3.4125E-02, -3.2645E-02, -2.2165E-02, -7.1582E-03 /)
    REAL, PARAMETER :: c0_2_2_H2O2(dim58) = (/ &
      -3.9672E-01, -3.9672E-01, -3.9672E-01, -4.8047E-01, -4.8821E-01, -4.7751E-01, &
      -7.0213E-01, -6.4713E-01, -4.9899E-01, -5.2669E-01, -2.6383E-01, -3.4880E-01, &
       8.8558E-02,  1.2376E-01,  3.4380E-01,  4.8721E-01,  7.2797E-01,  8.2089E-01, &
       1.1269E+00,  1.2731E+00,  1.4507E+00,  1.5752E+00,  1.8187E+00,  2.0082E+00, &
       2.1568E+00,  2.1281E+00,  2.0359E+00,  1.6042E+00,  1.1933E+00,  5.9279E-01, &
       4.0845E-02, -4.5502E-01, -6.2104E-01, -9.0351E-01, -8.4053E-01, -8.0134E-01, &
      -7.3066E-01, -6.1369E-01, -5.3768E-01, -5.0921E-01, -7.3842E-01, -8.1797E-01, &
      -9.8806E-01, -1.3596E+00, -1.6532E+00, -1.6211E+00, -1.6328E+00, -1.3640E+00, &
      -1.2680E+00, -9.7206E-01, -6.5421E-01, -2.8365E-01,  5.0078E-01,  1.3272E+00, &
       1.8761E+00,  1.7947E+00,  1.2162E+00,  3.8484E-01 /)
    REAL, PARAMETER :: c1_H2O2(3) = (/  9.9999E-01,  3.2070E-03, -3.9189E-05 /)
    REAL, PARAMETER :: c2_H2O2(3) = (/  9.9967E-01,  2.1332E-01,  3.3687E-01 /)
    REAL, PARAMETER :: c3_H2O2(3) = (/  9.9942E-01,  3.6369E-01,  5.7636E-01 /)
    REAL, PARAMETER :: c4_H2O2(3) = (/  9.9930E-01,  4.5012E-01,  7.0624E-01 /)
    REAL, PARAMETER :: c5_H2O2(3) = (/  9.9897E-01,  7.1217E-01,  1.0882E+00 /)
    REAL, PARAMETER :: c6_H2O2(3) = (/  9.9874E-01,  7.7813E-01,  1.2582E+00 /)

    jval_2d(ip_H2O2)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_H2O2(0) = &
          p2(1.,c0_1_1_H2O2(i0(j,k))*dlv2(j,k) + &
          c0_1_2_H2O2(i0(j,k)), &
          c0_2_1_H2O2(i0(j,k))*dlv2(j,k) + &
          c0_2_2_H2O2(i0(j,k)), tnorm_sr(j,k)) * &
          p1(a0_1_1_H2O2(i0(j,k))*dlv2(j,k) + &
          a0_1_2_H2O2(i0(j,k)), &
          a0_2_1_H2O2(i0(j,k))*dlv2(j,k) + &
          a0_2_2_H2O2(i0(j,k)),v3_du1(j,k))
        sig_H2O2(1) = &
          p2(c1_H2O2(1),c1_H2O2(2), &
          c1_H2O2(3),tnorm(j,k)) * &
          (p1(b1_1_H2O2(i1(j,k)),a1_1_H2O2(i1(j,k)), &
          v3_du1(j,k)) + &
          p1(b1_2_H2O2(i1(j,k)),a1_2_H2O2(i1(j,k)), &
          v3_du1(j,k)) * v2s_m(j,k))
        sig_H2O2(2) = &
          p2(c2_H2O2(1),c2_H2O2(2),c2_H2O2(3),tnorm(j,k))* &
          p1(b2_H2O2(i2(j,k)), a2_H2O2(i2(j,k)), &
          v3_du1(j,k))
        sig_H2O2(3) = &
          p2(c3_H2O2(1),c3_H2O2(2),c3_H2O2(3),tnorm(j,k))* &
          p1(b3_H2O2(i3(j,k)), a3_H2O2(i3(j,k)), &
          v3_du2(j,k))
        sig_H2O2(4) = &
          p2(c4_H2O2(1),c4_H2O2(2),c4_H2O2(3),tnorm(j,k))* &
          p3(a4_H2O2(1),a4_H2O2(2),a4_H2O2(3), &
          a4_H2O2(4),v3_du2(j,k))
        sig_H2O2(5) = &
          p2(c5_H2O2(1),c5_H2O2(2),c5_H2O2(3),tnorm(j,k))* &
          p3(a5_H2O2(1),a5_H2O2(2),a5_H2O2(3), &
          a5_H2O2(4),v3_du2(j,k))
        sig_H2O2(6) = &
          p2(c6_H2O2(1),c6_H2O2(2),c6_H2O2(3),tnorm(j,k))* &
          p3(a6_H2O2(1),a6_H2O2(2),a6_H2O2(3), &
          a6_H2O2(4),v3_du2(j,k))
        dj = 0. &
          + sig_H2O2(0) * fint(j,k,0) &
          + sig_H2O2(1) * fint(j,k,1) &
          + sig_H2O2(2) * fint(j,k,2) &
          + sig_H2O2(3) * fint(j,k,3) &
          + sig_H2O2(4) * fint(j,k,4) &
          + sig_H2O2(5) * fint(j,k,5) &
          + sig_H2O2(6) * fint(j,k,6)

        jval_2d(ip_H2O2)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,5)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_H2O2

  ! **************************************************************************

  SUBROUTINE jval_cal_NO2

    ! NO_2 \TOHV\ NO + O

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_NO2

    ! T-const parameters:
    REAL, PARAMETER :: a2_NO2(dim55) = (/ &
       2.1096E-21,  1.9556E-21,  1.7064E-21,  1.4196E-21,  1.1440E-21,  9.0440E-22, &
       7.1080E-22,  5.5960E-22,  4.4400E-22,  3.5760E-22,  2.9200E-22,  2.4240E-22, &
       2.0400E-22,  1.7440E-22,  1.5080E-22,  1.3240E-22,  1.1680E-22,  1.0480E-22, &
       9.3600E-23,  8.5200E-23,  7.7200E-23,  7.0800E-23,  6.5200E-23,  5.9600E-23, &
       5.5200E-23,  5.1200E-23,  4.7600E-23,  4.4000E-23,  4.1200E-23,  3.8000E-23, &
       3.5600E-23,  3.3600E-23,  3.1200E-23,  2.8800E-23,  2.7600E-23,  2.5200E-23, &
       2.4000E-23,  2.2400E-23,  2.0800E-23,  2.0000E-23,  1.6240E-23,  1.1840E-23, &
       8.5600E-24,  6.2400E-24,  4.5600E-24,  3.3600E-24,  2.4000E-24,  1.6800E-24, &
       1.2800E-24,  9.6000E-25,  6.4000E-25,  4.8000E-25,  3.2000E-25,  3.2000E-25, &
       1.6000E-25 /)
    REAL, PARAMETER :: b2_NO2(dim55) = (/ &
       4.1206E-20,  4.1668E-20,  4.3039E-20,  4.5333E-20,  4.8227E-20,  5.1342E-20, &
       5.4343E-20,  5.7064E-20,  5.9434E-20,  6.1421E-20,  6.3094E-20,  6.4483E-20, &
       6.5654E-20,  6.6631E-20,  6.7469E-20,  6.8168E-20,  6.8800E-20,  6.9316E-20, &
       6.9825E-20,  7.0228E-20,  7.0632E-20,  7.0972E-20,  7.1282E-20,  7.1607E-20, &
       7.1873E-20,  7.2125E-20,  7.2361E-20,  7.2606E-20,  7.2803E-20,  7.3037E-20, &
       7.3218E-20,  7.3374E-20,  7.3567E-20,  7.3767E-20,  7.3869E-20,  7.4080E-20, &
       7.4189E-20,  7.4338E-20,  7.4491E-20,  7.4569E-20,  7.4947E-20,  7.5444E-20, &
       7.5856E-20,  7.6176E-20,  7.6429E-20,  7.6624E-20,  7.6793E-20,  7.6928E-20, &
       7.7008E-20,  7.7077E-20,  7.7149E-20,  7.7187E-20,  7.7227E-20,  7.7227E-20, &
       7.7271E-20 /)
    REAL, PARAMETER :: a3_NO2(dim55) = (/ &
       1.7030E-22,  1.1348E-22,  6.9485E-23,  4.4669E-23,  3.1154E-23,  2.3447E-23, &
       1.8313E-23,  1.5063E-23,  1.2494E-23,  1.0611E-23,  9.4146E-24,  8.0438E-24, &
       7.3592E-24,  6.3334E-24,  5.8189E-24,  5.3064E-24,  4.7921E-24,  4.4482E-24, &
       3.9384E-24,  3.7671E-24,  3.4188E-24,  3.0822E-24,  2.9110E-24,  2.7397E-24, &
       2.5641E-24,  2.2260E-24,  2.2260E-24,  2.0548E-24,  2.0513E-24,  1.7123E-24, &
       1.7123E-24,  1.7123E-24,  1.3675E-24,  1.5411E-24,  1.1986E-24,  1.3675E-24, &
       1.1986E-24,  1.0274E-24,  1.0274E-24,  1.0256E-24,  8.5587E-25,  6.5046E-25, &
       4.7912E-25,  3.7658E-25,  3.0811E-25,  2.3956E-25,  1.7117E-25,  1.3694E-25, &
       1.0267E-25,  6.8470E-26,  6.8470E-26,  6.8446E-26,  3.4235E-26,  3.4235E-26, &
       3.4223E-26 /)
    REAL, PARAMETER :: b3_NO2(dim55) = (/ &
       1.2156E-19,  1.2491E-19,  1.3008E-19,  1.3444E-19,  1.3760E-19,  1.3986E-19, &
       1.4166E-19,  1.4299E-19,  1.4419E-19,  1.4519E-19,  1.4588E-19,  1.4677E-19, &
       1.4725E-19,  1.4803E-19,  1.4845E-19,  1.4890E-19,  1.4938E-19,  1.4972E-19, &
       1.5026E-19,  1.5045E-19,  1.5085E-19,  1.5127E-19,  1.5149E-19,  1.5172E-19, &
       1.5196E-19,  1.5246E-19,  1.5246E-19,  1.5273E-19,  1.5273E-19,  1.5331E-19, &
       1.5331E-19,  1.5331E-19,  1.5395E-19,  1.5362E-19,  1.5430E-19,  1.5395E-19, &
       1.5431E-19,  1.5468E-19,  1.5468E-19,  1.5468E-19,  1.5508E-19,  1.5562E-19, &
       1.5612E-19,  1.5645E-19,  1.5669E-19,  1.5695E-19,  1.5723E-19,  1.5738E-19, &
       1.5754E-19,  1.5771E-19,  1.5771E-19,  1.5771E-19,  1.5791E-19,  1.5791E-19, &
       1.5791E-19 /)
    REAL, PARAMETER :: a4_NO2(4) = (/  1.8460E-19,  8.6476E-24, -1.7451E-27,  1.1999E-31 /)
    REAL, PARAMETER :: a5_NO2(4) = (/  2.8658E-19,  1.3353E-23, -2.0320E-27,  1.2344E-31 /)
    REAL, PARAMETER :: a6_NO2(4) = (/  3.7266E-19, -3.4048E-26,  5.5239E-31, -1.1476E-35 /)
    REAL, PARAMETER :: a7_NO2(4) = (/  8.9420E-24,  5.7463E-28,  1.0427E-32, -1.8664E-37 /)
    ! T-dep parameters:
    REAL, PARAMETER :: c2_NO2(3) = (/  1.0000E+00, -4.8125E-02,  9.7129E-04 /)
    REAL, PARAMETER :: c3_NO2(3) = (/  1.0000E+00,  7.0030E-03, -2.5677E-03 /)
    REAL, PARAMETER :: c4_NO2(3) = (/  1.0000E+00,  6.4010E-02, -5.1729E-03 /)
    REAL, PARAMETER :: c5_NO2(3) = (/  9.9999E-01,  2.0925E-01, -1.2680E-02 /)
    REAL, PARAMETER :: c6_NO2(3) = (/  1.0000E+00,  8.3343E-02,  4.4046E-04 /)
    REAL, PARAMETER :: c7_NO2(3) = (/  1.0000E+00,  5.4563E-02, -1.5145E-05 /)

    jval_2d(ip_NO2)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_NO2(2) = &
          p2(c2_NO2(1),c2_NO2(2),c2_NO2(3),tnorm(j,k))* &
          p1(b2_NO2(i2(j,k)), a2_NO2(i2(j,k)), &
          v3_du1(j,k))
        sig_NO2(3) = &
          p2(c3_NO2(1),c3_NO2(2),c3_NO2(3),tnorm(j,k))* &
          p1(b3_NO2(i3(j,k)), a3_NO2(i3(j,k)), &
          v3_du2(j,k))
        sig_NO2(4) = &
          p2(c4_NO2(1),c4_NO2(2),c4_NO2(3),tnorm(j,k))* &
          p3(a4_NO2(1),a4_NO2(2),a4_NO2(3), &
          a4_NO2(4),v3_du2(j,k))
        sig_NO2(5) = &
          p2(c5_NO2(1),c5_NO2(2),c5_NO2(3),tnorm(j,k))* &
          p3(a5_NO2(1),a5_NO2(2),a5_NO2(3), &
          a5_NO2(4),v3_du2(j,k))
        sig_NO2(6) = &
          p2(c6_NO2(1),c6_NO2(2),c6_NO2(3),tnorm(j,k))* &
          p3(a6_NO2(1),a6_NO2(2),a6_NO2(3), &
          a6_NO2(4),v3_du2(j,k))
        sig_NO2(7) = &
          p2(c7_NO2(1),c7_NO2(2),c7_NO2(3),tnorm(j,k))* &
          p3(a7_NO2(1),a7_NO2(2),a7_NO2(3), &
          a7_NO2(4),v3_du2(j,k))
        dj = 0. &
          + sig_NO2(2) * fint(j,k,2) &
          + sig_NO2(3) * fint(j,k,3) &
          + sig_NO2(4) * fint(j,k,4) &
          + sig_NO2(5) * fint(j,k,5) &
          + sig_NO2(6) * fint(j,k,6) &
          + sig_NO2(7) * fint(j,k,7)

        jval_2d(ip_NO2)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,1)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_NO2

  ! **************************************************************************

  SUBROUTINE jval_cal_NO2O

    ! NO_3 \TOHV\ NO_2 + O

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_NO2O

    ! T-const parameters:
    REAL, PARAMETER :: a6_NO2O(4) = (/  1.9022E-20,  4.5382E-26, -5.3828E-31,  4.5558E-36 /)
    REAL, PARAMETER :: a7_NO2O(4) = (/  1.5056E-18, -3.5908E-23,  1.4120E-28,  1.2681E-32 /)
    ! T-dep parameters:
    REAL, PARAMETER :: c6_NO2O(3) = (/  1.0001E+00, -7.4239E-01, -1.4027E-01 /)
    REAL, PARAMETER :: c7_NO2O(3) = (/  1.0001E+00, -7.4069E-01, -1.4124E-01 /)

    jval_2d(ip_NO2O)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_NO2O(6) = &
          p2(c6_NO2O(1),c6_NO2O(2),c6_NO2O(3),tnorm(j,k))* &
          p3(a6_NO2O(1),a6_NO2O(2),a6_NO2O(3), &
          a6_NO2O(4),v3_du2(j,k))
        sig_NO2O(7) = &
          p2(c7_NO2O(1),c7_NO2O(2),c7_NO2O(3),tnorm(j,k))* &
          p3(a7_NO2O(1),a7_NO2O(2),a7_NO2O(3), &
          a7_NO2O(4),v3_du2(j,k))
        dj = 0. &
          + sig_NO2O(6) * fint(j,k,6) &
          + sig_NO2O(7) * fint(j,k,7)

        jval_2d(ip_NO2O)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,1)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_NO2O

  ! **************************************************************************

  SUBROUTINE jval_cal_NOO2

    ! NO_3 \TOHV\ NO + O_2

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_NOO2

    ! T-const parameters:
    REAL, PARAMETER :: a7_NOO2(4) = (/  1.8969E-19, -1.0317E-23,  1.2680E-28,  2.5158E-33 /)
    ! T-dep parameters:
    REAL, PARAMETER :: c7_NOO2(3) = (/  1.0001E+00, -7.4073E-01, -1.4134E-01 /)

    jval_2d(ip_NOO2)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_NOO2(7) = &
          p2(c7_NOO2(1),c7_NOO2(2),c7_NOO2(3),tnorm(j,k))* &
          p3(a7_NOO2(1),a7_NOO2(2),a7_NOO2(3), &
          a7_NOO2(4),v3_du2(j,k))
        dj = 0. &
          + sig_NOO2(7) * fint(j,k,7)

        jval_2d(ip_NOO2)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,1)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_NOO2

  ! **************************************************************************

  SUBROUTINE jval_cal_N2O5

    ! N_2O_5 \TOHV\ NO_2 + NO_3

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_N2O5

    ! T-const parameters:
    REAL, PARAMETER :: a0_1_1_N2O5(dim58) = (/ &
       3.6366E-20,  3.9863E-20,  4.3435E-20,  4.7344E-20,  5.1374E-20,  5.5610E-20, &
       6.0046E-20,  6.4679E-20,  6.9522E-20,  7.4578E-20,  7.9992E-20,  8.5538E-20, &
       1.0374E-19,  1.4789E-19,  1.4392E-19,  1.5220E-19,  1.7450E-19,  1.6901E-19, &
       1.7681E-19,  1.9926E-19,  1.9057E-19,  1.9592E-19,  2.1713E-19,  2.0383E-19, &
       2.0586E-19,  1.7214E-19,  1.5688E-19,  1.6071E-19,  1.6652E-19,  1.7469E-19, &
       1.8544E-19,  1.9876E-19,  2.1452E-19,  2.3215E-19,  2.5152E-19,  2.7131E-19, &
       2.9189E-19,  3.1243E-19,  3.3300E-19,  3.5363E-19,  3.7438E-19,  3.9505E-19, &
       4.1553E-19,  4.3508E-19,  4.5242E-19,  4.6657E-19,  4.7574E-19,  4.7991E-19, &
       4.7830E-19,  4.7147E-19,  4.6028E-19,  4.4522E-19,  4.2734E-19,  4.0671E-19, &
       3.8313E-19,  3.5348E-19,  3.0799E-19,  2.5278E-19 /)
    REAL, PARAMETER :: a0_1_2_N2O5(dim58) = (/ &
       2.7339E-20, -1.2721E-19, -2.8578E-19, -4.6016E-19, -6.4069E-19, -8.3133E-19, &
      -1.0318E-18, -1.2422E-18, -1.4630E-18, -1.6946E-18, -1.9436E-18, -2.1998E-18, &
      -3.0442E-18, -5.1019E-18, -4.9160E-18, -5.3049E-18, -6.3575E-18, -6.0973E-18, &
      -6.4690E-18, -7.5420E-18, -7.1246E-18, -7.3826E-18, -8.4090E-18, -7.7630E-18, &
      -7.8621E-18, -6.2094E-18, -5.4587E-18, -5.6479E-18, -5.9361E-18, -6.3429E-18, &
      -6.8808E-18, -7.5493E-18, -8.3436E-18, -9.2357E-18, -1.0220E-17, -1.1229E-17, &
      -1.2283E-17, -1.3338E-17, -1.4400E-17, -1.5468E-17, -1.6548E-17, -1.7626E-17, &
      -1.8700E-17, -1.9728E-17, -2.0643E-17, -2.1393E-17, -2.1881E-17, -2.2104E-17, &
      -2.2018E-17, -2.1650E-17, -2.1046E-17, -2.0229E-17, -1.9257E-17, -1.8131E-17, &
      -1.6838E-17, -1.5208E-17, -1.2697E-17, -9.6381E-18 /)
    REAL, PARAMETER :: a0_2_1_N2O5(dim58) = (/ &
       1.8765E-22,  2.0754E-22,  2.2868E-22,  2.5168E-22,  2.7679E-22,  3.0361E-22, &
       3.3202E-22,  3.6355E-22,  3.9731E-22,  4.3461E-22,  4.7425E-22,  5.1905E-22, &
       3.8536E-22, -1.0929E-22,  1.2217E-22,  1.7931E-22,  6.2098E-23,  3.1168E-22, &
       3.8705E-22,  2.8907E-22,  5.5781E-22,  6.5064E-22,  5.6759E-22,  8.4675E-22, &
       9.4688E-22,  1.3893E-21,  1.6240E-21,  1.6506E-21,  1.6401E-21,  1.5872E-21, &
       1.4885E-21,  1.3448E-21,  1.1607E-21,  9.4587E-22,  7.1424E-22,  4.8143E-22, &
       2.6130E-22,  6.6526E-23, -9.5557E-23, -2.2054E-22, -3.0963E-22, -3.6671E-22, &
      -3.9946E-22, -4.1558E-22, -4.2011E-22, -4.1729E-22, -4.0714E-22, -3.9201E-22, &
      -3.7271E-22, -3.5108E-22, -3.2853E-22, -3.0497E-22, -2.8111E-22, -2.5419E-22, &
      -2.2496E-22, -1.9385E-22, -1.6153E-22, -1.3695E-22 /)
    REAL, PARAMETER :: a0_2_2_N2O5(dim58) = (/ &
      -1.0820E-20, -1.1700E-20, -1.2638E-20, -1.3664E-20, -1.4789E-20, -1.5996E-20, &
      -1.7280E-20, -1.8711E-20, -2.0251E-20, -2.1959E-20, -2.3783E-20, -2.5852E-20, &
      -1.9649E-20,  3.4016E-21, -7.4307E-21, -1.0116E-20, -4.5838E-21, -1.6414E-20, &
      -2.0002E-20, -1.5318E-20, -2.8218E-20, -3.2692E-20, -2.8673E-20, -4.2239E-20, &
      -4.7126E-20, -6.8804E-20, -8.0353E-20, -8.1665E-20, -8.1147E-20, -7.8511E-20, &
      -7.3574E-20, -6.6364E-20, -5.7085E-20, -4.6213E-20, -3.4446E-20, -2.2573E-20, &
      -1.1302E-20, -1.2906E-21,  7.0729E-21,  1.3547E-20,  1.8180E-20,  2.1159E-20, &
       2.2875E-20,  2.3723E-20,  2.3962E-20,  2.3813E-20,  2.3273E-20,  2.2465E-20, &
       2.1431E-20,  2.0267E-20,  1.9049E-20,  1.7772E-20,  1.6474E-20,  1.5004E-20, &
       1.3402E-20,  1.1692E-20,  9.9073E-21,  8.5456E-21 /)
    REAL, PARAMETER :: a1_1_N2O5(dim55) = (/ &
       7.4683E-20,  7.3151E-20,  7.3559E-20,  6.9106E-20,  6.6962E-20,  6.1628E-20, &
       5.8540E-20,  5.3638E-20,  5.0620E-20,  4.6580E-20,  4.3963E-20,  4.0799E-20, &
       3.8591E-20,  3.6129E-20,  3.4306E-20,  3.2372E-20,  3.0812E-20,  2.9302E-20, &
       2.7957E-20,  2.6744E-20,  2.5548E-20,  2.4593E-20,  2.3518E-20,  2.2753E-20, &
       2.1778E-20,  2.1152E-20,  2.0272E-20,  1.9778E-20,  1.8960E-20,  1.8561E-20, &
       1.7806E-20,  1.7510E-20,  1.6797E-20,  1.6553E-20,  1.5874E-20,  1.5721E-20, &
       1.5081E-20,  1.4953E-20,  1.4348E-20,  1.4267E-20,  1.3224E-20,  1.2004E-20, &
       1.0916E-20,  1.0104E-20,  9.3043E-21,  8.7210E-21,  8.0848E-21,  7.6443E-21, &
       6.9308E-21,  6.4755E-21,  6.0538E-21,  5.6647E-21,  5.3023E-21,  4.9690E-21, &
       4.6556E-21 /)
    REAL, PARAMETER :: b1_1_N2O5(dim55) = (/ &
       1.7404E-18,  1.7450E-18,  1.7427E-18,  1.7784E-18,  1.8009E-18,  1.8702E-18, &
       1.9181E-18,  2.0063E-18,  2.0682E-18,  2.1611E-18,  2.2279E-18,  2.3165E-18, &
       2.3838E-18,  2.4650E-18,  2.5297E-18,  2.6032E-18,  2.6664E-18,  2.7314E-18, &
       2.7925E-18,  2.8508E-18,  2.9112E-18,  2.9618E-18,  3.0215E-18,  3.0658E-18, &
       3.1248E-18,  3.1642E-18,  3.2219E-18,  3.2555E-18,  3.3131E-18,  3.3422E-18, &
       3.3993E-18,  3.4224E-18,  3.4798E-18,  3.5000E-18,  3.5581E-18,  3.5715E-18, &
       3.6294E-18,  3.6414E-18,  3.6991E-18,  3.7070E-18,  3.8119E-18,  3.9498E-18, &
       4.0863E-18,  4.1984E-18,  4.3187E-18,  4.4138E-18,  4.5254E-18,  4.6082E-18, &
       4.7513E-18,  4.8483E-18,  4.9434E-18,  5.0360E-18,  5.1268E-18,  5.2144E-18, &
       5.3007E-18 /)
    REAL, PARAMETER :: a1_2_N2O5(dim55) = (/ &
      -2.1489E-22, -1.2574E-22, -1.2847E-22, -4.8879E-23, -4.8294E-23,  7.2506E-24, &
       5.3846E-24,  3.8325E-23,  3.3336E-23,  5.0798E-23,  4.5000E-23,  5.3090E-23, &
       4.7988E-23,  5.1091E-23,  4.6824E-23,  4.7421E-23,  4.4529E-23,  4.3199E-23, &
       4.1544E-23,  3.9415E-23,  3.8671E-23,  3.5861E-23,  3.5813E-23,  3.2719E-23, &
       3.3202E-23,  2.9990E-23,  3.0806E-23,  2.7421E-23,  2.8517E-23,  2.5230E-23, &
       2.6517E-23,  2.3162E-23,  2.4594E-23,  2.1422E-23,  2.3031E-23,  1.9693E-23, &
       2.1380E-23,  1.8293E-23,  2.0035E-23,  1.6999E-23,  1.6685E-23,  1.3857E-23, &
       1.2455E-23,  1.0584E-23,  9.8840E-24,  8.5496E-24,  8.2580E-24,  7.2224E-24, &
       8.1697E-24,  7.8839E-24,  7.6480E-24,  7.4415E-24,  7.2482E-24,  7.0588E-24, &
       6.8820E-24 /)
    REAL, PARAMETER :: b1_2_N2O5(dim55) = (/ &
      -5.0237E-21, -5.2912E-21, -5.2762E-21, -5.9129E-21, -5.9191E-21, -6.6411E-21, &
      -6.6122E-21, -7.2051E-21, -7.1029E-21, -7.5045E-21, -7.3566E-21, -7.5832E-21, &
      -7.4276E-21, -7.5299E-21, -7.3785E-21, -7.4011E-21, -7.2840E-21, -7.2268E-21, &
      -7.1515E-21, -7.0493E-21, -7.0118E-21, -6.8628E-21, -6.8602E-21, -6.6807E-21, &
      -6.7099E-21, -6.5076E-21, -6.5611E-21, -6.3309E-21, -6.4081E-21, -6.1682E-21, &
      -6.2653E-21, -6.0037E-21, -6.1189E-21, -5.8557E-21, -5.9932E-21, -5.6995E-21, &
      -5.8522E-21, -5.5651E-21, -5.7315E-21, -5.4339E-21, -5.4024E-21, -5.0828E-21, &
      -4.9068E-21, -4.6486E-21, -4.5433E-21, -4.3258E-21, -4.2746E-21, -4.0799E-21, &
      -4.2698E-21, -4.2090E-21, -4.1558E-21, -4.1066E-21, -4.0582E-21, -4.0084E-21, &
      -3.9597E-21 /)
    REAL, PARAMETER :: a2_N2O5(dim55) = (/ &
      -6.9440E-21, -6.0160E-21, -4.8944E-21, -3.7916E-21, -2.8344E-21, -2.0732E-21, &
      -1.5028E-21, -1.0912E-21, -8.0000E-22, -5.9560E-22, -4.5280E-22, -3.5200E-22, &
      -2.7960E-22, -2.2760E-22, -1.8880E-22, -1.5960E-22, -1.3720E-22, -1.1920E-22, &
      -1.0560E-22, -9.3600E-23, -8.4000E-23, -7.6000E-23, -6.9200E-23, -6.3200E-23, &
      -5.7600E-23, -5.3200E-23, -4.9200E-23, -4.5200E-23, -4.2000E-23, -3.9200E-23, &
      -3.6000E-23, -3.4000E-23, -3.1600E-23, -2.9200E-23, -2.7200E-23, -2.5600E-23, &
      -2.4000E-23, -2.2400E-23, -2.1200E-23, -1.9600E-23, -1.6160E-23, -1.1680E-23, &
      -8.5600E-24, -6.1600E-24, -4.4800E-24, -3.2000E-24, -2.4000E-24, -1.6800E-24, &
      -1.2800E-24, -8.8000E-25, -6.4000E-25, -4.8000E-25, -3.2000E-25, -3.2000E-25, &
      -1.6000E-25 /)
    REAL, PARAMETER :: b2_N2O5(dim55) = (/ &
       1.4767E-19,  1.4489E-19,  1.3872E-19,  1.2990E-19,  1.1985E-19,  1.0995E-19, &
       1.0111E-19,  9.3701E-20,  8.7731E-20,  8.3030E-20,  7.9388E-20,  7.6566E-20, &
       7.4358E-20,  7.2642E-20,  7.1264E-20,  7.0155E-20,  6.9248E-20,  6.8474E-20, &
       6.7855E-20,  6.7279E-20,  6.6794E-20,  6.6370E-20,  6.5993E-20,  6.5645E-20, &
       6.5306E-20,  6.5029E-20,  6.4767E-20,  6.4495E-20,  6.4269E-20,  6.4065E-20, &
       6.3823E-20,  6.3667E-20,  6.3474E-20,  6.3275E-20,  6.3104E-20,  6.2963E-20, &
       6.2818E-20,  6.2669E-20,  6.2555E-20,  6.2398E-20,  6.2052E-20,  6.1546E-20, &
       6.1154E-20,  6.0823E-20,  6.0570E-20,  6.0362E-20,  6.0221E-20,  6.0086E-20, &
       6.0006E-20,  5.9920E-20,  5.9866E-20,  5.9828E-20,  5.9788E-20,  5.9788E-20, &
       5.9744E-20 /)
    REAL, PARAMETER :: a3_N2O5(dim55) = (/ &
      -7.7190E-23, -4.8525E-23, -2.7520E-23, -1.6413E-23, -1.0698E-23, -7.5646E-24, &
      -5.6649E-24, -4.4334E-24, -3.6112E-24, -2.9779E-24, -2.5334E-24, -2.1907E-24, &
      -1.9168E-24, -1.6775E-24, -1.5061E-24, -1.3523E-24, -1.1980E-24, -1.1121E-24, &
      -9.9315E-25, -9.2466E-25, -8.3761E-25, -7.7055E-25, -7.1918E-25, -6.6781E-25, &
      -6.1538E-25, -5.8219E-25, -5.3082E-25, -4.9658E-25, -4.6154E-25, -4.4521E-25, &
      -4.1096E-25, -3.7671E-25, -3.5897E-25, -3.4247E-25, -3.0822E-25, -3.0769E-25, &
      -2.7397E-25, -2.7397E-25, -2.5685E-25, -2.2222E-25, -2.0199E-25, -1.5063E-25, &
      -1.1636E-25, -8.9011E-26, -6.8470E-26, -5.4757E-26, -4.1082E-26, -3.0811E-26, &
      -2.3956E-26, -2.0541E-26, -1.3694E-26, -1.3689E-26, -1.0270E-26, -6.8470E-27, &
      -6.8446E-27 /)
    REAL, PARAMETER :: b3_N2O5(dim55) = (/ &
       3.4829E-20,  3.3139E-20,  3.0674E-20,  2.8722E-20,  2.7384E-20,  2.6467E-20, &
       2.5800E-20,  2.5295E-20,  2.4911E-20,  2.4577E-20,  2.4317E-20,  2.4097E-20, &
       2.3905E-20,  2.3723E-20,  2.3583E-20,  2.3448E-20,  2.3304E-20,  2.3218E-20, &
       2.3093E-20,  2.3017E-20,  2.2915E-20,  2.2833E-20,  2.2767E-20,  2.2698E-20, &
       2.2624E-20,  2.2576E-20,  2.2498E-20,  2.2444E-20,  2.2386E-20,  2.2359E-20, &
       2.2299E-20,  2.2236E-20,  2.2203E-20,  2.2171E-20,  2.2103E-20,  2.2102E-20, &
       2.2031E-20,  2.2031E-20,  2.1993E-20,  2.1914E-20,  2.1867E-20,  2.1732E-20, &
       2.1632E-20,  2.1544E-20,  2.1472E-20,  2.1420E-20,  2.1364E-20,  2.1319E-20, &
       2.1287E-20,  2.1270E-20,  2.1234E-20,  2.1234E-20,  2.1214E-20,  2.1193E-20, &
       2.1193E-20 /)
    REAL, PARAMETER :: a4_N2O5(4) = (/  1.5396E-20, -1.6976E-24,  3.4805E-28, -2.4133E-32 /)
    REAL, PARAMETER :: a5_N2O5(4) = (/  5.1929E-21, -8.5083E-25,  1.4162E-28, -8.8542E-33 /)
    REAL, PARAMETER :: a6_N2O5(4) = (/  2.5147E-22, -3.1326E-27,  3.6298E-32, -2.5499E-37 /)
    ! T-dep parameters:
    REAL, PARAMETER :: c0_1_1_N2O5(dim58) = (/ &
       2.7430E-02,  2.7430E-02,  2.7430E-02,  3.1718E-02,  3.5847E-02,  3.9407E-02, &
       4.3102E-02,  4.4869E-02,  4.7377E-02,  4.8320E-02,  4.8852E-02,  4.7590E-02, &
       4.6747E-02,  4.5920E-02,  4.3364E-02,  4.3495E-02,  4.2753E-02,  4.2510E-02, &
       4.2933E-02,  4.4117E-02,  4.4498E-02,  4.3485E-02,  4.2795E-02,  3.9507E-02, &
       3.4767E-02,  2.9084E-02,  2.2356E-02,  1.5530E-02,  1.0654E-02,  8.5402E-03, &
       9.4369E-03,  1.6094E-02,  2.8072E-02,  4.4344E-02,  6.5595E-02,  8.9087E-02, &
       1.1323E-01,  1.3499E-01,  1.5342E-01,  1.6443E-01,  1.6766E-01,  1.6133E-01, &
       1.4599E-01,  1.2353E-01,  9.7003E-02,  7.0463E-02,  4.5148E-02,  2.3032E-02, &
       1.3992E-03, -2.4296E-02, -5.9310E-02, -1.0906E-01, -1.7508E-01, -2.5279E-01, &
      -3.3411E-01, -4.1404E-01, -5.1092E-01, -6.2771E-01 /)
    REAL, PARAMETER :: c0_1_2_N2O5(dim58) = (/ &
      -1.1802E+00, -1.1802E+00, -1.1802E+00, -1.3715E+00, -1.5564E+00, -1.7166E+00, &
      -1.8837E+00, -1.9639E+00, -2.0782E+00, -2.1215E+00, -2.1459E+00, -2.0876E+00, &
      -2.0485E+00, -2.0100E+00, -1.8903E+00, -1.8965E+00, -1.8615E+00, -1.8500E+00, &
      -1.8701E+00, -1.9267E+00, -1.9450E+00, -1.8961E+00, -1.8627E+00, -1.7029E+00, &
      -1.4716E+00, -1.1932E+00, -8.6215E-01, -5.2495E-01, -2.8311E-01, -1.7783E-01, &
      -2.2266E-01, -5.5683E-01, -1.1605E+00, -1.9839E+00, -3.0635E+00, -4.2616E+00, &
      -5.4974E+00, -6.6159E+00, -7.5674E+00, -8.1377E+00, -8.3052E+00, -7.9750E+00, &
      -7.1709E+00, -5.9900E+00, -4.5891E+00, -3.1825E+00, -1.8357E+00, -6.5477E-01, &
       5.0476E-01,  1.8872E+00,  3.7779E+00,  6.4744E+00,  1.0066E+01,  1.4309E+01, &
       1.8765E+01,  2.3161E+01,  2.8509E+01,  3.4979E+01 /)
    REAL, PARAMETER :: c0_2_1_N2O5(dim58) = (/ &
       1.3105E-02,  1.3105E-02,  1.3105E-02,  7.3720E-03,  1.4352E-02,  1.8309E-02, &
       1.7217E-02,  1.6327E-02,  1.5416E-02,  2.0637E-02,  7.6057E-03,  5.6247E-03, &
       8.0257E-03,  2.9260E-03, -6.0147E-04, -7.6989E-03, -6.3521E-03, -1.3496E-02, &
      -1.1049E-02, -1.2995E-02, -1.2433E-02, -1.6801E-02, -1.3915E-02, -8.6496E-03, &
      -1.2947E-02, -1.1361E-02, -4.4243E-03,  3.6286E-03,  1.4076E-02,  2.5029E-02, &
       4.0295E-02,  4.8099E-02,  6.3529E-02,  7.5627E-02,  8.8280E-02,  9.7457E-02, &
       1.1218E-01,  1.1430E-01,  1.1754E-01,  1.0744E-01,  9.0717E-02,  6.8488E-02, &
       4.0431E-02,  2.2146E-02,  2.2935E-03, -1.0608E-02, -2.8788E-02, -4.9250E-02, &
      -6.8686E-02, -8.0533E-02, -8.0881E-02, -6.4398E-02, -1.6323E-02,  4.3807E-02, &
       9.2390E-02,  1.0022E-01,  4.7499E-02, -3.0538E-02 /)
    REAL, PARAMETER :: c0_2_2_N2O5(dim58) = (/ &
      -5.7271E-01, -5.7271E-01, -5.7271E-01, -3.1700E-01, -6.2971E-01, -8.0776E-01, &
      -7.5840E-01, -7.1801E-01, -6.7648E-01, -9.1557E-01, -3.1614E-01, -2.2463E-01, &
      -3.3603E-01, -9.8385E-02,  6.6701E-02,  4.0028E-01,  3.3671E-01,  6.7532E-01, &
       5.5886E-01,  6.5189E-01,  6.2488E-01,  8.3545E-01,  6.9574E-01,  4.3985E-01, &
       6.4958E-01,  5.7187E-01,  2.3057E-01, -1.6725E-01, -6.8546E-01, -1.2309E+00, &
      -1.9942E+00, -2.3860E+00, -3.1636E+00, -3.7758E+00, -4.4186E+00, -4.8866E+00, &
      -5.6403E+00, -5.7495E+00, -5.9164E+00, -5.3932E+00, -4.5238E+00, -3.3634E+00, &
      -1.8932E+00, -9.3145E-01,  1.1676E-01,  8.0056E-01,  1.7677E+00,  2.8604E+00, &
       3.9022E+00,  4.5395E+00,  4.5583E+00,  3.6649E+00,  1.0497E+00, -2.2334E+00, &
      -4.8958E+00, -5.3264E+00, -2.4162E+00,  1.9070E+00 /)
    REAL, PARAMETER :: c1_N2O5(3) = (/  1.0000E+00,  8.7734E-03, -2.0897E-04 /)
    REAL, PARAMETER :: c2_N2O5(3) = (/  9.9988E-01,  1.1592E+00, -4.6500E-01 /)
    REAL, PARAMETER :: c3_N2O5(3) = (/  9.9960E-01,  1.7590E+00, -1.4037E-01 /)
    REAL, PARAMETER :: c4_N2O5(3) = (/  9.9957E-01,  2.1054E+00,  2.2476E-01 /)
    REAL, PARAMETER :: c5_N2O5(3) = (/  1.0001E+00,  3.1691E+00,  2.1353E+00 /)
    REAL, PARAMETER :: c6_N2O5(3) = (/  1.0008E+00,  6.0717E+00,  1.1606E+01 /)

    jval_2d(ip_N2O5)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_N2O5(0) = &
          p2(1.,c0_1_1_N2O5(i0(j,k))*dlv2(j,k) + &
          c0_1_2_N2O5(i0(j,k)), &
          c0_2_1_N2O5(i0(j,k))*dlv2(j,k) + &
          c0_2_2_N2O5(i0(j,k)), tnorm_sr(j,k)) * &
          p1(a0_1_1_N2O5(i0(j,k))*dlv2(j,k) + &
          a0_1_2_N2O5(i0(j,k)), &
          a0_2_1_N2O5(i0(j,k))*dlv2(j,k) + &
          a0_2_2_N2O5(i0(j,k)),v3_du1(j,k))
        sig_N2O5(1) = &
          p2(c1_N2O5(1),c1_N2O5(2), &
          c1_N2O5(3),tnorm(j,k)) * &
          (p1(b1_1_N2O5(i1(j,k)),a1_1_N2O5(i1(j,k)), &
          v3_du1(j,k)) + &
          p1(b1_2_N2O5(i1(j,k)),a1_2_N2O5(i1(j,k)), &
          v3_du1(j,k)) * v2s_m(j,k))
        sig_N2O5(2) = &
          p2(c2_N2O5(1),c2_N2O5(2),c2_N2O5(3),tnorm(j,k))* &
          p1(b2_N2O5(i2(j,k)), a2_N2O5(i2(j,k)), &
          v3_du1(j,k))
        sig_N2O5(3) = &
          p2(c3_N2O5(1),c3_N2O5(2),c3_N2O5(3),tnorm(j,k))* &
          p1(b3_N2O5(i3(j,k)), a3_N2O5(i3(j,k)), &
          v3_du2(j,k))
        sig_N2O5(4) = &
          p2(c4_N2O5(1),c4_N2O5(2),c4_N2O5(3),tnorm(j,k))* &
          p3(a4_N2O5(1),a4_N2O5(2),a4_N2O5(3), &
          a4_N2O5(4),v3_du2(j,k))
        sig_N2O5(5) = &
          p2(c5_N2O5(1),c5_N2O5(2),c5_N2O5(3),tnorm(j,k))* &
          p3(a5_N2O5(1),a5_N2O5(2),a5_N2O5(3), &
          a5_N2O5(4),v3_du2(j,k))
        sig_N2O5(6) = &
          p2(c6_N2O5(1),c6_N2O5(2),c6_N2O5(3),tnorm(j,k))* &
          p3(a6_N2O5(1),a6_N2O5(2),a6_N2O5(3), &
          a6_N2O5(4),v3_du2(j,k))
        dj = 0. &
          + sig_N2O5(0) * fint(j,k,0) &
          + sig_N2O5(1) * fint(j,k,1) &
          + sig_N2O5(2) * fint(j,k,2) &
          + sig_N2O5(3) * fint(j,k,3) &
          + sig_N2O5(4) * fint(j,k,4) &
          + sig_N2O5(5) * fint(j,k,5) &
          + sig_N2O5(6) * fint(j,k,6)

        jval_2d(ip_N2O5)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,4)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_N2O5

  ! **************************************************************************

  SUBROUTINE jval_cal_HNO3

    ! HNO_3 \TOHV\ \products

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_HNO3

    ! T-const parameters:
    REAL, PARAMETER :: a0_1_1_HNO3(dim58) = (/ &
       1.0380E-19,  1.1254E-19,  1.2155E-19,  1.3068E-19,  1.3980E-19,  1.4882E-19, &
       1.5754E-19,  1.6587E-19,  1.7371E-19,  1.8110E-19,  1.8777E-19,  1.9386E-19, &
       2.2232E-19,  2.9922E-19,  2.8350E-19,  2.8996E-19,  3.2093E-19,  2.9950E-19, &
       3.0117E-19,  3.2876E-19,  2.9790E-19,  2.9124E-19,  3.1187E-19,  2.6789E-19, &
       2.5021E-19,  1.6623E-19,  1.1375E-19,  9.4268E-20,  7.7378E-20,  6.4046E-20, &
       5.4898E-20,  4.9806E-20,  4.8900E-20,  5.1216E-20,  5.5521E-20,  6.0240E-20, &
       6.3900E-20,  6.5096E-20,  6.2646E-20,  5.5523E-20,  4.2812E-20,  2.4328E-20, &
      -3.6812E-22, -3.0950E-20, -6.5970E-20, -1.0363E-19, -1.4071E-19, -1.7418E-19, &
      -2.0147E-19, -2.2112E-19, -2.3324E-19, -2.3824E-19, -2.3645E-19, -2.2785E-19, &
      -2.1245E-19, -1.9006E-19, -1.6092E-19, -1.3355E-19 /)
    REAL, PARAMETER :: a0_1_2_HNO3(dim58) = (/ &
       2.7955E-19, -1.0657E-19, -5.0688E-19, -9.1404E-19, -1.3225E-18, -1.7283E-18, &
      -2.1225E-18, -2.5006E-18, -2.8584E-18, -3.1966E-18, -3.5037E-18, -3.7850E-18, &
      -5.1055E-18, -8.6888E-18, -7.9535E-18, -8.2569E-18, -9.7185E-18, -8.7030E-18, &
      -8.7825E-18, -1.0101E-17, -8.6201E-18, -8.2988E-18, -9.2973E-18, -7.1599E-18, &
      -6.2972E-18, -2.1823E-18,  3.9987E-19,  1.3623E-18,  2.2000E-18,  2.8640E-18, &
       3.3213E-18,  3.5770E-18,  3.6226E-18,  3.5054E-18,  3.2867E-18,  3.0461E-18, &
       2.8587E-18,  2.7972E-18,  2.9236E-18,  3.2926E-18,  3.9536E-18,  4.9184E-18, &
       6.2125E-18,  7.8211E-18,  9.6702E-18,  1.1666E-17,  1.3639E-17,  1.5426E-17, &
       1.6889E-17,  1.7946E-17,  1.8600E-17,  1.8871E-17,  1.8774E-17,  1.8305E-17, &
       1.7461E-17,  1.6229E-17,  1.4621E-17,  1.3105E-17 /)
    REAL, PARAMETER :: a0_2_1_HNO3(dim58) = (/ &
       3.7785E-22,  4.2013E-22,  4.6749E-22,  5.1905E-22,  5.7687E-22,  6.3982E-22, &
       7.0968E-22,  7.8591E-22,  8.7056E-22,  9.6353E-22,  1.0659E-21,  1.1795E-21, &
       9.5827E-22,  4.9710E-23,  5.2156E-22,  6.6119E-22,  4.8014E-22,  9.7514E-22, &
       1.1484E-21,  9.9912E-22,  1.5169E-21,  1.7098E-21,  1.5776E-21,  2.0970E-21, &
       2.2829E-21,  3.0775E-21,  3.4895E-21,  3.5147E-21,  3.4595E-21,  3.3164E-21, &
       3.0808E-21,  2.7604E-21,  2.3667E-21,  1.9234E-21,  1.4615E-21,  1.0107E-21, &
       6.0127E-22,  2.5353E-22, -1.8372E-23, -2.0912E-22, -3.2139E-22, -3.6654E-22, &
      -3.5890E-22, -3.1333E-22, -2.4578E-22, -1.6554E-22, -8.1586E-23, -2.9434E-24, &
       6.5815E-23,  1.1975E-22,  1.5931E-22,  1.8433E-22,  1.9592E-22,  1.9395E-22, &
       1.8030E-22,  1.5546E-22,  1.2557E-22,  1.0216E-22 /)
    REAL, PARAMETER :: a0_2_2_HNO3(dim58) = (/ &
      -2.7619E-20, -2.9488E-20, -3.1591E-20, -3.3890E-20, -3.6481E-20, -3.9313E-20, &
      -4.2471E-20, -4.5932E-20, -4.9792E-20, -5.4050E-20, -5.8761E-20, -6.4009E-20, &
      -5.3742E-20, -1.1403E-20, -3.3486E-20, -4.0048E-20, -3.1503E-20, -5.4966E-20, &
      -6.3214E-20, -5.6077E-20, -8.0930E-20, -9.0230E-20, -8.3830E-20, -1.0907E-19, &
      -1.1814E-19, -1.5708E-19, -1.7735E-19, -1.7859E-19, -1.7586E-19, -1.6873E-19, &
      -1.5695E-19, -1.4087E-19, -1.2102E-19, -9.8593E-20, -7.5128E-20, -5.2139E-20, &
      -3.1175E-20, -1.3302E-20,  7.2855E-22,  1.0609E-20,  1.6448E-20,  1.8804E-20, &
       1.8404E-20,  1.6007E-20,  1.2440E-20,  8.1874E-21,  3.7211E-21, -4.7838E-22, &
      -4.1638E-21, -7.0657E-21, -9.2020E-21, -1.0558E-20, -1.1189E-20, -1.1081E-20, &
      -1.0333E-20, -8.9665E-21, -7.3165E-21, -6.0198E-21 /)
    REAL, PARAMETER :: a1_1_HNO3(dim55) = (/ &
       1.7751E-20,  1.7805E-20,  1.8748E-20,  1.8001E-20,  1.8307E-20,  1.7158E-20, &
       1.7142E-20,  1.5922E-20,  1.5802E-20,  1.4670E-20,  1.4550E-20,  1.3554E-20, &
       1.3466E-20,  1.2596E-20,  1.2542E-20,  1.1781E-20,  1.1753E-20,  1.1081E-20, &
       1.1074E-20,  1.0472E-20,  1.0476E-20,  9.9453E-21,  9.9594E-21,  9.4518E-21, &
       9.5042E-21,  9.0315E-21,  9.0707E-21,  8.6775E-21,  8.6982E-21,  8.3144E-21, &
       8.3649E-21,  8.0041E-21,  8.0533E-21,  7.7263E-21,  7.7644E-21,  7.4809E-21, &
       7.4992E-21,  7.2329E-21,  7.2675E-21,  7.0087E-21,  6.7937E-21,  6.3231E-21, &
       5.9578E-21,  5.6077E-21,  5.3165E-21,  5.0391E-21,  4.7923E-21,  4.5657E-21, &
       4.3166E-21,  4.0863E-21,  3.8695E-21,  3.6663E-21,  3.4738E-21,  3.2920E-21, &
       3.1218E-21 /)
    REAL, PARAMETER :: b1_1_HNO3(dim55) = (/ &
       2.4566E-19,  2.4549E-19,  2.4031E-19,  2.4628E-19,  2.4307E-19,  2.5801E-19, &
       2.5826E-19,  2.8022E-19,  2.8268E-19,  3.0872E-19,  3.1177E-19,  3.3966E-19, &
       3.4234E-19,  3.7105E-19,  3.7296E-19,  4.0188E-19,  4.0302E-19,  4.3192E-19, &
       4.3223E-19,  4.6113E-19,  4.6093E-19,  4.8905E-19,  4.8827E-19,  5.1772E-19, &
       5.1454E-19,  5.4433E-19,  5.4176E-19,  5.6849E-19,  5.6703E-19,  5.9505E-19, &
       5.9124E-19,  6.1938E-19,  6.1543E-19,  6.4256E-19,  6.3930E-19,  6.6425E-19, &
       6.6260E-19,  6.8737E-19,  6.8406E-19,  7.0942E-19,  7.3103E-19,  7.8420E-19, &
       8.3005E-19,  8.7837E-19,  9.2219E-19,  9.6741E-19,  1.0107E-18,  1.0533E-18, &
       1.1033E-18,  1.1523E-18,  1.2012E-18,  1.2496E-18,  1.2978E-18,  1.3456E-18, &
       1.3925E-18 /)
    REAL, PARAMETER :: a1_2_HNO3(dim55) = (/ &
      -7.1644E-23, -4.8302E-23, -5.6469E-23, -3.2113E-23, -3.8647E-23, -1.7548E-23, &
      -2.4018E-23, -7.4729E-24, -1.4055E-23, -1.4175E-24, -7.8329E-24,  1.9337E-24, &
      -4.0547E-24,  3.7575E-24, -1.6931E-24,  4.7135E-24, -1.4200E-25,  5.2180E-24, &
       8.7930E-25,  5.4774E-24,  1.6198E-24,  5.5115E-24,  2.0743E-24,  5.6378E-24, &
       2.3523E-24,  5.5409E-24,  2.6921E-24,  5.2718E-24,  2.8250E-24,  5.2448E-24, &
       2.8938E-24,  5.0591E-24,  2.9616E-24,  4.8623E-24,  3.0120E-24,  4.6335E-24, &
       3.0222E-24,  4.5074E-24,  2.9872E-24,  4.3403E-24,  3.3939E-24,  3.3813E-24, &
       3.0330E-24,  2.9902E-24,  2.7926E-24,  2.7340E-24,  2.6372E-24,  2.5513E-24, &
       2.6939E-24,  2.8015E-24,  2.8986E-24,  2.9757E-24,  3.0337E-24,  3.0820E-24, &
       3.1096E-24 /)
    REAL, PARAMETER :: b1_2_HNO3(dim55) = (/ &
      -1.2034E-21, -1.2735E-21, -1.2286E-21, -1.4234E-21, -1.3548E-21, -1.6291E-21, &
      -1.5288E-21, -1.8266E-21, -1.6917E-21, -1.9823E-21, -1.8187E-21, -2.0922E-21, &
      -1.9096E-21, -2.1674E-21, -1.9739E-21, -2.2173E-21, -2.0207E-21, -2.2512E-21, &
      -2.0537E-21, -2.2745E-21, -2.0796E-21, -2.2859E-21, -2.0951E-21, -2.3018E-21, &
      -2.1031E-21, -2.3039E-21, -2.1173E-21, -2.2928E-21, -2.1203E-21, -2.2969E-21, &
      -2.1194E-21, -2.2883E-21, -2.1195E-21, -2.2772E-21, -2.1190E-21, -2.2617E-21, &
      -2.1159E-21, -2.2540E-21, -2.1088E-21, -2.2414E-21, -2.1463E-21, -2.1449E-21, &
      -2.1012E-21, -2.0953E-21, -2.0655E-21, -2.0560E-21, -2.0390E-21, -2.0228E-21, &
      -2.0514E-21, -2.0743E-21, -2.0962E-21, -2.1146E-21, -2.1291E-21, -2.1418E-21, &
      -2.1494E-21 /)
    REAL, PARAMETER :: a2_HNO3(dim55) = (/ &
      -3.8760E-22, -3.5680E-22, -3.0804E-22, -2.5380E-22, -2.0204E-22, -1.5764E-22, &
      -1.2204E-22, -9.4560E-23, -7.3920E-23, -5.8480E-23, -4.6960E-23, -3.8360E-23, &
      -3.1800E-23, -2.6840E-23, -2.2920E-23, -1.9840E-23, -1.7360E-23, -1.5320E-23, &
      -1.3720E-23, -1.2280E-23, -1.1120E-23, -1.0080E-23, -9.2400E-24, -8.4400E-24, &
      -7.7600E-24, -7.1600E-24, -6.6000E-24, -6.1600E-24, -5.6800E-24, -5.2800E-24, &
      -4.9200E-24, -4.6000E-24, -4.2800E-24, -4.0000E-24, -3.7200E-24, -3.4800E-24, &
      -3.2400E-24, -3.0800E-24, -2.8400E-24, -2.6800E-24, -2.2080E-24, -1.6000E-24, &
      -1.1600E-24, -8.4000E-25, -6.1600E-25, -4.4800E-25, -3.2000E-25, -2.3200E-25, &
      -1.7600E-25, -1.2000E-25, -8.8000E-26, -6.4000E-26, -4.8000E-26, -4.0000E-26, &
      -2.4000E-26 /)
    REAL, PARAMETER :: b2_HNO3(dim55) = (/ &
       1.2725E-20,  1.2632E-20,  1.2364E-20,  1.1930E-20,  1.1387E-20,  1.0810E-20, &
       1.0258E-20,  9.7632E-21,  9.3401E-21,  8.9849E-21,  8.6912E-21,  8.4504E-21, &
       8.2503E-21,  8.0866E-21,  7.9475E-21,  7.8304E-21,  7.7300E-21,  7.6423E-21, &
       7.5695E-21,  7.5003E-21,  7.4418E-21,  7.3866E-21,  7.3400E-21,  7.2936E-21, &
       7.2525E-21,  7.2147E-21,  7.1780E-21,  7.1481E-21,  7.1142E-21,  7.0850E-21, &
       7.0579E-21,  7.0329E-21,  7.0071E-21,  6.9839E-21,  6.9600E-21,  6.9388E-21, &
       6.9171E-21,  6.9022E-21,  6.8793E-21,  6.8636E-21,  6.8162E-21,  6.7475E-21, &
       6.6923E-21,  6.6481E-21,  6.6144E-21,  6.5870E-21,  6.5646E-21,  6.5480E-21, &
       6.5368E-21,  6.5249E-21,  6.5176E-21,  6.5119E-21,  6.5079E-21,  6.5058E-21, &
       6.5014E-21 /)
    REAL, PARAMETER :: a3_HNO3(dim55) = (/ &
      -1.0408E-23, -6.4632E-24, -3.6112E-24, -2.1154E-24, -1.3608E-24, -9.4643E-25, &
      -7.0169E-25, -5.4433E-25, -4.3471E-25, -3.6112E-25, -3.0127E-25, -2.6014E-25, &
      -2.2420E-25, -1.9856E-25, -1.7457E-25, -1.5577E-25, -1.4034E-25, -1.2660E-25, &
      -1.1473E-25, -1.0445E-25, -9.5726E-26, -8.9041E-26, -8.0479E-26, -7.5342E-26, &
      -6.8376E-26, -6.5068E-26, -5.9932E-26, -5.4795E-26, -5.2991E-26, -4.7945E-26, &
      -4.6233E-26, -4.2808E-26, -3.9316E-26, -3.7671E-26, -3.5959E-26, -3.2479E-26, &
      -3.0822E-26, -3.0822E-26, -2.7397E-26, -2.5641E-26, -2.1910E-26, -1.6775E-26, &
      -1.2663E-26, -9.5858E-27, -7.5317E-27, -5.8179E-27, -4.4505E-27, -3.7658E-27, &
      -2.7379E-27, -2.0541E-27, -1.7117E-27, -1.3689E-27, -1.0270E-27, -6.8470E-28, &
      -6.8446E-28 /)
    REAL, PARAMETER :: b3_HNO3(dim55) = (/ &
       3.0325E-21,  2.8001E-21,  2.4654E-21,  2.2024E-21,  2.0257E-21,  1.9045E-21, &
       1.8185E-21,  1.7541E-21,  1.7028E-21,  1.6641E-21,  1.6291E-21,  1.6026E-21, &
       1.5774E-21,  1.5579E-21,  1.5383E-21,  1.5218E-21,  1.5074E-21,  1.4937E-21, &
       1.4812E-21,  1.4698E-21,  1.4596E-21,  1.4514E-21,  1.4404E-21,  1.4335E-21, &
       1.4237E-21,  1.4189E-21,  1.4111E-21,  1.4030E-21,  1.4000E-21,  1.3915E-21, &
       1.3885E-21,  1.3823E-21,  1.3757E-21,  1.3726E-21,  1.3692E-21,  1.3620E-21, &
       1.3585E-21,  1.3585E-21,  1.3509E-21,  1.3469E-21,  1.3382E-21,  1.3247E-21, &
       1.3127E-21,  1.3028E-21,  1.2956E-21,  1.2891E-21,  1.2835E-21,  1.2805E-21, &
       1.2757E-21,  1.2723E-21,  1.2705E-21,  1.2686E-21,  1.2666E-21,  1.2645E-21, &
       1.2645E-21 /)
    REAL, PARAMETER :: a4_HNO3(4) = (/  7.0482E-22, -1.5179E-25,  3.1556E-29, -2.2030E-33 /)
    REAL, PARAMETER :: a5_HNO3(4) = (/  8.8738E-23, -3.0692E-26,  5.5805E-30, -3.6137E-34 /)
    REAL, PARAMETER :: a6_HNO3(4) = (/  4.6762E-25, -1.1068E-29,  1.3921E-34,  0.0000E+00 /)
    ! T-dep parameters:
    REAL, PARAMETER :: c0_1_1_HNO3(dim58) = (/ &
       2.8360E-02,  2.8360E-02,  2.8360E-02,  3.2253E-02,  3.6583E-02,  4.0136E-02, &
       4.3766E-02,  4.6346E-02,  4.7991E-02,  4.9030E-02,  4.8871E-02,  4.8348E-02, &
       4.7293E-02,  4.5293E-02,  4.3577E-02,  4.1324E-02,  3.9231E-02,  3.6708E-02, &
       3.3930E-02,  3.0400E-02,  2.5892E-02,  2.0420E-02,  1.2961E-02,  4.3296E-03, &
      -5.7660E-03, -1.6703E-02, -2.7888E-02, -3.8494E-02, -4.7806E-02, -5.4677E-02, &
      -5.8897E-02, -6.0663E-02, -5.9576E-02, -5.6892E-02, -5.2940E-02, -4.9523E-02, &
      -4.7092E-02, -4.6801E-02, -4.8925E-02, -5.3200E-02, -5.9826E-02, -6.7080E-02, &
      -7.3573E-02, -7.7291E-02, -7.6493E-02, -6.9915E-02, -5.8672E-02, -4.3973E-02, &
      -2.7387E-02, -9.4989E-03,  1.0807E-02,  3.4825E-02,  6.4377E-02,  9.5588E-02, &
       1.2441E-01,  1.4653E-01,  1.6820E-01,  1.9417E-01 /)
    REAL, PARAMETER :: c0_1_2_HNO3(dim58) = (/ &
      -9.2834E-01, -9.2834E-01, -9.2834E-01, -1.1020E+00, -1.2960E+00, -1.4558E+00, &
      -1.6199E+00, -1.7371E+00, -1.8121E+00, -1.8596E+00, -1.8523E+00, -1.8282E+00, &
      -1.7792E+00, -1.6860E+00, -1.6057E+00, -1.4998E+00, -1.4010E+00, -1.2814E+00, &
      -1.1492E+00, -9.8046E-01, -7.6408E-01, -5.0036E-01, -1.3934E-01,  2.8016E-01, &
       7.7282E-01,  1.3087E+00,  1.8590E+00,  2.3830E+00,  2.8449E+00,  3.1870E+00, &
       3.3980E+00,  3.4867E+00,  3.4319E+00,  3.2961E+00,  3.0953E+00,  2.9210E+00, &
       2.7966E+00,  2.7816E+00,  2.8912E+00,  3.1127E+00,  3.4572E+00,  3.8359E+00, &
       4.1761E+00,  4.3717E+00,  4.3296E+00,  3.9809E+00,  3.3828E+00,  2.5979E+00, &
       1.7089E+00,  7.4647E-01, -3.5004E-01, -1.6518E+00, -3.2594E+00, -4.9636E+00, &
      -6.5429E+00, -7.7596E+00, -8.9556E+00, -1.0395E+01 /)
    REAL, PARAMETER :: c0_2_1_HNO3(dim58) = (/ &
       1.7963E-02,  1.7963E-02,  1.7963E-02,  2.1680E-02,  2.4262E-02,  2.7026E-02, &
       2.9834E-02,  3.0069E-02,  3.0187E-02,  3.1141E-02,  2.6655E-02,  2.2648E-02, &
       2.0481E-02,  1.5017E-02,  1.1031E-02,  7.1674E-03,  3.0689E-03, -1.8926E-03, &
      -4.4524E-03, -1.0490E-02, -1.3136E-02, -1.8299E-02, -2.4003E-02, -2.9220E-02, &
      -3.5877E-02, -3.7744E-02, -4.1442E-02, -3.8114E-02, -3.3842E-02, -2.6522E-02, &
      -2.0286E-02, -1.5931E-02, -1.2592E-02, -1.0902E-02, -1.2254E-02, -1.5495E-02, &
      -2.0064E-02, -2.7766E-02, -3.6293E-02, -4.5027E-02, -5.0869E-02, -4.9787E-02, &
      -3.8618E-02, -1.6760E-02,  1.1356E-02,  4.0032E-02,  5.9570E-02,  7.2507E-02, &
       7.7680E-02,  7.3472E-02,  5.9990E-02,  3.1619E-02, -1.3703E-02, -6.7119E-02, &
      -1.0378E-01, -1.0252E-01, -4.6418E-02,  2.7452E-02 /)
    REAL, PARAMETER :: c0_2_2_HNO3(dim58) = (/ &
      -7.2158E-01, -7.2158E-01, -7.2158E-01, -8.8733E-01, -1.0030E+00, -1.1274E+00, &
      -1.2543E+00, -1.2650E+00, -1.2704E+00, -1.3141E+00, -1.1077E+00, -9.2259E-01, &
      -8.2204E-01, -5.6740E-01, -3.8085E-01, -1.9928E-01, -5.8348E-03,  2.2934E-01, &
       3.5119E-01,  6.3980E-01,  7.6680E-01,  1.0157E+00,  1.2917E+00,  1.5453E+00, &
       1.8701E+00,  1.9616E+00,  2.1435E+00,  1.9792E+00,  1.7673E+00,  1.4027E+00, &
       1.0909E+00,  8.7232E-01,  7.0404E-01,  6.1851E-01,  6.8716E-01,  8.5245E-01, &
       1.0864E+00,  1.4823E+00,  1.9223E+00,  2.3747E+00,  2.6785E+00,  2.6220E+00, &
       2.0367E+00,  8.8704E-01, -5.9753E-01, -2.1173E+00, -3.1567E+00, -3.8476E+00, &
      -4.1248E+00, -3.8984E+00, -3.1704E+00, -1.6327E+00,  8.3278E-01,  3.7493E+00, &
       5.7584E+00,  5.6888E+00,  2.5922E+00, -1.5002E+00 /)
    REAL, PARAMETER :: c1_HNO3(3) = (/  1.0000E+00,  4.7507E-01,  1.1242E-01 /)
    REAL, PARAMETER :: c2_HNO3(3) = (/  9.9999E-01,  5.1759E-01,  1.3270E-01 /)
    REAL, PARAMETER :: c3_HNO3(3) = (/  9.9998E-01,  9.1087E-01,  4.0888E-01 /)
    REAL, PARAMETER :: c4_HNO3(3) = (/  9.9995E-01,  1.1561E+00,  6.4910E-01 /)
    REAL, PARAMETER :: c5_HNO3(3) = (/  9.9964E-01,  1.9202E+00,  1.7827E+00 /)
    REAL, PARAMETER :: c6_HNO3(3) = (/  9.9839E-01,  2.8097E+00,  3.7724E+00 /)

    jval_2d(ip_HNO3)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_HNO3(0) = &
          p2(1.,c0_1_1_HNO3(i0(j,k))*dlv2(j,k) + &
          c0_1_2_HNO3(i0(j,k)), &
          c0_2_1_HNO3(i0(j,k))*dlv2(j,k) + &
          c0_2_2_HNO3(i0(j,k)), tnorm_sr(j,k)) * &
          p1(a0_1_1_HNO3(i0(j,k))*dlv2(j,k) + &
          a0_1_2_HNO3(i0(j,k)), &
          a0_2_1_HNO3(i0(j,k))*dlv2(j,k) + &
          a0_2_2_HNO3(i0(j,k)),v3_du1(j,k))
        sig_HNO3(1) = &
          p2(c1_HNO3(1),c1_HNO3(2), &
          c1_HNO3(3),tnorm(j,k)) * &
          (p1(b1_1_HNO3(i1(j,k)),a1_1_HNO3(i1(j,k)), &
          v3_du1(j,k)) + &
          p1(b1_2_HNO3(i1(j,k)),a1_2_HNO3(i1(j,k)), &
          v3_du1(j,k)) * v2s_m(j,k))
        sig_HNO3(2) = &
          p2(c2_HNO3(1),c2_HNO3(2),c2_HNO3(3),tnorm(j,k))* &
          p1(b2_HNO3(i2(j,k)), a2_HNO3(i2(j,k)), &
          v3_du1(j,k))
        sig_HNO3(3) = &
          p2(c3_HNO3(1),c3_HNO3(2),c3_HNO3(3),tnorm(j,k))* &
          p1(b3_HNO3(i3(j,k)), a3_HNO3(i3(j,k)), &
          v3_du2(j,k))
        sig_HNO3(4) = &
          p2(c4_HNO3(1),c4_HNO3(2),c4_HNO3(3),tnorm(j,k))* &
          p3(a4_HNO3(1),a4_HNO3(2),a4_HNO3(3), &
          a4_HNO3(4),v3_du2(j,k))
        sig_HNO3(5) = &
          p2(c5_HNO3(1),c5_HNO3(2),c5_HNO3(3),tnorm(j,k))* &
          p3(a5_HNO3(1),a5_HNO3(2),a5_HNO3(3), &
          a5_HNO3(4),v3_du2(j,k))
        sig_HNO3(6) = &
          p2(c6_HNO3(1),c6_HNO3(2),c6_HNO3(3),tnorm(j,k))* &
          p3(a6_HNO3(1),a6_HNO3(2),a6_HNO3(3), &
          a6_HNO3(4),v3_du2(j,k))
        dj = 0. &
          + sig_HNO3(0) * fint(j,k,0) &
          + sig_HNO3(1) * fint(j,k,1) &
          + sig_HNO3(2) * fint(j,k,2) &
          + sig_HNO3(3) * fint(j,k,3) &
          + sig_HNO3(4) * fint(j,k,4) &
          + sig_HNO3(5) * fint(j,k,5) &
          + sig_HNO3(6) * fint(j,k,6)

        jval_2d(ip_HNO3)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,7)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_HNO3

  ! **************************************************************************

  SUBROUTINE jval_cal_HNO4

    ! HNO_4 \TOHV\ \products

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_HNO4

    ! T-const parameters:
    REAL, PARAMETER :: a0_1_1_HNO4(dim58) = (/ &
       1.0917E-19,  1.1804E-19,  1.2683E-19,  1.3598E-19,  1.4485E-19,  1.5363E-19, &
       1.6216E-19,  1.7023E-19,  1.7805E-19,  1.8544E-19,  1.9219E-19,  1.9866E-19, &
       2.2544E-19,  2.9603E-19,  2.8327E-19,  2.9021E-19,  3.1905E-19,  2.9996E-19, &
       3.0110E-19,  3.2489E-19,  2.9433E-19,  2.8467E-19,  2.9887E-19,  2.5266E-19, &
       2.2945E-19,  1.4386E-19,  8.6628E-20,  5.9720E-20,  3.5404E-20,  1.4751E-20, &
      -1.7117E-21, -1.3544E-20, -2.1023E-20, -2.4997E-20, -2.6929E-20, -2.8108E-20, &
      -3.0197E-20, -3.4621E-20, -4.1986E-20, -5.3146E-20, -6.7973E-20, -8.6081E-20, &
      -1.0665E-19, -1.2840E-19, -1.4982E-19, -1.6902E-19, -1.8410E-19, -1.9382E-19, &
      -1.9715E-19, -1.9456E-19, -1.8734E-19, -1.7628E-19, -1.6320E-19, -1.4860E-19, &
      -1.3304E-19, -1.1646E-19, -9.7741E-20, -8.1165E-20 /)
    REAL, PARAMETER :: a0_1_2_HNO4(dim58) = (/ &
       4.2723E-19,  3.5348E-20, -3.5504E-19, -7.6301E-19, -1.1606E-18, -1.5559E-18, &
      -1.9412E-18, -2.3074E-18, -2.6640E-18, -3.0026E-18, -3.3133E-18, -3.6121E-18, &
      -4.8548E-18, -8.1444E-18, -7.5469E-18, -7.8733E-18, -9.2345E-18, -8.3298E-18, &
      -8.3838E-18, -9.5210E-18, -8.0541E-18, -7.5887E-18, -8.2756E-18, -6.0299E-18, &
      -4.8975E-18, -7.0336E-19,  2.1124E-18,  3.4417E-18,  4.6477E-18,  5.6763E-18, &
       6.4994E-18,  7.0934E-18,  7.4703E-18,  7.6714E-18,  7.7696E-18,  7.8296E-18, &
       7.9366E-18,  8.1640E-18,  8.5440E-18,  9.1221E-18,  9.8932E-18,  1.0838E-17, &
       1.1916E-17,  1.3060E-17,  1.4191E-17,  1.5209E-17,  1.6011E-17,  1.6530E-17, &
       1.6709E-17,  1.6569E-17,  1.6179E-17,  1.5580E-17,  1.4868E-17,  1.4071E-17, &
       1.3218E-17,  1.2307E-17,  1.1273E-17,  1.0355E-17 /)
    REAL, PARAMETER :: a0_2_1_HNO4(dim58) = (/ &
       3.7782E-22,  4.2156E-22,  4.7209E-22,  5.2605E-22,  5.8683E-22,  6.5382E-22, &
       7.2606E-22,  8.0740E-22,  8.9411E-22,  9.9124E-22,  1.0971E-21,  1.2136E-21, &
       1.0281E-21,  2.2079E-22,  6.5815E-22,  7.9811E-22,  6.4912E-22,  1.1142E-21, &
       1.2898E-21,  1.1761E-21,  1.6718E-21,  1.8740E-21,  1.7799E-21,  2.2847E-21, &
       2.4842E-21,  3.2471E-21,  3.6553E-21,  3.6999E-21,  3.6628E-21,  3.5354E-21, &
       3.3150E-21,  3.0068E-21,  2.6247E-21,  2.1919E-21,  1.7419E-21,  1.3030E-21, &
       9.0624E-22,  5.7385E-22,  3.1707E-22,  1.4169E-22,  4.2372E-23,  5.9781E-24, &
       1.5171E-23,  5.0957E-23,  9.7496E-23,  1.4348E-22,  1.8246E-22,  2.0915E-22, &
       2.2239E-22,  2.2204E-22,  2.1165E-22,  1.9247E-22,  1.6977E-22,  1.4497E-22, &
       1.2018E-22,  9.6959E-23,  7.5064E-23,  6.0958E-23 /)
    REAL, PARAMETER :: a0_2_2_HNO4(dim58) = (/ &
      -2.9230E-20, -3.1163E-20, -3.3407E-20, -3.5813E-20, -3.8536E-20, -4.1551E-20, &
      -4.4816E-20, -4.8509E-20, -5.2463E-20, -5.6911E-20, -6.1780E-20, -6.7165E-20, &
      -5.8557E-20, -2.0936E-20, -4.1404E-20, -4.7982E-20, -4.0950E-20, -6.2993E-20, &
      -7.1352E-20, -6.5916E-20, -8.9713E-20, -9.9458E-20, -9.4903E-20, -1.1944E-19, &
      -1.2917E-19, -1.6656E-19, -1.8664E-19, -1.8884E-19, -1.8700E-19, -1.8065E-19, &
      -1.6963E-19, -1.5417E-19, -1.3491E-19, -1.1301E-19, -9.0150E-20, -6.7765E-20, &
      -4.7449E-20, -3.0364E-20, -1.7114E-20, -8.0299E-21, -2.8652E-21, -9.6540E-22, &
      -1.4471E-21, -3.3294E-21, -5.7867E-21, -8.2241E-21, -1.0298E-20, -1.1723E-20, &
      -1.2432E-20, -1.2414E-20, -1.1853E-20, -1.0813E-20, -9.5781E-21, -8.2240E-21, &
      -6.8656E-21, -5.5884E-21, -4.3799E-21, -3.5984E-21 /)
    REAL, PARAMETER :: a1_1_HNO4(dim55) = (/ &
       3.4212E-20,  3.3331E-20,  3.3329E-20,  3.1231E-20,  3.0205E-20,  2.7716E-20, &
       2.6369E-20,  2.4113E-20,  2.2826E-20,  2.0987E-20,  1.9918E-20,  1.8452E-20, &
       1.7568E-20,  1.6441E-20,  1.5718E-20,  1.4826E-20,  1.4206E-20,  1.3488E-20, &
       1.2975E-20,  1.2380E-20,  1.1941E-20,  1.1447E-20,  1.1052E-20,  1.0659E-20, &
       1.0291E-20,  9.9690E-21,  9.6373E-21,  9.3576E-21,  9.0704E-21,  8.8338E-21, &
       8.5500E-21,  8.3597E-21,  8.1151E-21,  7.9427E-21,  7.7040E-21,  7.5688E-21, &
       7.3524E-21,  7.2273E-21,  7.0155E-21,  6.9169E-21,  6.4919E-21,  5.9272E-21, &
       5.4435E-21,  5.0584E-21,  4.7019E-21,  4.4193E-21,  4.1331E-21,  3.9181E-21, &
       3.6080E-21,  3.3934E-21,  3.1903E-21,  3.0046E-21,  2.8315E-21,  2.6680E-21, &
       2.5208E-21 /)
    REAL, PARAMETER :: b1_1_HNO4(dim55) = (/ &
       1.1541E-18,  1.1567E-18,  1.1568E-18,  1.1735E-18,  1.1843E-18,  1.2167E-18, &
       1.2375E-18,  1.2781E-18,  1.3045E-18,  1.3468E-18,  1.3741E-18,  1.4151E-18, &
       1.4421E-18,  1.4793E-18,  1.5050E-18,  1.5388E-18,  1.5640E-18,  1.5948E-18, &
       1.6182E-18,  1.6467E-18,  1.6689E-18,  1.6951E-18,  1.7170E-18,  1.7398E-18, &
       1.7620E-18,  1.7824E-18,  1.8041E-18,  1.8231E-18,  1.8434E-18,  1.8606E-18, &
       1.8821E-18,  1.8969E-18,  1.9166E-18,  1.9309E-18,  1.9513E-18,  1.9632E-18, &
       1.9828E-18,  1.9944E-18,  2.0146E-18,  2.0243E-18,  2.0670E-18,  2.1308E-18, &
       2.1915E-18,  2.2447E-18,  2.2983E-18,  2.3444E-18,  2.3946E-18,  2.4350E-18, &
       2.4972E-18,  2.5429E-18,  2.5887E-18,  2.6329E-18,  2.6763E-18,  2.7193E-18, &
       2.7598E-18 /)
    REAL, PARAMETER :: a1_2_HNO4(dim55) = (/ &
      -9.3479E-23, -5.3428E-23, -5.4509E-23, -1.9796E-23, -2.0587E-23,  4.3770E-24, &
       1.8022E-24,  1.6934E-23,  1.3292E-23,  2.1742E-23,  1.7657E-23,  2.2384E-23, &
       1.8818E-23,  2.1166E-23,  1.8324E-23,  1.9483E-23,  1.7338E-23,  1.7952E-23, &
       1.6147E-23,  1.6337E-23,  1.5038E-23,  1.5004E-23,  1.4021E-23,  1.3605E-23, &
       1.3086E-23,  1.2511E-23,  1.2182E-23,  1.1541E-23,  1.1317E-23,  1.0589E-23, &
       1.0625E-23,  9.8149E-24,  9.8598E-24,  9.1112E-24,  9.2674E-24,  8.4266E-24, &
       8.6141E-24,  7.8934E-24,  8.1636E-24,  7.3995E-24,  6.9698E-24,  5.9257E-24, &
       5.2976E-24,  4.6046E-24,  4.2619E-24,  3.7658E-24,  3.6117E-24,  3.2194E-24, &
       3.5434E-24,  3.4456E-24,  3.3753E-24,  3.3087E-24,  3.2452E-24,  3.1885E-24, &
       3.1190E-24 /)
    REAL, PARAMETER :: b1_2_HNO4(dim55) = (/ &
      -2.3056E-21, -2.4258E-21, -2.4198E-21, -2.6976E-21, -2.6892E-21, -3.0138E-21, &
      -2.9739E-21, -3.2462E-21, -3.1716E-21, -3.3659E-21, -3.2618E-21, -3.3941E-21, &
      -3.2854E-21, -3.3628E-21, -3.2619E-21, -3.3060E-21, -3.2191E-21, -3.2455E-21, &
      -3.1634E-21, -3.1725E-21, -3.1069E-21, -3.1051E-21, -3.0506E-21, -3.0265E-21, &
      -2.9951E-21, -2.9588E-21, -2.9372E-21, -2.8936E-21, -2.8778E-21, -2.8247E-21, &
      -2.8274E-21, -2.7643E-21, -2.7679E-21, -2.7057E-21, -2.7191E-21, -2.6451E-21, &
      -2.6621E-21, -2.5951E-21, -2.6209E-21, -2.5460E-21, -2.5028E-21, -2.3848E-21, &
      -2.3060E-21, -2.2104E-21, -2.1588E-21, -2.0779E-21, -2.0509E-21, -1.9771E-21, &
      -2.0421E-21, -2.0212E-21, -2.0054E-21, -1.9895E-21, -1.9736E-21, -1.9587E-21, &
      -1.9396E-21 /)
    REAL, PARAMETER :: a2_HNO4(dim55) = (/ &
      -8.8320E-21, -7.7840E-21, -6.4520E-21, -5.0908E-21, -3.8748E-21, -2.8880E-21, &
      -2.1332E-21, -1.5768E-21, -1.1760E-21, -8.8960E-22, -6.8480E-22, -5.3800E-22, &
      -4.3120E-22, -3.5200E-22, -2.9360E-22, -2.4800E-22, -2.1360E-22, -1.8560E-22, &
      -1.6320E-22, -1.4520E-22, -1.2960E-22, -1.1720E-22, -1.0600E-22, -9.6800E-23, &
      -8.8800E-23, -8.1200E-23, -7.4800E-23, -6.9200E-23, -6.4000E-23, -5.9600E-23, &
      -5.4800E-23, -5.1600E-23, -4.7600E-23, -4.4400E-23, -4.1600E-23, -3.8800E-23, &
      -3.6400E-23, -3.3600E-23, -3.2000E-23, -2.9600E-23, -2.4480E-23, -1.7680E-23, &
      -1.2800E-23, -9.2800E-24, -6.7200E-24, -4.9600E-24, -3.5200E-24, -2.5600E-24, &
      -1.9200E-24, -1.3600E-24, -9.6000E-25, -7.2000E-25, -5.6000E-25, -3.2000E-25, &
      -3.2000E-25 /)
    REAL, PARAMETER :: b2_HNO4(dim55) = (/ &
       1.6869E-19,  1.6554E-19,  1.5822E-19,  1.4733E-19,  1.3456E-19,  1.2173E-19, &
       1.1003E-19,  1.0002E-19,  9.1799E-20,  8.5212E-20,  7.9989E-20,  7.5879E-20, &
       7.2622E-20,  7.0008E-20,  6.7935E-20,  6.6202E-20,  6.4809E-20,  6.3605E-20, &
       6.2586E-20,  6.1722E-20,  6.0934E-20,  6.0277E-20,  5.9655E-20,  5.9121E-20, &
       5.8637E-20,  5.8159E-20,  5.7739E-20,  5.7359E-20,  5.6992E-20,  5.6671E-20, &
       5.6308E-20,  5.6059E-20,  5.5737E-20,  5.5471E-20,  5.5232E-20,  5.4985E-20, &
       5.4768E-20,  5.4508E-20,  5.4355E-20,  5.4120E-20,  5.3605E-20,  5.2837E-20, &
       5.2224E-20,  5.1739E-20,  5.1353E-20,  5.1066E-20,  5.0814E-20,  5.0633E-20, &
       5.0505E-20,  5.0386E-20,  5.0295E-20,  5.0238E-20,  5.0198E-20,  5.0135E-20, &
       5.0135E-20 /)
    REAL, PARAMETER :: a3_HNO4(dim55) = (/ &
      -7.2449E-23, -4.4075E-23, -2.4012E-23, -1.3726E-23, -8.6443E-24, -5.9045E-24, &
      -4.3300E-24, -3.3208E-24, -2.6699E-24, -2.1735E-24, -1.8487E-24, -1.5745E-24, &
      -1.3692E-24, -1.2153E-24, -1.0611E-24, -9.5858E-25, -8.7284E-25, -7.6989E-25, &
      -7.1918E-25, -6.5068E-25, -5.9829E-25, -5.4795E-25, -5.1027E-25, -4.7089E-25, &
      -4.3590E-25, -4.0753E-25, -3.7842E-25, -3.5445E-25, -3.2991E-25, -3.0993E-25, &
      -2.8938E-25, -2.7226E-25, -2.5470E-25, -2.3973E-25, -2.2603E-25, -2.1197E-25, &
      -1.9863E-25, -1.8836E-25, -1.7808E-25, -1.6752E-25, -1.4173E-25, -1.0716E-25, &
      -8.1793E-26, -6.2650E-26, -4.8271E-26, -3.7645E-26, -2.9100E-26, -2.2595E-26, &
      -1.7454E-26, -1.4036E-26, -1.0613E-26, -8.5558E-27, -6.8470E-27, -5.1352E-27, &
      -4.1068E-27 /)
    REAL, PARAMETER :: b3_HNO4(dim55) = (/ &
       2.1352E-20,  1.9680E-20,  1.7326E-20,  1.5518E-20,  1.4328E-20,  1.3526E-20, &
       1.2973E-20,  1.2560E-20,  1.2255E-20,  1.1994E-20,  1.1804E-20,  1.1628E-20, &
       1.1484E-20,  1.1367E-20,  1.1240E-20,  1.1151E-20,  1.1070E-20,  1.0968E-20, &
       1.0915E-20,  1.0839E-20,  1.0777E-20,  1.0716E-20,  1.0667E-20,  1.0614E-20, &
       1.0565E-20,  1.0524E-20,  1.0479E-20,  1.0442E-20,  1.0401E-20,  1.0368E-20, &
       1.0332E-20,  1.0301E-20,  1.0268E-20,  1.0239E-20,  1.0212E-20,  1.0183E-20, &
       1.0155E-20,  1.0133E-20,  1.0110E-20,  1.0086E-20,  1.0025E-20,  9.9345E-21, &
       9.8604E-21,  9.7989E-21,  9.7484E-21,  9.7081E-21,  9.6731E-21,  9.6446E-21, &
       9.6206E-21,  9.6036E-21,  9.5856E-21,  9.5742E-21,  9.5642E-21,  9.5537E-21, &
       9.5471E-21 /)
    REAL, PARAMETER :: a4_HNO4(4) = (/  5.9074E-21, -9.5904E-25,  2.0205E-28, -1.4211E-32 /)
    REAL, PARAMETER :: a5_HNO4(4) = (/  1.4709E-21, -2.9276E-25,  5.0174E-29, -3.1787E-33 /)
    REAL, PARAMETER :: a6_HNO4(4) = (/  2.9356E-23, -6.8914E-28,  8.5758E-33, -6.4193E-38 /)

    jval_2d(ip_HNO4)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_HNO4(0) = &
          p1(a0_1_1_HNO4(i0(j,k))*dlv2(j,k) + &
          a0_1_2_HNO4(i0(j,k)), &
          a0_2_1_HNO4(i0(j,k))*dlv2(j,k) + &
          a0_2_2_HNO4(i0(j,k)),v3_du1(j,k))
        sig_HNO4(1) = &
          (p1(b1_1_HNO4(i1(j,k)),a1_1_HNO4(i1(j,k)), &
          v3_du1(j,k)) + &
          p1(b1_2_HNO4(i1(j,k)),a1_2_HNO4(i1(j,k)), &
          v3_du1(j,k)) * v2s_m(j,k))
        sig_HNO4(2) = &
          p1(b2_HNO4(i2(j,k)), a2_HNO4(i2(j,k)), &
          v3_du1(j,k))
        sig_HNO4(3) = &
          p1(b3_HNO4(i3(j,k)), a3_HNO4(i3(j,k)), &
          v3_du2(j,k))
        sig_HNO4(4) = &
          p3(a4_HNO4(1),a4_HNO4(2),a4_HNO4(3), &
          a4_HNO4(4),v3_du2(j,k))
        sig_HNO4(5) = &
          p3(a5_HNO4(1),a5_HNO4(2),a5_HNO4(3), &
          a5_HNO4(4),v3_du2(j,k))
        sig_HNO4(6) = &
          p3(a6_HNO4(1),a6_HNO4(2),a6_HNO4(3), &
          a6_HNO4(4),v3_du2(j,k))
        dj = 0. &
          + 1.E-5 &
          + sig_HNO4(0) * fint(j,k,0) &
          + sig_HNO4(1) * fint(j,k,1) &
          + sig_HNO4(2) * fint(j,k,2) &
          + sig_HNO4(3) * fint(j,k,3) &
          + sig_HNO4(4) * fint(j,k,4) &
          + sig_HNO4(5) * fint(j,k,5) &
          + sig_HNO4(6) * fint(j,k,6)

        jval_2d(ip_HNO4)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,4)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_HNO4

  ! **************************************************************************

  SUBROUTINE jval_cal_PAN

    ! PAN \TOHV\ \products

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_PAN

    ! T-const parameters:
    REAL, PARAMETER :: a0_1_1_PAN(dim58) = (/ &
       3.6447E-20,  3.9996E-20,  4.3601E-20,  4.7471E-20,  5.1399E-20,  5.5576E-20, &
       5.9982E-20,  6.4509E-20,  6.9160E-20,  7.4081E-20,  7.9109E-20,  8.4624E-20, &
       1.0097E-19,  1.4116E-19,  1.3759E-19,  1.4508E-19,  1.6484E-19,  1.5975E-19, &
       1.6625E-19,  1.8571E-19,  1.7715E-19,  1.8087E-19,  1.9854E-19,  1.8517E-19, &
       1.8523E-19,  1.5344E-19,  1.3760E-19,  1.3858E-19,  1.4089E-19,  1.4502E-19, &
       1.5124E-19,  1.5898E-19,  1.6827E-19,  1.7864E-19,  1.8965E-19,  2.0018E-19, &
       2.1019E-19,  2.1924E-19,  2.2704E-19,  2.3361E-19,  2.3910E-19,  2.4308E-19, &
       2.4572E-19,  2.4626E-19,  2.4412E-19,  2.3879E-19,  2.2951E-19,  2.1685E-19, &
       2.0124E-19,  1.8381E-19,  1.6540E-19,  1.4662E-19,  1.2698E-19,  1.0631E-19, &
       8.4261E-20,  6.1814E-20,  4.1159E-20,  2.8209E-20 /)
    REAL, PARAMETER :: a0_1_2_PAN(dim58) = (/ &
       1.9585E-20, -1.3730E-19, -2.9736E-19, -4.6996E-19, -6.4592E-19, -8.3390E-19, &
      -1.0330E-18, -1.2386E-18, -1.4507E-18, -1.6761E-18, -1.9073E-18, -2.1621E-18, &
      -2.9204E-18, -4.7933E-18, -4.6261E-18, -4.9785E-18, -5.9111E-18, -5.6698E-18, &
      -5.9790E-18, -6.9092E-18, -6.4987E-18, -6.6777E-18, -7.5332E-18, -6.8830E-18, &
      -6.8863E-18, -5.3287E-18, -4.5492E-18, -4.5977E-18, -4.7121E-18, -4.9178E-18, &
      -5.2288E-18, -5.6173E-18, -6.0856E-18, -6.6104E-18, -7.1695E-18, -7.7066E-18, &
      -8.2193E-18, -8.6843E-18, -9.0868E-18, -9.4273E-18, -9.7124E-18, -9.9203E-18, &
      -1.0059E-17, -1.0087E-17, -9.9741E-18, -9.6915E-18, -9.1979E-18, -8.5218E-18, &
      -7.6853E-18, -6.7474E-18, -5.7534E-18, -4.7352E-18, -3.6669E-18, -2.5385E-18, &
      -1.3302E-18, -9.5566E-20,  1.0446E-18,  1.7621E-18 /)
    REAL, PARAMETER :: a0_2_1_PAN(dim58) = (/ &
       1.6617E-22,  1.8283E-22,  2.0176E-22,  2.2212E-22,  2.4507E-22,  2.6878E-22, &
       2.9407E-22,  3.2249E-22,  3.5299E-22,  3.8646E-22,  4.2286E-22,  4.6184E-22, &
       3.4312E-22, -1.0493E-22,  1.0463E-22,  1.5505E-22,  5.0995E-23,  2.7376E-22, &
       3.4136E-22,  2.5331E-22,  4.9171E-22,  5.7355E-22,  4.9735E-22,  7.4320E-22, &
       8.2827E-22,  1.2162E-21,  1.4194E-21,  1.4362E-21,  1.4197E-21,  1.3643E-21, &
       1.2668E-21,  1.1301E-21,  9.5866E-22,  7.6046E-22,  5.4877E-22,  3.3827E-22, &
       1.4207E-22, -3.0758E-23, -1.7203E-22, -2.7936E-22, -3.5430E-22, -3.9923E-22, &
      -4.2224E-22, -4.2932E-22, -4.2472E-22, -4.1207E-22, -3.9174E-22, -3.6516E-22, &
      -3.3422E-22, -3.0142E-22, -2.6753E-22, -2.3487E-22, -2.0128E-22, -1.6783E-22, &
      -1.3383E-22, -1.0030E-22, -7.0147E-23, -5.0239E-23 /)
    REAL, PARAMETER :: a0_2_2_PAN(dim58) = (/ &
      -1.0224E-20, -1.0960E-20, -1.1801E-20, -1.2709E-20, -1.3737E-20, -1.4804E-20, &
      -1.5947E-20, -1.7237E-20, -1.8628E-20, -2.0161E-20, -2.1835E-20, -2.3636E-20, &
      -1.8128E-20,  2.7516E-21, -7.0560E-21, -9.4255E-21, -4.5143E-21, -1.5073E-20, &
      -1.8291E-20, -1.4082E-20, -2.5525E-20, -2.9470E-20, -2.5782E-20, -3.7731E-20, &
      -4.1882E-20, -6.0892E-20, -7.0888E-20, -7.1715E-20, -7.0897E-20, -6.8141E-20, &
      -6.3267E-20, -5.6402E-20, -4.7762E-20, -3.7734E-20, -2.6980E-20, -1.6244E-20, &
      -6.1988E-21,  2.6845E-21,  9.9742E-21,  1.5534E-20,  1.9431E-20,  2.1776E-20, &
       2.2982E-20,  2.3354E-20,  2.3111E-20,  2.2441E-20,  2.1359E-20,  1.9940E-20, &
       1.8281E-20,  1.6517E-20,  1.4687E-20,  1.2917E-20,  1.1090E-20,  9.2629E-21, &
       7.3999E-21,  5.5558E-21,  3.8912E-21,  2.7883E-21 /)
    REAL, PARAMETER :: a1_1_PAN(dim55) = (/ &
       3.1038E-20,  3.0063E-20,  2.9701E-20,  2.7637E-20,  2.6322E-20,  2.4007E-20, &
       2.2466E-20,  2.0451E-20,  1.9022E-20,  1.7428E-20,  1.6235E-20,  1.5036E-20, &
       1.4039E-20,  1.3138E-20,  1.2334E-20,  1.1642E-20,  1.0967E-20,  1.0432E-20, &
       9.8610E-21,  9.4416E-21,  8.9423E-21,  8.6140E-21,  8.1566E-21,  7.9322E-21, &
       7.4982E-21,  7.3191E-21,  6.9420E-21,  6.8018E-21,  6.4351E-21,  6.3572E-21, &
       6.0172E-21,  5.9563E-21,  5.6330E-21,  5.6012E-21,  5.3037E-21,  5.2933E-21, &
       5.0152E-21,  4.9989E-21,  4.7474E-21,  4.7666E-21,  4.3514E-21,  3.9183E-21, &
       3.5224E-21,  3.2441E-21,  2.9555E-21,  2.7626E-21,  2.5364E-21,  2.3964E-21, &
       2.1447E-21,  1.9980E-21,  1.8665E-21,  1.7410E-21,  1.6298E-21,  1.5262E-21, &
       1.4271E-21 /)
    REAL, PARAMETER :: b1_1_PAN(dim55) = (/ &
       7.4375E-19,  7.4668E-19,  7.4867E-19,  7.6518E-19,  7.7898E-19,  8.0908E-19, &
       8.3297E-19,  8.6925E-19,  8.9854E-19,  9.3519E-19,  9.6562E-19,  9.9920E-19, &
       1.0296E-18,  1.0593E-18,  1.0879E-18,  1.1142E-18,  1.1415E-18,  1.1645E-18, &
       1.1905E-18,  1.2106E-18,  1.2358E-18,  1.2532E-18,  1.2786E-18,  1.2916E-18, &
       1.3179E-18,  1.3292E-18,  1.3539E-18,  1.3634E-18,  1.3893E-18,  1.3949E-18, &
       1.4206E-18,  1.4254E-18,  1.4514E-18,  1.4540E-18,  1.4795E-18,  1.4804E-18, &
       1.5056E-18,  1.5071E-18,  1.5311E-18,  1.5292E-18,  1.5709E-18,  1.6199E-18, &
       1.6696E-18,  1.7080E-18,  1.7514E-18,  1.7828E-18,  1.8226E-18,  1.8489E-18, &
       1.8993E-18,  1.9306E-18,  1.9602E-18,  1.9901E-18,  2.0179E-18,  2.0452E-18, &
       2.0725E-18 /)
    REAL, PARAMETER :: a1_2_PAN(dim55) = (/ &
      -7.5273E-23, -4.0058E-23, -3.8040E-23, -8.7001E-24, -6.3511E-24,  1.2730E-23, &
       1.2991E-23,  2.2686E-23,  2.1687E-23,  2.5477E-23,  2.4029E-23,  2.4779E-23, &
       2.3541E-23,  2.2744E-23,  2.1804E-23,  2.0422E-23,  1.9946E-23,  1.8202E-23, &
       1.8190E-23,  1.6256E-23,  1.6511E-23,  1.4664E-23,  1.5200E-23,  1.3065E-23, &
       1.3897E-23,  1.1938E-23,  1.2715E-23,  1.0798E-23,  1.1826E-23,  9.7764E-24, &
       1.0834E-23,  9.0258E-24,  1.0001E-23,  8.2947E-24,  9.3016E-24,  7.5369E-24, &
       8.6141E-24,  7.0376E-24,  8.0197E-24,  6.4520E-24,  6.5182E-24,  5.3108E-24, &
       4.7635E-24,  3.9613E-24,  3.6989E-24,  3.1253E-24,  3.0158E-24,  2.5769E-24, &
       2.9218E-24,  2.7679E-24,  2.6255E-24,  2.5180E-24,  2.4142E-24,  2.3166E-24, &
       2.2341E-24 /)
    REAL, PARAMETER :: b1_2_PAN(dim55) = (/ &
      -2.0901E-21, -2.1957E-21, -2.2068E-21, -2.4416E-21, -2.4662E-21, -2.7143E-21, &
      -2.7183E-21, -2.8928E-21, -2.8724E-21, -2.9595E-21, -2.9226E-21, -2.9436E-21, &
      -2.9059E-21, -2.8795E-21, -2.8462E-21, -2.7937E-21, -2.7744E-21, -2.6994E-21, &
      -2.6988E-21, -2.6060E-21, -2.6189E-21, -2.5210E-21, -2.5507E-21, -2.4269E-21, &
      -2.4773E-21, -2.3538E-21, -2.4048E-21, -2.2744E-21, -2.3469E-21, -2.1972E-21, &
      -2.2771E-21, -2.1360E-21, -2.2145E-21, -2.0729E-21, -2.1590E-21, -2.0037E-21, &
      -2.1012E-21, -1.9546E-21, -2.0484E-21, -1.8947E-21, -1.9014E-21, -1.7650E-21, &
      -1.6963E-21, -1.5856E-21, -1.5461E-21, -1.4526E-21, -1.4334E-21, -1.3509E-21, &
      -1.4200E-21, -1.3872E-21, -1.3551E-21, -1.3295E-21, -1.3035E-21, -1.2779E-21, &
      -1.2551E-21 /)
    REAL, PARAMETER :: a2_PAN(dim55) = (/ &
      -2.1664E-21, -1.8684E-21, -1.5120E-21, -1.1608E-21, -8.5800E-22, -6.1864E-22, &
      -4.4064E-22, -3.1324E-22, -2.2408E-22, -1.6240E-22, -1.1988E-22, -9.0440E-23, &
      -6.9760E-23, -5.5120E-23, -4.4560E-23, -3.6800E-23, -3.0960E-23, -2.6480E-23, &
      -2.2960E-23, -2.0160E-23, -1.7880E-23, -1.6040E-23, -1.4400E-23, -1.3120E-23, &
      -1.1880E-23, -1.0920E-23, -1.0040E-23, -9.2000E-24, -8.5200E-24, -7.8800E-24, &
      -7.3200E-24, -6.8000E-24, -6.2800E-24, -5.8800E-24, -5.4800E-24, -5.1200E-24, &
      -4.7600E-24, -4.4800E-24, -4.1600E-24, -3.8800E-24, -3.2080E-24, -2.3120E-24, &
      -1.6800E-24, -1.2080E-24, -8.8800E-25, -6.4000E-25, -4.6400E-25, -3.3600E-25, &
      -2.4000E-25, -1.8400E-25, -1.2800E-25, -8.8000E-26, -7.2000E-26, -4.8000E-26, &
      -3.2000E-26 /)
    REAL, PARAMETER :: b2_PAN(dim55) = (/ &
       3.1064E-20,  3.0170E-20,  2.8210E-20,  2.5400E-20,  2.2221E-20,  1.9109E-20, &
       1.6350E-20,  1.4057E-20,  1.2229E-20,  1.0811E-20,  9.7264E-21,  8.9021E-21, &
       8.2714E-21,  7.7883E-21,  7.4134E-21,  7.1185E-21,  6.8820E-21,  6.6893E-21, &
       6.5292E-21,  6.3948E-21,  6.2796E-21,  6.1821E-21,  6.0911E-21,  6.0169E-21, &
       5.9418E-21,  5.8814E-21,  5.8237E-21,  5.7666E-21,  5.7187E-21,  5.6719E-21, &
       5.6297E-21,  5.5891E-21,  5.5472E-21,  5.5140E-21,  5.4798E-21,  5.4482E-21, &
       5.4156E-21,  5.3895E-21,  5.3590E-21,  5.3315E-21,  5.2640E-21,  5.1628E-21, &
       5.0834E-21,  5.0183E-21,  4.9701E-21,  4.9297E-21,  4.8988E-21,  4.8748E-21, &
       4.8555E-21,  4.8436E-21,  4.8310E-21,  4.8214E-21,  4.8174E-21,  4.8111E-21, &
       4.8067E-21 /)
    REAL, PARAMETER :: a3_PAN(dim55) = (/ &
      -7.2124E-24, -4.3527E-24, -2.3464E-24, -1.3243E-24, -8.2198E-25, -5.5605E-25, &
      -4.0202E-25, -3.0537E-25, -2.4097E-25, -1.9630E-25, -1.6381E-25, -1.3897E-25, &
      -1.2014E-25, -1.0493E-25, -9.2589E-26, -8.2335E-26, -7.4106E-26, -6.6724E-26, &
      -6.0616E-26, -5.5308E-26, -5.0598E-26, -4.6575E-26, -4.2979E-26, -3.9726E-26, &
      -3.6752E-26, -3.4247E-26, -3.1849E-26, -2.9623E-26, -2.7863E-26, -2.5856E-26, &
      -2.4315E-26, -2.2945E-26, -2.1368E-26, -2.0205E-26, -1.8836E-26, -1.7778E-26, &
      -1.6781E-26, -1.5925E-26, -1.4897E-26, -1.4017E-26, -1.1914E-26, -9.0380E-27, &
      -6.9131E-27, -5.3064E-27, -4.0739E-27, -3.1828E-27, -2.4649E-27, -1.9172E-27, &
      -1.5058E-27, -1.1640E-27, -9.2434E-28, -7.1869E-28, -5.8199E-28, -4.4505E-28, &
      -3.4223E-28 /)
    REAL, PARAMETER :: b3_PAN(dim55) = (/ &
       1.8809E-21,  1.7124E-21,  1.4769E-21,  1.2973E-21,  1.1796E-21,  1.1018E-21, &
       1.0477E-21,  1.0082E-21,  9.7803E-22,  9.5452E-22,  9.3552E-22,  9.1954E-22, &
       9.0634E-22,  8.9477E-22,  8.8467E-22,  8.7568E-22,  8.6798E-22,  8.6065E-22, &
       8.5422E-22,  8.4833E-22,  8.4282E-22,  8.3788E-22,  8.3326E-22,  8.2888E-22, &
       8.2471E-22,  8.2105E-22,  8.1741E-22,  8.1390E-22,  8.1102E-22,  8.0761E-22, &
       8.0491E-22,  8.0243E-22,  7.9948E-22,  7.9724E-22,  7.9452E-22,  7.9235E-22, &
       7.9026E-22,  7.8840E-22,  7.8612E-22,  7.8412E-22,  7.7920E-22,  7.7164E-22, &
       7.6543E-22,  7.6026E-22,  7.5594E-22,  7.5256E-22,  7.4962E-22,  7.4722E-22, &
       7.4530E-22,  7.4360E-22,  7.4234E-22,  7.4120E-22,  7.4040E-22,  7.3956E-22, &
       7.3890E-22 /)
    REAL, PARAMETER :: a4_PAN(4) = (/  4.4927E-22, -7.4797E-26,  1.5700E-29, -1.0998E-33 /)
    REAL, PARAMETER :: a5_PAN(4) = (/  1.0163E-22, -2.2380E-26,  3.9150E-30, -2.5016E-34 /)
    REAL, PARAMETER :: a6_PAN(4) = (/  2.4067E-24, -5.1121E-29,  5.7843E-34,  0.0000E+00 /)
    ! T-dep parameters:
    REAL, PARAMETER :: c0_1_1_PAN(dim58) = (/ &
       2.7940E-02,  2.7940E-02,  2.7940E-02,  3.1706E-02,  3.5826E-02,  3.9605E-02, &
       4.3189E-02,  4.5514E-02,  4.8119E-02,  4.8200E-02,  4.8729E-02,  4.7735E-02, &
       4.6874E-02,  4.4997E-02,  4.3628E-02,  4.2475E-02,  4.1791E-02,  4.1108E-02, &
       4.0518E-02,  4.0762E-02,  4.0066E-02,  3.7870E-02,  3.4663E-02,  2.9041E-02, &
       2.1547E-02,  1.2508E-02,  1.5883E-03, -9.5493E-03, -1.9374E-02, -2.7541E-02, &
      -3.2913E-02, -3.4365E-02, -3.0874E-02, -2.4381E-02, -1.5050E-02, -4.2279E-03, &
       6.4079E-03,  1.3706E-02,  1.7510E-02,  1.5615E-02,  7.3729E-03, -6.5869E-03, &
      -2.5575E-02, -4.6117E-02, -6.5379E-02, -8.0189E-02, -8.8077E-02, -8.9373E-02, &
      -8.6311E-02, -8.1825E-02, -7.9890E-02, -8.2051E-02, -8.7554E-02, -9.2247E-02, &
      -9.1080E-02, -8.0020E-02, -6.3011E-02, -4.9580E-02 /)
    REAL, PARAMETER :: c0_1_2_PAN(dim58) = (/ &
      -8.3395E-01, -8.3395E-01, -8.3395E-01, -1.0019E+00, -1.1865E+00, -1.3565E+00, &
      -1.5185E+00, -1.6241E+00, -1.7429E+00, -1.7466E+00, -1.7709E+00, -1.7250E+00, &
      -1.6851E+00, -1.5976E+00, -1.5335E+00, -1.4793E+00, -1.4470E+00, -1.4146E+00, &
      -1.3866E+00, -1.3982E+00, -1.3648E+00, -1.2590E+00, -1.1038E+00, -8.3055E-01, &
      -4.6481E-01, -2.1936E-02,  5.1533E-01,  1.0655E+00,  1.5528E+00,  1.9596E+00, &
       2.2282E+00,  2.3010E+00,  2.1251E+00,  1.7965E+00,  1.3226E+00,  7.7061E-01, &
       2.2605E-01, -1.4906E-01, -3.4537E-01, -2.4717E-01,  1.8140E-01,  9.1010E-01, &
       1.9051E+00,  2.9856E+00,  4.0026E+00,  4.7875E+00,  5.2072E+00,  5.2764E+00, &
       5.1123E+00,  4.8709E+00,  4.7664E+00,  4.8836E+00,  5.1829E+00,  5.4392E+00, &
       5.3752E+00,  4.7669E+00,  3.8280E+00,  3.0839E+00 /)
    REAL, PARAMETER :: c0_2_1_PAN(dim58) = (/ &
       1.9069E-02,  1.9069E-02,  1.9069E-02,  2.4023E-02,  2.7664E-02,  2.5835E-02, &
       4.0072E-02,  3.0799E-02,  3.4191E-02,  3.1516E-02,  3.1491E-02,  2.3449E-02, &
       2.5218E-02,  1.8529E-02,  1.6521E-02,  8.2129E-03,  4.6126E-03,  2.1552E-03, &
       5.0581E-03, -1.7667E-03,  6.8892E-04, -4.3407E-03, -8.0630E-03, -6.7411E-03, &
      -1.5803E-02, -1.6841E-02, -2.0088E-02, -2.5621E-02, -2.0310E-02, -1.8435E-02, &
      -1.2532E-02, -9.8925E-03, -7.2732E-03, -2.8384E-03,  5.0534E-05,  2.1736E-03, &
      -1.4773E-03, -5.1246E-03, -1.8999E-02, -3.6400E-02, -6.1341E-02, -8.0526E-02, &
      -1.0187E-01, -1.0989E-01, -1.0616E-01, -9.6385E-02, -8.9943E-02, -8.0890E-02, &
      -7.7826E-02, -7.2244E-02, -5.5850E-02, -2.0421E-02,  3.2937E-02,  9.7529E-02, &
       1.4683E-01,  1.5188E-01,  1.1259E-01,  4.7289E-02 /)
    REAL, PARAMETER :: c0_2_2_PAN(dim58) = (/ &
      -7.5298E-01, -7.5298E-01, -7.5298E-01, -9.7391E-01, -1.1370E+00, -1.0547E+00, &
      -1.6982E+00, -1.2773E+00, -1.4319E+00, -1.3094E+00, -1.3083E+00, -9.3673E-01, &
      -1.0188E+00, -7.0709E-01, -6.1314E-01, -2.2264E-01, -5.2708E-02,  6.3774E-02, &
      -7.4404E-02,  2.5182E-01,  1.3395E-01,  3.7638E-01,  5.5654E-01,  4.9229E-01, &
       9.3450E-01,  9.8540E-01,  1.1452E+00,  1.4184E+00,  1.1550E+00,  1.0617E+00, &
       7.6651E-01,  6.3401E-01,  5.0199E-01,  2.7759E-01,  1.3083E-01,  2.2560E-02, &
       2.0948E-01,  3.9696E-01,  1.1129E+00,  2.0142E+00,  3.3112E+00,  4.3126E+00, &
       5.4311E+00,  5.8527E+00,  5.6559E+00,  5.1379E+00,  4.7952E+00,  4.3117E+00, &
       4.1475E+00,  3.8472E+00,  2.9619E+00,  1.0417E+00, -1.8610E+00, -5.3877E+00, &
      -8.0897E+00, -8.3669E+00, -6.1982E+00, -2.5807E+00 /)
    REAL, PARAMETER :: c1_PAN(3) = (/  1.0000E+00,  2.1986E-01,  2.4319E-02 /)
    REAL, PARAMETER :: c2_PAN(3) = (/  9.9977E-01,  1.7399E+00,  1.4721E+00 /)
    REAL, PARAMETER :: c3_PAN(3) = (/  9.9933E-01,  2.3100E+00,  2.5235E+00 /)
    REAL, PARAMETER :: c4_PAN(3) = (/  9.9918E-01,  2.4476E+00,  2.8117E+00 /)
    REAL, PARAMETER :: c5_PAN(3) = (/  9.9852E-01,  2.8790E+00,  3.8056E+00 /)
    REAL, PARAMETER :: c6_PAN(3) = (/  9.9897E-01,  1.3246E+00,  1.9882E+00 /)

    jval_2d(ip_PAN)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_PAN(0) = &
          p2(1.,c0_1_1_PAN(i0(j,k))*dlv2(j,k) + &
          c0_1_2_PAN(i0(j,k)), &
          c0_2_1_PAN(i0(j,k))*dlv2(j,k) + &
          c0_2_2_PAN(i0(j,k)), tnorm_sr(j,k)) * &
          p1(a0_1_1_PAN(i0(j,k))*dlv2(j,k) + &
          a0_1_2_PAN(i0(j,k)), &
          a0_2_1_PAN(i0(j,k))*dlv2(j,k) + &
          a0_2_2_PAN(i0(j,k)),v3_du1(j,k))
        sig_PAN(1) = &
          p2(c1_PAN(1),c1_PAN(2), &
          c1_PAN(3),tnorm(j,k)) * &
          (p1(b1_1_PAN(i1(j,k)),a1_1_PAN(i1(j,k)), &
          v3_du1(j,k)) + &
          p1(b1_2_PAN(i1(j,k)),a1_2_PAN(i1(j,k)), &
          v3_du1(j,k)) * v2s_m(j,k))
        sig_PAN(2) = &
          p2(c2_PAN(1),c2_PAN(2),c2_PAN(3),tnorm(j,k))* &
          p1(b2_PAN(i2(j,k)), a2_PAN(i2(j,k)), &
          v3_du1(j,k))
        sig_PAN(3) = &
          p2(c3_PAN(1),c3_PAN(2),c3_PAN(3),tnorm(j,k))* &
          p1(b3_PAN(i3(j,k)), a3_PAN(i3(j,k)), &
          v3_du2(j,k))
        sig_PAN(4) = &
          p2(c4_PAN(1),c4_PAN(2),c4_PAN(3),tnorm(j,k))* &
          p3(a4_PAN(1),a4_PAN(2),a4_PAN(3), &
          a4_PAN(4),v3_du2(j,k))
        sig_PAN(5) = &
          p2(c5_PAN(1),c5_PAN(2),c5_PAN(3),tnorm(j,k))* &
          p3(a5_PAN(1),a5_PAN(2),a5_PAN(3), &
          a5_PAN(4),v3_du2(j,k))
        sig_PAN(6) = &
          p2(c6_PAN(1),c6_PAN(2),c6_PAN(3),tnorm(j,k))* &
          p3(a6_PAN(1),a6_PAN(2),a6_PAN(3), &
          a6_PAN(4),v3_du2(j,k))
        dj = 0. &
          + sig_PAN(0) * fint(j,k,0) &
          + sig_PAN(1) * fint(j,k,1) &
          + sig_PAN(2) * fint(j,k,2) &
          + sig_PAN(3) * fint(j,k,3) &
          + sig_PAN(4) * fint(j,k,4) &
          + sig_PAN(5) * fint(j,k,5) &
          + sig_PAN(6) * fint(j,k,6)

        jval_2d(ip_PAN)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,6)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_PAN

  ! **************************************************************************

  SUBROUTINE jval_cal_HONO

    ! HONO \TOHV\ \products

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_HONO

    ! T-const parameters:
    REAL, PARAMETER :: a0_1_1_HONO(dim58) = (/ &
       2.5900E-20,  2.7976E-20,  3.0026E-20,  3.2082E-20,  3.4176E-20,  3.6300E-20, &
       3.8173E-20,  4.0271E-20,  4.2136E-20,  4.4064E-20,  4.5784E-20,  4.7495E-20, &
       5.4139E-20,  7.1234E-20,  6.8350E-20,  7.0161E-20,  7.7343E-20,  7.2924E-20, &
       7.3420E-20,  7.9165E-20,  7.2274E-20,  7.0524E-20,  7.4317E-20,  6.4583E-20, &
       6.0524E-20,  4.2895E-20,  3.2518E-20,  2.9300E-20,  2.7014E-20,  2.5605E-20, &
       2.5414E-20,  2.6177E-20,  2.7904E-20,  3.0454E-20,  3.3266E-20,  3.6327E-20, &
       3.9204E-20,  4.1713E-20,  4.3695E-20,  4.5300E-20,  4.6207E-20,  4.6814E-20, &
       4.6786E-20,  4.6370E-20,  4.5364E-20,  4.3853E-20,  4.1762E-20,  3.9287E-20, &
       3.6547E-20,  3.3633E-20,  3.0916E-20,  2.8166E-20,  2.5532E-20,  2.2836E-20, &
       2.0251E-20,  1.7458E-20,  1.4559E-20,  1.2001E-20 /)
    REAL, PARAMETER :: a0_1_2_HONO(dim58) = (/ &
       4.3204E-19,  3.4026E-19,  2.4926E-19,  1.5755E-19,  6.3736E-20, -3.1822E-20, &
      -1.1651E-19, -2.1175E-19, -2.9679E-19, -3.8508E-19, -4.6422E-19, -5.4326E-19, &
      -8.5156E-19, -1.6482E-18, -1.5132E-18, -1.5983E-18, -1.9373E-18, -1.7278E-18, &
      -1.7515E-18, -2.0260E-18, -1.6953E-18, -1.6109E-18, -1.7945E-18, -1.3214E-18, &
      -1.1234E-18, -2.5958E-19,  2.5100E-19,  4.0994E-19,  5.2337E-19,  5.9351E-19, &
       6.0305E-19,  5.6477E-19,  4.7770E-19,  3.4868E-19,  2.0582E-19,  4.9738E-20, &
      -9.7565E-20, -2.2656E-19, -3.2881E-19, -4.1196E-19, -4.5911E-19, -4.9080E-19, &
      -4.8934E-19, -4.6747E-19, -4.1435E-19, -3.3425E-19, -2.2303E-19, -9.0842E-20, &
       5.6044E-20,  2.1279E-19,  3.5949E-19,  5.0858E-19,  6.5185E-19,  7.9903E-19, &
       9.4069E-19,  1.0943E-18,  1.2543E-18,  1.3960E-18 /)
    REAL, PARAMETER :: a0_2_1_HONO(dim58) = (/ &
       1.3039E-22,  1.4381E-22,  1.5848E-22,  1.7497E-22,  1.9316E-22,  2.1162E-22, &
       2.3386E-22,  2.5503E-22,  2.7949E-22,  3.0374E-22,  3.3166E-22,  3.6159E-22, &
       3.1871E-22,  1.2758E-22,  2.3531E-22,  2.7087E-22,  2.3643E-22,  3.4877E-22, &
       3.8999E-22,  3.6186E-22,  4.7415E-22,  5.1363E-22,  4.8236E-22,  5.8489E-22, &
       6.1427E-22,  7.6773E-22,  8.3614E-22,  8.2387E-22,  7.9564E-22,  7.5117E-22, &
       6.8924E-22,  6.1190E-22,  5.2156E-22,  4.2233E-22,  3.2163E-22,  2.2449E-22, &
       1.3788E-22,  6.5165E-23,  8.2611E-24, -3.3034E-23, -5.9361E-23, -7.3881E-23, &
      -7.9474E-23, -7.9868E-23, -7.6729E-23, -7.1743E-23, -6.5727E-23, -5.8778E-23, &
      -5.1907E-23, -4.4823E-23, -3.9221E-23, -3.3467E-23, -2.8458E-23, -2.3477E-23, &
      -1.9442E-23, -1.5096E-23, -1.1858E-23, -9.2367E-24 /)
    REAL, PARAMETER :: a0_2_2_HONO(dim58) = (/ &
      -8.4750E-21, -9.0680E-21, -9.7196E-21, -1.0455E-20, -1.1270E-20, -1.2100E-20, &
      -1.3106E-20, -1.4067E-20, -1.5182E-20, -1.6293E-20, -1.7577E-20, -1.8960E-20, &
      -1.6970E-20, -8.0639E-21, -1.3105E-20, -1.4777E-20, -1.3151E-20, -1.8476E-20, &
      -2.0438E-20, -1.9093E-20, -2.4483E-20, -2.6387E-20, -2.4873E-20, -2.9856E-20, &
      -3.1289E-20, -3.8809E-20, -4.2175E-20, -4.1569E-20, -4.0169E-20, -3.7954E-20, &
      -3.4857E-20, -3.0975E-20, -2.6422E-20, -2.1401E-20, -1.6285E-20, -1.1331E-20, &
      -6.8966E-21, -3.1592E-21, -2.2301E-22,  1.9161E-21,  3.2851E-21,  4.0430E-21, &
       4.3361E-21,  4.3568E-21,  4.1911E-21,  3.9268E-21,  3.6068E-21,  3.2357E-21, &
       2.8674E-21,  2.4863E-21,  2.1838E-21,  1.8719E-21,  1.5994E-21,  1.3275E-21, &
       1.1063E-21,  8.6734E-22,  6.8857E-22,  5.4336E-22 /)
    REAL, PARAMETER :: a1_1_HONO(dim55) = (/ &
       3.3875E-20,  3.1817E-20,  2.9881E-20,  2.6947E-20,  2.4250E-20,  2.1502E-20, &
       1.8883E-20,  1.6765E-20,  1.4607E-20,  1.3116E-20,  1.1406E-20,  1.0447E-20, &
       9.0990E-21,  8.4670E-21,  7.3935E-21,  7.0182E-21,  6.1414E-21,  5.9034E-21, &
       5.1670E-21,  5.0319E-21,  4.4196E-21,  4.3427E-21,  3.8200E-21,  3.8038E-21, &
       3.3112E-21,  3.3464E-21,  2.9048E-21,  2.9694E-21,  2.5670E-21,  2.6446E-21, &
       2.2880E-21,  2.3823E-21,  2.0352E-21,  2.1555E-21,  1.8528E-21,  1.9411E-21, &
       1.6756E-21,  1.7724E-21,  1.5141E-21,  1.6279E-21,  1.3381E-21,  1.1322E-21, &
       9.1739E-22,  8.0584E-22,  6.7124E-22,  6.0687E-22,  5.1090E-22,  4.7183E-22, &
       3.6146E-22,  3.2368E-22,  2.8964E-22,  2.6053E-22,  2.3404E-22,  2.1016E-22, &
       1.9070E-22 /)
    REAL, PARAMETER :: b1_1_HONO(dim55) = (/ &
       1.1711E-18,  1.1772E-18,  1.1879E-18,  1.2114E-18,  1.2397E-18,  1.2754E-18, &
       1.3160E-18,  1.3541E-18,  1.3984E-18,  1.4327E-18,  1.4763E-18,  1.5031E-18, &
       1.5442E-18,  1.5651E-18,  1.6032E-18,  1.6175E-18,  1.6530E-18,  1.6632E-18, &
       1.6967E-18,  1.7032E-18,  1.7341E-18,  1.7382E-18,  1.7672E-18,  1.7681E-18, &
       1.7980E-18,  1.7957E-18,  1.8247E-18,  1.8203E-18,  1.8486E-18,  1.8430E-18, &
       1.8699E-18,  1.8625E-18,  1.8905E-18,  1.8805E-18,  1.9064E-18,  1.8986E-18, &
       1.9226E-18,  1.9136E-18,  1.9383E-18,  1.9271E-18,  1.9563E-18,  1.9795E-18, &
       2.0065E-18,  2.0219E-18,  2.0421E-18,  2.0526E-18,  2.0695E-18,  2.0768E-18, &
       2.0990E-18,  2.1070E-18,  2.1147E-18,  2.1216E-18,  2.1282E-18,  2.1345E-18, &
       2.1399E-18 /)
    REAL, PARAMETER :: a1_2_HONO(dim55) = (/ &
      -4.2075E-23, -7.9246E-24,  3.8546E-24,  2.5926E-23,  3.5287E-23,  4.2798E-23, &
       4.8571E-23,  4.6450E-23,  4.9081E-23,  4.2662E-23,  4.4429E-23,  3.6366E-23, &
       3.8100E-23,  3.0241E-23,  3.2333E-23,  2.5017E-23,  2.7166E-23,  2.0793E-23, &
       2.3130E-23,  1.7550E-23,  1.9699E-23,  1.4883E-23,  1.7013E-23,  1.2655E-23, &
       1.4954E-23,  1.0890E-23,  1.3126E-23,  9.4833E-24,  1.1624E-23,  8.3135E-24, &
       1.0265E-23,  7.3183E-24,  9.1980E-24,  6.4514E-24,  8.1734E-24,  5.7924E-24, &
       7.3706E-24,  5.1576E-24,  6.6877E-24,  4.6082E-24,  4.8931E-24,  3.6008E-24, &
       3.1424E-24,  2.3783E-24,  2.1561E-24,  1.6653E-24,  1.5607E-24,  1.2295E-24, &
       1.4029E-24,  1.2304E-24,  1.0860E-24,  9.6419E-25,  8.6542E-25,  7.8148E-25, &
       7.0596E-25 /)
    REAL, PARAMETER :: b1_2_HONO(dim55) = (/ &
      -2.2838E-21, -2.3862E-21, -2.4510E-21, -2.6276E-21, -2.7259E-21, -2.8235E-21, &
      -2.9130E-21, -2.8748E-21, -2.9288E-21, -2.7811E-21, -2.8262E-21, -2.6004E-21, &
      -2.6533E-21, -2.3940E-21, -2.4683E-21, -2.1902E-21, -2.2773E-21, -2.0032E-21, &
      -2.1096E-21, -1.8417E-21, -1.9503E-21, -1.6950E-21, -1.8132E-21, -1.5605E-21, &
      -1.6996E-21, -1.4435E-21, -1.5900E-21, -1.3423E-21, -1.4932E-21, -1.2515E-21, &
      -1.3988E-21, -1.1690E-21, -1.3203E-21, -1.0923E-21, -1.2396E-21, -1.0301E-21, &
      -1.1729E-21, -9.6707E-22, -1.1132E-21, -9.0941E-22, -9.3804E-22, -7.9201E-22, &
      -7.3448E-22, -6.2904E-22, -5.9560E-22, -5.1559E-22, -4.9724E-22, -4.3496E-22, &
      -4.6974E-22, -4.3300E-22, -4.0042E-22, -3.7144E-22, -3.4670E-22, -3.2462E-22, &
      -3.0382E-22 /)
    REAL, PARAMETER :: a2_HONO(dim55) = (/ &
      -3.5936E-21, -3.0592E-21, -2.4396E-21, -1.8432E-21, -1.3380E-21, -9.4560E-22, &
      -6.5920E-22, -4.5800E-22, -3.1960E-22, -2.2600E-22, -1.6320E-22, -1.2080E-22, &
      -9.1600E-23, -7.1600E-23, -5.7200E-23, -4.7200E-23, -4.0000E-23, -3.4400E-23, &
      -3.0000E-23, -2.6400E-23, -2.3600E-23, -2.1200E-23, -1.9600E-23, -1.7600E-23, &
      -1.6400E-23, -1.4800E-23, -1.4000E-23, -1.2800E-23, -1.1600E-23, -1.1200E-23, &
      -1.0400E-23, -9.6000E-24, -8.8000E-24, -8.4000E-24, -7.6000E-24, -7.6000E-24, &
      -6.8000E-24, -6.4000E-24, -6.0000E-24, -5.6000E-24, -4.6400E-24, -3.3600E-24, &
      -2.4000E-24, -1.7600E-24, -1.2800E-24, -9.6000E-25, -6.4000E-25, -5.6000E-25, &
      -3.2000E-25, -2.4000E-25, -2.4000E-25, -8.0000E-26, -1.6000E-25, -8.0000E-26, &
       0.0000E+00 /)
    REAL, PARAMETER :: b2_HONO(dim55) = (/ &
       5.2882E-20,  5.1279E-20,  4.7871E-20,  4.3100E-20,  3.7795E-20,  3.2694E-20, &
       2.8255E-20,  2.4633E-20,  2.1796E-20,  1.9643E-20,  1.8042E-20,  1.6854E-20, &
       1.5964E-20,  1.5304E-20,  1.4793E-20,  1.4413E-20,  1.4121E-20,  1.3880E-20, &
       1.3680E-20,  1.3507E-20,  1.3366E-20,  1.3239E-20,  1.3150E-20,  1.3034E-20, &
       1.2961E-20,  1.2860E-20,  1.2808E-20,  1.2726E-20,  1.2642E-20,  1.2613E-20, &
       1.2552E-20,  1.2490E-20,  1.2425E-20,  1.2392E-20,  1.2324E-20,  1.2324E-20, &
       1.2251E-20,  1.2214E-20,  1.2176E-20,  1.2137E-20,  1.2040E-20,  1.1896E-20, &
       1.1775E-20,  1.1687E-20,  1.1615E-20,  1.1562E-20,  1.1506E-20,  1.1491E-20, &
       1.1443E-20,  1.1426E-20,  1.1426E-20,  1.1388E-20,  1.1408E-20,  1.1387E-20, &
       1.1365E-20 /)
    REAL, PARAMETER :: a3_HONO(dim55) = (/ &
       1.1649E-23,  1.2742E-23,  1.1051E-23,  9.0091E-24,  7.3673E-24,  6.1441E-24, &
       5.2542E-24,  4.5875E-24,  4.0390E-24,  3.6283E-24,  3.2865E-24,  2.9950E-24, &
       2.7554E-24,  2.5334E-24,  2.3447E-24,  2.1739E-24,  2.0195E-24,  1.8820E-24, &
       1.7808E-24,  1.6438E-24,  1.5556E-24,  1.4555E-24,  1.3699E-24,  1.3014E-24, &
       1.2137E-24,  1.1473E-24,  1.0959E-24,  1.0274E-24,  9.5726E-25,  9.2466E-25, &
       8.7329E-25,  8.2192E-25,  7.6923E-25,  7.3630E-25,  7.0205E-25,  6.6667E-25, &
       6.3356E-25,  5.9932E-25,  5.6507E-25,  5.4701E-25,  4.6217E-25,  3.6289E-25, &
       2.7721E-25,  2.1910E-25,  1.7117E-25,  1.3347E-25,  1.0613E-25,  8.2164E-26, &
       6.5024E-26,  5.1352E-26,  3.7658E-26,  3.0801E-26,  2.7388E-26,  1.7117E-26, &
       1.7112E-26 /)
    REAL, PARAMETER :: b3_HONO(dim55) = (/ &
       7.1777E-21,  7.1133E-21,  7.3117E-21,  7.6706E-21,  8.0551E-21,  8.4131E-21, &
       8.7255E-21,  8.9985E-21,  9.2551E-21,  9.4713E-21,  9.6711E-21,  9.8586E-21, &
       1.0027E-20,  1.0196E-20,  1.0350E-20,  1.0500E-20,  1.0644E-20,  1.0781E-20, &
       1.0887E-20,  1.1039E-20,  1.1143E-20,  1.1265E-20,  1.1375E-20,  1.1468E-20, &
       1.1591E-20,  1.1688E-20,  1.1766E-20,  1.1874E-20,  1.1989E-20,  1.2044E-20, &
       1.2134E-20,  1.2227E-20,  1.2325E-20,  1.2389E-20,  1.2457E-20,  1.2529E-20, &
       1.2599E-20,  1.2673E-20,  1.2749E-20,  1.2790E-20,  1.2989E-20,  1.3250E-20, &
       1.3500E-20,  1.3687E-20,  1.3855E-20,  1.3998E-20,  1.4110E-20,  1.4215E-20, &
       1.4295E-20,  1.4363E-20,  1.4435E-20,  1.4473E-20,  1.4493E-20,  1.4556E-20, &
       1.4556E-20 /)
    REAL, PARAMETER :: a4_HONO(4) = (/  1.8267E-20,  3.2468E-24, -6.5574E-28,  4.4624E-32 /)
    REAL, PARAMETER :: a5_HONO(4) = (/  5.9480E-20,  5.3968E-24, -9.3457E-28,  5.6612E-32 /)
    REAL, PARAMETER :: a6_HONO(4) = (/  5.9858E-20, -1.9786E-25,  2.1746E-30, -1.8372E-35 /)

    jval_2d(ip_HONO)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_HONO(0) = &
          p1(a0_1_1_HONO(i0(j,k))*dlv2(j,k) + &
          a0_1_2_HONO(i0(j,k)), &
          a0_2_1_HONO(i0(j,k))*dlv2(j,k) + &
          a0_2_2_HONO(i0(j,k)),v3_du1(j,k))
        sig_HONO(1) = &
          (p1(b1_1_HONO(i1(j,k)),a1_1_HONO(i1(j,k)), &
          v3_du1(j,k)) + &
          p1(b1_2_HONO(i1(j,k)),a1_2_HONO(i1(j,k)), &
          v3_du1(j,k)) * v2s_m(j,k))
        sig_HONO(2) = &
          p1(b2_HONO(i2(j,k)), a2_HONO(i2(j,k)), &
          v3_du1(j,k))
        sig_HONO(3) = &
          p1(b3_HONO(i3(j,k)), a3_HONO(i3(j,k)), &
          v3_du2(j,k))
        sig_HONO(4) = &
          p3(a4_HONO(1),a4_HONO(2),a4_HONO(3), &
          a4_HONO(4),v3_du2(j,k))
        sig_HONO(5) = &
          p3(a5_HONO(1),a5_HONO(2),a5_HONO(3), &
          a5_HONO(4),v3_du2(j,k))
        sig_HONO(6) = &
          p3(a6_HONO(1),a6_HONO(2),a6_HONO(3), &
          a6_HONO(4),v3_du2(j,k))
        dj = 0. &
          + sig_HONO(0) * fint(j,k,0) &
          + sig_HONO(1) * fint(j,k,1) &
          + sig_HONO(2) * fint(j,k,2) &
          + sig_HONO(3) * fint(j,k,3) &
          + sig_HONO(4) * fint(j,k,4) &
          + sig_HONO(5) * fint(j,k,5) &
          + sig_HONO(6) * fint(j,k,6)

        jval_2d(ip_HONO)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,1)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_HONO

  ! **************************************************************************

  SUBROUTINE jval_cal_CH3OOH

    ! CH_3OOH \TOHV\ \products

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_CH3OOH

    ! T-const parameters:
    REAL, PARAMETER :: a1_1_CH3OOH(dim55) = (/ &
       2.1565E-21,  1.9480E-21,  1.6544E-21,  1.4110E-21,  1.0734E-21,  8.7625E-22, &
       5.6661E-22,  4.4176E-22,  1.7921E-22,  1.2013E-22, -9.6269E-23, -1.0805E-22, &
      -2.9160E-22, -2.7041E-22, -4.2482E-22, -3.8745E-22, -5.1937E-22, -4.7139E-22, &
      -5.8821E-22, -5.3165E-22, -6.3638E-22, -5.7710E-22, -6.7160E-22, -6.0902E-22, &
      -6.9351E-22, -6.3303E-22, -7.0914E-22, -6.4790E-22, -7.1816E-22, -6.5845E-22, &
      -7.2244E-22, -6.6376E-22, -7.2204E-22, -6.6662E-22, -7.1809E-22, -6.6612E-22, &
      -7.1244E-22, -6.6293E-22, -7.0367E-22, -6.5928E-22, -6.6877E-22, -6.3634E-22, &
      -6.0952E-22, -5.7428E-22, -5.4090E-22, -5.0791E-22, -4.7143E-22, -4.4286E-22, &
      -3.9079E-22, -3.5373E-22, -3.1942E-22, -2.8773E-22, -2.5865E-22, -2.3206E-22, &
      -2.0786E-22 /)
    REAL, PARAMETER :: b1_1_CH3OOH(dim55) = (/ &
       1.1792E-19,  1.1854E-19,  1.2016E-19,  1.2211E-19,  1.2565E-19,  1.2821E-19, &
       1.3301E-19,  1.3526E-19,  1.4064E-19,  1.4200E-19,  1.4752E-19,  1.4785E-19, &
       1.5345E-19,  1.5275E-19,  1.5823E-19,  1.5681E-19,  1.6215E-19,  1.6009E-19, &
       1.6540E-19,  1.6269E-19,  1.6798E-19,  1.6484E-19,  1.7008E-19,  1.6645E-19, &
       1.7156E-19,  1.6775E-19,  1.7274E-19,  1.6857E-19,  1.7353E-19,  1.6917E-19, &
       1.7400E-19,  1.6942E-19,  1.7411E-19,  1.6951E-19,  1.7391E-19,  1.6934E-19, &
       1.7353E-19,  1.6893E-19,  1.7282E-19,  1.6847E-19,  1.6942E-19,  1.6576E-19, &
       1.6239E-19,  1.5753E-19,  1.5251E-19,  1.4713E-19,  1.4073E-19,  1.3536E-19, &
       1.2491E-19,  1.1702E-19,  1.0928E-19,  1.0174E-19,  9.4459E-20,  8.7465E-20, &
       8.0799E-20 /)
    REAL, PARAMETER :: a1_2_CH3OOH(dim55) = (/ &
       1.4449E-24,  3.1226E-24,  5.4328E-24,  5.7077E-24,  7.7119E-24,  6.6343E-24, &
       8.2220E-24,  6.3587E-24,  7.6905E-24,  5.5383E-24,  6.7500E-24,  4.6097E-24, &
       5.7836E-24,  3.7868E-24,  4.8902E-24,  3.0948E-24,  4.1338E-24,  2.5287E-24, &
       3.5221E-24,  2.0662E-24,  3.0036E-24,  1.7025E-24,  2.5730E-24,  1.4014E-24, &
       2.1839E-24,  1.1621E-24,  1.8747E-24,  9.4449E-25,  1.6026E-24,  7.6887E-25, &
       1.3689E-24,  6.1637E-25,  1.1616E-24,  4.9095E-25,  9.7680E-25,  3.8565E-25, &
       8.1489E-25,  2.9039E-25,  6.6995E-25,  2.1594E-25,  3.0375E-25,  7.0767E-26, &
      -3.1400E-26, -1.5085E-25, -2.2317E-25, -2.7370E-25, -3.3534E-25, -3.4097E-25, &
      -4.8054E-25, -5.2779E-25, -5.5984E-25, -5.7956E-25, -5.8850E-25, -5.8879E-25, &
      -5.8185E-25 /)
    REAL, PARAMETER :: b1_2_CH3OOH(dim55) = (/ &
      -1.4316E-22, -1.4819E-22, -1.6090E-22, -1.6310E-22, -1.8414E-22, -1.7013E-22, &
      -1.9474E-22, -1.6120E-22, -1.8851E-22, -1.3900E-22, -1.6990E-22, -1.0997E-22, &
      -1.4578E-22, -7.9885E-23, -1.1906E-22, -5.0829E-23, -9.2908E-23, -2.3890E-23, &
      -6.9091E-23,  7.9058E-25, -4.6546E-23,  2.2410E-23, -2.5900E-23,  4.2052E-23, &
      -5.2856E-24,  5.9085E-23,  1.2409E-23,  7.5664E-23,  2.9266E-23,  9.0130E-23, &
       4.4825E-23,  1.0352E-22,  5.9636E-23,  1.1530E-22,  7.3757E-23,  1.2578E-22, &
       8.6932E-23,  1.3571E-22,  9.9463E-23,  1.4396E-22,  1.3513E-22,  1.6146E-22, &
       1.7428E-22,  1.9076E-22,  2.0165E-22,  2.0988E-22,  2.2070E-22,  2.2176E-22, &
       2.4974E-22,  2.5981E-22,  2.6704E-22,  2.7173E-22,  2.7397E-22,  2.7404E-22, &
       2.7213E-22 /)
    REAL, PARAMETER :: a2_CH3OOH(dim55) = (/ &
      -7.2440E-22, -6.3440E-22, -5.2200E-22, -4.0880E-22, -3.0880E-22, -2.2828E-22, &
      -1.6728E-22, -1.2268E-22, -9.0720E-23, -6.8120E-23, -5.2080E-23, -4.0680E-23, &
      -3.2440E-23, -2.6400E-23, -2.1880E-23, -1.8520E-23, -1.5840E-23, -1.3800E-23, &
      -1.2120E-23, -1.0720E-23, -9.6400E-24, -8.6400E-24, -7.8800E-24, -7.1600E-24, &
      -6.5200E-24, -6.0000E-24, -5.5600E-24, -5.0800E-24, -4.7200E-24, -4.4000E-24, &
      -4.0800E-24, -3.7600E-24, -3.5200E-24, -3.2800E-24, -3.0800E-24, -2.8400E-24, &
      -2.6800E-24, -2.4800E-24, -2.3600E-24, -2.1600E-24, -1.8000E-24, -1.3040E-24, &
      -9.3600E-25, -6.8800E-25, -4.9600E-25, -3.6000E-25, -2.6400E-25, -1.8400E-25, &
      -1.4400E-25, -9.6000E-26, -7.2000E-26, -5.6000E-26, -3.2000E-26, -3.2000E-26, &
      -1.6000E-26 /)
    REAL, PARAMETER :: b2_CH3OOH(dim55) = (/ &
       1.7150E-20,  1.6880E-20,  1.6262E-20,  1.5356E-20,  1.4306E-20,  1.3260E-20, &
       1.2314E-20,  1.1511E-20,  1.0856E-20,  1.0336E-20,  9.9273E-21,  9.6081E-21, &
       9.3568E-21,  9.1575E-21,  8.9970E-21,  8.8694E-21,  8.7608E-21,  8.6731E-21, &
       8.5967E-21,  8.5295E-21,  8.4749E-21,  8.4219E-21,  8.3797E-21,  8.3380E-21, &
       8.2993E-21,  8.2665E-21,  8.2377E-21,  8.2050E-21,  8.1797E-21,  8.1563E-21, &
       8.1321E-21,  8.1072E-21,  8.0879E-21,  8.0679E-21,  8.0508E-21,  8.0297E-21, &
       8.0152E-21,  7.9966E-21,  7.9852E-21,  7.9656E-21,  7.9294E-21,  7.8734E-21, &
       7.8272E-21,  7.7929E-21,  7.7640E-21,  7.7419E-21,  7.7250E-21,  7.7100E-21, &
       7.7020E-21,  7.6917E-21,  7.6863E-21,  7.6825E-21,  7.6765E-21,  7.6765E-21, &
       7.6721E-21 /)
    REAL, PARAMETER :: a3_CH3OOH(dim55) = (/ &
      -9.4665E-24, -6.0182E-24, -3.4451E-24, -2.0657E-24, -1.3489E-24, -9.5157E-25, &
      -7.1196E-25, -5.5632E-25, -4.5182E-25, -3.7652E-25, -3.2010E-25, -2.7554E-25, &
      -2.4303E-25, -2.1397E-25, -1.9168E-25, -1.7117E-25, -1.5574E-25, -1.4200E-25, &
      -1.2842E-25, -1.1815E-25, -1.0940E-25, -1.0103E-25, -9.4178E-26, -8.5616E-26, &
      -8.0342E-26, -7.5342E-26, -7.0205E-26, -6.6781E-26, -5.9829E-26, -5.8219E-26, &
      -5.3082E-26, -5.1370E-26, -4.7863E-26, -4.4521E-26, -4.2808E-26, -3.9316E-26, &
      -3.7671E-26, -3.5959E-26, -3.2534E-26, -3.2479E-26, -2.6703E-26, -2.0199E-26, &
      -1.5400E-26, -1.1982E-26, -9.2434E-27, -7.1869E-27, -5.4776E-27, -4.4505E-27, &
      -3.4223E-27, -2.7388E-27, -2.0541E-27, -1.3689E-27, -1.3694E-27, -1.0270E-27, &
      -6.8446E-28 /)
    REAL, PARAMETER :: b3_CH3OOH(dim55) = (/ &
       4.8445E-21,  4.6413E-21,  4.3394E-21,  4.0969E-21,  3.9290E-21,  3.8128E-21, &
       3.7286E-21,  3.6649E-21,  3.6160E-21,  3.5764E-21,  3.5434E-21,  3.5147E-21, &
       3.4919E-21,  3.4698E-21,  3.4516E-21,  3.4336E-21,  3.4192E-21,  3.4055E-21, &
       3.3912E-21,  3.3798E-21,  3.3696E-21,  3.3593E-21,  3.3505E-21,  3.3390E-21, &
       3.3316E-21,  3.3243E-21,  3.3165E-21,  3.3111E-21,  3.2997E-21,  3.2970E-21, &
       3.2880E-21,  3.2849E-21,  3.2783E-21,  3.2719E-21,  3.2685E-21,  3.2613E-21, &
       3.2579E-21,  3.2542E-21,  3.2465E-21,  3.2464E-21,  3.2329E-21,  3.2158E-21, &
       3.2018E-21,  3.1908E-21,  3.1812E-21,  3.1734E-21,  3.1664E-21,  3.1619E-21, &
       3.1571E-21,  3.1537E-21,  3.1501E-21,  3.1463E-21,  3.1463E-21,  3.1442E-21, &
       3.1420E-21 /)
    REAL, PARAMETER :: a4_CH3OOH(4) = (/  2.4415E-21, -2.1336E-25,  4.3788E-29, -3.0383E-33 /)
    REAL, PARAMETER :: a5_CH3OOH(4) = (/  1.0322E-21, -1.2689E-25,  2.0832E-29, -1.2963E-33 /)
    REAL, PARAMETER :: a6_CH3OOH(4) = (/  7.8569E-23, -8.6787E-28,  9.7042E-33, -6.3855E-38 /)

    jval_2d(ip_CH3OOH)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_CH3OOH(1) = &
          (p1(b1_1_CH3OOH(i1(j,k)),a1_1_CH3OOH(i1(j,k)), &
          v3_du1(j,k)) + &
          p1(b1_2_CH3OOH(i1(j,k)),a1_2_CH3OOH(i1(j,k)), &
          v3_du1(j,k)) * v2s_m(j,k))
        sig_CH3OOH(2) = &
          p1(b2_CH3OOH(i2(j,k)), a2_CH3OOH(i2(j,k)), &
          v3_du1(j,k))
        sig_CH3OOH(3) = &
          p1(b3_CH3OOH(i3(j,k)), a3_CH3OOH(i3(j,k)), &
          v3_du2(j,k))
        sig_CH3OOH(4) = &
          p3(a4_CH3OOH(1),a4_CH3OOH(2),a4_CH3OOH(3), &
          a4_CH3OOH(4),v3_du2(j,k))
        sig_CH3OOH(5) = &
          p3(a5_CH3OOH(1),a5_CH3OOH(2),a5_CH3OOH(3), &
          a5_CH3OOH(4),v3_du2(j,k))
        sig_CH3OOH(6) = &
          p3(a6_CH3OOH(1),a6_CH3OOH(2),a6_CH3OOH(3), &
          a6_CH3OOH(4),v3_du2(j,k))
        dj = 0. &
          + sig_CH3OOH(1) * fint(j,k,1) &
          + sig_CH3OOH(2) * fint(j,k,2) &
          + sig_CH3OOH(3) * fint(j,k,3) &
          + sig_CH3OOH(4) * fint(j,k,4) &
          + sig_CH3OOH(5) * fint(j,k,5) &
          + sig_CH3OOH(6) * fint(j,k,6)

        jval_2d(ip_CH3OOH)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,4)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_CH3OOH

  ! **************************************************************************

  SUBROUTINE jval_cal_COH2

    ! HCHO \TOHV\ CO + H_2

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_COH2

    ! T-const parameters:
    REAL, PARAMETER :: a2_COH2(dim55) = (/ &
       1.5880E-22,  1.3604E-22,  1.0868E-22,  8.1760E-23,  5.8440E-23,  4.0000E-23, &
       2.6280E-23,  1.6480E-23,  9.7200E-24,  5.0400E-24,  1.8800E-24, -2.0000E-25, &
      -1.6000E-24, -2.5600E-24, -3.1200E-24, -3.4800E-24, -3.7200E-24, -3.8400E-24, &
      -3.8800E-24, -3.8400E-24, -3.7600E-24, -3.7200E-24, -3.6000E-24, -3.4800E-24, &
      -3.4000E-24, -3.2400E-24, -3.0800E-24, -3.0000E-24, -2.8400E-24, -2.7200E-24, &
      -2.6000E-24, -2.4400E-24, -2.3600E-24, -2.2400E-24, -2.1200E-24, -2.0000E-24, &
      -1.8800E-24, -1.8000E-24, -1.7200E-24, -1.6000E-24, -1.3600E-24, -1.0160E-24, &
      -7.5200E-25, -5.5200E-25, -4.0000E-25, -2.9600E-25, -2.1600E-25, -1.6000E-25, &
      -1.1200E-25, -8.0000E-26, -6.4000E-26, -4.0000E-26, -3.2000E-26, -2.4000E-26, &
      -1.6000E-26 /)
    REAL, PARAMETER :: b2_COH2(dim55) = (/ &
       5.3719E-21,  5.4402E-21,  5.5907E-21,  5.8060E-21,  6.0509E-21,  6.2906E-21, &
       6.5033E-21,  6.6797E-21,  6.8182E-21,  6.9259E-21,  7.0065E-21,  7.0647E-21, &
       7.1074E-21,  7.1391E-21,  7.1590E-21,  7.1726E-21,  7.1824E-21,  7.1875E-21, &
       7.1893E-21,  7.1874E-21,  7.1834E-21,  7.1813E-21,  7.1746E-21,  7.1676E-21, &
       7.1628E-21,  7.1527E-21,  7.1422E-21,  7.1368E-21,  7.1255E-21,  7.1168E-21, &
       7.1077E-21,  7.0952E-21,  7.0888E-21,  7.0788E-21,  7.0686E-21,  7.0580E-21, &
       7.0471E-21,  7.0397E-21,  7.0321E-21,  7.0203E-21,  6.9962E-21,  6.9573E-21, &
       6.9242E-21,  6.8966E-21,  6.8737E-21,  6.8567E-21,  6.8427E-21,  6.8322E-21, &
       6.8226E-21,  6.8157E-21,  6.8121E-21,  6.8064E-21,  6.8044E-21,  6.8023E-21, &
       6.8001E-21 /)
    REAL, PARAMETER :: a3_COH2(dim55) = (/ &
       7.2723E-24,  7.0589E-24,  6.6353E-24,  6.2417E-24,  5.8251E-24,  5.3688E-24, &
       4.8776E-24,  4.4163E-24,  3.9534E-24,  3.5256E-24,  3.1154E-24,  2.7554E-24, &
       2.4303E-24,  2.1226E-24,  1.8484E-24,  1.6262E-24,  1.4034E-24,  1.2147E-24, &
       1.0445E-24,  8.9041E-25,  7.5214E-25,  6.3356E-25,  5.4795E-25,  4.2808E-25, &
       3.5897E-25,  2.9110E-25,  2.2260E-25,  1.7123E-25,  1.1966E-25,  6.8493E-26, &
       5.1370E-26,  0.0000E+00, -1.7094E-26, -5.1370E-26, -6.8493E-26, -8.5470E-26, &
      -8.5616E-26, -1.1986E-25, -1.1986E-25, -1.1966E-25, -1.4379E-25, -1.5063E-25, &
      -1.4031E-25, -1.2667E-25, -1.0955E-25, -8.8980E-26, -7.5317E-26, -6.1623E-26, &
      -5.1335E-26, -3.7658E-26, -3.4235E-26, -2.3956E-26, -2.0541E-26, -1.7117E-26, &
      -1.3689E-26 /)
    REAL, PARAMETER :: b3_COH2(dim55) = (/ &
       7.8137E-21,  7.8262E-21,  7.8759E-21,  7.9451E-21,  8.0427E-21,  8.1762E-21, &
       8.3487E-21,  8.5376E-21,  8.7541E-21,  8.9793E-21,  9.2192E-21,  9.4507E-21, &
       9.6789E-21,  9.9127E-21,  1.0137E-20,  1.0332E-20,  1.0540E-20,  1.0728E-20, &
       1.0907E-20,  1.1078E-20,  1.1240E-20,  1.1385E-20,  1.1495E-20,  1.1657E-20, &
       1.1753E-20,  1.1853E-20,  1.1957E-20,  1.2038E-20,  1.2122E-20,  1.2209E-20, &
       1.2239E-20,  1.2332E-20,  1.2364E-20,  1.2430E-20,  1.2464E-20,  1.2499E-20, &
       1.2499E-20,  1.2573E-20,  1.2573E-20,  1.2573E-20,  1.2629E-20,  1.2647E-20, &
       1.2617E-20,  1.2573E-20,  1.2513E-20,  1.2435E-20,  1.2379E-20,  1.2319E-20, &
       1.2271E-20,  1.2203E-20,  1.2185E-20,  1.2128E-20,  1.2108E-20,  1.2087E-20, &
       1.2065E-20 /)
    REAL, PARAMETER :: a4_COH2(4) = (/  4.6702E-21, -8.3706E-25,  2.3508E-28, -1.8112E-32 /)
    REAL, PARAMETER :: a5_COH2(4) = (/  1.0147E-20, -3.4020E-25,  1.9495E-29, -2.4577E-33 /)
    REAL, PARAMETER :: a6_COH2(4) = (/  8.9740E-22, -2.2724E-26,  3.1317E-31, -2.4796E-36 /)
    ! T-dep parameters:
    REAL, PARAMETER :: c2_COH2(3) = (/  1.0000E+00, -1.1444E-02, -1.4307E-04 /)
    REAL, PARAMETER :: c3_COH2(3) = (/  9.9999E-01, -4.8736E-02, -8.3588E-03 /)
    REAL, PARAMETER :: c4_COH2(3) = (/  1.0000E+00,  3.2473E-02,  7.4068E-03 /)
    REAL, PARAMETER :: c5_COH2(3) = (/  9.9999E-01,  3.2488E-02,  6.6812E-04 /)
    REAL, PARAMETER :: c6_COH2(3) = (/  1.0000E+00,  3.2705E-02,  7.2248E-04 /)

    jval_2d(ip_COH2)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_COH2(2) = &
          p2(c2_COH2(1),c2_COH2(2),c2_COH2(3),tnorm(j,k))* &
          p1(b2_COH2(i2(j,k)), a2_COH2(i2(j,k)), &
          v3_du1(j,k))
        sig_COH2(3) = &
          p2(c3_COH2(1),c3_COH2(2),c3_COH2(3),tnorm(j,k))* &
          p1(b3_COH2(i3(j,k)), a3_COH2(i3(j,k)), &
          v3_du2(j,k))
        sig_COH2(4) = &
          p2(c4_COH2(1),c4_COH2(2),c4_COH2(3),tnorm(j,k))* &
          p3(a4_COH2(1),a4_COH2(2),a4_COH2(3), &
          a4_COH2(4),v3_du2(j,k))
        sig_COH2(5) = &
          p2(c5_COH2(1),c5_COH2(2),c5_COH2(3),tnorm(j,k))* &
          p3(a5_COH2(1),a5_COH2(2),a5_COH2(3), &
          a5_COH2(4),v3_du2(j,k))
        sig_COH2(6) = &
          p2(c6_COH2(1),c6_COH2(2),c6_COH2(3),tnorm(j,k))* &
          p3(a6_COH2(1),a6_COH2(2),a6_COH2(3), &
          a6_COH2(4),v3_du2(j,k))
        dj = 0. &
          + sig_COH2(2) * fint(j,k,2) &
          + sig_COH2(3) * fint(j,k,3) &
          + sig_COH2(4) * fint(j,k,4) &
          + sig_COH2(5) * fint(j,k,5) &
          + sig_COH2(6) * fint(j,k,6)

        jval_2d(ip_COH2)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,4)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_COH2

  ! **************************************************************************

  SUBROUTINE jval_cal_CHOH

    ! HCHO \TOHV\ CHO + H

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_CHOH

    ! T-const parameters:
    REAL, PARAMETER :: a2_CHOH(dim55) = (/ &
       4.9752E-22,  4.5692E-22,  3.9400E-22,  3.2280E-22,  2.5480E-22,  1.9600E-22, &
       1.4920E-22,  1.1280E-22,  8.5600E-23,  6.5600E-23,  5.0000E-23,  3.9200E-23, &
       3.0400E-23,  2.4000E-23,  1.9200E-23,  1.5600E-23,  1.2400E-23,  1.0400E-23, &
       8.0000E-24,  6.8000E-24,  6.0000E-24,  4.4000E-24,  4.0000E-24,  3.2000E-24, &
       2.4000E-24,  2.4000E-24,  1.6000E-24,  1.6000E-24,  1.2000E-24,  1.2000E-24, &
       8.0000E-25,  4.0000E-25,  8.0000E-25,  4.0000E-25,  4.0000E-25,  0.0000E+00, &
       4.0000E-25,  0.0000E+00,  0.0000E+00,  0.0000E+00,  0.0000E+00,  0.0000E+00, &
      -8.0000E-26, -8.0000E-26, -8.0000E-26,  0.0000E+00, -8.0000E-26,  0.0000E+00, &
       0.0000E+00,  0.0000E+00, -8.0000E-26,  0.0000E+00,  0.0000E+00,  0.0000E+00, &
       0.0000E+00 /)
    REAL, PARAMETER :: b2_CHOH(dim55) = (/ &
       8.3301E-21,  8.4519E-21,  8.7980E-21,  9.3676E-21,  1.0082E-20,  1.0846E-20, &
       1.1571E-20,  1.2227E-20,  1.2784E-20,  1.3244E-20,  1.3642E-20,  1.3944E-20, &
       1.4213E-20,  1.4424E-20,  1.4594E-20,  1.4731E-20,  1.4861E-20,  1.4947E-20, &
       1.5056E-20,  1.5114E-20,  1.5154E-20,  1.5239E-20,  1.5261E-20,  1.5307E-20, &
       1.5356E-20,  1.5356E-20,  1.5408E-20,  1.5408E-20,  1.5436E-20,  1.5436E-20, &
       1.5467E-20,  1.5498E-20,  1.5466E-20,  1.5499E-20,  1.5499E-20,  1.5534E-20, &
       1.5498E-20,  1.5535E-20,  1.5535E-20,  1.5535E-20,  1.5535E-20,  1.5535E-20, &
       1.5545E-20,  1.5545E-20,  1.5545E-20,  1.5532E-20,  1.5546E-20,  1.5531E-20, &
       1.5531E-20,  1.5531E-20,  1.5549E-20,  1.5530E-20,  1.5530E-20,  1.5530E-20, &
       1.5530E-20 /)
    REAL, PARAMETER :: a3_CHOH(dim55) = (/ &
       3.5429E-23,  2.9920E-23,  2.5021E-23,  2.1924E-23,  1.9651E-23,  1.7696E-23, &
       1.5899E-23,  1.4225E-23,  1.2665E-23,  1.1227E-23,  9.9110E-24,  8.7284E-24, &
       7.6673E-24,  6.6929E-24,  5.8360E-24,  5.0668E-24,  4.3642E-24,  3.7810E-24, &
       3.2192E-24,  2.7568E-24,  2.3077E-24,  1.9521E-24,  1.6096E-24,  1.3356E-24, &
       1.0598E-24,  8.2192E-25,  6.3356E-25,  4.6233E-25,  3.0769E-25,  1.7123E-25, &
       6.8493E-26, -5.1370E-26, -1.1966E-25, -2.0548E-25, -2.7397E-25, -3.2479E-25, &
      -3.5959E-25, -4.1096E-25, -4.2808E-25, -4.6154E-25, -4.9983E-25, -5.1010E-25, &
      -4.7912E-25, -4.2109E-25, -3.5947E-25, -3.0459E-25, -2.4991E-25, -2.0199E-25, &
      -1.6769E-25, -1.3352E-25, -1.0613E-25, -8.5558E-26, -6.8470E-26, -5.4776E-26, &
      -4.4490E-26 /)
    REAL, PARAMETER :: b3_CHOH(dim55) = (/ &
       2.3213E-20,  2.3538E-20,  2.4113E-20,  2.4657E-20,  2.5190E-20,  2.5762E-20, &
       2.6392E-20,  2.7078E-20,  2.7808E-20,  2.8565E-20,  2.9334E-20,  3.0095E-20, &
       3.0839E-20,  3.1580E-20,  3.2281E-20,  3.2956E-20,  3.3613E-20,  3.4193E-20, &
       3.4784E-20,  3.5297E-20,  3.5822E-20,  3.6259E-20,  3.6699E-20,  3.7068E-20, &
       3.7454E-20,  3.7802E-20,  3.8088E-20,  3.8358E-20,  3.8611E-20,  3.8843E-20, &
       3.9023E-20,  3.9240E-20,  3.9368E-20,  3.9533E-20,  3.9669E-20,  3.9773E-20, &
       3.9847E-20,  3.9958E-20,  3.9996E-20,  4.0072E-20,  4.0161E-20,  4.0188E-20, &
       4.0098E-20,  3.9911E-20,  3.9695E-20,  3.9487E-20,  3.9263E-20,  3.9053E-20, &
       3.8893E-20,  3.8723E-20,  3.8579E-20,  3.8465E-20,  3.8365E-20,  3.8281E-20, &
       3.8215E-20 /)
    REAL, PARAMETER :: a4_CHOH(4) = (/  1.3309E-20, -3.2149E-24,  8.2717E-28, -6.2224E-32 /)
    REAL, PARAMETER :: a5_CHOH(4) = (/  1.0257E-20, -2.4331E-24,  4.3616E-28, -2.9700E-32 /)
    ! T-dep parameters:
    REAL, PARAMETER :: c2_CHOH(3) = (/  9.9998E-01, -1.6085E-02, -3.9788E-04 /)
    REAL, PARAMETER :: c3_CHOH(3) = (/  1.0000E+00, -4.8692E-02, -8.7605E-03 /)
    REAL, PARAMETER :: c4_CHOH(3) = (/  1.0000E+00,  4.9948E-02,  9.0709E-03 /)
    REAL, PARAMETER :: c5_CHOH(3) = (/  1.0000E+00,  1.2481E-01,  1.4804E-02 /)

    jval_2d(ip_CHOH)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_CHOH(2) = &
          p2(c2_CHOH(1),c2_CHOH(2),c2_CHOH(3),tnorm(j,k))* &
          p1(b2_CHOH(i2(j,k)), a2_CHOH(i2(j,k)), &
          v3_du1(j,k))
        sig_CHOH(3) = &
          p2(c3_CHOH(1),c3_CHOH(2),c3_CHOH(3),tnorm(j,k))* &
          p1(b3_CHOH(i3(j,k)), a3_CHOH(i3(j,k)), &
          v3_du2(j,k))
        sig_CHOH(4) = &
          p2(c4_CHOH(1),c4_CHOH(2),c4_CHOH(3),tnorm(j,k))* &
          p3(a4_CHOH(1),a4_CHOH(2),a4_CHOH(3), &
          a4_CHOH(4),v3_du2(j,k))
        sig_CHOH(5) = &
          p2(c5_CHOH(1),c5_CHOH(2),c5_CHOH(3),tnorm(j,k))* &
          p3(a5_CHOH(1),a5_CHOH(2),a5_CHOH(3), &
          a5_CHOH(4),v3_du2(j,k))
        dj = 0. &
          + sig_CHOH(2) * fint(j,k,2) &
          + sig_CHOH(3) * fint(j,k,3) &
          + sig_CHOH(4) * fint(j,k,4) &
          + sig_CHOH(5) * fint(j,k,5)

        jval_2d(ip_CHOH)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,5)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_CHOH

  ! **************************************************************************

  SUBROUTINE jval_cal_CH3CO3H

    ! CH_3CO_3H \TOHV\ \products

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_CH3CO3H

    ! T-const parameters:
    REAL, PARAMETER :: a1_1_CH3CO3H(dim55) = (/ &
       3.3861E-21,  3.1012E-21,  2.7178E-21,  2.3613E-21,  1.8881E-21,  1.5869E-21, &
       1.1374E-21,  9.3600E-22,  5.5050E-22,  4.4293E-22,  1.2354E-22,  8.3983E-23, &
      -1.8230E-22, -1.7117E-22, -3.9780E-22, -3.5909E-22, -5.5213E-22, -4.9364E-22, &
      -6.6407E-22, -5.9247E-22, -7.4604E-22, -6.6715E-22, -8.0236E-22, -7.2213E-22, &
      -8.4229E-22, -7.6217E-22, -8.6947E-22, -7.9006E-22, -8.8691E-22, -8.1036E-22, &
      -8.9568E-22, -8.2245E-22, -8.9966E-22, -8.2886E-22, -8.9831E-22, -8.3018E-22, &
      -8.9194E-22, -8.2936E-22, -8.8355E-22, -8.2453E-22, -8.4048E-22, -7.9973E-22, &
      -7.6627E-22, -7.2139E-22, -6.7863E-22, -6.3657E-22, -5.8988E-22, -5.5352E-22, &
      -4.8715E-22, -4.4024E-22, -3.9690E-22, -3.5721E-22, -3.2070E-22, -2.8747E-22, &
      -2.5724E-22 /)
    REAL, PARAMETER :: b1_1_CH3CO3H(dim55) = (/ &
       1.2976E-19,  1.3062E-19,  1.3273E-19,  1.3558E-19,  1.4055E-19,  1.4446E-19, &
       1.5143E-19,  1.5506E-19,  1.6296E-19,  1.6543E-19,  1.7358E-19,  1.7468E-19, &
       1.8281E-19,  1.8244E-19,  1.9048E-19,  1.8901E-19,  1.9683E-19,  1.9432E-19, &
       2.0207E-19,  1.9863E-19,  2.0639E-19,  2.0221E-19,  2.0971E-19,  2.0506E-19, &
       2.1233E-19,  2.0728E-19,  2.1431E-19,  2.0891E-19,  2.1574E-19,  2.1015E-19, &
       2.1659E-19,  2.1088E-19,  2.1709E-19,  2.1122E-19,  2.1716E-19,  2.1116E-19, &
       2.1675E-19,  2.1093E-19,  2.1610E-19,  2.1032E-19,  2.1192E-19,  2.0732E-19, &
       2.0312E-19,  1.9693E-19,  1.9049E-19,  1.8363E-19,  1.7544E-19,  1.6861E-19, &
       1.5530E-19,  1.4531E-19,  1.3553E-19,  1.2609E-19,  1.1694E-19,  1.0820E-19, &
       9.9873E-20 /)
    REAL, PARAMETER :: a1_2_CH3CO3H(dim55) = (/ &
       2.5213E-25,  3.2621E-24,  6.4182E-24,  7.3759E-24,  1.0239E-23,  9.1489E-24, &
       1.1435E-23,  9.0594E-24,  1.0949E-23,  8.0644E-24,  9.7258E-24,  6.8362E-24, &
       8.3889E-24,  5.6337E-24,  7.1363E-24,  4.6468E-24,  6.0529E-24,  3.7951E-24, &
       5.1481E-24,  3.1075E-24,  4.3928E-24,  2.5629E-24,  3.7288E-24,  2.1160E-24, &
       3.1772E-24,  1.7493E-24,  2.7036E-24,  1.4327E-24,  2.3033E-24,  1.1709E-24, &
       1.9520E-24,  9.4645E-25,  1.6544E-24,  7.5864E-25,  1.3890E-24,  5.9303E-25, &
       1.1582E-24,  4.5965E-25,  9.5054E-25,  3.3699E-25,  4.4857E-25,  1.2146E-25, &
      -2.2694E-26, -1.8428E-25, -2.8332E-25, -3.4962E-25, -4.2996E-25, -4.3710E-25, &
      -6.1487E-25, -6.7389E-25, -7.1314E-25, -7.3471E-25, -7.4464E-25, -7.4282E-25, &
      -7.3245E-25 /)
    REAL, PARAMETER :: b1_2_CH3CO3H(dim55) = (/ &
      -2.2463E-22, -2.3366E-22, -2.5102E-22, -2.5868E-22, -2.8874E-22, -2.7457E-22, &
      -3.1001E-22, -2.6725E-22, -3.0599E-22, -2.3963E-22, -2.8200E-22, -2.0109E-22, &
      -2.4845E-22, -1.5753E-22, -2.1087E-22, -1.1627E-22, -1.7321E-22, -7.6132E-23, &
      -1.3769E-22, -3.9746E-23, -1.0465E-22, -7.6681E-24, -7.2376E-23,  2.1166E-23, &
      -4.3034E-23,  4.6923E-23, -1.5580E-23,  7.0837E-23,  9.4604E-24,  9.2123E-23, &
       3.3153E-23,  1.1159E-22,  5.4594E-23,  1.2894E-22,  7.5047E-23,  1.4509E-22, &
       9.3947E-23,  1.5891E-22,  1.1203E-22,  1.7216E-22,  1.6095E-22,  1.9791E-22, &
       2.1600E-22,  2.3830E-22,  2.5320E-22,  2.6401E-22,  2.7811E-22,  2.7945E-22, &
       3.1510E-22,  3.2767E-22,  3.3652E-22,  3.4165E-22,  3.4414E-22,  3.4366E-22, &
       3.4080E-22 /)
    REAL, PARAMETER :: a2_CH3CO3H(dim55) = (/ &
      -5.8776E-22, -5.0956E-22, -4.1460E-22, -3.2056E-22, -2.3888E-22, -1.7388E-22, &
      -1.2520E-22, -9.0160E-23, -6.5400E-23, -4.8120E-23, -3.6120E-23, -2.7680E-23, &
      -2.1680E-23, -1.7400E-23, -1.4240E-23, -1.1920E-23, -1.0120E-23, -8.7600E-24, &
      -7.6400E-24, -6.7200E-24, -6.0400E-24, -5.4000E-24, -4.8800E-24, -4.4400E-24, &
      -4.0800E-24, -3.7200E-24, -3.4400E-24, -3.1200E-24, -2.9600E-24, -2.6800E-24, &
      -2.5200E-24, -2.3200E-24, -2.2000E-24, -2.0000E-24, -1.8800E-24, -1.7600E-24, &
      -1.6800E-24, -1.5200E-24, -1.4400E-24, -1.3600E-24, -1.1040E-24, -8.0000E-25, &
      -5.7600E-25, -4.2400E-25, -3.0400E-25, -2.2400E-25, -1.6000E-25, -1.1200E-25, &
      -8.8000E-26, -6.4000E-26, -4.0000E-26, -3.2000E-26, -2.4000E-26, -1.6000E-26, &
      -1.6000E-26 /)
    REAL, PARAMETER :: b2_CH3CO3H(dim55) = (/ &
       1.0333E-20,  1.0098E-20,  9.5760E-21,  8.8237E-21,  7.9660E-21,  7.1210E-21, &
       6.3665E-21,  5.7358E-21,  5.2282E-21,  4.8308E-21,  4.5248E-21,  4.2884E-21, &
       4.1054E-21,  3.9642E-21,  3.8520E-21,  3.7639E-21,  3.6910E-21,  3.6325E-21, &
       3.5815E-21,  3.5374E-21,  3.5030E-21,  3.4691E-21,  3.4402E-21,  3.4147E-21, &
       3.3929E-21,  3.3703E-21,  3.3519E-21,  3.3302E-21,  3.3189E-21,  3.2984E-21, &
       3.2864E-21,  3.2708E-21,  3.2611E-21,  3.2445E-21,  3.2342E-21,  3.2237E-21, &
       3.2164E-21,  3.2016E-21,  3.1939E-21,  3.1861E-21,  3.1604E-21,  3.1260E-21, &
       3.0979E-21,  3.0769E-21,  3.0589E-21,  3.0458E-21,  3.0346E-21,  3.0256E-21, &
       3.0207E-21,  3.0156E-21,  3.0102E-21,  3.0083E-21,  3.0063E-21,  3.0042E-21, &
       3.0042E-21 /)
    REAL, PARAMETER :: a3_CH3CO3H(dim55) = (/ &
      -4.1385E-24, -2.5435E-24, -1.4034E-24, -8.1123E-25, -5.1523E-25, -3.5718E-25, &
      -2.6373E-25, -2.0472E-25, -1.6515E-25, -1.3709E-25, -1.1657E-25, -1.0063E-25, &
      -8.8311E-26, -7.8227E-26, -6.9998E-26, -6.3163E-26, -5.7162E-26, -5.2010E-26, &
      -4.7774E-26, -4.3836E-26, -4.0513E-26, -3.7500E-26, -3.4760E-26, -3.2534E-26, &
      -3.0085E-26, -2.8253E-26, -2.6370E-26, -2.4829E-26, -2.3077E-26, -2.1918E-26, &
      -2.0377E-26, -1.9349E-26, -1.8120E-26, -1.7295E-26, -1.6096E-26, -1.5214E-26, &
      -1.4384E-26, -1.3699E-26, -1.2842E-26, -1.2308E-26, -1.0373E-26, -7.9425E-27, &
      -6.0917E-27, -4.7244E-27, -3.6631E-27, -2.8405E-27, -2.2253E-27, -1.7460E-27, &
      -1.3347E-27, -1.0613E-27, -8.5587E-28, -6.5024E-28, -5.1352E-28, -4.1082E-28, &
      -3.0801E-28 /)
    REAL, PARAMETER :: b3_CH3CO3H(dim55) = (/ &
       1.5601E-21,  1.4661E-21,  1.3323E-21,  1.2282E-21,  1.1589E-21,  1.1126E-21, &
       1.0798E-21,  1.0557E-21,  1.0371E-21,  1.0224E-21,  1.0104E-21,  1.0001E-21, &
       9.9147E-22,  9.8381E-22,  9.7707E-22,  9.7108E-22,  9.6547E-22,  9.6035E-22, &
       9.5589E-22,  9.5151E-22,  9.4763E-22,  9.4393E-22,  9.4041E-22,  9.3742E-22, &
       9.3398E-22,  9.3130E-22,  9.2844E-22,  9.2601E-22,  9.2314E-22,  9.2118E-22, &
       9.1848E-22,  9.1662E-22,  9.1432E-22,  9.1272E-22,  9.1034E-22,  9.0854E-22, &
       9.0679E-22,  9.0531E-22,  9.0341E-22,  9.0219E-22,  8.9767E-22,  8.9128E-22, &
       8.8587E-22,  8.8147E-22,  8.7775E-22,  8.7463E-22,  8.7211E-22,  8.7001E-22, &
       8.6809E-22,  8.6673E-22,  8.6565E-22,  8.6451E-22,  8.6371E-22,  8.6308E-22, &
       8.6242E-22 /)
    REAL, PARAMETER :: a4_CH3CO3H(4) = (/  5.9703E-22, -8.5926E-26,  1.7491E-29, -1.1950E-33 /)
    REAL, PARAMETER :: a5_CH3CO3H(4) = (/  1.8645E-22, -3.3899E-26,  5.9590E-30, -3.7923E-34 /)
    REAL, PARAMETER :: a6_CH3CO3H(4) = (/  1.5834E-24, -5.0586E-29,  7.6084E-34,  0.0000E+00 /)

    jval_2d(ip_CH3CO3H)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_CH3CO3H(1) = &
          (p1(b1_1_CH3CO3H(i1(j,k)),a1_1_CH3CO3H(i1(j,k)), &
          v3_du1(j,k)) + &
          p1(b1_2_CH3CO3H(i1(j,k)),a1_2_CH3CO3H(i1(j,k)), &
          v3_du1(j,k)) * v2s_m(j,k))
        sig_CH3CO3H(2) = &
          p1(b2_CH3CO3H(i2(j,k)), a2_CH3CO3H(i2(j,k)), &
          v3_du1(j,k))
        sig_CH3CO3H(3) = &
          p1(b3_CH3CO3H(i3(j,k)), a3_CH3CO3H(i3(j,k)), &
          v3_du2(j,k))
        sig_CH3CO3H(4) = &
          p3(a4_CH3CO3H(1),a4_CH3CO3H(2),a4_CH3CO3H(3), &
          a4_CH3CO3H(4),v3_du2(j,k))
        sig_CH3CO3H(5) = &
          p3(a5_CH3CO3H(1),a5_CH3CO3H(2),a5_CH3CO3H(3), &
          a5_CH3CO3H(4),v3_du2(j,k))
        sig_CH3CO3H(6) = &
          p3(a6_CH3CO3H(1),a6_CH3CO3H(2),a6_CH3CO3H(3), &
          a6_CH3CO3H(4),v3_du2(j,k))
        dj = 0. &
          + sig_CH3CO3H(1) * fint(j,k,1) &
          + sig_CH3CO3H(2) * fint(j,k,2) &
          + sig_CH3CO3H(3) * fint(j,k,3) &
          + sig_CH3CO3H(4) * fint(j,k,4) &
          + sig_CH3CO3H(5) * fint(j,k,5) &
          + sig_CH3CO3H(6) * fint(j,k,6)

        jval_2d(ip_CH3CO3H)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,6)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_CH3CO3H

  ! **************************************************************************

  SUBROUTINE jval_cal_CH3CHO

    ! CH_3CHO \TOHV\ CH_3 + CHO

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_CH3CHO

    ! T-const parameters:
    REAL, PARAMETER :: a2_CH3CHO(dim55) = (/ &
       7.3040E-22,  6.4200E-22,  5.2880E-22,  4.1240E-22,  3.0840E-22,  2.2440E-22, &
       1.6000E-22,  1.1280E-22,  7.9200E-23,  5.5200E-23,  3.8400E-23,  2.6800E-23, &
       1.8400E-23,  1.2400E-23,  8.4000E-24,  5.6000E-24,  3.6000E-24,  2.0000E-24, &
       8.0000E-25, -4.0000E-25, -4.0000E-25, -8.0000E-25, -1.6000E-24, -1.2000E-24, &
      -1.6000E-24, -2.0000E-24, -1.6000E-24, -1.6000E-24, -2.0000E-24, -1.6000E-24, &
      -1.6000E-24, -1.6000E-24, -1.6000E-24, -1.2000E-24, -1.6000E-24, -1.2000E-24, &
      -1.6000E-24, -1.2000E-24, -1.2000E-24, -8.0000E-25, -9.6000E-25, -7.2000E-25, &
      -5.6000E-25, -4.0000E-25, -3.2000E-25, -1.6000E-25, -1.6000E-25, -1.6000E-25, &
      -8.0000E-26,  0.0000E+00, -8.0000E-26,  0.0000E+00, -8.0000E-26,  0.0000E+00, &
       0.0000E+00 /)
    REAL, PARAMETER :: b2_CH3CHO(dim55) = (/ &
       1.7371E-20,  1.7636E-20,  1.8259E-20,  1.9190E-20,  2.0282E-20,  2.1374E-20, &
       2.2372E-20,  2.3222E-20,  2.3910E-20,  2.4462E-20,  2.4891E-20,  2.5216E-20, &
       2.5472E-20,  2.5670E-20,  2.5812E-20,  2.5918E-20,  2.5999E-20,  2.6068E-20, &
       2.6123E-20,  2.6180E-20,  2.6180E-20,  2.6201E-20,  2.6246E-20,  2.6223E-20, &
       2.6247E-20,  2.6272E-20,  2.6246E-20,  2.6246E-20,  2.6274E-20,  2.6245E-20, &
       2.6245E-20,  2.6245E-20,  2.6245E-20,  2.6212E-20,  2.6246E-20,  2.6211E-20, &
       2.6247E-20,  2.6210E-20,  2.6210E-20,  2.6170E-20,  2.6186E-20,  2.6159E-20, &
       2.6139E-20,  2.6117E-20,  2.6105E-20,  2.6079E-20,  2.6079E-20,  2.6079E-20, &
       2.6063E-20,  2.6046E-20,  2.6064E-20,  2.6045E-20,  2.6065E-20,  2.6044E-20, &
       2.6044E-20 /)
    REAL, PARAMETER :: a3_CH3CHO(dim55) = (/ &
      -3.2177E-23, -2.1361E-23, -1.3007E-23, -8.3348E-24, -5.8199E-24, -4.2957E-24, &
      -3.3544E-24, -2.6874E-24, -2.2078E-24, -1.8655E-24, -1.5748E-24, -1.3692E-24, &
      -1.1980E-24, -1.0442E-24, -9.4130E-25, -8.3875E-25, -7.5304E-25, -6.6724E-25, &
      -6.1644E-25, -5.6507E-25, -5.1282E-25, -4.6233E-25, -4.2808E-25, -4.1096E-25, &
      -3.5897E-25, -3.4247E-25, -3.0822E-25, -2.9110E-25, -2.7350E-25, -2.5685E-25, &
      -2.3973E-25, -2.2260E-25, -2.0513E-25, -1.8836E-25, -1.8836E-25, -1.5385E-25, &
      -1.7123E-25, -1.3699E-25, -1.5411E-25, -1.1966E-25, -1.0955E-25, -8.2164E-26, &
      -6.1602E-26, -4.7929E-26, -3.4235E-26, -2.7379E-26, -2.0541E-26, -1.7117E-26, &
      -1.3689E-26, -1.0270E-26, -6.8470E-27, -6.8446E-27, -3.4235E-27, -3.4235E-27, &
      -3.4223E-27 /)
    REAL, PARAMETER :: b3_CH3CHO(dim55) = (/ &
       1.9107E-20,  1.8470E-20,  1.7489E-20,  1.6668E-20,  1.6079E-20,  1.5633E-20, &
       1.5303E-20,  1.5029E-20,  1.4805E-20,  1.4625E-20,  1.4455E-20,  1.4323E-20, &
       1.4203E-20,  1.4086E-20,  1.4001E-20,  1.3912E-20,  1.3831E-20,  1.3746E-20, &
       1.3693E-20,  1.3636E-20,  1.3574E-20,  1.3513E-20,  1.3468E-20,  1.3445E-20, &
       1.3373E-20,  1.3348E-20,  1.3296E-20,  1.3269E-20,  1.3241E-20,  1.3212E-20, &
       1.3182E-20,  1.3151E-20,  1.3119E-20,  1.3086E-20,  1.3086E-20,  1.3016E-20, &
       1.3052E-20,  1.2978E-20,  1.3016E-20,  1.2938E-20,  1.2914E-20,  1.2842E-20, &
       1.2782E-20,  1.2738E-20,  1.2690E-20,  1.2664E-20,  1.2636E-20,  1.2621E-20, &
       1.2605E-20,  1.2588E-20,  1.2570E-20,  1.2570E-20,  1.2550E-20,  1.2550E-20, &
       1.2550E-20 /)
    REAL, PARAMETER :: a4_CH3CHO(4) = (/  8.2852E-21, -1.6046E-24,  3.2531E-28, -2.2359E-32 /)
    REAL, PARAMETER :: a5_CH3CHO(4) = (/  8.3186E-22, -3.8318E-25,  7.1407E-29, -4.6507E-33 /)

    jval_2d(ip_CH3CHO)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_CH3CHO(2) = &
          p1(b2_CH3CHO(i2(j,k)), a2_CH3CHO(i2(j,k)), &
          v3_du1(j,k))
        sig_CH3CHO(3) = &
          p1(b3_CH3CHO(i3(j,k)), a3_CH3CHO(i3(j,k)), &
          v3_du2(j,k))
        sig_CH3CHO(4) = &
          p3(a4_CH3CHO(1),a4_CH3CHO(2),a4_CH3CHO(3), &
          a4_CH3CHO(4),v3_du2(j,k))
        sig_CH3CHO(5) = &
          p3(a5_CH3CHO(1),a5_CH3CHO(2),a5_CH3CHO(3), &
          a5_CH3CHO(4),v3_du2(j,k))
        dj = 0. &
          + sig_CH3CHO(2) * fint(j,k,2) &
          + sig_CH3CHO(3) * fint(j,k,3) &
          + sig_CH3CHO(4) * fint(j,k,4) &
          + sig_CH3CHO(5) * fint(j,k,5)

        jval_2d(ip_CH3CHO)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,6)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_CH3CHO

  ! **************************************************************************

  ! NOTE: this subroutine was not calculated by JVPP but simply copied
  ! from jval_cal_CH3COCH3.f90

  SUBROUTINE jval_cal_CH3COCH3

    ! CH3COCH3 -> products Gierzcak et al., CP, (1998)

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_CH3COCH3

    REAL :: c1, c2, f2, f3, f4, f5
    REAL :: drel
    ! factors that correct the Jval depending on  the "new" quantum yield
    REAL :: nqyf(MAXWAV)
    REAL :: bqyf(MAXWAV)
    REAL :: wqyf(MAXWAV)
    REAL :: gqyf(MAXWAV)
    REAL :: A,B,a0,b0,D0,a1,b1,D1,a2,b2,D2,a3,b3,D3,E3,A4,B4,D4
    REAL :: PHI_ch3co, PHI_co, PhiS
    REAL, PARAMETER :: wave(7) = (/ &
      2.0513E-05, 2.8777E-05, 3.0200E-05, 3.0900E-05, &
      3.2000E-05, 3.7000E-05, 5.8000E-05 /)

    ! T-const parameters:
    REAL, PARAMETER :: a2_CH3COCH3(dim55) = (/ &
      1.0640E-22, 7.0800E-23, 3.8400E-23, 1.2800E-23, -4.3996E-24, -1.4800E-23, &
      -2.0400E-23, -2.2000E-23, -2.2400E-23, -2.1600E-23, -2.0000E-23, -1.8400E-23, &
      -1.6800E-23, -1.5199E-23, -1.4000E-23, -1.2400E-23, -1.1601E-23, -1.0400E-23, &
      -9.5998E-24, -8.7998E-24, -8.4004E-24, -7.1997E-24, -7.2003E-24, -6.3997E-24, &
      -6.0003E-24, -5.5996E-24, -5.2003E-24, -4.8002E-24, -4.3996E-24, -4.4002E-24, &
      -4.0002E-24, -3.5995E-24, -3.2002E-24, -3.2002E-24, -3.2002E-24, -2.7995E-24, &
      -2.4001E-24, -2.8001E-24, -2.0001E-24, -2.4001E-24, -1.7600E-24, -1.2801E-24, &
      -9.5992E-25, -6.4003E-25, -4.8002E-25, -4.0002E-25, -2.4001E-25, -1.6001E-25, &
      -1.5988E-25, -8.0004E-26, -8.0004E-26, -0.0000E+00, -8.0004E-26, -0.0000E+00, &
      -0.0000E+00 /)
    REAL, PARAMETER :: b2_CH3COCH3(dim55) = (/ &
      1.9411E-20, 1.9518E-20, 1.9696E-20, 1.9901E-20, 2.0081E-20, 2.0216E-20, &
      2.0303E-20, 2.0332E-20, 2.0340E-20, 2.0322E-20, 2.0281E-20, 2.0236E-20, &
      2.0187E-20, 2.0135E-20, 2.0092E-20, 2.0031E-20, 1.9999E-20, 1.9947E-20, &
      1.9911E-20, 1.9872E-20, 1.9852E-20, 1.9789E-20, 1.9789E-20, 1.9742E-20, &
      1.9718E-20, 1.9693E-20, 1.9667E-20, 1.9639E-20, 1.9611E-20, 1.9611E-20, &
      1.9581E-20, 1.9550E-20, 1.9518E-20, 1.9518E-20, 1.9518E-20, 1.9482E-20, &
      1.9446E-20, 1.9483E-20, 1.9407E-20, 1.9446E-20, 1.9382E-20, 1.9328E-20, &
      1.9287E-20, 1.9243E-20, 1.9219E-20, 1.9206E-20, 1.9178E-20, 1.9163E-20, &
      1.9163E-20, 1.9146E-20, 1.9146E-20, 1.9127E-20, 1.9147E-20, 1.9126E-20, &
      1.9126E-20 /)
    REAL, PARAMETER :: a3_CH3COCH3(dim55) = (/ &
      -4.9569E-23, -4.1283E-23, -3.2563E-23, -2.4847E-23, -1.8694E-23, -1.4097E-23, &
      -1.0771E-23, -8.3866E-24, -6.6773E-24, -5.4393E-24, -4.5146E-24, -3.8179E-24, &
      -3.2668E-24, -2.8355E-24, -2.4890E-24, -2.1965E-24, -1.9569E-24, -1.7572E-24, &
      -1.5861E-24, -1.4337E-24, -1.3099E-24, -1.1981E-24, -1.1027E-24, -1.0144E-24, &
      -9.4249E-25, -8.7061E-25, -8.1501E-25, -7.5879E-25, -7.1086E-25, -6.6694E-25, &
      -6.2724E-25, -5.9105E-25, -5.5512E-25, -5.2715E-25, -4.9940E-25, -4.7125E-25, &
      -4.4728E-25, -4.2732E-25, -4.0751E-25, -3.8738E-25, -3.3786E-25, -2.7476E-25, &
      -2.2764E-25, -1.9089E-25, -1.6307E-25, -1.3978E-25, -1.2061E-25, -1.0463E-25, &
      -9.1054E-26, -7.9873E-26, -7.0287E-26, -6.0702E-26, -5.4357E-26, -4.7924E-26, &
      -4.1533E-26 /)
    REAL, PARAMETER :: b3_CH3COCH3(dim55) = (/ &
      8.4433E-21, 8.2317E-21, 7.7906E-21, 7.2073E-21, 6.5880E-21, 6.0102E-21, &
      5.5088E-21, 5.0897E-21, 4.7465E-21, 4.4669E-21, 4.2349E-21, 4.0427E-21, &
      3.8768E-21, 3.7362E-21, 3.6146E-21, 3.5046E-21, 3.4085E-21, 3.3234E-21, &
      3.2462E-21, 3.1736E-21, 3.1116E-21, 3.0527E-21, 3.0001E-21, 2.9492E-21, &
      2.9060E-21, 2.8610E-21, 2.8248E-21, 2.7867E-21, 2.7531E-21, 2.7212E-21, &
      2.6914E-21, 2.6632E-21, 2.6344E-21, 2.6113E-21, 2.5877E-21, 2.5630E-21, &
      2.5414E-21, 2.5229E-21, 2.5040E-21, 2.4844E-21, 2.4347E-21, 2.3636E-21, &
      2.3046E-21, 2.2540E-21, 2.2122E-21, 2.1742E-21, 2.1406E-21, 2.1106E-21, &
      2.0834E-21, 2.0596E-21, 2.0380E-21, 2.0152E-21, 1.9993E-21, 1.9824E-21, &
      1.9648E-21 /)
    REAL, PARAMETER :: dsa3_1_CH3COCH3(dim55) = (/ &
      -8.7405E-04, -8.6062E-04, -7.8720E-04, -6.7922E-04, -5.6261E-04, -4.5646E-04, &
      -3.6784E-04, -2.9810E-04, -2.4464E-04, -2.0400E-04, -1.7227E-04, -1.4859E-04, &
      -1.2845E-04, -1.1290E-04, -1.0034E-04, -8.9182E-05, -8.0034E-05, -7.2459E-05, &
      -6.5823E-05, -5.9828E-05, -5.4890E-05, -5.0366E-05, -4.6642E-05, -4.2921E-05, &
      -4.0045E-05, -3.6948E-05, -3.4929E-05, -3.2514E-05, -3.0457E-05, -2.8703E-05, &
      -2.6914E-05, -2.5648E-05, -2.3776E-05, -2.2798E-05, -2.1749E-05, -2.0374E-05, &
      -1.9275E-05, -1.8577E-05, -1.7802E-05, -1.6807E-05, -1.4674E-05, -1.1985E-05, &
      -9.9764E-06, -8.3432E-06, -7.1492E-06, -6.1589E-06, -5.3040E-06, -4.5950E-06, &
      -3.9953E-06, -3.5412E-06, -3.1346E-06, -2.6308E-06, -2.4255E-06, -2.1664E-06, &
      -1.8061E-06 /)
    REAL, PARAMETER :: dsa3_2_CH3COCH3(dim55) = (/ &
      9.1117E-05, 8.7876E-05, 7.8667E-05, 6.6481E-05, 5.4159E-05, 4.3326E-05, &
      3.4607E-05, 2.7929E-05, 2.2909E-05, 1.9017E-05, 1.6106E-05, 1.3845E-05, &
      1.2039E-05, 1.0606E-05, 9.3262E-06, 8.4146E-06, 7.5131E-06, 6.7728E-06, &
      6.1316E-06, 5.6864E-06, 5.1595E-06, 4.7200E-06, 4.4147E-06, 4.0797E-06, &
      3.7396E-06, 3.5361E-06, 3.2833E-06, 3.0966E-06, 2.8868E-06, 2.7184E-06, &
      2.5599E-06, 2.4247E-06, 2.2602E-06, 2.1846E-06, 2.0593E-06, 1.9635E-06, &
      1.8519E-06, 1.7552E-06, 1.6601E-06, 1.5794E-06, 1.4238E-06, 1.1506E-06, &
      9.4632E-07, 8.1659E-07, 6.8318E-07, 5.8587E-07, 5.1928E-07, 4.4674E-07, &
      3.9776E-07, 3.3260E-07, 2.9642E-07, 2.7725E-07, 2.2566E-07, 1.9834E-07, &
      1.8531E-07 /)
    REAL, PARAMETER :: dsb3_1_CH3COCH3(dim55) = (/ &
      3.4148E-01, 3.4114E-01, 3.3742E-01, 3.2926E-01, 3.1752E-01, 3.0418E-01, &
      2.9082E-01, 2.7856E-01, 2.6783E-01, 2.5865E-01, 2.5069E-01, 2.4416E-01, &
      2.3810E-01, 2.3303E-01, 2.2862E-01, 2.2442E-01, 2.2075E-01, 2.1752E-01, &
      2.1453E-01, 2.1168E-01, 2.0920E-01, 2.0682E-01, 2.0477E-01, 2.0262E-01, &
      2.0089E-01, 1.9895E-01, 1.9764E-01, 1.9600E-01, 1.9456E-01, 1.9329E-01, &
      1.9194E-01, 1.9096E-01, 1.8946E-01, 1.8865E-01, 1.8776E-01, 1.8655E-01, &
      1.8556E-01, 1.8491E-01, 1.8417E-01, 1.8320E-01, 1.8106E-01, 1.7803E-01, &
      1.7552E-01, 1.7327E-01, 1.7147E-01, 1.6986E-01, 1.6836E-01, 1.6703E-01, &
      1.6583E-01, 1.6486E-01, 1.6395E-01, 1.6275E-01, 1.6223E-01, 1.6155E-01, &
      1.6056E-01 /)
    REAL, PARAMETER :: dsb3_2_CH3COCH3(dim55) = (/ &
      6.6324E-02, 6.6407E-02, 6.6873E-02, 6.7794E-02, 6.9034E-02, 7.0396E-02, &
      7.1710E-02, 7.2884E-02, 7.3892E-02, 7.4771E-02, 7.5501E-02, 7.6125E-02, &
      7.6668E-02, 7.7136E-02, 7.7585E-02, 7.7928E-02, 7.8289E-02, 7.8605E-02, &
      7.8894E-02, 7.9106E-02, 7.9370E-02, 7.9601E-02, 7.9770E-02, 7.9963E-02, &
      8.0167E-02, 8.0295E-02, 8.0459E-02, 8.0586E-02, 8.0733E-02, 8.0855E-02, &
      8.0974E-02, 8.1079E-02, 8.1211E-02, 8.1274E-02, 8.1381E-02, 8.1465E-02, &
      8.1565E-02, 8.1655E-02, 8.1745E-02, 8.1824E-02, 8.1980E-02, 8.2288E-02, &
      8.2544E-02, 8.2723E-02, 8.2923E-02, 8.3081E-02, 8.3198E-02, 8.3334E-02, &
      8.3433E-02, 8.3571E-02, 8.3653E-02, 8.3698E-02, 8.3828E-02, 8.3899E-02, &
      8.3935E-02 /)
    REAL, PARAMETER :: a4_CH3COCH3(3) = (/ 7.9742E-22, -2.1322E-25, 4.0290E-29 /)
    REAL, PARAMETER :: a5_CH3COCH3(4) = (/ 7.7582E-23, -3.6187E-26, 9.1185E-30, -9.5885E-34 /)

    jval_2d(ip_CH3COCH3)%ptr(:,:) = 0.0_dp

    SELECT CASE(qy_CH3COCH3)
    CASE(1)
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_CH3COCH3(2) = &
          p1(b2_CH3COCH3(i2(j,k)), a2_CH3COCH3(i2(j,k)), &
          v3_du1(j,k))
        sig_CH3COCH3(3) = &
          p1(b3_CH3COCH3(i3(j,k)), a3_CH3COCH3(i3(j,k)),v3_du2(j,k))
        sig_CH3COCH3(4) = &
          p2(a4_CH3COCH3(1),a4_CH3COCH3(2),a4_CH3COCH3(3), v3_du2(j,k))
        sig_CH3COCH3(5) = &
          p3(a5_CH3COCH3(1),a5_CH3COCH3(2),a5_CH3COCH3(3), &
          a5_CH3COCH3(4),v3_du2(j,k))
        ! correction for density dependence
        drel = dens(j,k)/dens_ref
        C1 = p1(DSb3_1_CH3COCH3(i3(j,k)), DSa3_1_CH3COCH3(i3(j,k)), &
          v3_du2(j,k))
        C2 = p1(DSb3_2_CH3COCH3(i3(j,k)), DSa3_2_CH3COCH3(i3(j,k)), &
          v3_du2(j,k))
        F2 = 1./p1(4.3154E-01, 5.6559E-02, DREL)
        F3 = 1./p1(C1,C2,DREL)
        F4 = 1./p1(1.4094E-01, 8.5977E-02, DREL)
        F5 = 1./p1(2.0675E-01, 7.9342E-02, DREL)

        dj=&
          sig_CH3COCH3(2) * F2 * fint(j,k,2)  + &
          sig_CH3COCH3(3) * F3 * fint(j,k,3)  + &
          sig_CH3COCH3(4) * F4 * fint(j,k,4)  + &
          sig_CH3COCH3(5) * F5 * fint(j,k,5)
        jval_2d(ip_CH3COCH3)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,6)),dp)
      ENDDO
    ENDDO

    CASE(2)
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_CH3COCH3(2) = &
          p1(b2_CH3COCH3(i2(j,k)), a2_CH3COCH3(i2(j,k)),v3_du1(j,k))
        sig_CH3COCH3(3) = &
          p1(b3_CH3COCH3(i3(j,k)), a3_CH3COCH3(i3(j,k)),v3_du2(j,k))
        sig_CH3COCH3(4) = &
          p2(a4_CH3COCH3(1),a4_CH3COCH3(2),a4_CH3COCH3(3),v3_du2(j,k))
        sig_CH3COCH3(5) = &
          p3(a5_CH3COCH3(1),a5_CH3COCH3(2),a5_CH3COCH3(3), &
          a5_CH3COCH3(4),v3_du2(j,k))
        ! correction for density dependence
        drel = dens(j,k)/dens_ref
        C1 = p1(DSb3_1_CH3COCH3(i3(j,k)), DSa3_1_CH3COCH3(i3(j,k)), &
          v3_du2(j,k))
        C2 = p1(DSb3_2_CH3COCH3(i3(j,k)), DSa3_2_CH3COCH3(i3(j,k)), &
          v3_du2(j,k))
        F2 = 1./p1(4.3154E-01, 5.6559E-02, DREL)
        F3 = 1./p1(C1,C2,DREL)
        F4 = 1./p1(1.4094E-01, 8.5977E-02, DREL)
        F5 = 1./p1(2.0675E-01, 7.9342E-02, DREL)

        ! calculate some correction factors for acetone photolysis,
        ! due to new measurements of the quantum yield
        ! we can skip calculation of 1 & 6 & 7 wavelenght
        !  wavelength(7)
        ! 1 : 2.0513E-05, --> 205
        ! 2 : 2.8777E-05, --> 287 ! used
        ! 3 : 3.0200E-05, --> 302 ! used
        ! 4 : 3.0900E-05, --> 309 ! used
        ! 5 : 3.2000E-05, --> 320 ! used
        ! 6 : 3.7000E-05, --> 370
        ! 7:  5.8000E-05, --> 580
        ! the following lines have been made to increase calculation speed.
        ! If new wavelenght used, check the comments down (real calculation on
        ! all the wavelnght range!)
        ! Quantum Yield of Acetone based on the paper of Gierzack-1998
            A = -15.696 + 0.05707 *WAVE(2) *1.e7
            B = EXP(-88.81 + 0.15161 * WAVE(2)*1.e7 )
            GQYF(2) =  MIN(1.,1./(A + B * DENS(J,K)))

            A = -15.696 + 0.05707 *WAVE(3) *1.e7
            B = EXP(-88.81 + 0.15161 * WAVE(3)*1.e7 )
            GQYF(3) = MIN(1.,1./(A + B * DENS(J,K)))

            A = -130.2 + 0.42884 * WAVE(4)*1.e7
            B = EXP(-55.947 + .044913 * WAVE(4)*1.e7 )
            GQYF(4) =  MIN(1.,1./(A + B * DENS(J,K)))

            A = -130.2 + 0.42884 * WAVE(5)*1.e7
            B = EXP(-55.947 + .044913 * WAVE(5)*1.e7 )
            GQYF(5) =  MIN(1.,1./(A + B * DENS(J,K)))

        ! Quantum yield of Acetone based on the paper of Blitz-2004
            a0 = 0.35*((TEMP(J,K)/295.)**(-1.28))
            b0 =(0.068)*((TEMP(J,K)/295.)**(-2.65))
            D0 = (a0/(1.-a0))*EXP(b0*(WAVE(2)*1.e7-248.))
            PHI_co=(1./(1.+D0))
            a1 = 1.6*1.E-19*((TEMP(J,K)/295.)**(-2.38))
            b1 = 0.55*1.E-3*((TEMP(J,K)/295.)**(-3.19))
            D1 = a1*EXP(-b1*((1.E7/(WAVE(2)*1.e7))-33113.))
            PHI_ch3co = (1.-PHI_co)/(1.+DENS(J,K)*D1)
            BQYF(2)=MIN(1.E+0,PHI_co+PHI_ch3co)

            a0 = 0.35*((TEMP(J,K)/295.)**(-1.28))
            b0 =(0.068)*((TEMP(J,K)/295.)**(-2.65))
            D0 = (a0/(1.-a0))*EXP(b0*(WAVE(3)*1.e7-248.))
            PHI_co=(1./(1.+D0))
            a1 = 1.6*1.E-19*((TEMP(J,K)/295.)**(-2.38))
            b1 = 0.55*1.E-3*((TEMP(J,K)/295.)**(-3.19))
            D1 = a1*EXP(-b1*((1.E7/(WAVE(3)*1.e7))-33113.))
            PHI_ch3co = (1.-PHI_co)/(1.+DENS(J,K)*D1)
            BQYF(3)=MIN(1.E+0,PHI_co+PHI_ch3co)

            a0 = 0.35*((TEMP(J,K)/295.)**(-1.28))
            b0 =(0.068)*((TEMP(J,K)/295.)**(-2.65))
            D0 = (a0/(1.-a0))*EXP(b0*(WAVE(4)*1.e7-248.))
            PHI_co=(1./(1.+D0))
            a2 = 1.62*1.E-17*((TEMP(J,K)/295.)**(-10.03))
            b2 = 1.79*1.E-03*((TEMP(J,K)/295.)**(-1.364))
            D2 = a2 *EXP(-b2*((1.E7/(WAVE(4)*1.e7))-30488.))
            a3 = 26.29 * ((TEMP(J,K)/295.)**(-6.59))
            b3 = 5.72*1.E-7 *((TEMP(J,K)/295.)**(-2.93))
            E3 = 30006. * ((TEMP(J,K)/295.)**(-0.064))
            D3 = a3*EXP(-b3*(((1.E7/(WAVE(4)*1.e7))-E3)**2))
            A4 = 1.67*1.E-15*((TEMP(J,K)/295.)**(-7.25))
            B4 = 2.08*1.E-05*((TEMP(J,K)/295.)**(-1.16))
            D4 = A4 *EXP(-B4*((1.E7/(WAVE(4)*1.e7))-30488.))
            PHI_ch3co = (1.-PHI_co) * (1.+D4*DENS(J,K)+D3) &
              / ((1.+D2*DENS(J,K)+D3)*(1.+D4*DENS(J,K)))
            BQYF(4)=MIN(1.E+0,PHI_co+PHI_ch3co)

            a0 = 0.35*((TEMP(J,K)/295.)**(-1.28))
            b0 =(0.068)*((TEMP(J,K)/295.)**(-2.65))
            D0 = (a0/(1.-a0))*EXP(b0*(WAVE(5)*1.e7-248.))
            PHI_co=(1./(1.+D0))
            a2 = 1.62*1.E-17*((TEMP(J,K)/295.)**(-10.03))
            b2 = 1.79*1.E-03*((TEMP(J,K)/295.)**(-1.364))
            D2 = a2 *EXP(-b2*((1.E7/(WAVE(5)*1.e7))-30488.))
            a3 = 26.29 * ((TEMP(J,K)/295.)**(-6.59))
            b3 = 5.72*1.E-7 *((TEMP(J,K)/295.)**(-2.93))
            E3 = 30006. * ((TEMP(J,K)/295.)**(-0.064))
            D3 = a3*EXP(-b3*(((1.E7/(WAVE(5)*1.e7))-E3)**2))
            A4 = 1.67*1.E-15*((TEMP(J,K)/295.)**(-7.25))
            B4 = 2.08*1.E-05*((TEMP(J,K)/295.)**(-1.16))
            D4 = A4 *EXP(-B4*((1.E7/(WAVE(5)*1.e7))-30488.))
            PHI_ch3co = (1.-PHI_co) * (1.+D4*DENS(J,K)+D3) &
              / ((1.+D2*DENS(J,K)+D3)*(1.+D4*DENS(J,K)))
            BQYF(5)=MIN(1.E+0,PHI_co+PHI_ch3co)

        ! quantum yield correction
          nqyf(2) = bqyf(2)/gqyf(2) ! BLITZ 2004
          nqyf(3) = bqyf(3)/gqyf(3)
          nqyf(4) = bqyf(4)/gqyf(4)
          nqyf(5) = bqyf(5)/gqyf(5)

        ! factors that correct the Jval depending on the "new" quantum yield
        dj=&
          sig_CH3COCH3(2) * F2 * fint(j,k,2) * nqyf(2) + &
          sig_CH3COCH3(3) * F3 * fint(j,k,3) * nqyf(3) + &
          sig_CH3COCH3(4) * F4 * fint(j,k,4) * nqyf(4) + &
          sig_CH3COCH3(5) * F5 * fint(j,k,5) * nqyf(5)
        jval_2d(ip_CH3COCH3)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,6)),dp)
      ENDDO
    ENDDO

    CASE(3)

    DO k = 1,klev
      DO j = 1,kproma_day
        sig_CH3COCH3(2) = &
          p1(b2_CH3COCH3(i2(j,k)), a2_CH3COCH3(i2(j,k)),v3_du1(j,k))
        sig_CH3COCH3(3) = &
          p1(b3_CH3COCH3(i3(j,k)), a3_CH3COCH3(i3(j,k)),v3_du2(j,k))
        sig_CH3COCH3(4) = &
          p2(a4_CH3COCH3(1),a4_CH3COCH3(2),a4_CH3COCH3(3), v3_du2(j,k))
        sig_CH3COCH3(5) = &
          p3(a5_CH3COCH3(1),a5_CH3COCH3(2),a5_CH3COCH3(3), &
          a5_CH3COCH3(4),v3_du2(j,k))
        ! correction for density dependence
        drel = dens(j,k)/dens_ref
        C1 = p1(DSb3_1_CH3COCH3(i3(j,k)), DSa3_1_CH3COCH3(i3(j,k)), &
          v3_du2(j,k))
        C2 = p1(DSb3_2_CH3COCH3(i3(j,k)), DSa3_2_CH3COCH3(i3(j,k)), &
          v3_du2(j,k))
        F2 = 1./p1(4.3154E-01, 5.6559E-02, DREL)
        F3 = 1./p1(C1,C2,DREL)
        F4 = 1./p1(1.4094E-01, 8.5977E-02, DREL)
        F5 = 1./p1(2.0675E-01, 7.9342E-02, DREL)

        ! calculate some correction factors for acetone photolysis,
        ! due to new measurements of the quantum yield
        ! we can skip calculation of 1 & 6 & 7 wavelenght
        !  wavelength(7)
        ! 1 : 2.0513E-05, --> 205
        ! 2 : 2.8777E-05, --> 287 ! used
        ! 3 : 3.0200E-05, --> 302 ! used
        ! 4 : 3.0900E-05, --> 309 ! used
        ! 5 : 3.2000E-05, --> 320 ! used
        ! 6 : 3.7000E-05, --> 370
        ! 7:  5.8000E-05, --> 580
        ! the following lines have been made to increase calculation speed.
        ! If new wavelenght used, check the comments down (real calculation on
        ! all the wavelnght range!)
        ! Quantum Yield of Acetone based on the paper of Gierzack-1998
            A = -15.696 + 0.05707 *WAVE(2) *1.e7
            B = EXP(-88.81 + 0.15161 * WAVE(2)*1.e7 )
            GQYF(2) =  MIN(1.,1./(A + B * DENS(J,K)))

            A = -15.696 + 0.05707 *WAVE(3) *1.e7
            B = EXP(-88.81 + 0.15161 * WAVE(3)*1.e7 )
            GQYF(3) = MIN(1.,1./(A + B * DENS(J,K)))

            A = -130.2 + 0.42884 * WAVE(4)*1.e7
            B = EXP(-55.947 + .044913 * WAVE(4)*1.e7 )
            GQYF(4) =  MIN(1.,1./(A + B * DENS(J,K)))

            A = -130.2 + 0.42884 * WAVE(5)*1.e7
            B = EXP(-55.947 + .044913 * WAVE(5)*1.e7 )
            GQYF(5) =  MIN(1.,1./(A + B * DENS(J,K)))

        ! quantum yield of acetone based on Warneck
        ! Atmos. Environ. 35, 5773-5777 (2001)

          PhiS=(1.-0.113)*((1.+EXP(((WAVE(2)*1.E7)-307.5)/3.))**(-1.))+0.113
          WQYF(2) = &
            ((1./PhiS)+7.138E-7*DENS(J,K)*EXP((-8780.6/(WAVE(2)*1.E7))))**(-1.)

          PhiS=(1.-0.113)*((1.+EXP(((WAVE(3)*1.E7)-307.5)/3.))**(-1.))+0.113
          WQYF(3) = &
            ((1./PhiS)+7.138E-7*DENS(J,K)*EXP((-8780.6/(WAVE(3)*1.E7))))**(-1.)

          PhiS=(1.-0.113)*((1.+EXP(((WAVE(4)*1.E7)-307.5)/3.))**(-1.))+0.113
          WQYF(4) = &
            ((1./PhiS)+7.138E-7*DENS(J,K)*EXP((-8780.6/(WAVE(4)*1.E7))))**(-1.)

          PhiS=(1.-0.113)*((1.+EXP(((WAVE(5)*1.E7)-307.5)/3.))**(-1.))+0.113
          WQYF(5) = &
            ((1./PhiS)+7.138E-7*DENS(J,K)*EXP((-8780.6/(WAVE(5)*1.E7))))**(-1.)

        ! quantum yield correction
          nqyf(2) = wqyf(2)/gqyf(2) ! IUPAC
          nqyf(3) = wqyf(3)/gqyf(3)
          nqyf(4) = wqyf(4)/gqyf(4)
          nqyf(5) = wqyf(5)/gqyf(5)

        ! factors that correct the Jval depending on the "new" quantum yield
        dj=&
          sig_CH3COCH3(2) * F2 * fint(j,k,2) * nqyf(2) + &
          sig_CH3COCH3(3) * F3 * fint(j,k,3) * nqyf(3) + &
          sig_CH3COCH3(4) * F4 * fint(j,k,4) * nqyf(4) + &
          sig_CH3COCH3(5) * F5 * fint(j,k,5) * nqyf(5)
        jval_2d(ip_CH3COCH3)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,6)),dp)
      ENDDO
    ENDDO

    END SELECT

  END SUBROUTINE jval_cal_CH3COCH3

  ! **************************************************************************

  ! NOTE: this subroutine was not calculated by JVPP but simply copied
  ! from jval_cal_MGLYOX.f90

  SUBROUTINE jval_cal_MGLYOX

    ! MGLYOX -> products Koch + Moortgat (1998), Meller et al. (1991)

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_MGLYOX

    REAL :: f6, f7
    REAL :: prel

    ! T-const parameters:
    REAL, PARAMETER :: a2_MGLYOX(dim55) = (/ &
      6.3800E-22, 5.2200E-22, 3.9880E-22, 2.8800E-22, 1.9840E-22, 1.3200E-22, &
      8.6000E-23, 5.5200E-23, 3.5200E-23, 2.1999E-23, 1.4000E-23, 8.8004E-24, &
      5.1996E-24, 3.2002E-24, 2.4001E-24, 1.1994E-24, 8.0004E-25, 4.0067E-25, &
      0.0000E+00, 0.0000E+00, 0.0000E+00, 0.0000E+00, 0.0000E+00, 0.0000E+00, &
      0.0000E+00, 0.0000E+00, 0.0000E+00, 0.0000E+00, 0.0000E+00, 0.0000E+00, &
      0.0000E+00, 0.0000E+00, 0.0000E+00, 0.0000E+00, 0.0000E+00, 0.0000E+00, &
      0.0000E+00, 0.0000E+00, 0.0000E+00, 0.0000E+00, 0.0000E+00, 0.0000E+00, &
      0.0000E+00, 0.0000E+00, 0.0000E+00, 0.0000E+00, 0.0000E+00, 0.0000E+00, &
      0.0000E+00, 0.0000E+00, 0.0000E+00, 0.0000E+00, 0.0000E+00, 0.0000E+00, &
      0.0000E+00 /)
    REAL, PARAMETER :: b2_MGLYOX(dim55) = (/ &
      2.3144E-20, 2.3492E-20, 2.4170E-20, 2.5056E-20, 2.5997E-20, 2.6860E-20, &
      2.7573E-20, 2.8127E-20, 2.8537E-20, 2.8841E-20, 2.9045E-20, 2.9191E-20, &
      2.9300E-20, 2.9366E-20, 2.9395E-20, 2.9440E-20, 2.9457E-20, 2.9474E-20, &
      2.9492E-20, 2.9473E-20, 2.9493E-20, 2.9493E-20, 2.9493E-20, 2.9493E-20, &
      2.9493E-20, 2.9493E-20, 2.9493E-20, 2.9493E-20, 2.9465E-20, 2.9494E-20, &
      2.9494E-20, 2.9494E-20, 2.9494E-20, 2.9461E-20, 2.9495E-20, 2.9495E-20, &
      2.9495E-20, 2.9495E-20, 2.9457E-20, 2.9496E-20, 2.9488E-20, 2.9488E-20, &
      2.9498E-20, 2.9487E-20, 2.9499E-20, 2.9499E-20, 2.9485E-20, 2.9500E-20, &
      2.9500E-20, 2.9500E-20, 2.9500E-20, 2.9500E-20, 2.9500E-20, 2.9500E-20, &
      2.9500E-20 /)
    REAL, PARAMETER :: a3_MGLYOX(dim55) = (/ &
      -3.9314E-23, -2.1567E-23, -1.0662E-23, -5.8360E-24, -3.7488E-24, -2.7725E-24, &
      -2.2591E-24, -1.9514E-24, -1.7457E-24, -1.6087E-24, -1.5064E-24, -1.4034E-24, &
      -1.3349E-24, -1.2495E-24, -1.1980E-24, -1.1297E-24, -1.0782E-24, -1.0265E-24, &
      -9.7599E-25, -9.2470E-25, -8.8888E-25, -8.3905E-25, -8.0475E-25, -7.5346E-25, &
      -7.1793E-25, -7.0206E-25, -6.5066E-25, -6.3356E-25, -5.9829E-25, -5.6507E-25, &
      -5.3082E-25, -5.1372E-25, -4.7866E-25, -4.6232E-25, -4.4517E-25, -4.1028E-25, &
      -4.1098E-25, -3.7668E-25, -3.4248E-25, -3.4190E-25, -2.9099E-25, -2.2252E-25, &
      -1.6770E-25, -1.3010E-25, -9.9280E-26, -7.5283E-26, -5.8208E-26, -4.4502E-26, &
      -3.4225E-26, -2.7389E-26, -2.0531E-26, -1.3690E-26, -1.0276E-26, -1.0265E-26, &
      -6.8450E-27 /)
    REAL, PARAMETER :: b3_MGLYOX(dim55) = (/ &
      4.0886E-20, 3.9840E-20, 3.8560E-20, 3.7712E-20, 3.7223E-20, 3.6937E-20, &
      3.6757E-20, 3.6631E-20, 3.6535E-20, 3.6463E-20, 3.6403E-20, 3.6337E-20, &
      3.6289E-20, 3.6224E-20, 3.6182E-20, 3.6122E-20, 3.6073E-20, 3.6022E-20, &
      3.5969E-20, 3.5912E-20, 3.5870E-20, 3.5809E-20, 3.5765E-20, 3.5696E-20, &
      3.5646E-20, 3.5623E-20, 3.5545E-20, 3.5518E-20, 3.5460E-20, 3.5404E-20, &
      3.5344E-20, 3.5313E-20, 3.5247E-20, 3.5216E-20, 3.5182E-20, 3.5110E-20, &
      3.5112E-20, 3.5037E-20, 3.4962E-20, 3.4960E-20, 3.4841E-20, 3.4661E-20, &
      3.4501E-20, 3.4380E-20, 3.4272E-20, 3.4181E-20, 3.4111E-20, 3.4051E-20, &
      3.4003E-20, 3.3969E-20, 3.3933E-20, 3.3895E-20, 3.3875E-20, 3.3875E-20, &
      3.3853E-20 /)
    REAL, PARAMETER :: a4_MGLYOX(3) = (/ 2.3571E-20, -1.4561E-24, 1.4153E-28 /)
    REAL, PARAMETER :: a5_MGLYOX(3) = (/ 9.5590E-21, -1.0975E-24, 8.9459E-29 /)
    REAL, PARAMETER :: a6_MGLYOX(1) = (/ 2.1329E-21 /)
    REAL, PARAMETER :: a7_MGLYOX(2) = (/ 3.8083E-23, 2.6202E-27 /)

    jval_2d(ip_MGLYOX)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        PREL = (MIN(1.E5,PRESS(J,K))/PRESS_REF)  !relative pressure
        sig_MGLYOX(2) = &
          p1(b2_MGLYOX(i2(j,k)), a2_MGLYOX(i2(j,k)), &
          v3_du1(j,k))
        sig_MGLYOX(3) = &
          p1(b3_MGLYOX(i3(j,k)), a3_MGLYOX(i3(j,k)), &
          v3_du2(j,k))
        sig_MGLYOX(4) = &
          p2(a4_MGLYOX(1),a4_MGLYOX(2),a4_MGLYOX(3),v3_du2(j,k))
        sig_MGLYOX(5) = &
          p2(a5_MGLYOX(1),a5_MGLYOX(2),a5_MGLYOX(3),v3_du2(j,k))
        sig_MGLYOX(6) = &
          a6_MGLYOX(1)
        sig_MGLYOX(7) = &
          p1(a7_MGLYOX(1),a7_MGLYOX(2),v3_du2(j,k))
        F6 = 1./p1(8.7005E-02, 9.1257E-02, PREL)
        F7 = 1./p1(5.3416E-02, 9.4662E-02, PREL)
        dj = 0. &
          + sig_MGLYOX(2) * fint(j,k,2) &
          + sig_MGLYOX(3) * fint(j,k,3) &
          + sig_MGLYOX(4) * fint(j,k,4) &
          + sig_MGLYOX(5) * fint(j,k,5) &
          + sig_MGLYOX(6) * F6 * fint(j,k,6) &
          + sig_MGLYOX(7) * F7 * fint(j,k,7)

        jval_2d(ip_MGLYOX)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,6)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_MGLYOX

  ! **************************************************************************

  SUBROUTINE jval_cal_HOCl

    ! HOCl \TOHV\ OH + Cl

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_HOCl

    ! T-const parameters:
    REAL, PARAMETER :: a0_1_1_HOCl(dim58) = (/ &
       2.8182E-22,  3.0838E-22,  3.3695E-22,  3.6588E-22,  3.9858E-22,  4.3005E-22, &
       4.6500E-22,  5.0024E-22,  5.3883E-22,  5.7721E-22,  6.1960E-22,  6.6254E-22, &
       8.0227E-22,  1.1459E-21,  1.1142E-21,  1.1781E-21,  1.3512E-21,  1.3093E-21, &
       1.3683E-21,  1.5433E-21,  1.4753E-21,  1.5167E-21,  1.6818E-21,  1.5775E-21, &
       1.5945E-21,  1.3328E-21,  1.2153E-21,  1.2437E-21,  1.2897E-21,  1.3524E-21, &
       1.4357E-21,  1.5388E-21,  1.6607E-21,  1.7980E-21,  1.9467E-21,  2.1018E-21, &
       2.2599E-21,  2.4190E-21,  2.5785E-21,  2.7381E-21,  2.8984E-21,  3.0596E-21, &
       3.2167E-21,  3.3684E-21,  3.5034E-21,  3.6126E-21,  3.6831E-21,  3.7165E-21, &
       3.7034E-21,  3.6499E-21,  3.5641E-21,  3.4479E-21,  3.3083E-21,  3.1489E-21, &
       2.9669E-21,  2.7362E-21,  2.3852E-21,  1.9568E-21 /)
    REAL, PARAMETER :: a0_1_2_HOCl(dim58) = (/ &
       2.0104E-22, -9.7268E-22, -2.2414E-21, -3.5317E-21, -4.9965E-21, -6.4127E-21, &
      -7.9926E-21, -9.5923E-21, -1.1352E-20, -1.3110E-20, -1.5060E-20, -1.7044E-20, &
      -2.3527E-20, -3.9540E-20, -3.8058E-20, -4.1058E-20, -4.9230E-20, -4.7242E-20, &
      -5.0051E-20, -5.8416E-20, -5.5152E-20, -5.7151E-20, -6.5140E-20, -6.0070E-20, &
      -6.0899E-20, -4.8077E-20, -4.2296E-20, -4.3700E-20, -4.5982E-20, -4.9103E-20, &
      -5.3270E-20, -5.8446E-20, -6.4586E-20, -7.1533E-20, -7.9089E-20, -8.6999E-20, &
      -9.5095E-20, -1.0327E-19, -1.1150E-19, -1.1977E-19, -1.2810E-19, -1.3652E-19, &
      -1.4475E-19, -1.5273E-19, -1.5986E-19, -1.6565E-19, -1.6940E-19, -1.7118E-19, &
      -1.7048E-19, -1.6760E-19, -1.6297E-19, -1.5667E-19, -1.4908E-19, -1.4037E-19, &
      -1.3040E-19, -1.1771E-19, -9.8336E-20, -7.4602E-20 /)
    REAL, PARAMETER :: a0_2_1_HOCl(dim58) = (/ &
       1.4530E-24,  1.6067E-24,  1.7664E-24,  1.9526E-24,  2.1378E-24,  2.3531E-24, &
       2.5703E-24,  2.8212E-24,  3.0736E-24,  3.3661E-24,  3.6697E-24,  4.0180E-24, &
       2.9894E-24, -8.5497E-25,  9.4782E-25,  1.3915E-24,  4.8264E-25,  2.4084E-24, &
       3.0010E-24,  2.2368E-24,  4.3189E-24,  5.0405E-24,  4.3913E-24,  6.5583E-24, &
       7.3283E-24,  1.0758E-23,  1.2574E-23,  1.2783E-23,  1.2698E-23,  1.2288E-23, &
       1.1528E-23,  1.0413E-23,  8.9897E-24,  7.3215E-24,  5.5344E-24,  3.7213E-24, &
       2.0234E-24,  5.1614E-25, -7.4017E-25, -1.7070E-24, -2.3965E-24, -2.8432E-24, &
      -3.0888E-24, -3.2181E-24, -3.2551E-24, -3.2289E-24, -3.1537E-24, -3.0346E-24, &
      -2.8869E-24, -2.7149E-24, -2.5440E-24, -2.3656E-24, -2.1747E-24, -1.9683E-24, &
      -1.7423E-24, -1.4968E-24, -1.2533E-24, -1.0577E-24 /)
    REAL, PARAMETER :: a0_2_2_HOCl(dim58) = (/ &
      -8.3780E-23, -9.0574E-23, -9.7665E-23, -1.0597E-22, -1.1427E-22, -1.2396E-22, &
      -1.3377E-22, -1.4517E-22, -1.5667E-22, -1.7007E-22, -1.8404E-22, -2.0012E-22, &
      -1.5240E-22,  2.6748E-23, -5.7622E-23, -7.8477E-23, -3.5578E-23, -1.2686E-22, &
      -1.5507E-22, -1.1854E-22, -2.1848E-22, -2.5326E-22, -2.2184E-22, -3.2715E-22, &
      -3.6473E-22, -5.3276E-22, -6.2212E-22, -6.3244E-22, -6.2823E-22, -6.0781E-22, &
      -5.6983E-22, -5.1383E-22, -4.4212E-22, -3.5770E-22, -2.6692E-22, -1.7445E-22, &
      -8.7523E-23, -1.0047E-23,  5.4779E-23,  1.0486E-22,  1.4071E-22,  1.6403E-22, &
       1.7690E-22,  1.8370E-22,  1.8566E-22,  1.8427E-22,  1.8027E-22,  1.7391E-22, &
       1.6599E-22,  1.5673E-22,  1.4751E-22,  1.3784E-22,  1.2745E-22,  1.1619E-22, &
       1.0380E-22,  9.0297E-23,  7.6859E-23,  6.6022E-23 /)
    REAL, PARAMETER :: a1_1_HOCl(dim55) = (/ &
      -3.2696E-21, -3.0643E-21, -2.8537E-21, -2.5617E-21, -2.2758E-21, -2.0016E-21, &
      -1.7293E-21, -1.5220E-21, -1.2934E-21, -1.1553E-21, -9.7546E-22, -8.8862E-22, &
      -7.4976E-22, -6.9693E-22, -5.8721E-22, -5.5735E-22, -4.6925E-22, -4.5361E-22, &
      -3.8104E-22, -3.7484E-22, -3.1359E-22, -3.1371E-22, -2.6106E-22, -2.6526E-22, &
      -2.1950E-22, -2.2641E-22, -1.8596E-22, -1.9473E-22, -1.5862E-22, -1.6870E-22, &
      -1.3611E-22, -1.4710E-22, -1.1761E-22, -1.2880E-22, -1.0190E-22, -1.1356E-22, &
      -8.8863E-23, -1.0038E-22, -7.7654E-23, -8.9303E-23, -6.6438E-23, -5.2484E-23, &
      -3.7855E-23, -3.1241E-23, -2.2468E-23, -1.9192E-23, -1.3418E-23, -1.1808E-23, &
      -5.0745E-24, -3.6322E-24, -2.3878E-24, -1.3638E-24, -5.0024E-25,  2.0174E-25, &
       8.1176E-25 /)
    REAL, PARAMETER :: b1_1_HOCl(dim55) = (/ &
       1.4040E-19,  1.3979E-19,  1.3863E-19,  1.3629E-19,  1.3329E-19,  1.2973E-19, &
       1.2550E-19,  1.2177E-19,  1.1709E-19,  1.1391E-19,  1.0932E-19,  1.0689E-19, &
       1.0266E-19,  1.0091E-19,  9.7019E-20,  9.5885E-20,  9.2317E-20,  9.1644E-20, &
       8.8342E-20,  8.8045E-20,  8.4952E-20,  8.4958E-20,  8.2036E-20,  8.2279E-20, &
       7.9511E-20,  7.9946E-20,  7.7297E-20,  7.7893E-20,  7.5347E-20,  7.6083E-20, &
       7.3623E-20,  7.4479E-20,  7.2106E-20,  7.3035E-20,  7.0735E-20,  7.1760E-20, &
       6.9526E-20,  7.0597E-20,  6.8427E-20,  6.9568E-20,  6.7270E-20,  6.5693E-20, &
       6.3857E-20,  6.2945E-20,  6.1624E-20,  6.1090E-20,  6.0077E-20,  5.9774E-20, &
       5.8424E-20,  5.8117E-20,  5.7836E-20,  5.7593E-20,  5.7376E-20,  5.7192E-20, &
       5.7024E-20 /)
    REAL, PARAMETER :: a1_2_HOCl(dim55) = (/ &
       3.6364E-24,  3.4399E-25, -1.0800E-24, -3.1041E-24, -4.2294E-24, -4.8071E-24, &
      -5.4510E-24, -5.0296E-24, -5.4222E-24, -4.5229E-24, -4.8130E-24, -3.7983E-24, &
      -4.0431E-24, -3.1024E-24, -3.3541E-24, -2.5164E-24, -2.7714E-24, -2.0509E-24, &
      -2.3048E-24, -1.6850E-24, -1.9349E-24, -1.3980E-24, -1.6395E-24, -1.1724E-24, &
      -1.4006E-24, -9.9152E-25, -1.2072E-24, -8.4566E-25, -1.0477E-24, -7.2662E-25, &
      -9.1545E-25, -6.2782E-25, -8.0315E-25, -5.4645E-25, -7.0989E-25, -4.7718E-25, &
      -6.2922E-25, -4.1962E-25, -5.6065E-25, -3.6968E-25, -3.9508E-25, -2.8000E-25, &
      -2.3765E-25, -1.7316E-25, -1.5356E-25, -1.1413E-25, -1.0497E-25, -7.9103E-26, &
      -9.0218E-26, -7.5400E-26, -6.3671E-26, -5.4071E-26, -4.6220E-26, -3.9655E-26, &
      -3.4192E-26 /)
    REAL, PARAMETER :: b1_2_HOCl(dim55) = (/ &
       2.2007E-22,  2.2995E-22,  2.3778E-22,  2.5397E-22,  2.6579E-22,  2.7330E-22, &
       2.8328E-22,  2.7569E-22,  2.8374E-22,  2.6306E-22,  2.7045E-22,  2.4204E-22, &
       2.4951E-22,  2.1847E-22,  2.2740E-22,  1.9557E-22,  2.0590E-22,  1.7491E-22, &
       1.8646E-22,  1.5672E-22,  1.6934E-22,  1.4088E-22,  1.5428E-22,  1.2719E-22, &
       1.4100E-22,  1.1523E-22,  1.2935E-22,  1.0477E-22,  1.1901E-22,  9.5573E-23, &
       1.0983E-22,  8.7394E-23,  1.0151E-22,  8.0202E-23,  9.4176E-23,  7.3697E-23, &
       8.7457E-23,  6.7964E-23,  8.1433E-23,  6.2717E-23,  6.5271E-23,  5.2267E-23, &
       4.6952E-23,  3.8052E-23,  3.5102E-23,  2.8675E-23,  2.7067E-23,  2.2204E-23, &
       2.4433E-23,  2.1277E-23,  1.8632E-23,  1.6347E-23,  1.4381E-23,  1.2654E-23, &
       1.1149E-23 /)
    REAL, PARAMETER :: a2_HOCl(dim55) = (/ &
      -2.3504E-21, -1.9568E-21, -1.5212E-21, -1.1152E-21, -7.8000E-22, -5.2600E-22, &
      -3.4400E-22, -2.1960E-22, -1.3720E-22, -8.2800E-23, -4.8400E-23, -2.6000E-23, &
      -1.2400E-23, -3.2000E-24,  2.4000E-24,  5.6000E-24,  7.2000E-24,  8.8000E-24, &
       9.2000E-24,  9.2000E-24,  9.2000E-24,  8.8000E-24,  8.8000E-24,  8.4000E-24, &
       8.0000E-24,  7.6000E-24,  7.2000E-24,  6.8000E-24,  6.8000E-24,  6.0000E-24, &
       6.0000E-24,  5.2000E-24,  5.2000E-24,  5.2000E-24,  4.4000E-24,  4.4000E-24, &
       4.0000E-24,  4.0000E-24,  3.6000E-24,  3.2000E-24,  2.8800E-24,  2.0800E-24, &
       1.5200E-24,  1.1200E-24,  8.0000E-25,  6.4000E-25,  4.0000E-25,  3.2000E-25, &
       2.4000E-25,  1.6000E-25,  8.0000E-26,  1.6000E-25,  0.0000E+00,  8.0000E-26, &
       0.0000E+00 /)
    REAL, PARAMETER :: b2_HOCl(dim55) = (/ &
       7.2822E-20,  7.1641E-20,  6.9246E-20,  6.5998E-20,  6.2478E-20,  5.9176E-20, &
       5.6355E-20,  5.4116E-20,  5.2427E-20,  5.1175E-20,  5.0298E-20,  4.9671E-20, &
       4.9256E-20,  4.8953E-20,  4.8754E-20,  4.8632E-20,  4.8567E-20,  4.8499E-20, &
       4.8480E-20,  4.8480E-20,  4.8480E-20,  4.8502E-20,  4.8502E-20,  4.8525E-20, &
       4.8549E-20,  4.8574E-20,  4.8600E-20,  4.8628E-20,  4.8628E-20,  4.8686E-20, &
       4.8686E-20,  4.8748E-20,  4.8748E-20,  4.8748E-20,  4.8817E-20,  4.8817E-20, &
       4.8853E-20,  4.8853E-20,  4.8891E-20,  4.8930E-20,  4.8963E-20,  4.9053E-20, &
       4.9123E-20,  4.9178E-20,  4.9227E-20,  4.9253E-20,  4.9295E-20,  4.9310E-20, &
       4.9326E-20,  4.9343E-20,  4.9361E-20,  4.9342E-20,  4.9382E-20,  4.9361E-20, &
       4.9383E-20 /)
    REAL, PARAMETER :: a3_HOCl(dim55) = (/ &
       2.4903E-23,  1.4840E-23,  7.8042E-24,  4.2444E-24,  2.5163E-24,  1.6088E-24, &
       1.1124E-24,  8.0452E-25,  5.8189E-25,  4.6209E-25,  3.5947E-25,  3.0806E-25, &
       2.3960E-25,  1.8829E-25,  1.7114E-25,  1.3694E-25,  1.1980E-25,  1.0265E-25, &
       1.0274E-25,  6.8493E-26,  6.8376E-26,  6.8493E-26,  5.1370E-26,  5.1370E-26, &
       5.1282E-26,  3.4247E-26,  3.4247E-26,  3.4247E-26,  1.7094E-26,  3.4247E-26, &
       1.7123E-26,  1.7123E-26,  1.7094E-26,  1.7123E-26,  1.7123E-26,  1.7094E-26, &
       1.7123E-26,  1.7123E-26,  0.0000E+00,  1.7094E-26,  6.8470E-27,  6.8470E-27, &
       3.4223E-27,  3.4235E-27,  0.0000E+00,  3.4223E-27,  0.0000E+00,  0.0000E+00, &
       0.0000E+00,  3.4235E-27,  0.0000E+00,  0.0000E+00,  0.0000E+00,  0.0000E+00, &
       0.0000E+00 /)
    REAL, PARAMETER :: b3_HOCl(dim55) = (/ &
       5.7600E-20,  5.8193E-20,  5.9018E-20,  5.9644E-20,  6.0049E-20,  6.0314E-20, &
       6.0488E-20,  6.0615E-20,  6.0719E-20,  6.0782E-20,  6.0842E-20,  6.0875E-20, &
       6.0923E-20,  6.0962E-20,  6.0976E-20,  6.1006E-20,  6.1022E-20,  6.1039E-20, &
       6.1039E-20,  6.1077E-20,  6.1077E-20,  6.1077E-20,  6.1099E-20,  6.1099E-20, &
       6.1099E-20,  6.1124E-20,  6.1124E-20,  6.1124E-20,  6.1152E-20,  6.1123E-20, &
       6.1153E-20,  6.1153E-20,  6.1153E-20,  6.1153E-20,  6.1153E-20,  6.1153E-20, &
       6.1153E-20,  6.1153E-20,  6.1191E-20,  6.1152E-20,  6.1176E-20,  6.1176E-20, &
       6.1186E-20,  6.1186E-20,  6.1198E-20,  6.1185E-20,  6.1199E-20,  6.1199E-20, &
       6.1199E-20,  6.1182E-20,  6.1200E-20,  6.1200E-20,  6.1200E-20,  6.1200E-20, &
       6.1200E-20 /)
    REAL, PARAMETER :: a4_HOCl(4) = (/  5.9534E-20, -9.4083E-25,  1.7638E-28, -1.1656E-32 /)
    REAL, PARAMETER :: a5_HOCl(4) = (/  3.9889E-20, -2.9434E-24,  4.4384E-28, -2.6663E-32 /)
    REAL, PARAMETER :: a6_HOCl(4) = (/  6.2956E-21, -3.5185E-26,  3.9252E-31, -2.2997E-36 /)

    jval_2d(ip_HOCl)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_HOCl(0) = &
          p1(a0_1_1_HOCl(i0(j,k))*dlv2(j,k) + &
          a0_1_2_HOCl(i0(j,k)), &
          a0_2_1_HOCl(i0(j,k))*dlv2(j,k) + &
          a0_2_2_HOCl(i0(j,k)),v3_du1(j,k))
        sig_HOCl(1) = &
          (p1(b1_1_HOCl(i1(j,k)),a1_1_HOCl(i1(j,k)), &
          v3_du1(j,k)) + &
          p1(b1_2_HOCl(i1(j,k)),a1_2_HOCl(i1(j,k)), &
          v3_du1(j,k)) * v2s_m(j,k))
        sig_HOCl(2) = &
          p1(b2_HOCl(i2(j,k)), a2_HOCl(i2(j,k)), &
          v3_du1(j,k))
        sig_HOCl(3) = &
          p1(b3_HOCl(i3(j,k)), a3_HOCl(i3(j,k)), &
          v3_du2(j,k))
        sig_HOCl(4) = &
          p3(a4_HOCl(1),a4_HOCl(2),a4_HOCl(3), &
          a4_HOCl(4),v3_du2(j,k))
        sig_HOCl(5) = &
          p3(a5_HOCl(1),a5_HOCl(2),a5_HOCl(3), &
          a5_HOCl(4),v3_du2(j,k))
        sig_HOCl(6) = &
          p3(a6_HOCl(1),a6_HOCl(2),a6_HOCl(3), &
          a6_HOCl(4),v3_du2(j,k))
        dj = 0. &
          + sig_HOCl(0) * fint(j,k,0) &
          + sig_HOCl(1) * fint(j,k,1) &
          + sig_HOCl(2) * fint(j,k,2) &
          + sig_HOCl(3) * fint(j,k,3) &
          + sig_HOCl(4) * fint(j,k,4) &
          + sig_HOCl(5) * fint(j,k,5) &
          + sig_HOCl(6) * fint(j,k,6)

        jval_2d(ip_HOCl)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,3)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_HOCl

  ! **************************************************************************

  SUBROUTINE jval_cal_OClO

    ! OClO \TOHV\ \products

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_OClO

    ! T-const parameters:
    REAL, PARAMETER :: a2_OClO(dim55) = (/ &
       1.8076E-20,  1.6928E-20,  1.4904E-20,  1.2512E-20,  1.0168E-20,  8.1120E-21, &
       6.4320E-21,  5.1080E-21,  4.0960E-21,  3.3280E-21,  2.7480E-21,  2.2960E-21, &
       1.9520E-21,  1.6840E-21,  1.4680E-21,  1.2960E-21,  1.1520E-21,  1.0320E-21, &
       9.3600E-22,  8.4800E-22,  7.7600E-22,  7.0800E-22,  6.5600E-22,  6.0400E-22, &
       5.6000E-22,  5.1600E-22,  4.8000E-22,  4.4800E-22,  4.2000E-22,  3.8800E-22, &
       3.6400E-22,  3.4000E-22,  3.1600E-22,  3.0000E-22,  2.7600E-22,  2.6000E-22, &
       2.4400E-22,  2.2800E-22,  2.1600E-22,  2.0000E-22,  1.6640E-22,  1.2080E-22, &
       8.8000E-23,  6.4000E-23,  4.7200E-23,  3.3600E-23,  2.4800E-23,  1.7600E-23, &
       1.2800E-23,  9.6000E-24,  7.2000E-24,  4.8000E-24,  3.2000E-24,  2.4000E-24, &
       2.4000E-24 /)
    REAL, PARAMETER :: b2_OClO(dim55) = (/ &
       5.5926E-19,  5.6271E-19,  5.7384E-19,  5.9297E-19,  6.1759E-19,  6.4431E-19, &
       6.7035E-19,  6.9419E-19,  7.1493E-19,  7.3260E-19,  7.4739E-19,  7.6004E-19, &
       7.7053E-19,  7.7938E-19,  7.8705E-19,  7.9358E-19,  7.9941E-19,  8.0457E-19, &
       8.0894E-19,  8.1317E-19,  8.1680E-19,  8.2041E-19,  8.2329E-19,  8.2631E-19, &
       8.2897E-19,  8.3174E-19,  8.3410E-19,  8.3628E-19,  8.3825E-19,  8.4059E-19, &
       8.4240E-19,  8.4427E-19,  8.4620E-19,  8.4753E-19,  8.4958E-19,  8.5099E-19, &
       8.5244E-19,  8.5393E-19,  8.5507E-19,  8.5664E-19,  8.6002E-19,  8.6517E-19, &
       8.6929E-19,  8.7260E-19,  8.7513E-19,  8.7734E-19,  8.7889E-19,  8.8024E-19, &
       8.8120E-19,  8.8189E-19,  8.8243E-19,  8.8300E-19,  8.8340E-19,  8.8361E-19, &
       8.8361E-19 /)
    REAL, PARAMETER :: a3_OClO(dim55) = (/ &
       2.0710E-21,  1.3779E-21,  8.7969E-22,  6.2639E-22,  5.0668E-22,  4.5182E-22, &
       4.2444E-22,  4.1424E-22,  4.0904E-22,  4.1075E-22,  4.1082E-22,  4.1246E-22, &
       4.1075E-22,  4.1082E-22,  4.0733E-22,  4.0397E-22,  3.9706E-22,  3.9008E-22, &
       3.8185E-22,  3.7500E-22,  3.6239E-22,  3.5445E-22,  3.4418E-22,  3.3390E-22, &
       3.2308E-22,  3.1164E-22,  2.9966E-22,  2.9110E-22,  2.7863E-22,  2.6884E-22, &
       2.5856E-22,  2.4829E-22,  2.3932E-22,  2.2774E-22,  2.2089E-22,  2.0855E-22, &
       2.0205E-22,  1.9349E-22,  1.8493E-22,  1.7607E-22,  1.5543E-22,  1.2359E-22, &
       9.8220E-23,  7.7713E-23,  6.1280E-23,  4.8597E-23,  3.8343E-23,  3.0127E-23, &
       2.3956E-23,  1.8829E-23,  1.4721E-23,  1.1636E-23,  9.2434E-24,  7.5317E-24, &
       5.4757E-24 /)
    REAL, PARAMETER :: b3_OClO(dim55) = (/ &
       1.3937E-18,  1.4345E-18,  1.4930E-18,  1.5375E-18,  1.5655E-18,  1.5816E-18, &
       1.5912E-18,  1.5954E-18,  1.5978E-18,  1.5969E-18,  1.5969E-18,  1.5958E-18, &
       1.5970E-18,  1.5970E-18,  1.5998E-18,  1.6028E-18,  1.6092E-18,  1.6162E-18, &
       1.6248E-18,  1.6324E-18,  1.6472E-18,  1.6569E-18,  1.6701E-18,  1.6839E-18, &
       1.6991E-18,  1.7158E-18,  1.7340E-18,  1.7476E-18,  1.7679E-18,  1.7846E-18, &
       1.8026E-18,  1.8212E-18,  1.8380E-18,  1.8603E-18,  1.8739E-18,  1.8991E-18, &
       1.9128E-18,  1.9313E-18,  1.9503E-18,  1.9705E-18,  2.0188E-18,  2.1025E-18, &
       2.1766E-18,  2.2425E-18,  2.3001E-18,  2.3483E-18,  2.3903E-18,  2.4263E-18, &
       2.4551E-18,  2.4806E-18,  2.5022E-18,  2.5193E-18,  2.5333E-18,  2.5438E-18, &
       2.5570E-18 /)
    REAL, PARAMETER :: a4_OClO(4) = (/  2.4490E-18,  2.5531E-22, -9.6558E-26,  7.7283E-30 /)
    REAL, PARAMETER :: a5_OClO(4) = (/  3.7632E-18,  2.5970E-22, -3.5142E-26,  2.1125E-30 /)
    REAL, PARAMETER :: a6_OClO(4) = (/  2.9154E-18, -2.9878E-24,  1.1519E-29,  1.5396E-34 /)
    REAL, PARAMETER :: a7_OClO(4) = (/  3.4538E-20,  2.1483E-24,  3.5802E-29, -7.7389E-34 /)

    jval_2d(ip_OClO)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_OClO(2) = &
          p1(b2_OClO(i2(j,k)), a2_OClO(i2(j,k)), &
          v3_du1(j,k))
        sig_OClO(3) = &
          p1(b3_OClO(i3(j,k)), a3_OClO(i3(j,k)), &
          v3_du2(j,k))
        sig_OClO(4) = &
          p3(a4_OClO(1),a4_OClO(2),a4_OClO(3), &
          a4_OClO(4),v3_du2(j,k))
        sig_OClO(5) = &
          p3(a5_OClO(1),a5_OClO(2),a5_OClO(3), &
          a5_OClO(4),v3_du2(j,k))
        sig_OClO(6) = &
          p3(a6_OClO(1),a6_OClO(2),a6_OClO(3), &
          a6_OClO(4),v3_du2(j,k))
        sig_OClO(7) = &
          p3(a7_OClO(1),a7_OClO(2),a7_OClO(3), &
          a7_OClO(4),v3_du2(j,k))
        dj = 0. &
          + sig_OClO(2) * fint(j,k,2) &
          + sig_OClO(3) * fint(j,k,3) &
          + sig_OClO(4) * fint(j,k,4) &
          + sig_OClO(5) * fint(j,k,5) &
          + sig_OClO(6) * fint(j,k,6) &
          + sig_OClO(7) * fint(j,k,7)

        jval_2d(ip_OClO)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,1)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_OClO

  ! **************************************************************************

  SUBROUTINE jval_cal_Cl2O2

    ! Cl_2O_2 \TOHV\ Cl + ClO_2

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_Cl2O2

    ! T-const parameters:
    REAL, PARAMETER :: a0_1_1_Cl2O2(dim58) = (/ &
       1.6987E-20,  1.8586E-20,  2.0306E-20,  2.2105E-20,  2.3998E-20,  2.5966E-20, &
       2.8031E-20,  3.0195E-20,  3.2455E-20,  3.4838E-20,  3.7332E-20,  3.9983E-20, &
       4.8424E-20,  6.9041E-20,  6.7194E-20,  7.1073E-20,  8.1481E-20,  7.8931E-20, &
       8.2517E-20,  9.3066E-20,  8.8968E-20,  9.1473E-20,  1.0141E-19,  9.5145E-20, &
       9.6169E-20,  8.0337E-20,  7.3288E-20,  7.4996E-20,  7.7761E-20,  8.1605E-20, &
       8.6571E-20,  9.2797E-20,  1.0018E-19,  1.0843E-19,  1.1738E-19,  1.2674E-19, &
       1.3629E-19,  1.4587E-19,  1.5546E-19,  1.6514E-19,  1.7482E-19,  1.8445E-19, &
       1.9404E-19,  2.0307E-19,  2.1129E-19,  2.1789E-19,  2.2209E-19,  2.2410E-19, &
       2.2331E-19,  2.2015E-19,  2.1496E-19,  2.0792E-19,  1.9949E-19,  1.8986E-19, &
       1.7900E-19,  1.6503E-19,  1.4379E-19,  1.1797E-19 /)
    REAL, PARAMETER :: a0_1_2_Cl2O2(dim58) = (/ &
       1.2503E-20, -5.8206E-20, -1.3455E-19, -2.1479E-19, -2.9962E-19, -3.8818E-19, &
      -4.8151E-19, -5.7976E-19, -6.8279E-19, -7.9195E-19, -9.0667E-19, -1.0292E-18, &
      -1.4208E-18, -2.3816E-18, -2.2951E-18, -2.4774E-18, -2.9687E-18, -2.8478E-18, &
      -3.0185E-18, -3.5228E-18, -3.3260E-18, -3.4468E-18, -3.9278E-18, -3.6233E-18, &
      -3.6733E-18, -2.8975E-18, -2.5507E-18, -2.6350E-18, -2.7722E-18, -2.9636E-18, &
      -3.2119E-18, -3.5245E-18, -3.8966E-18, -4.3138E-18, -4.7688E-18, -5.2460E-18, &
      -5.7349E-18, -6.2276E-18, -6.7223E-18, -7.2239E-18, -7.7268E-18, -8.2300E-18, &
      -8.7321E-18, -9.2073E-18, -9.6411E-18, -9.9912E-18, -1.0214E-17, -1.0322E-17, &
      -1.0279E-17, -1.0110E-17, -9.8290E-18, -9.4478E-18, -8.9892E-18, -8.4635E-18, &
      -7.8683E-18, -7.0999E-18, -5.9275E-18, -4.4968E-18 /)
    REAL, PARAMETER :: a0_2_1_Cl2O2(dim58) = (/ &
       8.7737E-23,  9.6904E-23,  1.0670E-22,  1.1749E-22,  1.2914E-22,  1.4167E-22, &
       1.5524E-22,  1.6981E-22,  1.8560E-22,  2.0275E-22,  2.2150E-22,  2.4217E-22, &
       1.7999E-22, -5.1062E-23,  5.7137E-23,  8.3713E-23,  2.9031E-23,  1.4542E-22, &
       1.8097E-22,  1.3489E-22,  2.6046E-22,  3.0388E-22,  2.6486E-22,  3.9553E-22, &
       4.4184E-22,  6.4900E-22,  7.5805E-22,  7.7101E-22,  7.6566E-22,  7.4107E-22, &
       6.9512E-22,  6.2793E-22,  5.4183E-22,  4.4158E-22,  3.3387E-22,  2.2439E-22, &
       1.2212E-22,  3.1050E-23, -4.4448E-23, -1.0297E-22, -1.4469E-22, -1.7123E-22, &
      -1.8655E-22, -1.9380E-22, -1.9631E-22, -1.9501E-22, -1.9002E-22, -1.8299E-22, &
      -1.7381E-22, -1.6409E-22, -1.5335E-22, -1.4264E-22, -1.3098E-22, -1.1865E-22, &
      -1.0562E-22, -9.0322E-23, -7.5382E-23, -6.3570E-23 /)
    REAL, PARAMETER :: a0_2_2_Cl2O2(dim58) = (/ &
      -5.0575E-21, -5.4627E-21, -5.8976E-21, -6.3788E-21, -6.9007E-21, -7.4644E-21, &
      -8.0778E-21, -8.7394E-21, -9.4596E-21, -1.0245E-20, -1.1108E-20, -1.2062E-20, &
      -9.1774E-21,  1.5898E-21, -3.4739E-21, -4.7230E-21, -2.1420E-21, -7.6590E-21, &
      -9.3509E-21, -7.1482E-21, -1.3176E-20, -1.5268E-20, -1.3380E-20, -1.9731E-20, &
      -2.1990E-20, -3.2141E-20, -3.7507E-20, -3.8147E-20, -3.7881E-20, -3.6657E-20, &
      -3.4360E-20, -3.0986E-20, -2.6647E-20, -2.1574E-20, -1.6103E-20, -1.0519E-20, &
      -5.2829E-21, -6.0196E-22,  3.2937E-21,  6.3250E-21,  8.4944E-21,  9.8801E-21, &
       1.0683E-20,  1.1064E-20,  1.1197E-20,  1.1128E-20,  1.0862E-20,  1.0487E-20, &
       9.9948E-21,  9.4720E-21,  8.8919E-21,  8.3114E-21,  7.6769E-21,  7.0041E-21, &
       6.2897E-21,  5.4485E-21,  4.6238E-21,  3.9694E-21 /)
    REAL, PARAMETER :: a1_1_Cl2O2(dim55) = (/ &
      -9.5384E-20, -8.3819E-20, -7.0364E-20, -5.8659E-20, -4.5648E-20, -3.6882E-20, &
      -2.6608E-20, -2.1271E-20, -1.3993E-20, -1.1177E-20, -6.3036E-21, -5.0477E-21, &
      -1.7540E-21, -1.3839E-21,  8.6590E-22,  7.9794E-22,  2.3577E-21,  2.0929E-21, &
       3.2070E-21,  2.8591E-21,  3.6640E-21,  3.3075E-21,  3.9179E-21,  3.5397E-21, &
       4.0145E-21,  3.6567E-21,  4.0506E-21,  3.6895E-21,  3.9974E-21,  3.7126E-21, &
       3.9124E-21,  3.6607E-21,  3.8422E-21,  3.6032E-21,  3.7475E-21,  3.5300E-21, &
       3.6254E-21,  3.4545E-21,  3.5289E-21,  3.3566E-21,  3.2929E-21,  3.0524E-21, &
       2.8524E-21,  2.6632E-21,  2.4926E-21,  2.3434E-21,  2.1953E-21,  2.0786E-21, &
       1.9151E-21,  1.7938E-21,  1.6789E-21,  1.5772E-21,  1.4811E-21,  1.3897E-21, &
       1.3083E-21 /)
    REAL, PARAMETER :: b1_1_Cl2O2(dim55) = (/ &
       3.9493E-18,  3.9146E-18,  3.8406E-18,  3.7470E-18,  3.6104E-18,  3.4964E-18, &
       3.3372E-18,  3.2411E-18,  3.0919E-18,  3.0272E-18,  2.9029E-18,  2.8677E-18, &
       2.7673E-18,  2.7550E-18,  2.6752E-18,  2.6778E-18,  2.6146E-18,  2.6260E-18, &
       2.5753E-18,  2.5920E-18,  2.5513E-18,  2.5702E-18,  2.5364E-18,  2.5583E-18, &
       2.5296E-18,  2.5521E-18,  2.5263E-18,  2.5509E-18,  2.5292E-18,  2.5499E-18, &
       2.5349E-18,  2.5545E-18,  2.5399E-18,  2.5597E-18,  2.5474E-18,  2.5665E-18, &
       2.5579E-18,  2.5738E-18,  2.5667E-18,  2.5836E-18,  2.5900E-18,  2.6171E-18, &
       2.6422E-18,  2.6683E-18,  2.6940E-18,  2.7183E-18,  2.7443E-18,  2.7663E-18, &
       2.7990E-18,  2.8249E-18,  2.8508E-18,  2.8750E-18,  2.8991E-18,  2.9231E-18, &
       2.9455E-18 /)
    REAL, PARAMETER :: a1_2_Cl2O2(dim55) = (/ &
      -9.8546E-23, -1.6402E-22, -2.3047E-22, -2.3681E-22, -2.7566E-22, -2.3701E-22, &
      -2.5470E-22, -1.9747E-22, -2.0486E-22, -1.4920E-22, -1.5277E-22, -1.0662E-22, &
      -1.1028E-22, -7.4469E-23, -7.8432E-23, -5.1571E-23, -5.5695E-23, -3.5723E-23, &
      -3.9860E-23, -2.4739E-23, -2.8571E-23, -1.7315E-23, -2.0691E-23, -1.1947E-23, &
      -1.5036E-23, -8.1789E-24, -1.1016E-23, -5.4461E-24, -7.8991E-24, -3.6871E-24, &
      -5.5046E-24, -2.2549E-24, -3.9139E-24, -1.2020E-24, -2.6618E-24, -4.0015E-25, &
      -1.5545E-24,  7.0196E-26, -7.7636E-25,  5.7932E-25,  4.8880E-25,  1.2049E-24, &
       1.4412E-24,  1.5870E-24,  1.6446E-24,  1.6157E-24,  1.6447E-24,  1.5402E-24, &
       1.7621E-24,  1.7836E-24,  1.7936E-24,  1.7827E-24,  1.7697E-24,  1.7564E-24, &
       1.7223E-24 /)
    REAL, PARAMETER :: b1_2_Cl2O2(dim55) = (/ &
       6.5253E-21,  6.7217E-21,  7.0872E-21,  7.1379E-21,  7.5458E-21,  7.0433E-21, &
       7.3176E-21,  6.2875E-21,  6.4389E-21,  5.1587E-21,  5.2498E-21,  3.9576E-21, &
       4.0690E-21,  2.8874E-21,  3.0280E-21,  2.0073E-21,  2.1744E-21,  1.3156E-21, &
       1.5038E-21,  7.7801E-22,  9.7154E-22,  3.7495E-22,  5.6231E-22,  5.5156E-23, &
       2.4202E-22, -1.8995E-22, -4.1354E-24, -3.8287E-22, -2.0994E-22, -5.1741E-22, &
      -3.8019E-22, -6.3367E-22, -5.0013E-22, -7.2521E-22, -6.0040E-22, -7.9942E-22, &
      -6.9496E-22, -8.4605E-22, -7.6520E-22, -8.9806E-22, -8.8896E-22, -9.6988E-22, &
      -9.9954E-22, -1.0197E-21, -1.0283E-21, -1.0236E-21, -1.0287E-21, -1.0091E-21, &
      -1.0536E-21, -1.0581E-21, -1.0604E-21, -1.0578E-21, -1.0545E-21, -1.0510E-21, &
      -1.0416E-21 /)
    REAL, PARAMETER :: a2_Cl2O2(dim55) = (/ &
      -1.2140E-19, -1.0528E-19, -8.5800E-20, -6.6640E-20, -4.9960E-20, -3.6720E-20, &
      -2.6680E-20, -1.9520E-20, -1.4360E-20, -1.0720E-20, -8.2400E-21, -6.4000E-21, &
      -5.1200E-21, -4.1600E-21, -3.4800E-21, -2.9600E-21, -2.5200E-21, -2.2000E-21, &
      -1.9600E-21, -1.7200E-21, -1.5600E-21, -1.4000E-21, -1.2800E-21, -1.1600E-21, &
      -1.0400E-21, -1.0000E-21, -8.8000E-22, -8.4000E-22, -8.0000E-22, -7.2000E-22, &
      -6.4000E-22, -6.4000E-22, -5.6000E-22, -5.6000E-22, -4.8000E-22, -4.8000E-22, &
      -4.4000E-22, -4.4000E-22, -3.6000E-22, -3.6000E-22, -2.9600E-22, -2.1600E-22, &
      -1.6000E-22, -1.1200E-22, -8.0000E-23, -6.4000E-23, -4.0000E-23, -3.2000E-23, &
      -2.4000E-23, -1.6000E-23, -8.0000E-24, -1.6000E-23,  0.0000E+00, -8.0000E-24, &
       0.0000E+00 /)
    REAL, PARAMETER :: b2_Cl2O2(dim55) = (/ &
       2.7571E-18,  2.7087E-18,  2.6016E-18,  2.4483E-18,  2.2732E-18,  2.1011E-18, &
       1.9454E-18,  1.8166E-18,  1.7108E-18,  1.6271E-18,  1.5638E-18,  1.5123E-18, &
       1.4733E-18,  1.4416E-18,  1.4174E-18,  1.3977E-18,  1.3799E-18,  1.3661E-18, &
       1.3552E-18,  1.3437E-18,  1.3356E-18,  1.3271E-18,  1.3204E-18,  1.3135E-18, &
       1.3062E-18,  1.3037E-18,  1.2958E-18,  1.2931E-18,  1.2903E-18,  1.2845E-18, &
       1.2784E-18,  1.2784E-18,  1.2720E-18,  1.2720E-18,  1.2651E-18,  1.2651E-18, &
       1.2615E-18,  1.2615E-18,  1.2539E-18,  1.2539E-18,  1.2474E-18,  1.2384E-18, &
       1.2314E-18,  1.2248E-18,  1.2199E-18,  1.2173E-18,  1.2131E-18,  1.2116E-18, &
       1.2100E-18,  1.2083E-18,  1.2065E-18,  1.2084E-18,  1.2044E-18,  1.2065E-18, &
       1.2043E-18 /)
    REAL, PARAMETER :: a3_Cl2O2(dim55) = (/ &
      -1.3660E-21, -8.5651E-22, -4.8400E-22, -2.8701E-22, -1.8658E-22, -1.3127E-22, &
      -9.8066E-23, -7.6686E-23, -6.1954E-23, -5.1343E-23, -4.3478E-23, -3.7481E-23, &
      -3.2860E-23, -2.8757E-23, -2.5672E-23, -2.2937E-23, -2.0709E-23, -1.8820E-23, &
      -1.7123E-23, -1.5582E-23, -1.4359E-23, -1.3185E-23, -1.2158E-23, -1.1301E-23, &
      -1.0427E-23, -9.7603E-24, -9.0753E-24, -8.5616E-24, -7.8632E-24, -7.3630E-24, &
      -7.0205E-24, -6.5068E-24, -5.9829E-24, -5.8219E-24, -5.3082E-24, -5.1282E-24, &
      -4.7945E-24, -4.4521E-24, -4.2808E-24, -3.9316E-24, -3.3893E-24, -2.5676E-24, &
      -1.9507E-24, -1.5063E-24, -1.1640E-24, -8.8980E-25, -6.8470E-25, -5.4776E-25, &
      -4.1068E-25, -3.4235E-25, -2.3964E-25, -2.0534E-25, -1.7117E-25, -1.0270E-25, &
      -1.0267E-25 /)
    REAL, PARAMETER :: b3_Cl2O2(dim55) = (/ &
       7.6034E-19,  7.3032E-19,  6.8661E-19,  6.5198E-19,  6.2846E-19,  6.1227E-19, &
       6.0062E-19,  5.9186E-19,  5.8497E-19,  5.7938E-19,  5.7478E-19,  5.7093E-19, &
       5.6769E-19,  5.6457E-19,  5.6204E-19,  5.5964E-19,  5.5756E-19,  5.5568E-19, &
       5.5390E-19,  5.5219E-19,  5.5076E-19,  5.4931E-19,  5.4799E-19,  5.4684E-19, &
       5.4562E-19,  5.4464E-19,  5.4360E-19,  5.4279E-19,  5.4165E-19,  5.4080E-19, &
       5.4020E-19,  5.3927E-19,  5.3829E-19,  5.3798E-19,  5.3696E-19,  5.3659E-19, &
       5.3589E-19,  5.3515E-19,  5.3477E-19,  5.3397E-19,  5.3270E-19,  5.3054E-19, &
       5.2874E-19,  5.2731E-19,  5.2611E-19,  5.2507E-19,  5.2423E-19,  5.2363E-19, &
       5.2299E-19,  5.2265E-19,  5.2211E-19,  5.2192E-19,  5.2172E-19,  5.2130E-19, &
       5.2130E-19 /)
    REAL, PARAMETER :: a4_Cl2O2(4) = (/  4.2166E-19, -2.9502E-23,  6.0564E-27, -4.1999E-31 /)
    REAL, PARAMETER :: a5_Cl2O2(4) = (/  2.3599E-19, -1.6798E-23,  2.7364E-27, -1.7005E-31 /)
    REAL, PARAMETER :: a6_Cl2O2(4) = (/  3.9216E-20, -2.7001E-25,  2.9273E-30, -2.0926E-35 /)
    REAL, PARAMETER :: a7_Cl2O2(4) = (/  7.7570E-22,  4.0814E-26,  5.1366E-31, -1.5845E-35 /)

    jval_2d(ip_Cl2O2)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_Cl2O2(0) = &
          p1(a0_1_1_Cl2O2(i0(j,k))*dlv2(j,k) + &
          a0_1_2_Cl2O2(i0(j,k)), &
          a0_2_1_Cl2O2(i0(j,k))*dlv2(j,k) + &
          a0_2_2_Cl2O2(i0(j,k)),v3_du1(j,k))
        sig_Cl2O2(1) = &
          (p1(b1_1_Cl2O2(i1(j,k)),a1_1_Cl2O2(i1(j,k)), &
          v3_du1(j,k)) + &
          p1(b1_2_Cl2O2(i1(j,k)),a1_2_Cl2O2(i1(j,k)), &
          v3_du1(j,k)) * v2s_m(j,k))
        sig_Cl2O2(2) = &
          p1(b2_Cl2O2(i2(j,k)), a2_Cl2O2(i2(j,k)), &
          v3_du1(j,k))
        sig_Cl2O2(3) = &
          p1(b3_Cl2O2(i3(j,k)), a3_Cl2O2(i3(j,k)), &
          v3_du2(j,k))
        sig_Cl2O2(4) = &
          p3(a4_Cl2O2(1),a4_Cl2O2(2),a4_Cl2O2(3), &
          a4_Cl2O2(4),v3_du2(j,k))
        sig_Cl2O2(5) = &
          p3(a5_Cl2O2(1),a5_Cl2O2(2),a5_Cl2O2(3), &
          a5_Cl2O2(4),v3_du2(j,k))
        sig_Cl2O2(6) = &
          p3(a6_Cl2O2(1),a6_Cl2O2(2),a6_Cl2O2(3), &
          a6_Cl2O2(4),v3_du2(j,k))
        sig_Cl2O2(7) = &
          p3(a7_Cl2O2(1),a7_Cl2O2(2),a7_Cl2O2(3), &
          a7_Cl2O2(4),v3_du2(j,k))
        dj = 0. &
          + sig_Cl2O2(0) * fint(j,k,0) &
          + sig_Cl2O2(1) * fint(j,k,1) &
          + sig_Cl2O2(2) * fint(j,k,2) &
          + sig_Cl2O2(3) * fint(j,k,3) &
          + sig_Cl2O2(4) * fint(j,k,4) &
          + sig_Cl2O2(5) * fint(j,k,5) &
          + sig_Cl2O2(6) * fint(j,k,6) &
          + sig_Cl2O2(7) * fint(j,k,7)

        jval_2d(ip_Cl2O2)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,2)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_Cl2O2

  ! **************************************************************************

  SUBROUTINE jval_cal_ClNO3

    ! ClNO_3 \TOHV\ Cl + NO_3

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_ClNO3

    ! T-const parameters:
    REAL, PARAMETER :: a0_1_1_ClNO3(dim58) = (/ &
       1.7974E-20,  1.9666E-20,  2.1460E-20,  2.3349E-20,  2.5313E-20,  2.7381E-20, &
       2.9510E-20,  3.1742E-20,  3.4041E-20,  3.6476E-20,  3.8993E-20,  4.1641E-20, &
       4.9793E-20,  6.9546E-20,  6.7820E-20,  7.1521E-20,  8.1324E-20,  7.8797E-20, &
       8.2000E-20,  9.1662E-20,  8.7419E-20,  8.9277E-20,  9.8036E-20,  9.1438E-20, &
       9.1587E-20,  7.5851E-20,  6.8059E-20,  6.8511E-20,  6.9812E-20,  7.1921E-20, &
       7.4920E-20,  7.8866E-20,  8.3637E-20,  8.8818E-20,  9.4316E-20,  9.9705E-20, &
       1.0476E-19,  1.0932E-19,  1.1346E-19,  1.1689E-19,  1.1973E-19,  1.2215E-19, &
       1.2359E-19,  1.2418E-19,  1.2335E-19,  1.2112E-19,  1.1666E-19,  1.1084E-19, &
       1.0334E-19,  9.4962E-20,  8.6090E-20,  7.6855E-20,  6.7251E-20,  5.7126E-20, &
       4.6300E-20,  3.5103E-20,  2.4621E-20,  1.7613E-20 /)
    REAL, PARAMETER :: a0_1_2_ClNO3(dim58) = (/ &
       8.2038E-21, -6.6616E-20, -1.4623E-19, -2.3051E-19, -3.1849E-19, -4.1154E-19, &
      -5.0780E-19, -6.0910E-19, -7.1395E-19, -8.2547E-19, -9.4123E-19, -1.0636E-18, &
      -1.4418E-18, -2.3623E-18, -2.2816E-18, -2.4555E-18, -2.9182E-18, -2.7984E-18, &
      -2.9509E-18, -3.4127E-18, -3.2091E-18, -3.2986E-18, -3.7226E-18, -3.4019E-18, &
      -3.4092E-18, -2.6381E-18, -2.2547E-18, -2.2771E-18, -2.3416E-18, -2.4466E-18, &
      -2.5965E-18, -2.7947E-18, -3.0351E-18, -3.2973E-18, -3.5766E-18, -3.8514E-18, &
      -4.1104E-18, -4.3448E-18, -4.5585E-18, -4.7357E-18, -4.8837E-18, -5.0101E-18, &
      -5.0853E-18, -5.1162E-18, -5.0724E-18, -4.9546E-18, -4.7170E-18, -4.4063E-18, &
      -4.0041E-18, -3.5536E-18, -3.0745E-18, -2.5740E-18, -2.0515E-18, -1.4987E-18, &
      -9.0543E-19, -2.8960E-19,  2.8900E-19,  6.7726E-19 /)
    REAL, PARAMETER :: a0_2_1_ClNO3(dim58) = (/ &
       8.1955E-23,  9.0450E-23,  9.9715E-23,  1.0989E-22,  1.2095E-22,  1.3270E-22, &
       1.4560E-22,  1.5946E-22,  1.7451E-22,  1.9083E-22,  2.0875E-22,  2.2851E-22, &
       1.6918E-22, -5.1369E-23,  5.1726E-23,  7.6872E-23,  2.5099E-23,  1.3530E-22, &
       1.6872E-22,  1.2514E-22,  2.4313E-22,  2.8351E-22,  2.4593E-22,  3.6752E-22, &
       4.0923E-22,  6.0132E-22,  7.0190E-22,  7.1074E-22,  7.0209E-22,  6.7466E-22, &
       6.2752E-22,  5.5984E-22,  4.7462E-22,  3.7695E-22,  2.7286E-22,  1.6871E-22, &
       7.1458E-23, -1.3108E-23, -8.3739E-23, -1.3683E-22, -1.7345E-22, -1.9652E-22, &
      -2.0777E-22, -2.1127E-22, -2.0919E-22, -2.0345E-22, -1.9288E-22, -1.8055E-22, &
      -1.6543E-22, -1.4936E-22, -1.3333E-22, -1.1693E-22, -1.0055E-22, -8.4330E-23, &
      -6.7691E-23, -5.1077E-23, -3.6308E-23, -2.6345E-23 /)
    REAL, PARAMETER :: a0_2_2_ClNO3(dim58) = (/ &
      -5.0339E-21, -5.4094E-21, -5.8208E-21, -6.2748E-21, -6.7702E-21, -7.2986E-21, &
      -7.8818E-21, -8.5114E-21, -9.1976E-21, -9.9451E-21, -1.0769E-20, -1.1682E-20, &
      -8.9292E-21,  1.3484E-21, -3.4765E-21, -4.6583E-21, -2.2147E-21, -7.4383E-21, &
      -9.0289E-21, -6.9458E-21, -1.2610E-20, -1.4556E-20, -1.2737E-20, -1.8646E-20, &
      -2.0682E-20, -3.0094E-20, -3.5042E-20, -3.5479E-20, -3.5050E-20, -3.3684E-20, &
      -3.1327E-20, -2.7929E-20, -2.3634E-20, -1.8692E-20, -1.3405E-20, -8.0929E-21, &
      -3.1137E-21,  1.2330E-21,  4.8776E-21,  7.6277E-21,  9.5318E-21,  1.0736E-20, &
       1.1326E-20,  1.1510E-20,  1.1400E-20,  1.1096E-20,  1.0534E-20,  9.8751E-21, &
       9.0644E-21,  8.2002E-21,  7.3342E-21,  6.4457E-21,  5.5546E-21,  4.6688E-21, &
       3.7570E-21,  2.8432E-21,  2.0280E-21,  1.4761E-21 /)
    REAL, PARAMETER :: a1_1_ClNO3(dim55) = (/ &
       3.1051E-20,  2.7967E-20,  2.4356E-20,  2.0869E-20,  1.7035E-20,  1.4205E-20, &
       1.0946E-20,  9.1044E-21,  6.6026E-21,  5.5620E-21,  3.7554E-21,  3.2271E-21, &
       1.9600E-21,  1.7385E-21,  8.0499E-22,  7.5967E-22,  6.0123E-23,  1.3543E-22, &
      -4.0422E-22, -2.9319E-22, -7.0779E-22, -5.7711E-22, -9.0534E-22, -7.6296E-22, &
      -1.0140E-21, -9.0122E-22, -1.0930E-21, -9.7156E-22, -1.1259E-21, -1.0157E-21, &
      -1.1656E-21, -1.0420E-21, -1.1525E-21, -1.0692E-21, -1.1518E-21, -1.0558E-21, &
      -1.1286E-21, -1.0539E-21, -1.1140E-21, -1.0403E-21, -1.0433E-21, -9.7374E-22, &
      -9.1601E-22, -8.5460E-22, -7.9438E-22, -7.4366E-22, -6.9007E-22, -6.4937E-22, &
      -5.8512E-22, -5.4205E-22, -5.0098E-22, -4.6564E-22, -4.3031E-22, -4.0214E-22, &
      -3.7126E-22 /)
    REAL, PARAMETER :: b1_1_ClNO3(dim55) = (/ &
       1.4686E-18,  1.4778E-18,  1.4977E-18,  1.5256E-18,  1.5659E-18,  1.6027E-18, &
       1.6532E-18,  1.6863E-18,  1.7376E-18,  1.7615E-18,  1.8076E-18,  1.8224E-18, &
       1.8610E-18,  1.8684E-18,  1.9015E-18,  1.9032E-18,  1.9315E-18,  1.9283E-18, &
       1.9529E-18,  1.9475E-18,  1.9685E-18,  1.9615E-18,  1.9798E-18,  1.9715E-18, &
       1.9867E-18,  1.9796E-18,  1.9921E-18,  1.9839E-18,  1.9948E-18,  1.9867E-18, &
       1.9980E-18,  1.9884E-18,  1.9973E-18,  1.9904E-18,  1.9974E-18,  1.9890E-18, &
       1.9956E-18,  1.9886E-18,  1.9944E-18,  1.9872E-18,  1.9875E-18,  1.9796E-18, &
       1.9724E-18,  1.9639E-18,  1.9548E-18,  1.9465E-18,  1.9371E-18,  1.9295E-18, &
       1.9166E-18,  1.9074E-18,  1.8982E-18,  1.8898E-18,  1.8809E-18,  1.8735E-18, &
       1.8650E-18 /)
    REAL, PARAMETER :: a1_2_ClNO3(dim55) = (/ &
       8.8971E-24,  3.4196E-23,  5.5273E-23,  6.3490E-23,  7.7203E-23,  7.0506E-23, &
       7.8132E-23,  6.3073E-23,  6.7622E-23,  5.0834E-23,  5.3957E-23,  3.8839E-23, &
       4.1235E-23,  2.8863E-23,  3.1186E-23,  2.1396E-23,  2.3695E-23,  1.5726E-23, &
       1.7979E-23,  1.1644E-23,  1.3808E-23,  8.7424E-24,  1.0551E-23,  6.5276E-24, &
       8.0904E-24,  5.0202E-24,  6.2964E-24,  3.6935E-24,  4.8209E-24,  2.7468E-24, &
       3.8708E-24,  2.0077E-24,  2.8732E-24,  1.5322E-24,  2.2271E-24,  1.0586E-24, &
       1.6355E-24,  7.0551E-25,  1.2473E-24,  4.5522E-25,  4.2302E-25, -6.2550E-26, &
      -2.6189E-25, -4.1085E-25, -5.0094E-25, -5.2390E-25, -5.6913E-25, -5.3925E-25, &
      -6.6574E-25, -6.7150E-25, -6.8383E-25, -6.7373E-25, -6.6920E-25, -6.4980E-25, &
      -6.4165E-25 /)
    REAL, PARAMETER :: b1_2_ClNO3(dim55) = (/ &
      -2.1074E-21, -2.1833E-21, -2.2992E-21, -2.3649E-21, -2.5089E-21, -2.4218E-21, &
      -2.5401E-21, -2.2690E-21, -2.3623E-21, -1.9761E-21, -2.0558E-21, -1.6325E-21, &
      -1.7056E-21, -1.2973E-21, -1.3797E-21, -1.0077E-21, -1.1008E-21, -7.5816E-22, &
      -8.6066E-22, -5.5658E-22, -6.6584E-22, -3.9738E-22, -4.9774E-22, -2.6440E-22, &
      -3.5895E-22, -1.6553E-22, -2.4913E-22, -7.2127E-23, -1.5161E-22, -2.0121E-25, &
      -8.5059E-23,  6.0263E-23, -9.4093E-24,  1.0189E-22,  4.2476E-23,  1.4530E-22, &
       9.3098E-23,  1.7958E-22,  1.2784E-22,  2.0547E-22,  2.0870E-22,  2.6357E-22, &
       2.8859E-22,  3.0915E-22,  3.2270E-22,  3.2645E-22,  3.3439E-22,  3.2877E-22, &
       3.5413E-22,  3.5536E-22,  3.5814E-22,  3.5573E-22,  3.5460E-22,  3.4950E-22, &
       3.4725E-22 /)
    REAL, PARAMETER :: a2_ClNO3(dim55) = (/ &
      -6.1656E-21, -5.3780E-21, -4.4040E-21, -3.4276E-21, -2.5720E-21, -1.8860E-21, &
      -1.3696E-21, -9.9400E-22, -7.2800E-22, -5.4040E-22, -4.0920E-22, -3.1680E-22, &
      -2.5040E-22, -2.0200E-22, -1.6720E-22, -1.4040E-22, -1.1960E-22, -1.0400E-22, &
      -9.1200E-23, -8.1200E-23, -7.2000E-23, -6.5200E-23, -5.9200E-23, -5.3600E-23, &
      -4.9200E-23, -4.5200E-23, -4.1600E-23, -3.8400E-23, -3.5600E-23, -3.3200E-23, &
      -3.0400E-23, -2.8400E-23, -2.6800E-23, -2.4400E-23, -2.3200E-23, -2.1600E-23, &
      -2.0000E-23, -1.8800E-23, -1.7600E-23, -1.6400E-23, -1.3600E-23, -9.7600E-24, &
      -7.1200E-24, -5.2000E-24, -3.6800E-24, -2.7200E-24, -2.0000E-24, -1.4400E-24, &
      -1.0400E-24, -7.2000E-25, -5.6000E-25, -4.0000E-25, -3.2000E-25, -1.6000E-25, &
      -1.6000E-25 /)
    REAL, PARAMETER :: b2_ClNO3(dim55) = (/ &
       1.1786E-19,  1.1550E-19,  1.1014E-19,  1.0233E-19,  9.3348E-20,  8.4430E-20, &
       7.6426E-20,  6.9665E-20,  6.4212E-20,  5.9897E-20,  5.6552E-20,  5.3964E-20, &
       5.1939E-20,  5.0342E-20,  4.9107E-20,  4.8088E-20,  4.7246E-20,  4.6575E-20, &
       4.5993E-20,  4.5513E-20,  4.5048E-20,  4.4688E-20,  4.4355E-20,  4.4030E-20, &
       4.3764E-20,  4.3512E-20,  4.3276E-20,  4.3058E-20,  4.2861E-20,  4.2686E-20, &
       4.2474E-20,  4.2318E-20,  4.2189E-20,  4.1990E-20,  4.1888E-20,  4.1747E-20, &
       4.1602E-20,  4.1490E-20,  4.1376E-20,  4.1258E-20,  4.0977E-20,  4.0543E-20, &
       4.0212E-20,  3.9947E-20,  3.9718E-20,  3.9561E-20,  3.9435E-20,  3.9330E-20, &
       3.9250E-20,  3.9181E-20,  3.9145E-20,  3.9107E-20,  3.9087E-20,  3.9045E-20, &
       3.9045E-20 /)
    REAL, PARAMETER :: a3_ClNO3(dim55) = (/ &
      -5.2459E-23, -3.2025E-23, -1.7594E-23, -1.0183E-23, -6.5046E-24, -4.5182E-24, &
      -3.3544E-24, -2.6018E-24, -2.1051E-24, -1.7457E-24, -1.4721E-24, -1.2665E-24, &
      -1.1124E-24, -9.7569E-25, -8.5572E-25, -7.8740E-25, -6.8458E-25, -6.3302E-25, &
      -5.8219E-25, -5.3082E-25, -4.7863E-25, -4.4521E-25, -4.1096E-25, -3.7671E-25, &
      -3.5897E-25, -3.2534E-25, -3.0822E-25, -2.9110E-25, -2.5641E-25, -2.5685E-25, &
      -2.2260E-25, -2.2260E-25, -2.0513E-25, -1.8836E-25, -1.8836E-25, -1.7094E-25, &
      -1.5411E-25, -1.5411E-25, -1.5411E-25, -1.1966E-25, -1.1640E-25, -8.5587E-26, &
      -6.5024E-26, -5.1352E-26, -3.7658E-26, -3.0801E-26, -2.3964E-26, -1.7117E-26, &
      -1.3689E-26, -1.3694E-26, -6.8470E-27, -6.8446E-27, -6.8470E-27, -3.4235E-27, &
      -3.4223E-27 /)
    REAL, PARAMETER :: b3_ClNO3(dim55) = (/ &
       1.9961E-20,  1.8757E-20,  1.7064E-20,  1.5761E-20,  1.4899E-20,  1.4318E-20, &
       1.3910E-20,  1.3601E-20,  1.3369E-20,  1.3180E-20,  1.3020E-20,  1.2888E-20, &
       1.2780E-20,  1.2676E-20,  1.2577E-20,  1.2517E-20,  1.2421E-20,  1.2370E-20, &
       1.2317E-20,  1.2260E-20,  1.2199E-20,  1.2157E-20,  1.2113E-20,  1.2067E-20, &
       1.2043E-20,  1.1993E-20,  1.1967E-20,  1.1940E-20,  1.1884E-20,  1.1884E-20, &
       1.1824E-20,  1.1824E-20,  1.1792E-20,  1.1759E-20,  1.1759E-20,  1.1724E-20, &
       1.1688E-20,  1.1688E-20,  1.1688E-20,  1.1610E-20,  1.1602E-20,  1.1521E-20, &
       1.1461E-20,  1.1417E-20,  1.1369E-20,  1.1343E-20,  1.1315E-20,  1.1285E-20, &
       1.1269E-20,  1.1269E-20,  1.1233E-20,  1.1233E-20,  1.1233E-20,  1.1212E-20, &
       1.1212E-20 /)
    REAL, PARAMETER :: a4_ClNO3(4) = (/  8.2111E-21, -8.0999E-25,  1.6695E-28, -1.1613E-32 /)
    REAL, PARAMETER :: a5_ClNO3(4) = (/  3.4894E-21, -3.8195E-25,  6.4263E-29, -4.0329E-33 /)
    REAL, PARAMETER :: a6_ClNO3(4) = (/  9.5985E-22, -2.6471E-27,  2.8106E-32, -2.1594E-37 /)
    REAL, PARAMETER :: a7_ClNO3(4) = (/  4.1455E-24,  2.6601E-28,  4.8100E-33, -8.7400E-38 /)
    ! T-dep parameters:
    REAL, PARAMETER :: c0_1_1_ClNO3(dim58) = (/ &
       2.7242E-02,  2.7242E-02,  2.7242E-02,  3.1340E-02,  3.5437E-02,  3.8969E-02, &
       4.2322E-02,  4.4940E-02,  4.6709E-02,  4.7640E-02,  4.7803E-02,  4.7027E-02, &
       4.6003E-02,  4.4601E-02,  4.3084E-02,  4.1960E-02,  4.1176E-02,  4.0612E-02, &
       4.0598E-02,  4.0267E-02,  3.9626E-02,  3.8235E-02,  3.4348E-02,  2.9255E-02, &
       2.2590E-02,  1.3122E-02,  2.4261E-03, -7.4729E-03, -1.7824E-02, -2.5182E-02, &
      -3.0008E-02, -3.0922E-02, -2.7973E-02, -2.0748E-02, -1.1363E-02,  3.8736E-04, &
       1.0459E-02,  1.9242E-02,  2.3193E-02,  2.1994E-02,  1.4701E-02,  1.5295E-03, &
      -1.7551E-02, -3.7494E-02, -5.6419E-02, -7.1448E-02, -7.9097E-02, -8.1011E-02, &
      -7.8798E-02, -7.5272E-02, -7.4483E-02, -7.8208E-02, -8.5545E-02, -9.4176E-02, &
      -9.5250E-02, -8.8434E-02, -7.6150E-02, -6.9461E-02 /)
    REAL, PARAMETER :: c0_1_2_ClNO3(dim58) = (/ &
      -9.5036E-01, -9.5036E-01, -9.5036E-01, -1.1331E+00, -1.3167E+00, -1.4756E+00, &
      -1.6272E+00, -1.7460E+00, -1.8267E+00, -1.8693E+00, -1.8768E+00, -1.8410E+00, &
      -1.7935E+00, -1.7281E+00, -1.6571E+00, -1.6043E+00, -1.5673E+00, -1.5406E+00, &
      -1.5399E+00, -1.5241E+00, -1.4933E+00, -1.4263E+00, -1.2381E+00, -9.9065E-01, &
      -6.6535E-01, -2.0146E-01,  3.2479E-01,  8.1381E-01,  1.3272E+00,  1.6937E+00, &
       1.9350E+00,  1.9809E+00,  1.8322E+00,  1.4666E+00,  9.8984E-01,  3.9059E-01, &
      -1.2507E-01, -5.7651E-01, -7.8038E-01, -7.1829E-01, -3.3902E-01,  3.4850E-01, &
       1.3483E+00,  2.3973E+00,  3.3966E+00,  4.1931E+00,  4.6000E+00,  4.7022E+00, &
       4.5836E+00,  4.3939E+00,  4.3513E+00,  4.5532E+00,  4.9523E+00,  5.4236E+00, &
       5.4825E+00,  5.1076E+00,  4.4295E+00,  4.0589E+00 /)
    REAL, PARAMETER :: c0_2_1_ClNO3(dim58) = (/ &
       1.4783E-02,  1.4783E-02,  1.4783E-02,  1.9225E-02,  2.1039E-02,  2.4651E-02, &
       2.5470E-02,  2.6839E-02,  2.6624E-02,  2.5591E-02,  2.2459E-02,  2.0366E-02, &
       1.5774E-02,  1.1885E-02,  7.5483E-03,  4.5844E-03,  6.9813E-04, -1.2506E-03, &
      -4.5014E-03, -4.9311E-03, -6.9867E-03, -7.7213E-03, -1.0439E-02, -1.1833E-02, &
      -1.4849E-02, -1.7136E-02, -1.7434E-02, -2.1250E-02, -1.6977E-02, -8.9840E-03, &
      -8.1617E-03, -2.1500E-03,  5.2620E-03,  1.0209E-02,  6.4451E-03,  9.9859E-03, &
       1.1064E-02, -1.5515E-04, -8.1166E-03, -2.6512E-02, -4.1276E-02, -6.6631E-02, &
      -8.4935E-02, -8.8903E-02, -8.5776E-02, -7.0165E-02, -7.1396E-02, -6.1074E-02, &
      -6.0087E-02, -5.6668E-02, -4.1152E-02, -1.2830E-02,  4.2033E-02,  1.0120E-01, &
       1.4249E-01,  1.4790E-01,  9.3052E-02,  2.8778E-02 /)
    REAL, PARAMETER :: c0_2_2_ClNO3(dim58) = (/ &
      -1.1002E+00, -1.1002E+00, -1.1002E+00, -1.2983E+00, -1.3796E+00, -1.5421E+00, &
      -1.5791E+00, -1.6413E+00, -1.6315E+00, -1.5842E+00, -1.4401E+00, -1.3434E+00, &
      -1.1303E+00, -9.4908E-01, -7.4614E-01, -6.0684E-01, -4.2341E-01, -3.3103E-01, &
      -1.7630E-01, -1.5576E-01, -5.7089E-02, -2.1681E-02,  1.0986E-01,  1.7759E-01, &
       3.2479E-01,  4.3686E-01,  4.5151E-01,  6.4001E-01,  4.2810E-01,  3.0028E-02, &
      -1.1087E-02, -3.1288E-01, -6.8644E-01, -9.3677E-01, -7.4555E-01, -9.2613E-01, &
      -9.8135E-01, -4.0467E-01,  6.1452E-03,  9.5902E-01,  1.7268E+00,  3.0503E+00, &
       4.0094E+00,  4.2181E+00,  4.0530E+00,  3.2256E+00,  3.2911E+00,  2.7399E+00, &
       2.6870E+00,  2.5031E+00,  1.6652E+00,  1.3020E-01, -2.8544E+00, -6.0848E+00, &
      -8.3476E+00, -8.6452E+00, -5.6176E+00, -2.0568E+00 /)
    REAL, PARAMETER :: c1_ClNO3(3) = (/  1.0000E+00,  3.2654E-02, -5.1733E-01 /)
    REAL, PARAMETER :: c2_ClNO3(3) = (/  1.0000E+00,  6.8692E-01,  1.7652E-01 /)
    REAL, PARAMETER :: c3_ClNO3(3) = (/  1.0000E+00,  9.5959E-01,  7.0739E-01 /)
    REAL, PARAMETER :: c4_ClNO3(3) = (/  9.9999E-01,  1.0802E+00,  9.6714E-01 /)
    REAL, PARAMETER :: c5_ClNO3(3) = (/  1.0000E+00,  1.1521E+00,  1.9193E+00 /)
    REAL, PARAMETER :: c6_ClNO3(3) = (/  9.9999E-01,  6.5110E-01,  3.1023E-01 /)
    REAL, PARAMETER :: c7_ClNO3(3) = (/  1.0000E+00,  9.3932E-01,  5.0492E+00 /)

    jval_2d(ip_ClNO3)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_ClNO3(0) = &
          p2(1.,c0_1_1_ClNO3(i0(j,k))*dlv2(j,k) + &
          c0_1_2_ClNO3(i0(j,k)), &
          c0_2_1_ClNO3(i0(j,k))*dlv2(j,k) + &
          c0_2_2_ClNO3(i0(j,k)), tnorm_sr(j,k)) * &
          p1(a0_1_1_ClNO3(i0(j,k))*dlv2(j,k) + &
          a0_1_2_ClNO3(i0(j,k)), &
          a0_2_1_ClNO3(i0(j,k))*dlv2(j,k) + &
          a0_2_2_ClNO3(i0(j,k)),v3_du1(j,k))
        sig_ClNO3(1) = &
          p2(c1_ClNO3(1),c1_ClNO3(2), &
          c1_ClNO3(3),tnorm(j,k)) * &
          (p1(b1_1_ClNO3(i1(j,k)),a1_1_ClNO3(i1(j,k)), &
          v3_du1(j,k)) + &
          p1(b1_2_ClNO3(i1(j,k)),a1_2_ClNO3(i1(j,k)), &
          v3_du1(j,k)) * v2s_m(j,k))
        sig_ClNO3(2) = &
          p2(c2_ClNO3(1),c2_ClNO3(2),c2_ClNO3(3),tnorm(j,k))* &
          p1(b2_ClNO3(i2(j,k)), a2_ClNO3(i2(j,k)), &
          v3_du1(j,k))
        sig_ClNO3(3) = &
          p2(c3_ClNO3(1),c3_ClNO3(2),c3_ClNO3(3),tnorm(j,k))* &
          p1(b3_ClNO3(i3(j,k)), a3_ClNO3(i3(j,k)), &
          v3_du2(j,k))
        sig_ClNO3(4) = &
          p2(c4_ClNO3(1),c4_ClNO3(2),c4_ClNO3(3),tnorm(j,k))* &
          p3(a4_ClNO3(1),a4_ClNO3(2),a4_ClNO3(3), &
          a4_ClNO3(4),v3_du2(j,k))
        sig_ClNO3(5) = &
          p2(c5_ClNO3(1),c5_ClNO3(2),c5_ClNO3(3),tnorm(j,k))* &
          p3(a5_ClNO3(1),a5_ClNO3(2),a5_ClNO3(3), &
          a5_ClNO3(4),v3_du2(j,k))
        sig_ClNO3(6) = &
          p2(c6_ClNO3(1),c6_ClNO3(2),c6_ClNO3(3),tnorm(j,k))* &
          p3(a6_ClNO3(1),a6_ClNO3(2),a6_ClNO3(3), &
          a6_ClNO3(4),v3_du2(j,k))
        sig_ClNO3(7) = &
          p2(c7_ClNO3(1),c7_ClNO3(2),c7_ClNO3(3),tnorm(j,k))* &
          p3(a7_ClNO3(1),a7_ClNO3(2),a7_ClNO3(3), &
          a7_ClNO3(4),v3_du2(j,k))
        dj = 0. &
          + sig_ClNO3(0) * fint(j,k,0) &
          + sig_ClNO3(1) * fint(j,k,1) &
          + sig_ClNO3(2) * fint(j,k,2) &
          + sig_ClNO3(3) * fint(j,k,3) &
          + sig_ClNO3(4) * fint(j,k,4) &
          + sig_ClNO3(5) * fint(j,k,5) &
          + sig_ClNO3(6) * fint(j,k,6) &
          + sig_ClNO3(7) * fint(j,k,7)

        jval_2d(ip_ClNO3)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,2)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_ClNO3

  ! **************************************************************************

  SUBROUTINE jval_cal_ClNO2

    ! ClNO_2 \TOHV\ \products

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_ClNO2

    ! T-const parameters:
    REAL, PARAMETER :: a0_1_1_ClNO2(dim58) = (/ &
       1.2980E-20,  1.4220E-20,  1.5527E-20,  1.6898E-20,  1.8354E-20,  1.9859E-20, &
       2.1439E-20,  2.3084E-20,  2.4819E-20,  2.6638E-20,  2.8541E-20,  3.0583E-20, &
       3.7017E-20,  5.2797E-20,  5.1388E-20,  5.4344E-20,  6.2310E-20,  6.0363E-20, &
       6.3084E-20,  7.1165E-20,  6.8036E-20,  6.9949E-20,  7.7544E-20,  7.2760E-20, &
       7.3521E-20,  6.1456E-20,  5.6014E-20,  5.7375E-20,  5.9460E-20,  6.2378E-20, &
       6.6211E-20,  7.0956E-20,  7.6583E-20,  8.2917E-20,  8.9766E-20,  9.6922E-20, &
       1.0420E-19,  1.1159E-19,  1.1885E-19,  1.2629E-19,  1.3364E-19,  1.4108E-19, &
       1.4839E-19,  1.5533E-19,  1.6145E-19,  1.6667E-19,  1.6983E-19,  1.7137E-19, &
       1.7078E-19,  1.6838E-19,  1.6425E-19,  1.5902E-19,  1.5261E-19,  1.4518E-19, &
       1.3677E-19,  1.2626E-19,  1.0996E-19,  9.0201E-20 /)
    REAL, PARAMETER :: a0_1_2_ClNO2(dim58) = (/ &
       9.9592E-21, -4.4825E-20, -1.0289E-19, -1.6401E-19, -2.2923E-19, -2.9696E-19, &
      -3.6841E-19, -4.4306E-19, -5.2218E-19, -6.0552E-19, -6.9305E-19, -7.8738E-19, &
      -1.0859E-18, -1.8213E-18, -1.7553E-18, -1.8942E-18, -2.2703E-18, -2.1779E-18, &
      -2.3075E-18, -2.6938E-18, -2.5435E-18, -2.6358E-18, -3.0034E-18, -2.7708E-18, &
      -2.8080E-18, -2.2168E-18, -1.9491E-18, -2.0163E-18, -2.1197E-18, -2.2651E-18, &
      -2.4567E-18, -2.6949E-18, -2.9785E-18, -3.2990E-18, -3.6469E-18, -4.0119E-18, &
      -4.3844E-18, -4.7644E-18, -5.1389E-18, -5.5244E-18, -5.9068E-18, -6.2949E-18, &
      -6.6779E-18, -7.0430E-18, -7.3660E-18, -7.6429E-18, -7.8108E-18, -7.8933E-18, &
      -7.8616E-18, -7.7323E-18, -7.5095E-18, -7.2258E-18, -6.8770E-18, -6.4713E-18, &
      -6.0106E-18, -5.4325E-18, -4.5326E-18, -3.4382E-18 /)
    REAL, PARAMETER :: a0_2_1_ClNO2(dim58) = (/ &
       6.7128E-23,  7.4048E-23,  8.1624E-23,  8.9869E-23,  9.8704E-23,  1.0832E-22, &
       1.1871E-22,  1.2985E-22,  1.4190E-22,  1.5504E-22,  1.6944E-22,  1.8512E-22, &
       1.3774E-22, -3.9079E-23,  4.3657E-23,  6.4032E-23,  2.2150E-23,  1.1117E-22, &
       1.3849E-22,  1.0317E-22,  1.9912E-22,  2.3234E-22,  2.0255E-22,  3.0245E-22, &
       3.3790E-22,  4.9617E-22,  5.7983E-22,  5.8938E-22,  5.8552E-22,  5.6670E-22, &
       5.3150E-22,  4.8023E-22,  4.1451E-22,  3.3763E-22,  2.5519E-22,  1.7162E-22, &
       9.3288E-23,  2.3557E-23, -3.3932E-23, -7.8656E-23, -1.1050E-22, -1.3104E-22, &
      -1.4275E-22, -1.4835E-22, -1.4957E-22, -1.4939E-22, -1.4510E-22, -1.4017E-22, &
      -1.3321E-22, -1.2541E-22, -1.1678E-22, -1.0917E-22, -1.0045E-22, -9.0706E-23, &
      -8.0038E-23, -6.9516E-23, -5.7747E-23, -4.8594E-23 /)
    REAL, PARAMETER :: a0_2_2_ClNO2(dim58) = (/ &
      -3.8690E-21, -4.1748E-21, -4.5112E-21, -4.8789E-21, -5.2748E-21, -5.7077E-21, &
      -6.1770E-21, -6.6829E-21, -7.2322E-21, -7.8342E-21, -8.4964E-21, -9.2209E-21, &
      -7.0225E-21,  1.2172E-21, -2.6548E-21, -3.6124E-21, -1.6356E-21, -5.8550E-21, &
      -7.1554E-21, -5.4671E-21, -1.0073E-20, -1.1674E-20, -1.0232E-20, -1.5087E-20, &
      -1.6817E-20, -2.4573E-20, -2.8689E-20, -2.9160E-20, -2.8969E-20, -2.8032E-20, &
      -2.6272E-20, -2.3698E-20, -2.0385E-20, -1.6495E-20, -1.2308E-20, -8.0458E-21, &
      -4.0349E-21, -4.5076E-22,  2.5157E-21,  4.8324E-21,  6.4881E-21,  7.5605E-21, &
       8.1741E-21,  8.4686E-21,  8.5333E-21,  8.5235E-21,  8.2952E-21,  8.0321E-21, &
       7.6588E-21,  7.2392E-21,  6.7732E-21,  6.3610E-21,  5.8866E-21,  5.3544E-21, &
       4.7698E-21,  4.1911E-21,  3.5415E-21,  3.0344E-21 /)
    REAL, PARAMETER :: a1_1_ClNO2(dim55) = (/ &
       4.6941E-20,  4.2512E-20,  3.7364E-20,  3.2284E-20,  2.6652E-20,  2.2455E-20, &
       1.7586E-20,  1.4769E-20,  1.1033E-20,  9.4092E-21,  6.6640E-21,  5.8165E-21, &
       3.8220E-21,  3.4627E-21,  1.9859E-21,  1.9056E-21,  7.7123E-22,  8.5524E-22, &
      -9.1309E-24,  1.2365E-22, -5.3663E-22, -3.5377E-22, -8.9334E-22, -6.9823E-22, &
      -1.1366E-21, -9.4476E-22, -1.2890E-21, -1.1049E-21, -1.3997E-21, -1.2153E-21, &
      -1.4640E-21, -1.2928E-21, -1.4967E-21, -1.3313E-21, -1.5142E-21, -1.3622E-21, &
      -1.5162E-21, -1.3741E-21, -1.4919E-21, -1.3798E-21, -1.4143E-21, -1.3353E-21, &
      -1.2750E-21, -1.1922E-21, -1.1190E-21, -1.0455E-21, -9.7559E-22, -9.1594E-22, &
      -8.2745E-22, -7.6154E-22, -7.0255E-22, -6.4846E-22, -5.9929E-22, -5.5471E-22, &
      -5.1236E-22 /)
    REAL, PARAMETER :: b1_1_ClNO2(dim55) = (/ &
       2.4911E-18,  2.5044E-18,  2.5327E-18,  2.5734E-18,  2.6325E-18,  2.6871E-18, &
       2.7625E-18,  2.8132E-18,  2.8899E-18,  2.9272E-18,  2.9972E-18,  3.0209E-18, &
       3.0818E-18,  3.0936E-18,  3.1460E-18,  3.1491E-18,  3.1950E-18,  3.1914E-18, &
       3.2307E-18,  3.2244E-18,  3.2577E-18,  3.2480E-18,  3.2780E-18,  3.2667E-18, &
       3.2932E-18,  3.2811E-18,  3.3036E-18,  3.2911E-18,  3.3119E-18,  3.2984E-18, &
       3.3172E-18,  3.3039E-18,  3.3203E-18,  3.3065E-18,  3.3222E-18,  3.3088E-18, &
       3.3227E-18,  3.3095E-18,  3.3208E-18,  3.3098E-18,  3.3133E-18,  3.3043E-18, &
       3.2968E-18,  3.2853E-18,  3.2743E-18,  3.2624E-18,  3.2501E-18,  3.2389E-18, &
       3.2211E-18,  3.2071E-18,  3.1938E-18,  3.1809E-18,  3.1686E-18,  3.1569E-18, &
       3.1452E-18 /)
    REAL, PARAMETER :: a1_2_ClNO2(dim55) = (/ &
       4.4123E-24,  4.4331E-23,  7.4837E-23,  8.8939E-23,  1.1038E-22,  1.0177E-22, &
       1.1418E-22,  9.3228E-23,  1.0029E-22,  7.6113E-23,  8.1000E-23,  5.8962E-23, &
       6.3124E-23,  4.4426E-23,  4.8392E-23,  3.3297E-23,  3.7309E-23,  2.5056E-23, &
       2.8660E-23,  1.9046E-23,  2.2235E-23,  1.4471E-23,  1.7403E-23,  1.1102E-23, &
       1.3710E-23,  8.6080E-24,  1.0814E-23,  6.6018E-24,  8.6244E-24,  5.1262E-24, &
       6.8431E-24,  3.9534E-24,  5.4687E-24,  3.0035E-24,  4.3077E-24,  2.2743E-24, &
       3.4614E-24,  1.7127E-24,  2.6542E-24,  1.2616E-24,  1.2470E-24,  3.4825E-25, &
      -1.1839E-26, -3.4477E-25, -5.0516E-25, -6.1587E-25, -7.0184E-25, -6.9958E-25, &
      -8.8936E-25, -9.3764E-25, -9.6569E-25, -9.7452E-25, -9.7030E-25, -9.5627E-25, &
      -9.4479E-25 /)
    REAL, PARAMETER :: b1_2_ClNO2(dim55) = (/ &
      -3.1804E-21, -3.3001E-21, -3.4679E-21, -3.5807E-21, -3.8058E-21, -3.6939E-21, &
      -3.8862E-21, -3.5091E-21, -3.6539E-21, -3.0979E-21, -3.2225E-21, -2.6054E-21, &
      -2.7323E-21, -2.1153E-21, -2.2561E-21, -1.6825E-21, -1.8450E-21, -1.3181E-21, &
      -1.4821E-21, -1.0206E-21, -1.1816E-21, -7.7016E-22, -9.3287E-22, -5.6742E-22, &
      -7.2521E-22, -4.0379E-22, -5.4830E-22, -2.6186E-22, -4.0445E-22, -1.4908E-22, &
      -2.7871E-22, -5.3308E-23, -1.7530E-22,  2.9320E-23, -8.2191E-23,  9.6748E-23, &
      -1.0685E-23,  1.5195E-22,  6.2033E-23,  1.9850E-22,  1.9997E-22,  3.0153E-22, &
       3.4672E-22,  3.9267E-22,  4.1681E-22,  4.3485E-22,  4.4994E-22,  4.4952E-22, &
       4.8757E-22,  4.9785E-22,  5.0418E-22,  5.0628E-22,  5.0522E-22,  5.0153E-22, &
       4.9837E-22 /)
    REAL, PARAMETER :: a2_ClNO2(dim55) = (/ &
      -1.4604E-20, -1.2524E-20, -1.0076E-20, -7.6880E-21, -5.6440E-21, -4.0440E-21, &
      -2.8520E-21, -2.0120E-21, -1.4200E-21, -1.0200E-21, -7.4000E-22, -5.4800E-22, &
      -4.1600E-22, -3.2400E-22, -2.5600E-22, -2.1200E-22, -1.7200E-22, -1.4400E-22, &
      -1.2400E-22, -1.0800E-22, -9.6000E-23, -8.4000E-23, -7.6000E-23, -6.8000E-23, &
      -6.0000E-23, -5.6000E-23, -5.2000E-23, -4.4000E-23, -4.4000E-23, -4.0000E-23, &
      -3.6000E-23, -3.2000E-23, -3.2000E-23, -2.8000E-23, -2.8000E-23, -2.4000E-23, &
      -2.4000E-23, -2.4000E-23, -2.0000E-23, -2.0000E-23, -1.5200E-23, -1.1200E-23, &
      -8.0000E-24, -6.4000E-24, -4.0000E-24, -3.2000E-24, -2.4000E-24, -1.6000E-24, &
      -8.0000E-25, -8.0000E-25, -8.0000E-25, -8.0000E-25,  0.0000E+00,  0.0000E+00, &
      -8.0000E-25 /)
    REAL, PARAMETER :: b2_ClNO2(dim55) = (/ &
       3.4567E-19,  3.3943E-19,  3.2597E-19,  3.0686E-19,  2.8540E-19,  2.6460E-19, &
       2.4613E-19,  2.3101E-19,  2.1887E-19,  2.0967E-19,  2.0253E-19,  1.9715E-19, &
       1.9313E-19,  1.9009E-19,  1.8768E-19,  1.8601E-19,  1.8439E-19,  1.8318E-19, &
       1.8227E-19,  1.8150E-19,  1.8090E-19,  1.8026E-19,  1.7982E-19,  1.7935E-19, &
       1.7887E-19,  1.7862E-19,  1.7836E-19,  1.7781E-19,  1.7781E-19,  1.7752E-19, &
       1.7722E-19,  1.7691E-19,  1.7691E-19,  1.7657E-19,  1.7657E-19,  1.7622E-19, &
       1.7622E-19,  1.7622E-19,  1.7584E-19,  1.7584E-19,  1.7536E-19,  1.7491E-19, &
       1.7450E-19,  1.7428E-19,  1.7392E-19,  1.7379E-19,  1.7365E-19,  1.7350E-19, &
       1.7334E-19,  1.7334E-19,  1.7334E-19,  1.7334E-19,  1.7314E-19,  1.7314E-19, &
       1.7336E-19 /)
    REAL, PARAMETER :: a3_ClNO2(dim55) = (/ &
      -8.6433E-23, -5.8196E-23, -3.5427E-23, -2.2762E-23, -1.5577E-23, -1.1638E-23, &
      -8.8995E-24, -7.3605E-24, -5.9901E-24, -4.9632E-24, -4.4505E-24, -3.7652E-24, &
      -3.4229E-24, -3.0811E-24, -2.7383E-24, -2.3964E-24, -2.2249E-24, -2.0530E-24, &
      -1.8836E-24, -1.7123E-24, -1.5385E-24, -1.5411E-24, -1.3699E-24, -1.1986E-24, &
      -1.1966E-24, -1.1986E-24, -1.0274E-24, -8.5616E-25, -8.5470E-25, -8.5616E-25, &
      -8.5616E-25, -6.8493E-25, -8.5470E-25, -5.1370E-25, -6.8493E-25, -6.8376E-25, &
      -5.1370E-25, -5.1370E-25, -5.1370E-25, -5.1282E-25, -3.7658E-25, -3.0811E-25, &
      -2.3956E-25, -1.7117E-25, -1.3694E-25, -1.0267E-25, -1.0270E-25, -6.8470E-26, &
      -3.4223E-26, -3.4235E-26, -3.4235E-26, -3.4223E-26, -3.4235E-26,  0.0000E+00, &
       0.0000E+00 /)
    REAL, PARAMETER :: b3_ClNO2(dim55) = (/ &
       1.5093E-19,  1.4927E-19,  1.4660E-19,  1.4437E-19,  1.4269E-19,  1.4154E-19, &
       1.4057E-19,  1.3994E-19,  1.3930E-19,  1.3876E-19,  1.3846E-19,  1.3802E-19, &
       1.3778E-19,  1.3752E-19,  1.3724E-19,  1.3694E-19,  1.3678E-19,  1.3661E-19, &
       1.3643E-19,  1.3624E-19,  1.3604E-19,  1.3604E-19,  1.3582E-19,  1.3559E-19, &
       1.3559E-19,  1.3559E-19,  1.3533E-19,  1.3506E-19,  1.3506E-19,  1.3506E-19, &
       1.3506E-19,  1.3475E-19,  1.3507E-19,  1.3441E-19,  1.3475E-19,  1.3475E-19, &
       1.3439E-19,  1.3439E-19,  1.3439E-19,  1.3439E-19,  1.3407E-19,  1.3389E-19, &
       1.3369E-19,  1.3347E-19,  1.3335E-19,  1.3322E-19,  1.3322E-19,  1.3307E-19, &
       1.3291E-19,  1.3291E-19,  1.3291E-19,  1.3291E-19,  1.3291E-19,  1.3270E-19, &
       1.3270E-19 /)
    REAL, PARAMETER :: a4_ClNO2(4) = (/  1.1707E-19, -5.4850E-24,  1.0931E-27, -7.4661E-32 /)
    REAL, PARAMETER :: a5_ClNO2(4) = (/  6.2752E-20, -6.3455E-24,  9.9731E-28, -6.0946E-32 /)
    REAL, PARAMETER :: a6_ClNO2(4) = (/  4.8216E-21, -5.4284E-26,  6.1548E-31, -4.1740E-36 /)
    REAL, PARAMETER :: a7_ClNO2(4) = (/  8.9249E-24,  5.5201E-28,  9.0741E-33, -2.0200E-37 /)
    ! T-dep parameters:
    REAL, PARAMETER :: c0_1_1_ClNO2(dim58) = (/ &
       2.8891E-02,  2.8891E-02,  2.8891E-02,  3.3259E-02,  3.7407E-02,  4.1420E-02, &
       4.4966E-02,  4.7718E-02,  4.9644E-02,  5.0379E-02,  5.0817E-02,  5.0048E-02, &
       4.8766E-02,  4.7496E-02,  4.6090E-02,  4.4891E-02,  4.4351E-02,  4.4383E-02, &
       4.4828E-02,  4.5529E-02,  4.6092E-02,  4.5635E-02,  4.4297E-02,  4.1149E-02, &
       3.6285E-02,  3.0186E-02,  2.3067E-02,  1.6218E-02,  1.1259E-02,  9.5369E-03, &
       1.0184E-02,  1.8010E-02,  2.9442E-02,  4.7232E-02,  6.9797E-02,  9.4142E-02, &
       1.1911E-01,  1.4272E-01,  1.6112E-01,  1.7312E-01,  1.7619E-01,  1.6876E-01, &
       1.5350E-01,  1.2864E-01,  1.0211E-01,  7.2341E-02,  4.7002E-02,  2.4080E-02, &
       1.2161E-04, -2.6311E-02, -6.2899E-02, -1.1414E-01, -1.8326E-01, -2.6345E-01, &
      -3.4748E-01, -4.3064E-01, -5.3259E-01, -6.5517E-01 /)
    REAL, PARAMETER :: c0_1_2_ClNO2(dim58) = (/ &
      -8.4168E-01, -8.4168E-01, -8.4168E-01, -1.0365E+00, -1.2223E+00, -1.4029E+00, &
      -1.5632E+00, -1.6881E+00, -1.7759E+00, -1.8096E+00, -1.8298E+00, -1.7942E+00, &
      -1.7347E+00, -1.6756E+00, -1.6098E+00, -1.5534E+00, -1.5279E+00, -1.5295E+00, &
      -1.5507E+00, -1.5841E+00, -1.6112E+00, -1.5891E+00, -1.5244E+00, -1.3714E+00, &
      -1.1340E+00, -8.3519E-01, -4.8494E-01, -1.4656E-01,  9.9379E-02,  1.8516E-01, &
       1.5282E-01, -2.4008E-01, -8.1623E-01, -1.7164E+00, -2.8627E+00, -4.1043E+00, &
      -5.3827E+00, -6.5963E+00, -7.5455E+00, -8.1674E+00, -8.3268E+00, -7.9389E+00, &
      -7.1392E+00, -5.8320E+00, -4.4309E+00, -2.8533E+00, -1.5052E+00, -2.8116E-01, &
       1.0030E+00,  2.4250E+00,  4.4008E+00,  7.1778E+00,  1.0938E+01,  1.5317E+01, &
       1.9921E+01,  2.4495E+01,  3.0123E+01,  3.6914E+01 /)
    REAL, PARAMETER :: c0_2_1_ClNO2(dim58) = (/ &
       2.1657E-02,  2.1657E-02,  2.1657E-02,  2.4576E-02,  2.9297E-02,  3.1751E-02, &
       3.5522E-02,  3.6029E-02,  3.6311E-02,  3.5839E-02,  3.2117E-02,  2.9891E-02, &
       2.3870E-02,  2.1390E-02,  1.5963E-02,  1.1835E-02,  7.5613E-03,  5.5061E-03, &
       3.2413E-03,  4.0511E-03,  3.2789E-03,  2.9962E-03,  1.4179E-03,  2.5402E-03, &
       1.7967E-03,  1.6270E-03,  4.1900E-03,  7.1066E-03,  1.8073E-02,  3.6410E-02, &
       4.0863E-02,  6.4506E-02,  7.5955E-02,  9.7903E-02,  1.2160E-01,  1.4053E-01, &
       1.5894E-01,  1.8165E-01,  1.8664E-01,  1.7615E-01,  1.6642E-01,  1.2990E-01, &
       1.0681E-01,  7.6407E-02,  3.8635E-02,  1.4191E-02, -1.1527E-02, -4.0896E-02, &
      -7.3181E-02, -9.4109E-02, -1.1065E-01, -1.0710E-01, -8.9582E-02, -5.9892E-02, &
      -3.1336E-02, -6.0434E-02, -1.5425E-01, -2.8957E-01 /)
    REAL, PARAMETER :: c0_2_2_ClNO2(dim58) = (/ &
       4.7258E-01,  4.7258E-01,  4.7258E-01,  3.4241E-01,  1.3089E-01,  2.0467E-02, &
      -1.4997E-01, -1.7298E-01, -1.8584E-01, -1.6424E-01,  6.9932E-03,  1.0983E-01, &
       3.8919E-01,  5.0474E-01,  7.5876E-01,  9.5278E-01,  1.1545E+00,  1.2519E+00, &
       1.3597E+00,  1.3210E+00,  1.3581E+00,  1.3717E+00,  1.4481E+00,  1.3935E+00, &
       1.4298E+00,  1.4381E+00,  1.3120E+00,  1.1679E+00,  6.2402E-01, -2.8916E-01, &
      -5.1183E-01, -1.6987E+00, -2.2757E+00, -3.3863E+00, -4.5903E+00, -5.5554E+00, &
      -6.4979E+00, -7.6654E+00, -7.9228E+00, -7.3794E+00, -6.8734E+00, -4.9674E+00, &
      -3.7574E+00, -2.1581E+00, -1.6377E-01,  1.1318E+00,  2.5000E+00,  4.0683E+00, &
       5.7988E+00,  6.9247E+00,  7.8178E+00,  7.6253E+00,  6.6725E+00,  5.0515E+00, &
       3.4866E+00,  5.0870E+00,  1.0266E+01,  1.7762E+01 /)
    REAL, PARAMETER :: c1_ClNO2(3) = (/  1.0000E+00, -4.0592E-02,  1.0210E+00 /)
    REAL, PARAMETER :: c2_ClNO2(3) = (/  1.0000E+00,  1.7652E-02,  8.6160E-01 /)
    REAL, PARAMETER :: c3_ClNO2(3) = (/  1.0000E+00, -1.4613E-02,  5.2362E-01 /)
    REAL, PARAMETER :: c4_ClNO2(3) = (/  1.0000E+00,  1.0497E-01,  4.7421E-01 /)
    REAL, PARAMETER :: c5_ClNO2(3) = (/  1.0000E+00,  5.4294E-01,  4.7615E-01 /)
    REAL, PARAMETER :: c6_ClNO2(3) = (/  1.0000E+00,  1.5301E+00,  1.3807E+00 /)
    REAL, PARAMETER :: c7_ClNO2(3) = (/  1.0000E+00,  3.8921E+00,  8.1322E+00 /)

    jval_2d(ip_ClNO2)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_ClNO2(0) = &
          p2(1.,c0_1_1_ClNO2(i0(j,k))*dlv2(j,k) + &
          c0_1_2_ClNO2(i0(j,k)), &
          c0_2_1_ClNO2(i0(j,k))*dlv2(j,k) + &
          c0_2_2_ClNO2(i0(j,k)), tnorm_sr(j,k)) * &
          p1(a0_1_1_ClNO2(i0(j,k))*dlv2(j,k) + &
          a0_1_2_ClNO2(i0(j,k)), &
          a0_2_1_ClNO2(i0(j,k))*dlv2(j,k) + &
          a0_2_2_ClNO2(i0(j,k)),v3_du1(j,k))
        sig_ClNO2(1) = &
          p2(c1_ClNO2(1),c1_ClNO2(2), &
          c1_ClNO2(3),tnorm(j,k)) * &
          (p1(b1_1_ClNO2(i1(j,k)),a1_1_ClNO2(i1(j,k)), &
          v3_du1(j,k)) + &
          p1(b1_2_ClNO2(i1(j,k)),a1_2_ClNO2(i1(j,k)), &
          v3_du1(j,k)) * v2s_m(j,k))
        sig_ClNO2(2) = &
          p2(c2_ClNO2(1),c2_ClNO2(2),c2_ClNO2(3),tnorm(j,k))* &
          p1(b2_ClNO2(i2(j,k)), a2_ClNO2(i2(j,k)), &
          v3_du1(j,k))
        sig_ClNO2(3) = &
          p2(c3_ClNO2(1),c3_ClNO2(2),c3_ClNO2(3),tnorm(j,k))* &
          p1(b3_ClNO2(i3(j,k)), a3_ClNO2(i3(j,k)), &
          v3_du2(j,k))
        sig_ClNO2(4) = &
          p2(c4_ClNO2(1),c4_ClNO2(2),c4_ClNO2(3),tnorm(j,k))* &
          p3(a4_ClNO2(1),a4_ClNO2(2),a4_ClNO2(3), &
          a4_ClNO2(4),v3_du2(j,k))
        sig_ClNO2(5) = &
          p2(c5_ClNO2(1),c5_ClNO2(2),c5_ClNO2(3),tnorm(j,k))* &
          p3(a5_ClNO2(1),a5_ClNO2(2),a5_ClNO2(3), &
          a5_ClNO2(4),v3_du2(j,k))
        sig_ClNO2(6) = &
          p2(c6_ClNO2(1),c6_ClNO2(2),c6_ClNO2(3),tnorm(j,k))* &
          p3(a6_ClNO2(1),a6_ClNO2(2),a6_ClNO2(3), &
          a6_ClNO2(4),v3_du2(j,k))
        sig_ClNO2(7) = &
          p2(c7_ClNO2(1),c7_ClNO2(2),c7_ClNO2(3),tnorm(j,k))* &
          p3(a7_ClNO2(1),a7_ClNO2(2),a7_ClNO2(3), &
          a7_ClNO2(4),v3_du2(j,k))
        dj = 0. &
          + sig_ClNO2(0) * fint(j,k,0) &
          + sig_ClNO2(1) * fint(j,k,1) &
          + sig_ClNO2(2) * fint(j,k,2) &
          + sig_ClNO2(3) * fint(j,k,3) &
          + sig_ClNO2(4) * fint(j,k,4) &
          + sig_ClNO2(5) * fint(j,k,5) &
          + sig_ClNO2(6) * fint(j,k,6) &
          + sig_ClNO2(7) * fint(j,k,7)

        jval_2d(ip_ClNO2)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,2)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_ClNO2

  ! **************************************************************************

  SUBROUTINE jval_cal_Cl2

    ! Cl_2 \TOHV\ 2 Cl

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_Cl2

    ! T-const parameters:
    REAL, PARAMETER :: a2_Cl2(dim55) = (/ &
       1.6964E-21,  1.6016E-21,  1.4232E-21,  1.2068E-21,  9.9040E-22,  7.9840E-22, &
       6.3920E-22,  5.1320E-22,  4.1480E-22,  3.3960E-22,  2.8160E-22,  2.3720E-22, &
       2.0200E-22,  1.7480E-22,  1.5240E-22,  1.3480E-22,  1.2000E-22,  1.0760E-22, &
       9.6800E-23,  8.8400E-23,  8.0400E-23,  7.3600E-23,  6.8000E-23,  6.2400E-23, &
       5.7600E-23,  5.3600E-23,  4.9600E-23,  4.6000E-23,  4.3200E-23,  4.0000E-23, &
       3.7200E-23,  3.5200E-23,  3.2400E-23,  3.0400E-23,  2.8800E-23,  2.6400E-23, &
       2.5200E-23,  2.3200E-23,  2.2000E-23,  2.0400E-23,  1.7040E-23,  1.2320E-23, &
       8.9600E-24,  6.5600E-24,  4.7200E-24,  3.4400E-24,  2.4800E-24,  1.8400E-24, &
       1.3600E-24,  8.8000E-25,  7.2000E-25,  4.8000E-25,  4.0000E-25,  2.4000E-25, &
       2.4000E-25 /)
    REAL, PARAMETER :: b2_Cl2(dim55) = (/ &
       2.2380E-20,  2.2664E-20,  2.3645E-20,  2.5377E-20,  2.7649E-20,  3.0145E-20, &
       3.2612E-20,  3.4880E-20,  3.6898E-20,  3.8627E-20,  4.0106E-20,  4.1349E-20, &
       4.2423E-20,  4.3321E-20,  4.4116E-20,  4.4785E-20,  4.5384E-20,  4.5917E-20, &
       4.6409E-20,  4.6812E-20,  4.7216E-20,  4.7576E-20,  4.7887E-20,  4.8212E-20, &
       4.8502E-20,  4.8754E-20,  4.9016E-20,  4.9261E-20,  4.9458E-20,  4.9692E-20, &
       4.9903E-20,  5.0059E-20,  5.0285E-20,  5.0451E-20,  5.0588E-20,  5.0799E-20, &
       5.0907E-20,  5.1093E-20,  5.1208E-20,  5.1365E-20,  5.1702E-20,  5.2236E-20, &
       5.2658E-20,  5.2989E-20,  5.3266E-20,  5.3474E-20,  5.3643E-20,  5.3763E-20, &
       5.3859E-20,  5.3962E-20,  5.3998E-20,  5.4055E-20,  5.4075E-20,  5.4117E-20, &
       5.4117E-20 /)
    REAL, PARAMETER :: a3_Cl2(dim55) = (/ &
       2.2216E-22,  1.4669E-22,  8.8311E-23,  5.5451E-23,  3.8001E-23,  2.7725E-23, &
       2.1393E-23,  1.7117E-23,  1.4205E-23,  1.1980E-23,  1.0270E-23,  8.8995E-24, &
       7.8727E-24,  7.0181E-24,  6.3324E-24,  5.6488E-24,  5.3055E-24,  4.6193E-24, &
       4.2808E-24,  3.9384E-24,  3.5897E-24,  3.4247E-24,  3.0822E-24,  2.9110E-24, &
       2.7350E-24,  2.5685E-24,  2.3973E-24,  2.0548E-24,  2.0513E-24,  2.0548E-24, &
       1.7123E-24,  1.7123E-24,  1.7094E-24,  1.3699E-24,  1.5411E-24,  1.3675E-24, &
       1.1986E-24,  1.1986E-24,  1.1986E-24,  1.0256E-24,  8.9011E-25,  6.8470E-25, &
       5.1335E-25,  4.1082E-25,  3.0811E-25,  2.7379E-25,  1.7117E-25,  1.3694E-25, &
       1.3689E-25,  6.8470E-26,  6.8470E-26,  6.8446E-26,  3.4235E-26,  3.4235E-26, &
       3.4223E-26 /)
    REAL, PARAMETER :: b3_Cl2(dim55) = (/ &
       1.0713E-19,  1.1158E-19,  1.1843E-19,  1.2420E-19,  1.2829E-19,  1.3130E-19, &
       1.3352E-19,  1.3527E-19,  1.3663E-19,  1.3780E-19,  1.3880E-19,  1.3969E-19, &
       1.4041E-19,  1.4106E-19,  1.4162E-19,  1.4222E-19,  1.4254E-19,  1.4322E-19, &
       1.4358E-19,  1.4396E-19,  1.4436E-19,  1.4457E-19,  1.4501E-19,  1.4524E-19, &
       1.4548E-19,  1.4573E-19,  1.4599E-19,  1.4653E-19,  1.4653E-19,  1.4653E-19, &
       1.4713E-19,  1.4713E-19,  1.4713E-19,  1.4779E-19,  1.4745E-19,  1.4780E-19, &
       1.4816E-19,  1.4816E-19,  1.4816E-19,  1.4855E-19,  1.4887E-19,  1.4941E-19, &
       1.4991E-19,  1.5024E-19,  1.5060E-19,  1.5073E-19,  1.5115E-19,  1.5130E-19, &
       1.5130E-19,  1.5164E-19,  1.5164E-19,  1.5164E-19,  1.5184E-19,  1.5184E-19, &
       1.5184E-19 /)
    REAL, PARAMETER :: a4_Cl2(4) = (/  1.8283E-19,  9.6087E-24, -1.9675E-27,  1.3635E-31 /)
    REAL, PARAMETER :: a5_Cl2(4) = (/  2.4190E-19,  3.6673E-24, -7.2999E-28,  4.7951E-32 /)
    REAL, PARAMETER :: a6_Cl2(4) = (/  6.4644E-20, -4.1505E-25,  4.3566E-30, -2.9653E-35 /)
    REAL, PARAMETER :: a7_Cl2(4) = (/  8.1710E-22,  4.8554E-26,  7.2544E-31, -1.8533E-35 /)

    jval_2d(ip_Cl2)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_Cl2(2) = &
          p1(b2_Cl2(i2(j,k)), a2_Cl2(i2(j,k)), &
          v3_du1(j,k))
        sig_Cl2(3) = &
          p1(b3_Cl2(i3(j,k)), a3_Cl2(i3(j,k)), &
          v3_du2(j,k))
        sig_Cl2(4) = &
          p3(a4_Cl2(1),a4_Cl2(2),a4_Cl2(3), &
          a4_Cl2(4),v3_du2(j,k))
        sig_Cl2(5) = &
          p3(a5_Cl2(1),a5_Cl2(2),a5_Cl2(3), &
          a5_Cl2(4),v3_du2(j,k))
        sig_Cl2(6) = &
          p3(a6_Cl2(1),a6_Cl2(2),a6_Cl2(3), &
          a6_Cl2(4),v3_du2(j,k))
        sig_Cl2(7) = &
          p3(a7_Cl2(1),a7_Cl2(2),a7_Cl2(3), &
          a7_Cl2(4),v3_du2(j,k))
        dj = 0. &
          + sig_Cl2(2) * fint(j,k,2) &
          + sig_Cl2(3) * fint(j,k,3) &
          + sig_Cl2(4) * fint(j,k,4) &
          + sig_Cl2(5) * fint(j,k,5) &
          + sig_Cl2(6) * fint(j,k,6) &
          + sig_Cl2(7) * fint(j,k,7)

        jval_2d(ip_Cl2)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,1)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_Cl2

  ! **************************************************************************

  SUBROUTINE jval_cal_BrO

    ! BrO \TOHV\ Br + O

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_BrO

    ! T-const parameters:
    REAL, PARAMETER :: a2_BrO(dim55) = (/ &
       2.3312E-20,  2.3880E-20,  2.3052E-20,  2.1284E-20,  1.9088E-20,  1.6844E-20, &
       1.4780E-20,  1.2992E-20,  1.1476E-20,  1.0216E-20,  9.1720E-21,  8.2960E-21, &
       7.5600E-21,  6.9280E-21,  6.3800E-21,  5.9080E-21,  5.4840E-21,  5.1040E-21, &
       4.7680E-21,  4.4560E-21,  4.1760E-21,  3.9120E-21,  3.6760E-21,  3.4520E-21, &
       3.2440E-21,  3.0480E-21,  2.8720E-21,  2.6960E-21,  2.5400E-21,  2.3920E-21, &
       2.2480E-21,  2.1200E-21,  1.9920E-21,  1.8760E-21,  1.7640E-21,  1.6640E-21, &
       1.5600E-21,  1.4720E-21,  1.3840E-21,  1.3000E-21,  1.0864E-21,  7.9760E-22, &
       5.8400E-22,  4.2640E-22,  3.1120E-22,  2.2640E-22,  1.6480E-22,  1.1920E-22, &
       8.7200E-23,  6.3200E-23,  4.5600E-23,  3.3600E-23,  2.4000E-23,  1.7600E-23, &
       1.2000E-23 /)
    REAL, PARAMETER :: b2_BrO(dim55) = (/ &
       1.9352E-19,  1.9182E-19,  1.9637E-19,  2.1052E-19,  2.3358E-19,  2.6275E-19, &
       2.9474E-19,  3.2692E-19,  3.5800E-19,  3.8698E-19,  4.1360E-19,  4.3813E-19, &
       4.6058E-19,  4.8144E-19,  5.0089E-19,  5.1883E-19,  5.3600E-19,  5.5234E-19, &
       5.6763E-19,  5.8260E-19,  5.9674E-19,  6.1073E-19,  6.2383E-19,  6.3682E-19, &
       6.4941E-19,  6.6176E-19,  6.7328E-19,  6.8525E-19,  6.9625E-19,  7.0705E-19, &
       7.1793E-19,  7.2791E-19,  7.3821E-19,  7.4784E-19,  7.5742E-19,  7.6622E-19, &
       7.7563E-19,  7.8381E-19,  7.9222E-19,  8.0045E-19,  8.2192E-19,  8.5455E-19, &
       8.8136E-19,  9.0311E-19,  9.2044E-19,  9.3427E-19,  9.4508E-19,  9.5365E-19, &
       9.6007E-19,  9.6518E-19,  9.6915E-19,  9.7200E-19,  9.7441E-19,  9.7609E-19, &
       9.7763E-19 /)
    REAL, PARAMETER :: a3_BrO(dim55) = (/ &
       5.9322E-21,  4.1491E-21,  2.7144E-21,  1.8997E-21,  1.4498E-21,  1.1809E-21, &
       1.0080E-21,  8.8839E-22,  8.0267E-22,  7.3592E-22,  6.8299E-22,  6.4008E-22, &
       6.0585E-22,  5.7343E-22,  5.4424E-22,  5.2037E-22,  4.9803E-22,  4.7562E-22, &
       4.5548E-22,  4.3664E-22,  4.1709E-22,  4.0240E-22,  3.8356E-22,  3.6815E-22, &
       3.5214E-22,  3.3733E-22,  3.2192E-22,  3.0993E-22,  2.9402E-22,  2.8253E-22, &
       2.7055E-22,  2.5685E-22,  2.4615E-22,  2.3459E-22,  2.2260E-22,  2.1368E-22, &
       2.0377E-22,  1.9349E-22,  1.8493E-22,  1.7607E-22,  1.5269E-22,  1.1914E-22, &
       9.2745E-23,  7.2578E-23,  5.6488E-23,  4.3806E-23,  3.4577E-23,  2.7046E-23, &
       2.0876E-23,  1.6775E-23,  1.3009E-23,  9.9247E-24,  8.2164E-24,  6.1623E-24, &
       5.1335E-24 /)
    REAL, PARAMETER :: b3_BrO(dim55) = (/ &
       2.5324E-18,  2.6375E-18,  2.8059E-18,  2.9491E-18,  3.0544E-18,  3.1331E-18, &
       3.1938E-18,  3.2428E-18,  3.2829E-18,  3.3181E-18,  3.3490E-18,  3.3766E-18, &
       3.4006E-18,  3.4253E-18,  3.4492E-18,  3.4701E-18,  3.4910E-18,  3.5133E-18, &
       3.5344E-18,  3.5554E-18,  3.5782E-18,  3.5963E-18,  3.6205E-18,  3.6412E-18, &
       3.6637E-18,  3.6853E-18,  3.7087E-18,  3.7276E-18,  3.7537E-18,  3.7731E-18, &
       3.7941E-18,  3.8190E-18,  3.8390E-18,  3.8613E-18,  3.8851E-18,  3.9033E-18, &
       3.9242E-18,  3.9464E-18,  3.9654E-18,  3.9856E-18,  4.0403E-18,  4.1285E-18, &
       4.2056E-18,  4.2704E-18,  4.3268E-18,  4.3750E-18,  4.4128E-18,  4.4458E-18, &
       4.4746E-18,  4.4950E-18,  4.5148E-18,  4.5319E-18,  4.5419E-18,  4.5545E-18, &
       4.5611E-18 /)
    REAL, PARAMETER :: a4_BrO(4) = (/  4.0853E-18, -1.2172E-22, -1.8176E-26,  2.9758E-30 /)
    REAL, PARAMETER :: a5_BrO(4) = (/  5.6738E-18,  1.9356E-23, -3.8909E-27,  2.1881E-31 /)
    REAL, PARAMETER :: a6_BrO(4) = (/  8.8424E-19, -1.0447E-23,  1.1088E-28, -7.2332E-34 /)

    jval_2d(ip_BrO)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_BrO(2) = &
          p1(b2_BrO(i2(j,k)), a2_BrO(i2(j,k)), &
          v3_du1(j,k))
        sig_BrO(3) = &
          p1(b3_BrO(i3(j,k)), a3_BrO(i3(j,k)), &
          v3_du2(j,k))
        sig_BrO(4) = &
          p3(a4_BrO(1),a4_BrO(2),a4_BrO(3), &
          a4_BrO(4),v3_du2(j,k))
        sig_BrO(5) = &
          p3(a5_BrO(1),a5_BrO(2),a5_BrO(3), &
          a5_BrO(4),v3_du2(j,k))
        sig_BrO(6) = &
          p3(a6_BrO(1),a6_BrO(2),a6_BrO(3), &
          a6_BrO(4),v3_du2(j,k))
        dj = 0. &
          + sig_BrO(2) * fint(j,k,2) &
          + sig_BrO(3) * fint(j,k,3) &
          + sig_BrO(4) * fint(j,k,4) &
          + sig_BrO(5) * fint(j,k,5) &
          + sig_BrO(6) * fint(j,k,6)

        jval_2d(ip_BrO)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,4)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_BrO

  ! **************************************************************************

  SUBROUTINE jval_cal_HOBr

    ! HOBr \TOHV\ OH + Br

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_HOBr

    ! T-const parameters:
    REAL, PARAMETER :: a2_HOBr(dim55) = (/ &
       5.1760E-21,  4.4400E-21,  3.5720E-21,  2.7200E-21,  1.9840E-21,  1.4080E-21, &
       9.7600E-22,  6.7200E-22,  4.6400E-22,  3.1200E-22,  2.1600E-22,  1.4800E-22, &
       1.0000E-22,  7.2000E-23,  4.4000E-23,  3.2000E-23,  2.0000E-23,  1.2000E-23, &
       8.0000E-24,  4.0000E-24,  0.0000E+00, -4.0000E-24, -4.0000E-24, -4.0000E-24, &
      -4.0000E-24, -4.0000E-24, -8.0000E-24, -4.0000E-24, -8.0000E-24, -4.0000E-24, &
      -8.0000E-24, -4.0000E-24, -8.0000E-24, -4.0000E-24, -8.0000E-24, -4.0000E-24, &
      -4.0000E-24, -4.0000E-24, -4.0000E-24, -4.0000E-24, -4.0000E-24, -2.4000E-24, &
      -2.4000E-24, -1.6000E-24, -8.0000E-25, -8.0000E-25, -8.0000E-25, -8.0000E-25, &
       0.0000E+00,  0.0000E+00,  0.0000E+00, -8.0000E-25,  0.0000E+00,  0.0000E+00, &
       0.0000E+00 /)
    REAL, PARAMETER :: b2_HOBr(dim55) = (/ &
       1.8628E-19,  1.8849E-19,  1.9326E-19,  2.0008E-19,  2.0781E-19,  2.1530E-19, &
       2.2199E-19,  2.2746E-19,  2.3173E-19,  2.3522E-19,  2.3767E-19,  2.3958E-19, &
       2.4104E-19,  2.4196E-19,  2.4296E-19,  2.4341E-19,  2.4390E-19,  2.4424E-19, &
       2.4443E-19,  2.4462E-19,  2.4482E-19,  2.4503E-19,  2.4503E-19,  2.4503E-19, &
       2.4503E-19,  2.4503E-19,  2.4529E-19,  2.4502E-19,  2.4530E-19,  2.4501E-19, &
       2.4531E-19,  2.4500E-19,  2.4532E-19,  2.4499E-19,  2.4533E-19,  2.4498E-19, &
       2.4498E-19,  2.4498E-19,  2.4498E-19,  2.4498E-19,  2.4498E-19,  2.4480E-19, &
       2.4480E-19,  2.4469E-19,  2.4457E-19,  2.4457E-19,  2.4457E-19,  2.4457E-19, &
       2.4441E-19,  2.4441E-19,  2.4441E-19,  2.4460E-19,  2.4440E-19,  2.4440E-19, &
       2.4440E-19 /)
    REAL, PARAMETER :: a3_HOBr(dim55) = (/ &
      -1.9837E-22, -1.3231E-22, -7.9925E-23, -5.0488E-23, -3.4235E-23, -2.4987E-23, &
      -1.9168E-23, -1.5406E-23, -1.2494E-23, -1.0611E-23, -9.0722E-24, -7.8727E-24, &
      -7.0169E-24, -6.1623E-24, -5.4766E-24, -5.1352E-24, -4.4498E-24, -4.1061E-24, &
      -3.7671E-24, -3.4247E-24, -3.2479E-24, -2.9110E-24, -2.7397E-24, -2.5685E-24, &
      -2.3932E-24, -2.2260E-24, -2.0548E-24, -1.8836E-24, -1.8803E-24, -1.5411E-24, &
      -1.7123E-24, -1.3699E-24, -1.5385E-24, -1.1986E-24, -1.3699E-24, -1.0256E-24, &
      -1.1986E-24, -1.0274E-24, -1.0274E-24, -8.5470E-25, -7.8740E-25, -6.1623E-25, &
      -4.4490E-25, -3.4235E-25, -2.7388E-25, -2.0534E-25, -1.7117E-25, -1.3694E-25, &
      -1.0267E-25, -6.8470E-26, -6.8470E-26, -3.4223E-26, -3.4235E-26, -3.4235E-26, &
      -3.4223E-26 /)
    REAL, PARAMETER :: b3_HOBr(dim55) = (/ &
       2.0234E-19,  1.9845E-19,  1.9230E-19,  1.8712E-19,  1.8332E-19,  1.8061E-19, &
       1.7857E-19,  1.7703E-19,  1.7567E-19,  1.7467E-19,  1.7378E-19,  1.7300E-19, &
       1.7240E-19,  1.7175E-19,  1.7119E-19,  1.7089E-19,  1.7025E-19,  1.6991E-19, &
       1.6955E-19,  1.6917E-19,  1.6897E-19,  1.6855E-19,  1.6833E-19,  1.6810E-19, &
       1.6786E-19,  1.6761E-19,  1.6735E-19,  1.6708E-19,  1.6708E-19,  1.6650E-19, &
       1.6680E-19,  1.6618E-19,  1.6650E-19,  1.6584E-19,  1.6618E-19,  1.6548E-19, &
       1.6584E-19,  1.6547E-19,  1.6547E-19,  1.6508E-19,  1.6492E-19,  1.6447E-19, &
       1.6397E-19,  1.6364E-19,  1.6340E-19,  1.6314E-19,  1.6300E-19,  1.6285E-19, &
       1.6269E-19,  1.6252E-19,  1.6252E-19,  1.6233E-19,  1.6233E-19,  1.6233E-19, &
       1.6233E-19 /)
    REAL, PARAMETER :: a4_HOBr(4) = (/  1.3816E-19, -7.1486E-24,  1.4807E-27, -1.0324E-31 /)
    REAL, PARAMETER :: a5_HOBr(4) = (/  1.1007E-19, -4.5166E-25,  1.5913E-28, -1.1898E-32 /)
    REAL, PARAMETER :: a6_HOBr(4) = (/  5.5577E-20, -1.7688E-25,  1.6486E-30, -5.2862E-36 /)
    REAL, PARAMETER :: a7_HOBr(4) = (/  4.2120E-21,  2.3350E-25,  2.7824E-30, -1.0090E-34 /)

    jval_2d(ip_HOBr)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_HOBr(2) = &
          p1(b2_HOBr(i2(j,k)), a2_HOBr(i2(j,k)), &
          v3_du1(j,k))
        sig_HOBr(3) = &
          p1(b3_HOBr(i3(j,k)), a3_HOBr(i3(j,k)), &
          v3_du2(j,k))
        sig_HOBr(4) = &
          p3(a4_HOBr(1),a4_HOBr(2),a4_HOBr(3), &
          a4_HOBr(4),v3_du2(j,k))
        sig_HOBr(5) = &
          p3(a5_HOBr(1),a5_HOBr(2),a5_HOBr(3), &
          a5_HOBr(4),v3_du2(j,k))
        sig_HOBr(6) = &
          p3(a6_HOBr(1),a6_HOBr(2),a6_HOBr(3), &
          a6_HOBr(4),v3_du2(j,k))
        sig_HOBr(7) = &
          p3(a7_HOBr(1),a7_HOBr(2),a7_HOBr(3), &
          a7_HOBr(4),v3_du2(j,k))
        dj = 0. &
          + sig_HOBr(2) * fint(j,k,2) &
          + sig_HOBr(3) * fint(j,k,3) &
          + sig_HOBr(4) * fint(j,k,4) &
          + sig_HOBr(5) * fint(j,k,5) &
          + sig_HOBr(6) * fint(j,k,6) &
          + sig_HOBr(7) * fint(j,k,7)

        jval_2d(ip_HOBr)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,1)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_HOBr

  ! **************************************************************************

  SUBROUTINE jval_cal_BrCl

    ! BrCl \TOHV\ Br + Cl

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_BrCl

    ! T-const parameters:
    REAL, PARAMETER :: a0_1_1_BrCl(dim58) = (/ &
       1.1790E-22,  1.2904E-22,  1.4093E-22,  1.5343E-22,  1.6660E-22,  1.8031E-22, &
       1.9462E-22,  2.0955E-22,  2.2524E-22,  2.4183E-22,  2.5917E-22,  2.7758E-22, &
       3.3609E-22,  4.7919E-22,  4.6652E-22,  4.9329E-22,  5.6566E-22,  5.4783E-22, &
       5.7290E-22,  6.4601E-22,  6.1752E-22,  6.3496E-22,  7.0399E-22,  6.6046E-22, &
       6.6740E-22,  5.5793E-22,  5.0848E-22,  5.2092E-22,  5.3969E-22,  5.6628E-22, &
       6.0100E-22,  6.4421E-22,  6.9526E-22,  7.5254E-22,  8.1494E-22,  8.7950E-22, &
       9.4628E-22,  1.0126E-21,  1.0791E-21,  1.1464E-21,  1.2133E-21,  1.2808E-21, &
       1.3468E-21,  1.4102E-21,  1.4666E-21,  1.5117E-21,  1.5422E-21,  1.5555E-21, &
       1.5501E-21,  1.5286E-21,  1.4908E-21,  1.4442E-21,  1.3847E-21,  1.3181E-21, &
       1.2424E-21,  1.1454E-21,  9.9830E-22,  8.1884E-22 /)
    REAL, PARAMETER :: a0_1_2_BrCl(dim58) = (/ &
       8.7245E-23, -4.0492E-22, -9.3313E-22, -1.4904E-21, -2.0803E-21, -2.6976E-21, &
      -3.3442E-21, -4.0220E-21, -4.7373E-21, -5.4974E-21, -6.2948E-21, -7.1456E-21, &
      -9.8605E-21, -1.6529E-20, -1.5936E-20, -1.7194E-20, -2.0610E-20, -1.9765E-20, &
      -2.0958E-20, -2.4453E-20, -2.3085E-20, -2.3926E-20, -2.7267E-20, -2.5151E-20, &
      -2.5490E-20, -2.0126E-20, -1.7693E-20, -1.8307E-20, -1.9239E-20, -2.0563E-20, &
      -2.2299E-20, -2.4468E-20, -2.7041E-20, -2.9939E-20, -3.3109E-20, -3.6402E-20, &
      -3.9821E-20, -4.3227E-20, -4.6662E-20, -5.0146E-20, -5.3626E-20, -5.7149E-20, &
      -6.0606E-20, -6.3942E-20, -6.6921E-20, -6.9312E-20, -7.0933E-20, -7.1646E-20, &
      -7.1356E-20, -7.0200E-20, -6.8155E-20, -6.5629E-20, -6.2395E-20, -5.8760E-20, &
      -5.4609E-20, -4.9274E-20, -4.1154E-20, -3.1212E-20 /)
    REAL, PARAMETER :: a0_2_1_BrCl(dim58) = (/ &
       6.0924E-25,  6.7239E-25,  7.4077E-25,  8.1553E-25,  8.9648E-25,  9.8322E-25, &
       1.0770E-24,  1.1793E-24,  1.2886E-24,  1.4074E-24,  1.5377E-24,  1.6808E-24, &
       1.2496E-24, -3.5411E-25,  3.9648E-25,  5.8124E-25,  2.0116E-25,  1.0098E-24, &
       1.2558E-24,  9.3642E-25,  1.8082E-24,  2.1095E-24,  1.8384E-24,  2.7456E-24, &
       3.0676E-24,  4.5039E-24,  5.2637E-24,  5.3497E-24,  5.3158E-24,  5.1442E-24, &
       4.8253E-24,  4.3589E-24,  3.7625E-24,  3.0655E-24,  2.3169E-24,  1.5592E-24, &
       8.4644E-25,  2.1589E-25, -3.0946E-25, -7.1558E-25, -1.0031E-24, -1.1899E-24, &
      -1.2934E-24, -1.3489E-24, -1.3614E-24, -1.3492E-24, -1.3211E-24, -1.2714E-24, &
      -1.2066E-24, -1.1404E-24, -1.0586E-24, -9.9577E-25, -9.0828E-25, -8.2278E-25, &
      -7.3258E-25, -6.2735E-25, -5.2324E-25, -4.3879E-25 /)
    REAL, PARAMETER :: a0_2_2_BrCl(dim58) = (/ &
      -3.5116E-23, -3.7907E-23, -4.0943E-23, -4.4277E-23, -4.7904E-23, -5.1807E-23, &
      -5.6048E-23, -6.0689E-23, -6.5673E-23, -7.1116E-23, -7.7108E-23, -8.3720E-23, &
      -6.3714E-23,  1.1020E-23, -2.4108E-23, -3.2791E-23, -1.4852E-23, -5.3180E-23, &
      -6.4891E-23, -4.9625E-23, -9.1468E-23, -1.0599E-22, -9.2869E-23, -1.3696E-22, &
      -1.5267E-22, -2.2305E-22, -2.6044E-22, -2.6468E-22, -2.6300E-22, -2.5446E-22, &
      -2.3851E-22, -2.1510E-22, -1.8504E-22, -1.4977E-22, -1.1174E-22, -7.3103E-23, &
      -3.6607E-23, -4.1970E-24,  2.2911E-23,  4.3948E-23,  5.8897E-23,  6.8652E-23, &
       7.4072E-23,  7.6993E-23,  7.7654E-23,  7.7007E-23,  7.5512E-23,  7.2859E-23, &
       6.9386E-23,  6.5824E-23,  6.1403E-23,  5.8000E-23,  5.3240E-23,  4.8572E-23, &
       4.3630E-23,  3.7842E-23,  3.2095E-23,  2.7416E-23 /)
    REAL, PARAMETER :: a1_1_BrCl(dim55) = (/ &
      -2.0048E-22, -2.2046E-22, -2.5246E-22, -2.5406E-22, -2.6781E-22, -2.5662E-22, &
      -2.5763E-22, -2.4170E-22, -2.3599E-22, -2.1985E-22, -2.1133E-22, -1.9742E-22, &
      -1.8826E-22, -1.7685E-22, -1.6791E-22, -1.5886E-22, -1.5059E-22, -1.4348E-22, &
      -1.3566E-22, -1.3038E-22, -1.2303E-22, -1.1884E-22, -1.1228E-22, -1.0922E-22, &
      -1.0298E-22, -1.0066E-22, -9.5064E-23, -9.3239E-23, -8.8059E-23, -8.6759E-23, &
      -8.1896E-23, -8.1313E-23, -7.6359E-23, -7.6096E-23, -7.1769E-23, -7.1705E-23, &
      -6.7546E-23, -6.7753E-23, -6.3717E-23, -6.4158E-23, -5.8245E-23, -5.2205E-23, &
      -4.6620E-23, -4.2773E-23, -3.8786E-23, -3.6173E-23, -3.3110E-23, -3.1215E-23, &
      -2.7779E-23, -2.5876E-23, -2.4127E-23, -2.2513E-23, -2.1034E-23, -1.9676E-23, &
      -1.8447E-23 /)
    REAL, PARAMETER :: b1_1_BrCl(dim55) = (/ &
       5.9153E-20,  5.9213E-20,  5.9389E-20,  5.9402E-20,  5.9546E-20,  5.9401E-20, &
       5.9417E-20,  5.9130E-20,  5.9013E-20,  5.8642E-20,  5.8424E-20,  5.8035E-20, &
       5.7755E-20,  5.7379E-20,  5.7062E-20,  5.6717E-20,  5.6383E-20,  5.6077E-20, &
       5.5721E-20,  5.5468E-20,  5.5097E-20,  5.4874E-20,  5.4510E-20,  5.4333E-20, &
       5.3955E-20,  5.3809E-20,  5.3443E-20,  5.3318E-20,  5.2953E-20,  5.2858E-20, &
       5.2491E-20,  5.2446E-20,  5.2047E-20,  5.2025E-20,  5.1655E-20,  5.1650E-20, &
       5.1273E-20,  5.1292E-20,  5.0907E-20,  5.0950E-20,  5.0356E-20,  4.9673E-20, &
       4.8972E-20,  4.8442E-20,  4.7842E-20,  4.7416E-20,  4.6878E-20,  4.6522E-20, &
       4.5833E-20,  4.5428E-20,  4.5033E-20,  4.4649E-20,  4.4279E-20,  4.3921E-20, &
       4.3583E-20 /)
    REAL, PARAMETER :: a1_2_BrCl(dim55) = (/ &
       1.4531E-24,  1.0796E-24,  1.1858E-24,  7.4824E-25,  7.6881E-25,  3.8618E-25, &
       3.8022E-25,  1.0886E-25,  1.0268E-25, -6.6689E-26, -6.9001E-26, -1.5982E-25, &
      -1.6135E-25, -2.0342E-25, -2.0490E-25, -2.1673E-25, -2.2089E-25, -2.1486E-25, &
      -2.2379E-25, -2.0419E-25, -2.1720E-25, -1.9321E-25, -2.0644E-25, -1.7834E-25, &
      -1.9451E-25, -1.6551E-25, -1.8186E-25, -1.5209E-25, -1.6899E-25, -1.4075E-25, &
      -1.5735E-25, -1.2833E-25, -1.4731E-25, -1.1907E-25, -1.3636E-25, -1.0891E-25, &
      -1.2678E-25, -1.0085E-25, -1.1793E-25, -9.3550E-26, -9.5092E-26, -7.6780E-26, &
      -6.8817E-26, -5.6678E-26, -5.2657E-26, -4.4044E-26, -4.2230E-26, -3.5814E-26, &
      -4.0521E-26, -3.7908E-26, -3.5755E-26, -3.3965E-26, -3.2392E-26, -3.0924E-26, &
      -2.9588E-26 /)
    REAL, PARAMETER :: b1_2_BrCl(dim55) = (/ &
       1.3037E-23,  1.4158E-23,  1.3574E-23,  1.7074E-23,  1.6858E-23,  2.1832E-23, &
       2.1925E-23,  2.6809E-23,  2.6936E-23,  3.0831E-23,  3.0890E-23,  3.3433E-23, &
       3.3480E-23,  3.4868E-23,  3.4921E-23,  3.5370E-23,  3.5539E-23,  3.5279E-23, &
       3.5686E-23,  3.4745E-23,  3.5402E-23,  3.4131E-23,  3.4865E-23,  3.3235E-23, &
       3.4213E-23,  3.2386E-23,  3.3457E-23,  3.1433E-23,  3.2624E-23,  3.0563E-23, &
       3.1816E-23,  2.9553E-23,  3.1080E-23,  2.8736E-23,  3.0215E-23,  2.7799E-23, &
       2.9416E-23,  2.7005E-23,  2.8636E-23,  2.6247E-23,  2.6402E-23,  2.4333E-23, &
       2.3333E-23,  2.1658E-23,  2.1053E-23,  1.9649E-23,  1.9331E-23,  1.8124E-23, &
       1.9068E-23,  1.8512E-23,  1.8026E-23,  1.7600E-23,  1.7206E-23,  1.6820E-23, &
       1.6452E-23 /)
    REAL, PARAMETER :: a2_BrCl(dim55) = (/ &
      -8.1040E-22, -7.0200E-22, -5.7116E-22, -4.4148E-22, -3.2888E-22, -2.3924E-22, &
      -1.7212E-22, -1.2364E-22, -8.9400E-23, -6.5520E-23, -4.8840E-23, -3.7160E-23, &
      -2.8880E-23, -2.2920E-23, -1.8560E-23, -1.5360E-23, -1.2920E-23, -1.1040E-23, &
      -9.5200E-24, -8.3600E-24, -7.4000E-24, -6.5600E-24, -5.9200E-24, -5.3600E-24, &
      -4.8400E-24, -4.4400E-24, -4.0400E-24, -3.7200E-24, -3.4000E-24, -3.1600E-24, &
      -2.9600E-24, -2.6800E-24, -2.5200E-24, -2.3600E-24, -2.1600E-24, -2.0400E-24, &
      -1.8800E-24, -1.7600E-24, -1.6800E-24, -1.5200E-24, -1.2640E-24, -9.1200E-25, &
      -6.5600E-25, -4.8000E-25, -3.4400E-25, -2.4800E-25, -1.8400E-25, -1.2800E-25, &
      -9.6000E-26, -7.2000E-26, -4.8000E-26, -4.0000E-26, -2.4000E-26, -2.4000E-26, &
      -8.0000E-27 /)
    REAL, PARAMETER :: b2_BrCl(dim55) = (/ &
       1.4046E-20,  1.3721E-20,  1.3001E-20,  1.1964E-20,  1.0782E-20,  9.6163E-21, &
       8.5760E-21,  7.7033E-21,  7.0014E-21,  6.4522E-21,  6.0268E-21,  5.6998E-21, &
       5.4472E-21,  5.2506E-21,  5.0958E-21,  4.9742E-21,  4.8754E-21,  4.7945E-21, &
       4.7254E-21,  4.6697E-21,  4.6212E-21,  4.5767E-21,  4.5412E-21,  4.5087E-21, &
       4.4772E-21,  4.4520E-21,  4.4258E-21,  4.4041E-21,  4.3815E-21,  4.3640E-21, &
       4.3489E-21,  4.3270E-21,  4.3142E-21,  4.3009E-21,  4.2838E-21,  4.2732E-21, &
       4.2587E-21,  4.2476E-21,  4.2399E-21,  4.2243E-21,  4.1985E-21,  4.1588E-21, &
       4.1266E-21,  4.1023E-21,  4.0819E-21,  4.0662E-21,  4.0550E-21,  4.0445E-21, &
       4.0380E-21,  4.0329E-21,  4.0275E-21,  4.0256E-21,  4.0216E-21,  4.0216E-21, &
       4.0172E-21 /)
    REAL, PARAMETER :: a3_BrCl(dim55) = (/ &
       1.2647E-23,  9.5579E-24,  6.5189E-24,  4.5439E-24,  3.3396E-24,  2.5706E-24, &
       2.0555E-24,  1.6929E-24,  1.4273E-24,  1.2237E-24,  1.0630E-24,  9.3787E-25, &
       8.3005E-25,  7.4461E-25,  6.7089E-25,  6.0938E-25,  5.5280E-25,  5.0642E-25, &
       4.6575E-25,  4.2808E-25,  3.9658E-25,  3.6644E-25,  3.4075E-25,  3.1849E-25, &
       2.9573E-25,  2.7568E-25,  2.5856E-25,  2.4315E-25,  2.2735E-25,  2.1404E-25, &
       2.0034E-25,  1.8836E-25,  1.7778E-25,  1.6781E-25,  1.5753E-25,  1.5043E-25, &
       1.4041E-25,  1.3356E-25,  1.2500E-25,  1.1966E-25,  1.0099E-25,  7.7028E-26, &
       5.9548E-26,  4.5532E-26,  3.5604E-26,  2.7379E-26,  2.1568E-26,  1.6775E-26, &
       1.3005E-26,  1.0270E-26,  8.2164E-27,  6.1602E-27,  5.1352E-27,  3.7658E-27, &
       3.0801E-27 /)
    REAL, PARAMETER :: b3_BrCl(dim55) = (/ &
       5.0610E-21,  5.2430E-21,  5.5996E-21,  5.9468E-21,  6.2288E-21,  6.4539E-21, &
       6.6347E-21,  6.7832E-21,  6.9074E-21,  7.0146E-21,  7.1086E-21,  7.1891E-21, &
       7.2647E-21,  7.3297E-21,  7.3900E-21,  7.4439E-21,  7.4969E-21,  7.5429E-21, &
       7.5857E-21,  7.6276E-21,  7.6644E-21,  7.7014E-21,  7.7344E-21,  7.7643E-21, &
       7.7963E-21,  7.8256E-21,  7.8516E-21,  7.8759E-21,  7.9018E-21,  7.9243E-21, &
       7.9483E-21,  7.9701E-21,  7.9898E-21,  8.0091E-21,  8.0295E-21,  8.0440E-21, &
       8.0651E-21,  8.0799E-21,  8.0989E-21,  8.1111E-21,  8.1547E-21,  8.2177E-21, &
       8.2688E-21,  8.3139E-21,  8.3487E-21,  8.3799E-21,  8.4037E-21,  8.4247E-21, &
       8.4423E-21,  8.4559E-21,  8.4667E-21,  8.4781E-21,  8.4841E-21,  8.4925E-21, &
       8.4969E-21 /)
    REAL, PARAMETER :: a4_BrCl(4) = (/  1.5234E-20,  2.7633E-24, -5.3021E-28,  3.5433E-32 /)
    REAL, PARAMETER :: a5_BrCl(4) = (/  7.8631E-20,  1.0989E-23, -1.5497E-27,  9.0951E-32 /)
    REAL, PARAMETER :: a6_BrCl(4) = (/  2.8618E-19,  2.2745E-25, -2.7151E-30,  1.9264E-35 /)
    REAL, PARAMETER :: a7_BrCl(4) = (/  2.8094E-20,  1.4491E-24,  1.6459E-29, -5.9967E-34 /)

    jval_2d(ip_BrCl)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_BrCl(0) = &
          p1(a0_1_1_BrCl(i0(j,k))*dlv2(j,k) + &
          a0_1_2_BrCl(i0(j,k)), &
          a0_2_1_BrCl(i0(j,k))*dlv2(j,k) + &
          a0_2_2_BrCl(i0(j,k)),v3_du1(j,k))
        sig_BrCl(1) = &
          (p1(b1_1_BrCl(i1(j,k)),a1_1_BrCl(i1(j,k)), &
          v3_du1(j,k)) + &
          p1(b1_2_BrCl(i1(j,k)),a1_2_BrCl(i1(j,k)), &
          v3_du1(j,k)) * v2s_m(j,k))
        sig_BrCl(2) = &
          p1(b2_BrCl(i2(j,k)), a2_BrCl(i2(j,k)), &
          v3_du1(j,k))
        sig_BrCl(3) = &
          p1(b3_BrCl(i3(j,k)), a3_BrCl(i3(j,k)), &
          v3_du2(j,k))
        sig_BrCl(4) = &
          p3(a4_BrCl(1),a4_BrCl(2),a4_BrCl(3), &
          a4_BrCl(4),v3_du2(j,k))
        sig_BrCl(5) = &
          p3(a5_BrCl(1),a5_BrCl(2),a5_BrCl(3), &
          a5_BrCl(4),v3_du2(j,k))
        sig_BrCl(6) = &
          p3(a6_BrCl(1),a6_BrCl(2),a6_BrCl(3), &
          a6_BrCl(4),v3_du2(j,k))
        sig_BrCl(7) = &
          p3(a7_BrCl(1),a7_BrCl(2),a7_BrCl(3), &
          a7_BrCl(4),v3_du2(j,k))
        dj = 0. &
          + sig_BrCl(0) * fint(j,k,0) &
          + sig_BrCl(1) * fint(j,k,1) &
          + sig_BrCl(2) * fint(j,k,2) &
          + sig_BrCl(3) * fint(j,k,3) &
          + sig_BrCl(4) * fint(j,k,4) &
          + sig_BrCl(5) * fint(j,k,5) &
          + sig_BrCl(6) * fint(j,k,6) &
          + sig_BrCl(7) * fint(j,k,7)

        jval_2d(ip_BrCl)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,1)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_BrCl

  ! **************************************************************************

  SUBROUTINE jval_cal_BrNO3

    ! BrNO_3 \TOHV\ \products

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_BrNO3

    ! T-const parameters:
    REAL, PARAMETER :: a0_1_1_BrNO3(dim58) = (/ &
       2.3606E-20,  2.5803E-20,  2.8278E-20,  3.0643E-20,  3.3439E-20,  3.6107E-20, &
       3.8942E-20,  4.1974E-20,  4.5128E-20,  4.8319E-20,  5.1976E-20,  5.5527E-20, &
       6.7321E-20,  9.5999E-20,  9.3354E-20,  9.8829E-20,  1.1318E-19,  1.0977E-19, &
       1.1468E-19,  1.2938E-19,  1.2365E-19,  1.2716E-19,  1.4092E-19,  1.3235E-19, &
       1.3358E-19,  1.1172E-19,  1.0180E-19,  1.0435E-19,  1.0800E-19,  1.1346E-19, &
       1.2027E-19,  1.2901E-19,  1.3926E-19,  1.5069E-19,  1.6315E-19,  1.7616E-19, &
       1.8949E-19,  2.0271E-19,  2.1613E-19,  2.2953E-19,  2.4299E-19,  2.5637E-19, &
       2.6973E-19,  2.8233E-19,  2.9361E-19,  3.0278E-19,  3.0881E-19,  3.1152E-19, &
       3.1042E-19,  3.0595E-19,  2.9880E-19,  2.8894E-19,  2.7729E-19,  2.6394E-19, &
       2.4871E-19,  2.2948E-19,  1.9985E-19,  1.6399E-19 /)
    REAL, PARAMETER :: a0_1_2_BrNO3(dim58) = (/ &
       1.7586E-20, -7.9535E-20, -1.8939E-19, -2.9487E-19, -4.2015E-19, -5.4021E-19, &
      -6.6835E-19, -8.0599E-19, -9.4981E-19, -1.0960E-18, -1.2642E-18, -1.4282E-18, &
      -1.9755E-18, -3.3119E-18, -3.1881E-18, -3.4454E-18, -4.1229E-18, -3.9611E-18, &
      -4.1950E-18, -4.8976E-18, -4.6225E-18, -4.7916E-18, -5.4579E-18, -5.0412E-18, &
      -5.1011E-18, -4.0299E-18, -3.5421E-18, -3.6678E-18, -3.8490E-18, -4.1211E-18, &
      -4.4614E-18, -4.9002E-18, -5.4167E-18, -5.9953E-18, -6.6282E-18, -7.2915E-18, &
      -7.9739E-18, -8.6537E-18, -9.3463E-18, -1.0040E-17, -1.0740E-17, -1.1439E-17, &
      -1.2139E-17, -1.2802E-17, -1.3397E-17, -1.3883E-17, -1.4204E-17, -1.4349E-17, &
      -1.4289E-17, -1.4049E-17, -1.3663E-17, -1.3129E-17, -1.2495E-17, -1.1766E-17, &
      -1.0931E-17, -9.8736E-18, -8.2381E-18, -6.2512E-18 /)
    REAL, PARAMETER :: a0_2_1_BrNO3(dim58) = (/ &
       1.2199E-22,  1.3490E-22,  1.4796E-22,  1.6386E-22,  1.7890E-22,  1.9689E-22, &
       2.1586E-22,  2.3598E-22,  2.5792E-22,  2.8247E-22,  3.0731E-22,  3.3696E-22, &
       2.5005E-22, -7.0897E-23,  7.9414E-23,  1.1622E-22,  4.0663E-23,  2.0183E-22, &
       2.5166E-22,  1.8735E-22,  3.6215E-22,  4.2227E-22,  3.6825E-22,  5.4943E-22, &
       6.1441E-22,  9.0179E-22,  1.0541E-21,  1.0711E-21,  1.0647E-21,  1.0299E-21, &
       9.6653E-22,  8.7274E-22,  7.5315E-22,  6.1379E-22,  4.6402E-22,  3.1192E-22, &
       1.6959E-22,  4.3408E-23, -6.1979E-23, -1.4322E-22, -2.0118E-22, -2.3776E-22, &
      -2.5942E-22, -2.6966E-22, -2.7262E-22, -2.7053E-22, -2.6439E-22, -2.5472E-22, &
      -2.4185E-22, -2.2762E-22, -2.1366E-22, -1.9782E-22, -1.8214E-22, -1.6477E-22, &
      -1.4621E-22, -1.2615E-22, -1.0472E-22, -8.8273E-23 /)
    REAL, PARAMETER :: a0_2_2_BrNO3(dim58) = (/ &
      -7.0315E-21, -7.6021E-21, -8.1818E-21, -8.8911E-21, -9.5647E-21, -1.0374E-20, &
      -1.1232E-20, -1.2145E-20, -1.3146E-20, -1.4270E-20, -1.5413E-20, -1.6783E-20, &
      -1.2750E-20,  2.2062E-21, -4.8284E-21, -6.5583E-21, -2.9920E-21, -1.0632E-20, &
      -1.3003E-20, -9.9292E-21, -1.8320E-20, -2.1217E-20, -1.8603E-20, -2.7408E-20, &
      -3.0579E-20, -4.4661E-20, -5.2156E-20, -5.2995E-20, -5.2677E-20, -5.0942E-20, &
      -4.7775E-20, -4.3067E-20, -3.7039E-20, -2.9988E-20, -2.2380E-20, -1.4623E-20, &
      -7.3352E-21, -8.4957E-22,  4.5884E-21,  8.7967E-21,  1.1811E-20,  1.3720E-20, &
       1.4855E-20,  1.5393E-20,  1.5550E-20,  1.5439E-20,  1.5112E-20,  1.4596E-20, &
       1.3906E-20,  1.3141E-20,  1.2387E-20,  1.1528E-20,  1.0676E-20,  9.7272E-21, &
       8.7102E-21,  7.6069E-21,  6.4237E-21,  5.5125E-21 /)
    REAL, PARAMETER :: a1_1_BrNO3(dim55) = (/ &
       4.2016E-20,  3.9685E-20,  3.7972E-20,  3.4615E-20,  3.2103E-20,  2.8868E-20, &
       2.6462E-20,  2.3860E-20,  2.1956E-20,  1.9988E-20,  1.8563E-20,  1.7130E-20, &
       1.6069E-20,  1.4989E-20,  1.4171E-20,  1.3371E-20,  1.2725E-20,  1.2104E-20, &
       1.1572E-20,  1.1079E-20,  1.0636E-20,  1.0224E-20,  9.8691E-21,  9.5054E-21, &
       9.1891E-21,  8.9037E-21,  8.6343E-21,  8.3564E-21,  8.1229E-21,  7.9115E-21, &
       7.6968E-21,  7.5003E-21,  7.2945E-21,  7.1522E-21,  6.9560E-21,  6.8199E-21, &
       6.6422E-21,  6.5307E-21,  6.3660E-21,  6.2654E-21,  5.9037E-21,  5.4111E-21, &
       4.9953E-21,  4.6542E-21,  4.3401E-21,  4.0888E-21,  3.8322E-21,  3.6356E-21, &
       3.3587E-21,  3.1584E-21,  2.9684E-21,  2.7938E-21,  2.6300E-21,  2.4781E-21, &
       2.3342E-21 /)
    REAL, PARAMETER :: b1_1_BrNO3(dim55) = (/ &
       2.3344E-18,  2.3414E-18,  2.3508E-18,  2.3777E-18,  2.4041E-18,  2.4461E-18, &
       2.4834E-18,  2.5303E-18,  2.5693E-18,  2.6146E-18,  2.6509E-18,  2.6910E-18, &
       2.7234E-18,  2.7590E-18,  2.7881E-18,  2.8184E-18,  2.8446E-18,  2.8713E-18, &
       2.8955E-18,  2.9192E-18,  2.9416E-18,  2.9634E-18,  2.9831E-18,  3.0042E-18, &
       3.0233E-18,  3.0413E-18,  3.0590E-18,  3.0779E-18,  3.0943E-18,  3.1097E-18, &
       3.1260E-18,  3.1413E-18,  3.1578E-18,  3.1697E-18,  3.1864E-18,  3.1984E-18, &
       3.2145E-18,  3.2249E-18,  3.2406E-18,  3.2505E-18,  3.2868E-18,  3.3425E-18, &
       3.3947E-18,  3.4417E-18,  3.4890E-18,  3.5300E-18,  3.5750E-18,  3.6119E-18, &
       3.6675E-18,  3.7101E-18,  3.7530E-18,  3.7945E-18,  3.8356E-18,  3.8755E-18, &
       3.9151E-18 /)
    REAL, PARAMETER :: a1_2_BrNO3(dim55) = (/ &
      -6.6400E-23, -2.4288E-23, -1.8618E-23,  1.2085E-23,  1.4979E-23,  3.1558E-23, &
       3.0593E-23,  3.6824E-23,  3.3196E-23,  3.4863E-23,  3.0529E-23,  3.0034E-23, &
       2.6277E-23,  2.5497E-23,  2.2412E-23,  2.1441E-23,  1.9249E-23,  1.8215E-23, &
       1.6723E-23,  1.5775E-23,  1.4650E-23,  1.4001E-23,  1.2930E-23,  1.2518E-23, &
       1.1715E-23,  1.1158E-23,  1.0569E-23,  1.0257E-23,  9.7235E-24,  9.2750E-24, &
       8.9046E-24,  8.4974E-24,  8.3255E-24,  7.7584E-24,  7.6581E-24,  7.2083E-24, &
       7.1965E-24,  6.6963E-24,  6.7370E-24,  6.1897E-24,  5.8061E-24,  4.9694E-24, &
       4.4240E-24,  3.8946E-24,  3.6258E-24,  3.2393E-24,  3.1278E-24,  2.8195E-24, &
       3.1192E-24,  3.0771E-24,  3.0527E-24,  3.0253E-24,  2.9953E-24,  2.9614E-24, &
       2.9220E-24 /)
    REAL, PARAMETER :: b1_2_BrNO3(dim55) = (/ &
      -2.8530E-21, -2.9793E-21, -3.0105E-21, -3.2561E-21, -3.2865E-21, -3.5021E-21, &
      -3.4871E-21, -3.5993E-21, -3.5249E-21, -3.5632E-21, -3.4527E-21, -3.4388E-21, &
      -3.3243E-21, -3.2985E-21, -3.1890E-21, -3.1521E-21, -3.0633E-21, -3.0189E-21, &
      -2.9510E-21, -2.9055E-21, -2.8487E-21, -2.8143E-21, -2.7548E-21, -2.7309E-21, &
      -2.6824E-21, -2.6473E-21, -2.6087E-21, -2.5875E-21, -2.5499E-21, -2.5171E-21, &
      -2.4892E-21, -2.4574E-21, -2.4436E-21, -2.3965E-21, -2.3879E-21, -2.3483E-21, &
      -2.3473E-21, -2.3007E-21, -2.3046E-21, -2.2510E-21, -2.2124E-21, -2.1179E-21, &
      -2.0494E-21, -1.9764E-21, -1.9359E-21, -1.8729E-21, -1.8534E-21, -1.7954E-21, &
      -1.8555E-21, -1.8465E-21, -1.8410E-21, -1.8345E-21, -1.8270E-21, -1.8181E-21, &
      -1.8072E-21 /)
    REAL, PARAMETER :: a2_BrNO3(dim55) = (/ &
      -9.9640E-21, -8.5680E-21, -6.9040E-21, -5.2880E-21, -3.8920E-21, -2.8040E-21, &
      -1.9920E-21, -1.4200E-21, -1.0160E-21, -7.4000E-22, -5.5200E-22, -4.2000E-22, &
      -3.2800E-22, -2.6400E-22, -2.1600E-22, -1.8000E-22, -1.5600E-22, -1.3600E-22, &
      -1.2000E-22, -1.0400E-22, -9.6000E-23, -8.8000E-23, -7.6000E-23, -7.2000E-23, &
      -6.8000E-23, -6.0000E-23, -5.6000E-23, -5.2000E-23, -4.8000E-23, -4.4000E-23, &
      -4.4000E-23, -4.0000E-23, -3.6000E-23, -3.2000E-23, -3.2000E-23, -3.2000E-23, &
      -2.8000E-23, -2.4000E-23, -2.4000E-23, -2.4000E-23, -1.8400E-23, -1.4400E-23, &
      -9.6000E-24, -7.2000E-24, -5.6000E-24, -3.2000E-24, -3.2000E-24, -1.6000E-24, &
      -1.6000E-24, -8.0000E-25, -8.0000E-25, -8.0000E-25, -8.0000E-25,  0.0000E+00, &
       0.0000E+00 /)
    REAL, PARAMETER :: b2_BrNO3(dim55) = (/ &
       3.5188E-19,  3.4769E-19,  3.3854E-19,  3.2561E-19,  3.1096E-19,  2.9681E-19, &
       2.8423E-19,  2.7393E-19,  2.6565E-19,  2.5930E-19,  2.5451E-19,  2.5081E-19, &
       2.4800E-19,  2.4589E-19,  2.4419E-19,  2.4282E-19,  2.4185E-19,  2.4099E-19, &
       2.4026E-19,  2.3949E-19,  2.3909E-19,  2.3866E-19,  2.3800E-19,  2.3777E-19, &
       2.3752E-19,  2.3702E-19,  2.3676E-19,  2.3649E-19,  2.3620E-19,  2.3591E-19, &
       2.3591E-19,  2.3560E-19,  2.3528E-19,  2.3495E-19,  2.3495E-19,  2.3495E-19, &
       2.3458E-19,  2.3421E-19,  2.3421E-19,  2.3421E-19,  2.3365E-19,  2.3320E-19, &
       2.3259E-19,  2.3226E-19,  2.3202E-19,  2.3163E-19,  2.3163E-19,  2.3133E-19, &
       2.3133E-19,  2.3116E-19,  2.3116E-19,  2.3116E-19,  2.3116E-19,  2.3095E-19, &
       2.3095E-19 /)
    REAL, PARAMETER :: a3_BrNO3(dim55) = (/ &
      -1.6602E-22, -1.0852E-22, -6.4179E-23, -3.9706E-23, -2.6703E-23, -1.9339E-23, &
      -1.4718E-23, -1.1640E-23, -9.5841E-24, -8.0438E-24, -6.8470E-24, -5.8189E-24, &
      -5.3055E-24, -4.4505E-24, -4.2786E-24, -3.5947E-24, -3.4229E-24, -2.9085E-24, &
      -2.9110E-24, -2.5685E-24, -2.2222E-24, -2.2260E-24, -1.8836E-24, -1.8836E-24, &
      -1.7094E-24, -1.7123E-24, -1.3699E-24, -1.3699E-24, -1.3675E-24, -1.1986E-24, &
      -1.1986E-24, -1.0274E-24, -1.0256E-24, -8.5616E-25, -1.0274E-24, -6.8376E-25, &
      -8.5616E-25, -6.8493E-25, -6.8493E-25, -6.8376E-25, -5.8199E-25, -4.1082E-25, &
      -3.0801E-25, -2.7388E-25, -1.7117E-25, -1.7112E-25, -1.0270E-25, -1.0270E-25, &
      -6.8446E-26, -3.4235E-26, -3.4235E-26, -3.4223E-26, -3.4235E-26, -3.4235E-26, &
       0.0000E+00 /)
    REAL, PARAMETER :: b3_BrNO3(dim55) = (/ &
       1.8823E-19,  1.8484E-19,  1.7964E-19,  1.7534E-19,  1.7229E-19,  1.7014E-19, &
       1.6852E-19,  1.6726E-19,  1.6629E-19,  1.6548E-19,  1.6478E-19,  1.6412E-19, &
       1.6376E-19,  1.6311E-19,  1.6297E-19,  1.6237E-19,  1.6221E-19,  1.6170E-19, &
       1.6170E-19,  1.6132E-19,  1.6092E-19,  1.6092E-19,  1.6048E-19,  1.6048E-19, &
       1.6024E-19,  1.6024E-19,  1.5972E-19,  1.5972E-19,  1.5972E-19,  1.5943E-19, &
       1.5943E-19,  1.5912E-19,  1.5912E-19,  1.5879E-19,  1.5913E-19,  1.5843E-19, &
       1.5879E-19,  1.5842E-19,  1.5842E-19,  1.5842E-19,  1.5818E-19,  1.5773E-19, &
       1.5743E-19,  1.5732E-19,  1.5696E-19,  1.5696E-19,  1.5668E-19,  1.5668E-19, &
       1.5652E-19,  1.5635E-19,  1.5635E-19,  1.5635E-19,  1.5635E-19,  1.5635E-19, &
       1.5613E-19 /)
    REAL, PARAMETER :: a4_BrNO3(4) = (/  1.3800E-19, -5.8028E-24,  1.1784E-27, -8.1304E-32 /)
    REAL, PARAMETER :: a5_BrNO3(4) = (/  9.4123E-20, -4.2951E-24,  6.9690E-28, -4.3169E-32 /)
    REAL, PARAMETER :: a6_BrNO3(4) = (/  3.3375E-20, -1.0051E-25,  1.0445E-30, -6.7309E-36 /)
    REAL, PARAMETER :: a7_BrNO3(4) = (/  1.7658E-21,  1.0432E-25,  1.5045E-30, -4.0961E-35 /)
    ! T-dep parameters:
    REAL, PARAMETER :: c0_1_1_BrNO3(dim58) = (/ &
       2.7068E-02,  2.7068E-02,  2.7068E-02,  2.9712E-02,  3.4324E-02,  3.8366E-02, &
       4.0876E-02,  4.3800E-02,  4.5724E-02,  4.5562E-02,  4.6700E-02,  4.5633E-02, &
       4.4416E-02,  4.3178E-02,  4.1196E-02,  4.1039E-02,  3.9766E-02,  4.0098E-02, &
       4.0572E-02,  4.1103E-02,  4.1501E-02,  4.1737E-02,  3.8950E-02,  3.7473E-02, &
       3.3449E-02,  2.6558E-02,  2.0794E-02,  1.4962E-02,  1.0790E-02,  8.2061E-03, &
       1.0137E-02,  1.7249E-02,  2.8158E-02,  4.4802E-02,  6.4458E-02,  8.7890E-02, &
       1.1030E-01,  1.3147E-01,  1.4877E-01,  1.5910E-01,  1.6182E-01,  1.5493E-01, &
       1.3955E-01,  1.1732E-01,  9.2113E-02,  6.5796E-02,  4.2675E-02,  2.0137E-02, &
      -9.6666E-04, -2.5446E-02, -5.8618E-02, -1.0542E-01, -1.6598E-01, -2.3840E-01, &
      -3.1333E-01, -3.8931E-01, -4.8235E-01, -5.9547E-01 /)
    REAL, PARAMETER :: c0_1_2_BrNO3(dim58) = (/ &
      -1.6895E-01, -1.6895E-01, -1.6895E-01, -2.8685E-01, -4.9345E-01, -6.7534E-01, &
      -7.8881E-01, -9.2155E-01, -1.0093E+00, -1.0019E+00, -1.0542E+00, -1.0049E+00, &
      -9.4846E-01, -8.9078E-01, -7.9801E-01, -7.9061E-01, -7.3056E-01, -7.4629E-01, &
      -7.6885E-01, -7.9420E-01, -8.1335E-01, -8.2469E-01, -6.8980E-01, -6.1801E-01, &
      -4.2164E-01, -8.3983E-02,  1.9959E-01,  4.8766E-01,  6.9461E-01,  8.2329E-01, &
       7.2673E-01,  3.6975E-01, -1.8010E-01, -1.0223E+00, -2.0208E+00, -3.2158E+00, &
      -4.3633E+00, -5.4514E+00, -6.3442E+00, -6.8789E+00, -7.0206E+00, -6.6608E+00, &
      -5.8548E+00, -4.6856E+00, -3.3548E+00, -1.9600E+00, -7.2994E-01,  4.7359E-01, &
       1.6047E+00,  2.9217E+00,  4.7130E+00,  7.2497E+00,  1.0544E+01,  1.4498E+01, &
       1.8604E+01,  2.2783E+01,  2.7919E+01,  3.4186E+01 /)
    REAL, PARAMETER :: c0_2_1_BrNO3(dim58) = (/ &
       4.0867E-02,  4.0867E-02,  4.0867E-02,  3.9440E-02,  4.7197E-02,  5.6399E-02, &
       5.6829E-02,  6.3537E-02,  6.3239E-02,  5.9207E-02,  6.0586E-02,  5.5756E-02, &
       5.2850E-02,  4.5498E-02,  4.2762E-02,  3.6985E-02,  3.4990E-02,  3.2405E-02, &
       2.8691E-02,  3.5231E-02,  3.0966E-02,  3.1901E-02,  2.2770E-02,  3.3026E-02, &
       2.6003E-02,  1.8338E-02,  1.8878E-02,  2.1190E-02,  2.1188E-02,  3.0365E-02, &
       4.4032E-02,  6.3519E-02,  9.1303E-02,  1.1252E-01,  1.4609E-01,  1.8278E-01, &
       2.1385E-01,  2.4153E-01,  2.6095E-01,  2.6577E-01,  2.5022E-01,  2.1870E-01, &
       1.8775E-01,  1.4221E-01,  9.8999E-02,  6.0431E-02,  2.1232E-02, -2.6206E-02, &
      -5.8794E-02, -9.7484E-02, -1.3579E-01, -1.6394E-01, -1.8992E-01, -2.1201E-01, &
      -2.4826E-01, -3.2189E-01, -4.6448E-01, -6.5225E-01 /)
    REAL, PARAMETER :: c0_2_2_BrNO3(dim58) = (/ &
      -3.4786E+00, -3.4786E+00, -3.4786E+00, -3.4150E+00, -3.7625E+00, -4.1765E+00, &
      -4.1960E+00, -4.5006E+00, -4.4869E+00, -4.3023E+00, -4.3657E+00, -4.1426E+00, &
      -4.0077E+00, -3.6651E+00, -3.5371E+00, -3.2656E+00, -3.1714E+00, -3.0489E+00, &
      -2.8721E+00, -3.1847E+00, -2.9800E+00, -3.0250E+00, -2.5831E+00, -3.0815E+00, &
      -2.7388E+00, -2.3632E+00, -2.3898E+00, -2.5040E+00, -2.5039E+00, -2.9610E+00, &
      -3.6443E+00, -4.6226E+00, -6.0228E+00, -7.0965E+00, -8.8017E+00, -1.0673E+01, &
      -1.2264E+01, -1.3687E+01, -1.4688E+01, -1.4938E+01, -1.4130E+01, -1.2484E+01, &
      -1.0862E+01, -8.4671E+00, -6.1856E+00, -4.1415E+00, -2.0561E+00,  4.7709E-01, &
       2.2238E+00,  4.3054E+00,  6.3738E+00,  7.8995E+00,  9.3128E+00,  1.0519E+01, &
       1.2506E+01,  1.6555E+01,  2.4426E+01,  3.4828E+01 /)
    REAL, PARAMETER :: c1_BrNO3(3) = (/  1.0000E+00,  4.0323E-01, -8.1811E-01 /)
    REAL, PARAMETER :: c2_BrNO3(3) = (/  1.0000E+00,  1.7433E-01,  6.7814E-01 /)
    REAL, PARAMETER :: c3_BrNO3(3) = (/  1.0000E+00,  1.8886E-01,  1.0292E-01 /)
    REAL, PARAMETER :: c4_BrNO3(3) = (/  9.9998E-01,  2.2209E-01, -9.4989E-02 /)
    REAL, PARAMETER :: c5_BrNO3(3) = (/  1.0000E+00,  2.1139E-01,  2.2516E-02 /)
    REAL, PARAMETER :: c6_BrNO3(3) = (/  1.0000E+00,  2.4918E-01,  2.8193E-01 /)
    REAL, PARAMETER :: c7_BrNO3(3) = (/  1.0000E+00,  2.9489E-01,  5.6516E-01 /)

    jval_2d(ip_BrNO3)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_BrNO3(0) = &
          p2(1.,c0_1_1_BrNO3(i0(j,k))*dlv2(j,k) + &
          c0_1_2_BrNO3(i0(j,k)), &
          c0_2_1_BrNO3(i0(j,k))*dlv2(j,k) + &
          c0_2_2_BrNO3(i0(j,k)), tnorm_sr(j,k)) * &
          p1(a0_1_1_BrNO3(i0(j,k))*dlv2(j,k) + &
          a0_1_2_BrNO3(i0(j,k)), &
          a0_2_1_BrNO3(i0(j,k))*dlv2(j,k) + &
          a0_2_2_BrNO3(i0(j,k)),v3_du1(j,k))
        sig_BrNO3(1) = &
          p2(c1_BrNO3(1),c1_BrNO3(2), &
          c1_BrNO3(3),tnorm(j,k)) * &
          (p1(b1_1_BrNO3(i1(j,k)),a1_1_BrNO3(i1(j,k)), &
          v3_du1(j,k)) + &
          p1(b1_2_BrNO3(i1(j,k)),a1_2_BrNO3(i1(j,k)), &
          v3_du1(j,k)) * v2s_m(j,k))
        sig_BrNO3(2) = &
          p2(c2_BrNO3(1),c2_BrNO3(2),c2_BrNO3(3),tnorm(j,k))* &
          p1(b2_BrNO3(i2(j,k)), a2_BrNO3(i2(j,k)), &
          v3_du1(j,k))
        sig_BrNO3(3) = &
          p2(c3_BrNO3(1),c3_BrNO3(2),c3_BrNO3(3),tnorm(j,k))* &
          p1(b3_BrNO3(i3(j,k)), a3_BrNO3(i3(j,k)), &
          v3_du2(j,k))
        sig_BrNO3(4) = &
          p2(c4_BrNO3(1),c4_BrNO3(2),c4_BrNO3(3),tnorm(j,k))* &
          p3(a4_BrNO3(1),a4_BrNO3(2),a4_BrNO3(3), &
          a4_BrNO3(4),v3_du2(j,k))
        sig_BrNO3(5) = &
          p2(c5_BrNO3(1),c5_BrNO3(2),c5_BrNO3(3),tnorm(j,k))* &
          p3(a5_BrNO3(1),a5_BrNO3(2),a5_BrNO3(3), &
          a5_BrNO3(4),v3_du2(j,k))
        sig_BrNO3(6) = &
          p2(c6_BrNO3(1),c6_BrNO3(2),c6_BrNO3(3),tnorm(j,k))* &
          p3(a6_BrNO3(1),a6_BrNO3(2),a6_BrNO3(3), &
          a6_BrNO3(4),v3_du2(j,k))
        sig_BrNO3(7) = &
          p2(c7_BrNO3(1),c7_BrNO3(2),c7_BrNO3(3),tnorm(j,k))* &
          p3(a7_BrNO3(1),a7_BrNO3(2),a7_BrNO3(3), &
          a7_BrNO3(4),v3_du2(j,k))
        dj = 0. &
          + sig_BrNO3(0) * fint(j,k,0) &
          + sig_BrNO3(1) * fint(j,k,1) &
          + sig_BrNO3(2) * fint(j,k,2) &
          + sig_BrNO3(3) * fint(j,k,3) &
          + sig_BrNO3(4) * fint(j,k,4) &
          + sig_BrNO3(5) * fint(j,k,5) &
          + sig_BrNO3(6) * fint(j,k,6) &
          + sig_BrNO3(7) * fint(j,k,7)

        jval_2d(ip_BrNO3)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,1)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_BrNO3

  ! **************************************************************************

  SUBROUTINE jval_cal_BrNO2

    ! BrNO_2 \TOHV\ \products

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_BrNO2

    ! T-const parameters:
    REAL, PARAMETER :: a0_1_1_BrNO2(dim58) = (/ &
       7.3972E-19,  7.9620E-19,  8.5276E-19,  9.1028E-19,  9.6958E-19,  1.0253E-18, &
       1.0798E-18,  1.1356E-18,  1.1863E-18,  1.2357E-18,  1.2823E-18,  1.3283E-18, &
       1.5078E-18,  1.9774E-18,  1.8958E-18,  1.9460E-18,  2.1402E-18,  2.0137E-18, &
       2.0221E-18,  2.1820E-18,  1.9792E-18,  1.9178E-18,  2.0179E-18,  1.7235E-18, &
       1.5881E-18,  1.0551E-18,  7.1950E-19,  5.9146E-19,  4.8548E-19,  4.1018E-19, &
       3.6577E-19,  3.5436E-19,  3.7453E-19,  4.1988E-19,  4.8169E-19,  5.4870E-19, &
       6.1494E-19,  6.7062E-19,  7.1255E-19,  7.3710E-19,  7.4489E-19,  7.3822E-19, &
       7.1716E-19,  6.8527E-19,  6.4067E-19,  5.8853E-19,  5.2781E-19,  4.6464E-19, &
       4.0142E-19,  3.4138E-19,  2.8778E-19,  2.4029E-19,  1.9790E-19,  1.5972E-19, &
       1.2555E-19,  9.6782E-20,  7.2950E-20,  5.8861E-20 /)
    REAL, PARAMETER :: a0_1_2_BrNO2(dim58) = (/ &
       9.1706E-18,  6.6742E-18,  4.1627E-18,  1.5976E-18, -1.0592E-18, -3.5687E-18, &
      -6.0307E-18, -8.5646E-18, -1.0875E-17, -1.3139E-17, -1.5283E-17, -1.7407E-17, &
      -2.5736E-17, -4.7620E-17, -4.3802E-17, -4.6160E-17, -5.5327E-17, -4.9331E-17, &
      -4.9730E-17, -5.7374E-17, -4.7637E-17, -4.4679E-17, -4.9521E-17, -3.5215E-17, &
      -2.8609E-17, -2.4931E-18,  1.4020E-17,  2.0346E-17,  2.5602E-17,  2.9352E-17, &
       3.1572E-17,  3.2146E-17,  3.1129E-17,  2.8834E-17,  2.5694E-17,  2.2277E-17, &
       1.8885E-17,  1.6023E-17,  1.3860E-17,  1.2588E-17,  1.2183E-17,  1.2531E-17, &
       1.3634E-17,  1.5312E-17,  1.7667E-17,  2.0430E-17,  2.3660E-17,  2.7034E-17, &
       3.0423E-17,  3.3652E-17,  3.6547E-17,  3.9121E-17,  4.1427E-17,  4.3512E-17, &
       4.5384E-17,  4.6966E-17,  4.8282E-17,  4.9063E-17 /)
    REAL, PARAMETER :: a0_2_1_BrNO2(dim58) = (/ &
       3.4244E-21,  3.7921E-21,  4.1899E-21,  4.6457E-21,  5.1231E-21,  5.6579E-21, &
       6.2396E-21,  6.8535E-21,  7.5313E-21,  8.2652E-21,  9.0560E-21,  9.9114E-21, &
       8.7806E-21,  3.5352E-21,  6.5235E-21,  7.5212E-21,  6.6054E-21,  9.7625E-21, &
       1.0964E-20,  1.0195E-20,  1.3450E-20,  1.4687E-20,  1.3903E-20,  1.7008E-20, &
       1.8040E-20,  2.2701E-20,  2.4977E-20,  2.4894E-20,  2.4317E-20,  2.3211E-20, &
       2.1556E-20,  1.9381E-20,  1.6763E-20,  1.3833E-20,  1.0810E-20,  7.8707E-21, &
       5.2061E-21,  2.9572E-21,  1.1847E-21, -8.0097E-23, -8.8225E-22, -1.3160E-21, &
      -1.4744E-21, -1.4731E-21, -1.3787E-21, -1.2472E-21, -1.0912E-21, -9.3601E-22, &
      -7.8578E-22, -6.3885E-22, -5.1684E-22, -4.1323E-22, -3.2357E-22, -2.4591E-22, &
      -1.7897E-22, -1.2814E-22, -8.8653E-23, -6.5562E-23 /)
    REAL, PARAMETER :: a0_2_2_BrNO2(dim58) = (/ &
      -2.3503E-19, -2.5128E-19, -2.6894E-19, -2.8927E-19, -3.1066E-19, -3.3473E-19, &
      -3.6101E-19, -3.8889E-19, -4.1979E-19, -4.5341E-19, -4.8979E-19, -5.2930E-19, &
      -4.7684E-19, -2.3240E-19, -3.7225E-19, -4.1914E-19, -3.7592E-19, -5.2556E-19, &
      -5.8278E-19, -5.4602E-19, -7.0226E-19, -7.6187E-19, -7.2392E-19, -8.7483E-19, &
      -9.2520E-19, -1.1536E-18, -1.2656E-18, -1.2615E-18, -1.2328E-18, -1.1777E-18, &
      -1.0950E-18, -9.8579E-19, -8.5386E-19, -7.0562E-19, -5.5206E-19, -4.0213E-19, &
      -2.6571E-19, -1.5012E-19, -5.8656E-20,  6.8619E-21,  4.8574E-20,  7.1214E-20, &
       7.9513E-20,  7.9449E-20,  7.4465E-20,  6.7494E-20,  5.9193E-20,  5.0907E-20, &
       4.2855E-20,  3.4950E-20,  2.8362E-20,  2.2746E-20,  1.7868E-20,  1.3628E-20, &
       9.9595E-21,  7.1642E-21,  4.9844E-21,  3.7052E-21 /)
    REAL, PARAMETER :: a1_1_BrNO2(dim55) = (/ &
       3.6207E-19,  3.6431E-19,  3.8181E-19,  3.6664E-19,  3.6882E-19,  3.4551E-19, &
       3.3951E-19,  3.1503E-19,  3.0628E-19,  2.8435E-19,  2.7533E-19,  2.5671E-19, &
       2.4857E-19,  2.3301E-19,  2.2562E-19,  2.1297E-19,  2.0628E-19,  1.9566E-19, &
       1.8958E-19,  1.8106E-19,  1.7517E-19,  1.6818E-19,  1.6288E-19,  1.5669E-19, &
       1.5186E-19,  1.4689E-19,  1.4220E-19,  1.3810E-19,  1.3370E-19,  1.3024E-19, &
       1.2601E-19,  1.2331E-19,  1.1909E-19,  1.1703E-19,  1.1292E-19,  1.1124E-19, &
       1.0742E-19,  1.0609E-19,  1.0234E-19,  1.0145E-19,  9.4266E-20,  8.5575E-20, &
       7.7701E-20,  7.1817E-20,  6.5917E-20,  6.1686E-20,  5.6929E-20,  5.3745E-20, &
       4.8385E-20,  4.5051E-20,  4.1989E-20,  3.9191E-20,  3.6609E-20,  3.4219E-20, &
       3.1986E-20 /)
    REAL, PARAMETER :: b1_1_BrNO2(dim55) = (/ &
       7.9200E-18,  7.9133E-18,  7.8170E-18,  7.9383E-18,  7.9154E-18,  8.2184E-18, &
       8.3115E-18,  8.7521E-18,  8.9315E-18,  9.4358E-18,  9.6658E-18,  1.0187E-17, &
       1.0436E-17,  1.0949E-17,  1.1211E-17,  1.1692E-17,  1.1963E-17,  1.2420E-17, &
       1.2696E-17,  1.3105E-17,  1.3403E-17,  1.3773E-17,  1.4067E-17,  1.4427E-17, &
       1.4719E-17,  1.5032E-17,  1.5339E-17,  1.5618E-17,  1.5928E-17,  1.6180E-17, &
       1.6500E-17,  1.6711E-17,  1.7050E-17,  1.7221E-17,  1.7572E-17,  1.7721E-17, &
       1.8066E-17,  1.8189E-17,  1.8547E-17,  1.8635E-17,  1.9357E-17,  2.0339E-17, &
       2.1327E-17,  2.2139E-17,  2.3027E-17,  2.3717E-17,  2.4552E-17,  2.5150E-17, &
       2.6225E-17,  2.6935E-17,  2.7626E-17,  2.8292E-17,  2.8938E-17,  2.9567E-17, &
       3.0182E-17 /)
    REAL, PARAMETER :: a1_2_BrNO2(dim55) = (/ &
      -1.4354E-21, -9.5953E-22, -1.0708E-21, -5.8414E-22, -6.4877E-22, -2.5315E-22, &
      -3.0952E-22, -2.6395E-23, -8.6523E-23,  1.0385E-22,  4.4000E-23,  1.7000E-22, &
       1.1682E-22,  1.9794E-22,  1.5510E-22,  2.0725E-22,  1.7437E-22,  2.0704E-22, &
       1.8232E-22,  2.0041E-22,  1.8466E-22,  1.9146E-22,  1.8094E-22,  1.8449E-22, &
       1.7671E-22,  1.7341E-22,  1.7134E-22,  1.6275E-22,  1.6443E-22,  1.5382E-22, &
       1.5686E-22,  1.4409E-22,  1.5044E-22,  1.3565E-22,  1.4335E-22,  1.2767E-22, &
       1.3603E-22,  1.2032E-22,  1.2975E-22,  1.1262E-22,  1.1203E-22,  9.5684E-23, &
       8.8111E-23,  7.5971E-23,  7.2072E-23,  6.2596E-23,  6.1247E-23,  5.3461E-23, &
       6.1186E-23,  5.9037E-23,  5.7054E-23,  5.5277E-23,  5.3512E-23,  5.1891E-23, &
       5.0340E-23 /)
    REAL, PARAMETER :: b1_2_BrNO2(dim55) = (/ &
      -2.4319E-20, -2.5747E-20, -2.5134E-20, -2.9028E-20, -2.8349E-20, -3.3492E-20, &
      -3.2619E-20, -3.7715E-20, -3.6482E-20, -4.0861E-20, -3.9335E-20, -4.2863E-20, &
      -4.1241E-20, -4.3918E-20, -4.2397E-20, -4.4379E-20, -4.3047E-20, -4.4452E-20, &
      -4.3327E-20, -4.4195E-20, -4.3400E-20, -4.3761E-20, -4.3176E-20, -4.3383E-20, &
      -4.2912E-20, -4.2704E-20, -4.2568E-20, -4.1984E-20, -4.2103E-20, -4.1328E-20, &
      -4.1557E-20, -4.0561E-20, -4.1073E-20, -3.9845E-20, -4.0503E-20, -3.9123E-20, &
      -3.9880E-20, -3.8419E-20, -3.9320E-20, -3.7641E-20, -3.7582E-20, -3.5734E-20, &
      -3.4784E-20, -3.3109E-20, -3.2522E-20, -3.0977E-20, -3.0740E-20, -2.9277E-20, &
      -3.0826E-20, -3.0368E-20, -2.9921E-20, -2.9498E-20, -2.9056E-20, -2.8629E-20, &
      -2.8202E-20 /)
    REAL, PARAMETER :: a2_BrNO2(dim55) = (/ &
      -7.1600E-20, -6.2720E-20, -5.1716E-20, -4.0572E-20, -3.0760E-20, -2.2844E-20, &
      -1.6820E-20, -1.2412E-20, -9.2400E-21, -6.9880E-21, -5.3800E-21, -4.2320E-21, &
      -3.4000E-21, -2.7840E-21, -2.3200E-21, -1.9720E-21, -1.6960E-21, -1.4800E-21, &
      -1.3080E-21, -1.1600E-21, -1.0440E-21, -9.4000E-22, -8.5200E-22, -7.8000E-22, &
      -7.1600E-22, -6.5600E-22, -6.0400E-22, -5.6000E-22, -5.1600E-22, -4.8000E-22, &
      -4.4800E-22, -4.1600E-22, -3.8400E-22, -3.6000E-22, -3.4000E-22, -3.1200E-22, &
      -2.9600E-22, -2.7200E-22, -2.5600E-22, -2.4400E-22, -1.9760E-22, -1.4320E-22, &
      -1.0400E-22, -7.5200E-23, -5.5200E-23, -4.0000E-23, -2.8800E-23, -2.0800E-23, &
      -1.5200E-23, -1.1200E-23, -8.0000E-24, -5.6000E-24, -4.0000E-24, -3.2000E-24, &
      -2.4000E-24 /)
    REAL, PARAMETER :: b2_BrNO2(dim55) = (/ &
       1.4731E-18,  1.4465E-18,  1.3859E-18,  1.2968E-18,  1.1938E-18,  1.0909E-18, &
       9.9748E-19,  9.1814E-19,  8.5311E-19,  8.0131E-19,  7.6031E-19,  7.2817E-19, &
       7.0279E-19,  6.8246E-19,  6.6599E-19,  6.5277E-19,  6.4159E-19,  6.3230E-19, &
       6.2447E-19,  6.1737E-19,  6.1151E-19,  6.0600E-19,  6.0112E-19,  5.9694E-19, &
       5.9307E-19,  5.8929E-19,  5.8588E-19,  5.8289E-19,  5.7979E-19,  5.7716E-19, &
       5.7474E-19,  5.7225E-19,  5.6967E-19,  5.6768E-19,  5.6597E-19,  5.6351E-19, &
       5.6206E-19,  5.5983E-19,  5.5830E-19,  5.5712E-19,  5.5246E-19,  5.4631E-19, &
       5.4139E-19,  5.3742E-19,  5.3441E-19,  5.3193E-19,  5.2996E-19,  5.2846E-19, &
       5.2734E-19,  5.2649E-19,  5.2576E-19,  5.2519E-19,  5.2479E-19,  5.2458E-19, &
       5.2436E-19 /)
    REAL, PARAMETER :: a3_BrNO2(dim55) = (/ &
      -7.0430E-22, -4.2569E-22, -2.2968E-22, -1.2973E-22, -8.0623E-23, -5.4595E-23, &
      -3.9706E-23, -3.0298E-23, -2.4131E-23, -1.9682E-23, -1.6775E-23, -1.4205E-23, &
      -1.2322E-23, -1.0955E-23, -9.7553E-24, -8.7299E-24, -7.7015E-24, -7.1856E-24, &
      -6.5068E-24, -5.9932E-24, -5.4701E-24, -5.1370E-24, -4.6233E-24, -4.4521E-24, &
      -3.9316E-24, -3.7671E-24, -3.5959E-24, -3.2534E-24, -3.0769E-24, -2.9110E-24, &
      -2.7397E-24, -2.5685E-24, -2.3932E-24, -2.2260E-24, -2.0548E-24, -2.0513E-24, &
      -1.8836E-24, -1.8836E-24, -1.5411E-24, -1.7094E-24, -1.3352E-24, -1.0270E-24, &
      -7.8713E-25, -5.8199E-25, -4.7929E-25, -3.4223E-25, -2.7388E-25, -2.3964E-25, &
      -1.7112E-25, -1.3694E-25, -1.0270E-25, -6.8446E-26, -6.8470E-26, -3.4235E-26, &
      -6.8446E-26 /)
    REAL, PARAMETER :: b3_BrNO2(dim55) = (/ &
       2.6331E-19,  2.4689E-19,  2.2389E-19,  2.0632E-19,  1.9482E-19,  1.8721E-19, &
       1.8198E-19,  1.7813E-19,  1.7524E-19,  1.7290E-19,  1.7120E-19,  1.6955E-19, &
       1.6823E-19,  1.6719E-19,  1.6620E-19,  1.6531E-19,  1.6434E-19,  1.6383E-19, &
       1.6312E-19,  1.6255E-19,  1.6193E-19,  1.6153E-19,  1.6087E-19,  1.6063E-19, &
       1.5990E-19,  1.5966E-19,  1.5940E-19,  1.5886E-19,  1.5858E-19,  1.5829E-19, &
       1.5799E-19,  1.5768E-19,  1.5736E-19,  1.5703E-19,  1.5669E-19,  1.5669E-19, &
       1.5633E-19,  1.5633E-19,  1.5557E-19,  1.5596E-19,  1.5508E-19,  1.5427E-19, &
       1.5357E-19,  1.5291E-19,  1.5255E-19,  1.5203E-19,  1.5175E-19,  1.5160E-19, &
       1.5128E-19,  1.5111E-19,  1.5093E-19,  1.5074E-19,  1.5074E-19,  1.5053E-19, &
       1.5075E-19 /)
    REAL, PARAMETER :: a4_BrNO2(4) = (/  1.1813E-19, -6.2334E-24,  1.4835E-27, -1.1045E-31 /)
    REAL, PARAMETER :: a5_BrNO2(4) = (/  1.2300E-19,  4.0839E-24, -5.5077E-28,  3.0625E-32 /)
    REAL, PARAMETER :: a6_BrNO2(4) = (/  1.4951E-19, -1.6147E-26,  5.4897E-31, -3.8234E-35 /)
    REAL, PARAMETER :: a7_BrNO2(4) = (/  1.5861E-20,  7.5491E-25,  8.7076E-30, -2.9874E-34 /)

    jval_2d(ip_BrNO2)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_BrNO2(0) = &
          p1(a0_1_1_BrNO2(i0(j,k))*dlv2(j,k) + &
          a0_1_2_BrNO2(i0(j,k)), &
          a0_2_1_BrNO2(i0(j,k))*dlv2(j,k) + &
          a0_2_2_BrNO2(i0(j,k)),v3_du1(j,k))
        sig_BrNO2(1) = &
          (p1(b1_1_BrNO2(i1(j,k)),a1_1_BrNO2(i1(j,k)), &
          v3_du1(j,k)) + &
          p1(b1_2_BrNO2(i1(j,k)),a1_2_BrNO2(i1(j,k)), &
          v3_du1(j,k)) * v2s_m(j,k))
        sig_BrNO2(2) = &
          p1(b2_BrNO2(i2(j,k)), a2_BrNO2(i2(j,k)), &
          v3_du1(j,k))
        sig_BrNO2(3) = &
          p1(b3_BrNO2(i3(j,k)), a3_BrNO2(i3(j,k)), &
          v3_du2(j,k))
        sig_BrNO2(4) = &
          p3(a4_BrNO2(1),a4_BrNO2(2),a4_BrNO2(3), &
          a4_BrNO2(4),v3_du2(j,k))
        sig_BrNO2(5) = &
          p3(a5_BrNO2(1),a5_BrNO2(2),a5_BrNO2(3), &
          a5_BrNO2(4),v3_du2(j,k))
        sig_BrNO2(6) = &
          p3(a6_BrNO2(1),a6_BrNO2(2),a6_BrNO2(3), &
          a6_BrNO2(4),v3_du2(j,k))
        sig_BrNO2(7) = &
          p3(a7_BrNO2(1),a7_BrNO2(2),a7_BrNO2(3), &
          a7_BrNO2(4),v3_du2(j,k))
        dj = 0. &
          + sig_BrNO2(0) * fint(j,k,0) &
          + sig_BrNO2(1) * fint(j,k,1) &
          + sig_BrNO2(2) * fint(j,k,2) &
          + sig_BrNO2(3) * fint(j,k,3) &
          + sig_BrNO2(4) * fint(j,k,4) &
          + sig_BrNO2(5) * fint(j,k,5) &
          + sig_BrNO2(6) * fint(j,k,6) &
          + sig_BrNO2(7) * fint(j,k,7)

        jval_2d(ip_BrNO2)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,1)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_BrNO2

  ! **************************************************************************

  SUBROUTINE jval_cal_Br2

    ! Br_2 \TOHV\ \products

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_Br2

    ! T-const parameters:
    REAL, PARAMETER :: a0_1_1_Br2(dim58) = (/ &
       2.4748E-23,  2.7046E-23,  2.9541E-23,  3.2192E-23,  3.4884E-23,  3.7780E-23, &
       4.0813E-23,  4.3909E-23,  4.7270E-23,  5.0657E-23,  5.4320E-23,  5.8189E-23, &
       7.0385E-23,  1.0052E-22,  9.7806E-23,  1.0339E-22,  1.1853E-22,  1.1484E-22, &
       1.2011E-22,  1.3544E-22,  1.2941E-22,  1.3309E-22,  1.4756E-22,  1.3847E-22, &
       1.3987E-22,  1.1698E-22,  1.0654E-22,  1.0925E-22,  1.1319E-22,  1.1862E-22, &
       1.2602E-22,  1.3503E-22,  1.4575E-22,  1.5774E-22,  1.7087E-22,  1.8432E-22, &
       1.9830E-22,  2.1228E-22,  2.2625E-22,  2.4025E-22,  2.5434E-22,  2.6846E-22, &
       2.8225E-22,  2.9558E-22,  3.0740E-22,  3.1705E-22,  3.2316E-22,  3.2608E-22, &
       3.2497E-22,  3.2030E-22,  3.1272E-22,  3.0256E-22,  2.9032E-22,  2.7623E-22, &
       2.6040E-22,  2.4015E-22,  2.0922E-22,  1.7173E-22 /)
    REAL, PARAMETER :: a0_1_2_Br2(dim58) = (/ &
       1.6804E-23, -8.4777E-23, -1.9556E-22, -3.1378E-22, -4.3437E-22, -5.6469E-22, &
      -7.0179E-22, -8.4234E-22, -9.9559E-22, -1.1507E-21, -1.3192E-21, -1.4980E-21, &
      -2.0639E-21, -3.4680E-21, -3.3412E-21, -3.6035E-21, -4.3183E-21, -4.1434E-21, &
      -4.3939E-21, -5.1271E-21, -4.8373E-21, -5.0149E-21, -5.7154E-21, -5.2734E-21, &
      -5.3417E-21, -4.2203E-21, -3.7064E-21, -3.8403E-21, -4.0356E-21, -4.3060E-21, &
      -4.6763E-21, -5.1284E-21, -5.6688E-21, -6.2754E-21, -6.9423E-21, -7.6287E-21, &
      -8.3443E-21, -9.0630E-21, -9.7836E-21, -1.0509E-20, -1.1242E-20, -1.1979E-20, &
      -1.2701E-20, -1.3402E-20, -1.4027E-20, -1.4538E-20, -1.4863E-20, -1.5019E-20, &
      -1.4960E-20, -1.4708E-20, -1.4299E-20, -1.3748E-20, -1.3083E-20, -1.2313E-20, &
      -1.1445E-20, -1.0332E-20, -8.6245E-21, -6.5477E-21 /)
    REAL, PARAMETER :: a0_2_1_Br2(dim58) = (/ &
       1.2743E-25,  1.4103E-25,  1.5526E-25,  1.7068E-25,  1.8818E-25,  2.0618E-25, &
       2.2582E-25,  2.4713E-25,  2.6978E-25,  2.9530E-25,  3.2237E-25,  3.5236E-25, &
       2.6219E-25, -7.4625E-26,  8.2850E-26,  1.2227E-25,  4.2393E-26,  2.1138E-25, &
       2.6304E-25,  1.9616E-25,  3.7945E-25,  4.4206E-25,  3.8543E-25,  5.7536E-25, &
       6.4317E-25,  9.4387E-25,  1.1037E-24,  1.1210E-24,  1.1141E-24,  1.0787E-24, &
       1.0112E-24,  9.1370E-25,  7.8854E-25,  6.4280E-25,  4.8533E-25,  3.2693E-25, &
       1.7773E-25,  4.5171E-26, -6.5137E-26, -1.4966E-25, -2.1034E-25, -2.4933E-25, &
      -2.7102E-25, -2.8238E-25, -2.8566E-25, -2.8361E-25, -2.7641E-25, -2.6640E-25, &
      -2.5313E-25, -2.3841E-25, -2.2331E-25, -2.0748E-25, -1.9095E-25, -1.7217E-25, &
      -1.5331E-25, -1.3159E-25, -1.0967E-25, -9.2805E-26 /)
    REAL, PARAMETER :: a0_2_2_Br2(dim58) = (/ &
      -7.3486E-24, -7.9497E-24, -8.5814E-24, -9.2693E-24, -1.0053E-23, -1.0863E-23, &
      -1.1751E-23, -1.2718E-23, -1.3751E-23, -1.4920E-23, -1.6165E-23, -1.7551E-23, &
      -1.3367E-23,  2.3285E-24, -5.0413E-24, -6.8942E-24, -3.1238E-24, -1.1134E-23, &
      -1.3593E-23, -1.0396E-23, -1.9194E-23, -2.2212E-23, -1.9471E-23, -2.8701E-23, &
      -3.2011E-23, -4.6745E-23, -5.4610E-23, -5.5462E-23, -5.5119E-23, -5.3360E-23, &
      -4.9984E-23, -4.5088E-23, -3.8780E-23, -3.1406E-23, -2.3406E-23, -1.5328E-23, &
      -7.6889E-24, -8.7545E-25,  4.8165E-24,  9.1945E-24,  1.2350E-23,  1.4385E-23, &
       1.5522E-23,  1.6120E-23,  1.6293E-23,  1.6184E-23,  1.5801E-23,  1.5266E-23, &
       1.4555E-23,  1.3763E-23,  1.2948E-23,  1.2090E-23,  1.1191E-23,  1.0165E-23, &
       9.1315E-24,  7.9372E-24,  6.7271E-24,  5.7928E-24 /)
    REAL, PARAMETER :: a1_1_Br2(dim55) = (/ &
       1.3717E-23,  7.3609E-24, -9.8698E-25, -5.4451E-24, -1.1733E-23, -1.3782E-23, &
      -1.7737E-23, -1.7963E-23, -2.0154E-23, -1.9454E-23, -2.0448E-23, -1.9407E-23, &
      -1.9752E-23, -1.8615E-23, -1.8619E-23, -1.7568E-23, -1.7377E-23, -1.6447E-23, &
      -1.6133E-23, -1.5372E-23, -1.4990E-23, -1.4355E-23, -1.3959E-23, -1.3427E-23, &
      -1.3014E-23, -1.2575E-23, -1.2179E-23, -1.1816E-23, -1.1418E-23, -1.1145E-23, &
      -1.0733E-23, -1.0529E-23, -1.0138E-23, -9.9649E-24, -9.5839E-24, -9.4755E-24, &
      -9.1022E-24, -9.0181E-24, -8.6583E-24, -8.5917E-24, -7.9595E-24, -7.2067E-24, &
      -6.5287E-24, -6.0267E-24, -5.5301E-24, -5.1738E-24, -4.7776E-24, -4.5159E-24, &
      -4.0788E-24, -3.8096E-24, -3.5632E-24, -3.3352E-24, -3.1241E-24, -2.9329E-24, &
      -2.7522E-24 /)
    REAL, PARAMETER :: b1_1_Br2(dim55) = (/ &
       9.6410E-21,  9.6600E-21,  9.7059E-21,  9.7416E-21,  9.8076E-21,  9.8343E-21, &
       9.8956E-21,  9.8996E-21,  9.9446E-21,  9.9285E-21,  9.9538E-21,  9.9246E-21, &
       9.9352E-21,  9.8976E-21,  9.8978E-21,  9.8579E-21,  9.8501E-21,  9.8101E-21, &
       9.7958E-21,  9.7593E-21,  9.7400E-21,  9.7064E-21,  9.6844E-21,  9.6535E-21, &
       9.6285E-21,  9.6009E-21,  9.5749E-21,  9.5503E-21,  9.5222E-21,  9.5023E-21, &
       9.4712E-21,  9.4553E-21,  9.4238E-21,  9.4094E-21,  9.3768E-21,  9.3673E-21, &
       9.3335E-21,  9.3257E-21,  9.2913E-21,  9.2848E-21,  9.2213E-21,  9.1362E-21, &
       9.0511E-21,  8.9818E-21,  8.9071E-21,  8.8490E-21,  8.7795E-21,  8.7303E-21, &
       8.6426E-21,  8.5853E-21,  8.5298E-21,  8.4755E-21,  8.4226E-21,  8.3723E-21, &
       8.3225E-21 /)
    REAL, PARAMETER :: a1_2_Br2(dim55) = (/ &
       1.9103E-25,  1.7543E-25,  2.1160E-25,  1.6705E-25,  1.8481E-25,  1.2954E-25, &
       1.3655E-25,  8.5616E-26,  8.9143E-26,  4.9726E-26,  5.1900E-26,  2.4228E-26, &
       2.6524E-26,  7.4516E-27,  9.9902E-27, -2.4710E-27, -3.5914E-28, -8.3476E-27, &
      -6.7579E-27, -1.1466E-26, -1.0517E-26, -1.3027E-26, -1.2494E-26, -1.3734E-26, &
      -1.3586E-26, -1.3900E-26, -1.3917E-26, -1.3587E-26, -1.3934E-26, -1.3056E-26, &
      -1.3748E-26, -1.2464E-26, -1.3283E-26, -1.1853E-26, -1.2813E-26, -1.1152E-26, &
      -1.2261E-26, -1.0545E-26, -1.1657E-26, -1.0007E-26, -1.0001E-26, -8.4797E-27, &
      -7.7381E-27, -6.6124E-27, -6.2012E-27, -5.3451E-27, -5.1743E-27, -4.4860E-27, &
      -5.0577E-27, -4.8277E-27, -4.6349E-27, -4.4642E-27, -4.3157E-27, -4.1640E-27, &
      -4.0280E-27 /)
    REAL, PARAMETER :: b1_2_Br2(dim55) = (/ &
      -1.0094E-24, -9.6260E-25, -1.1615E-24, -8.0516E-25, -9.9160E-25, -2.7305E-25, &
      -3.8174E-25,  5.3507E-25,  4.6277E-25,  1.3693E-24,  1.3139E-24,  2.0887E-24, &
       2.0187E-24,  2.6481E-24,  2.5580E-24,  3.0315E-24,  2.9460E-24,  3.2895E-24, &
       3.2171E-24,  3.4431E-24,  3.3952E-24,  3.5282E-24,  3.4986E-24,  3.5706E-24, &
       3.5616E-24,  3.5814E-24,  3.5825E-24,  3.5601E-24,  3.5845E-24,  3.5204E-24, &
       3.5727E-24,  3.4726E-24,  3.5385E-24,  3.4198E-24,  3.5019E-24,  3.3557E-24, &
       3.4560E-24,  3.2965E-24,  3.4027E-24,  3.2410E-24,  3.2404E-24,  3.0685E-24, &
       2.9754E-24,  2.8200E-24,  2.7581E-24,  2.6186E-24,  2.5886E-24,  2.4592E-24, &
       2.5739E-24,  2.5249E-24,  2.4814E-24,  2.4408E-24,  2.4036E-24,  2.3637E-24, &
       2.3262E-24 /)
    REAL, PARAMETER :: a2_Br2(dim55) = (/ &
      -1.1008E-22, -9.5280E-23, -7.7428E-23, -5.9788E-23, -4.4492E-23, -3.2348E-23, &
      -2.3260E-23, -1.6712E-23, -1.2096E-23, -8.8800E-24, -6.6360E-24, -5.0680E-24, &
      -3.9560E-24, -3.1560E-24, -2.5720E-24, -2.1440E-24, -1.8080E-24, -1.5560E-24, &
      -1.3560E-24, -1.1920E-24, -1.0600E-24, -9.4800E-25, -8.5600E-25, -7.7600E-25, &
      -7.0800E-25, -6.4800E-25, -5.9600E-25, -5.4800E-25, -5.0800E-25, -4.6800E-25, &
      -4.3200E-25, -4.0400E-25, -3.7600E-25, -3.4800E-25, -3.2800E-25, -3.0400E-25, &
      -2.8000E-25, -2.6800E-25, -2.4400E-25, -2.3200E-25, -1.9040E-25, -1.3760E-25, &
      -9.9200E-26, -7.2800E-26, -5.2000E-26, -3.7600E-26, -2.8000E-26, -2.0000E-26, &
      -1.4400E-26, -1.0400E-26, -8.0000E-27, -5.6000E-27, -4.0000E-27, -2.4000E-27, &
      -2.4000E-27 /)
    REAL, PARAMETER :: b2_Br2(dim55) = (/ &
       1.7391E-21,  1.6947E-21,  1.5966E-21,  1.4554E-21,  1.2948E-21,  1.1370E-21, &
       9.9609E-22,  8.7823E-22,  7.8360E-22,  7.0963E-22,  6.5241E-22,  6.0850E-22, &
       5.7459E-22,  5.4819E-22,  5.2746E-22,  5.1119E-22,  4.9758E-22,  4.8675E-22, &
       4.7765E-22,  4.6978E-22,  4.6311E-22,  4.5717E-22,  4.5207E-22,  4.4743E-22, &
       4.4331E-22,  4.3953E-22,  4.3613E-22,  4.3286E-22,  4.3004E-22,  4.2712E-22, &
       4.2441E-22,  4.2222E-22,  4.1997E-22,  4.1764E-22,  4.1593E-22,  4.1382E-22, &
       4.1165E-22,  4.1053E-22,  4.0824E-22,  4.0707E-22,  4.0289E-22,  3.9692E-22, &
       3.9210E-22,  3.8846E-22,  3.8533E-22,  3.8298E-22,  3.8129E-22,  3.7979E-22, &
       3.7867E-22,  3.7782E-22,  3.7727E-22,  3.7670E-22,  3.7630E-22,  3.7588E-22, &
       3.7588E-22 /)
    REAL, PARAMETER :: a3_Br2(dim55) = (/ &
      -4.7050E-25, -2.7301E-25, -1.3983E-25, -7.4277E-26, -4.3821E-26, -2.8068E-26, &
      -1.9682E-26, -1.4207E-26, -1.1124E-26, -8.7284E-27, -7.1893E-27, -5.9901E-27, &
      -5.1343E-27, -4.4505E-27, -3.9363E-27, -3.4235E-27, -3.0806E-27, -2.9085E-27, &
      -2.3973E-27, -2.3973E-27, -2.0513E-27, -1.8836E-27, -1.7123E-27, -1.5411E-27, &
      -1.5385E-27, -1.3699E-27, -1.1986E-27, -1.1986E-27, -1.1966E-27, -1.0274E-27, &
      -8.5616E-28, -8.5616E-28, -8.5470E-28, -8.5616E-28, -6.8493E-28, -6.8376E-28, &
      -6.8493E-28, -6.8493E-28, -5.1370E-28, -5.1282E-28, -4.4505E-28, -3.4235E-28, &
      -2.3956E-28, -2.0541E-28, -1.3694E-28, -1.3689E-28, -6.8470E-29, -6.8470E-29, &
      -6.8446E-29, -3.4235E-29, -3.4235E-29, -3.4223E-29,  0.0000E+00, -3.4235E-29, &
       0.0000E+00 /)
    REAL, PARAMETER :: b3_Br2(dim55) = (/ &
       1.6918E-22,  1.5754E-22,  1.4191E-22,  1.3039E-22,  1.2325E-22,  1.1864E-22, &
       1.1570E-22,  1.1346E-22,  1.1202E-22,  1.1075E-22,  1.0985E-22,  1.0908E-22, &
       1.0848E-22,  1.0796E-22,  1.0754E-22,  1.0709E-22,  1.0677E-22,  1.0660E-22, &
       1.0606E-22,  1.0606E-22,  1.0566E-22,  1.0545E-22,  1.0523E-22,  1.0500E-22, &
       1.0500E-22,  1.0475E-22,  1.0449E-22,  1.0449E-22,  1.0449E-22,  1.0420E-22, &
       1.0390E-22,  1.0390E-22,  1.0390E-22,  1.0390E-22,  1.0356E-22,  1.0356E-22, &
       1.0356E-22,  1.0356E-22,  1.0318E-22,  1.0318E-22,  1.0302E-22,  1.0275E-22, &
       1.0245E-22,  1.0234E-22,  1.0210E-22,  1.0210E-22,  1.0182E-22,  1.0182E-22, &
       1.0182E-22,  1.0165E-22,  1.0165E-22,  1.0165E-22,  1.0145E-22,  1.0166E-22, &
       1.0144E-22 /)
    REAL, PARAMETER :: a4_Br2(4) = (/  1.5200E-22,  2.9372E-26, -5.2874E-30,  3.3966E-34 /)
    REAL, PARAMETER :: a5_Br2(4) = (/  2.7788E-21,  6.0142E-25, -7.5393E-29,  4.2448E-33 /)
    REAL, PARAMETER :: a6_Br2(4) = (/  3.9391E-19,  1.0137E-24, -1.0043E-29,  5.9013E-35 /)
    REAL, PARAMETER :: a7_Br2(4) = (/  1.6987E-19,  6.7883E-24,  5.8193E-29, -2.8267E-33 /)

    jval_2d(ip_Br2)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_Br2(0) = &
          p1(a0_1_1_Br2(i0(j,k))*dlv2(j,k) + &
          a0_1_2_Br2(i0(j,k)), &
          a0_2_1_Br2(i0(j,k))*dlv2(j,k) + &
          a0_2_2_Br2(i0(j,k)),v3_du1(j,k))
        sig_Br2(1) = &
          (p1(b1_1_Br2(i1(j,k)),a1_1_Br2(i1(j,k)), &
          v3_du1(j,k)) + &
          p1(b1_2_Br2(i1(j,k)),a1_2_Br2(i1(j,k)), &
          v3_du1(j,k)) * v2s_m(j,k))
        sig_Br2(2) = &
          p1(b2_Br2(i2(j,k)), a2_Br2(i2(j,k)), &
          v3_du1(j,k))
        sig_Br2(3) = &
          p1(b3_Br2(i3(j,k)), a3_Br2(i3(j,k)), &
          v3_du2(j,k))
        sig_Br2(4) = &
          p3(a4_Br2(1),a4_Br2(2),a4_Br2(3), &
          a4_Br2(4),v3_du2(j,k))
        sig_Br2(5) = &
          p3(a5_Br2(1),a5_Br2(2),a5_Br2(3), &
          a5_Br2(4),v3_du2(j,k))
        sig_Br2(6) = &
          p3(a6_Br2(1),a6_Br2(2),a6_Br2(3), &
          a6_Br2(4),v3_du2(j,k))
        sig_Br2(7) = &
          p3(a7_Br2(1),a7_Br2(2),a7_Br2(3), &
          a7_Br2(4),v3_du2(j,k))
        dj = 0. &
          + sig_Br2(0) * fint(j,k,0) &
          + sig_Br2(1) * fint(j,k,1) &
          + sig_Br2(2) * fint(j,k,2) &
          + sig_Br2(3) * fint(j,k,3) &
          + sig_Br2(4) * fint(j,k,4) &
          + sig_Br2(5) * fint(j,k,5) &
          + sig_Br2(6) * fint(j,k,6) &
          + sig_Br2(7) * fint(j,k,7)

        jval_2d(ip_Br2)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,1)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_Br2

  ! **************************************************************************

  SUBROUTINE jval_cal_CCl4

    ! CCl_4 \TOHV\ \products

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_CCl4

    ! T-const parameters:
    REAL, PARAMETER :: a0_1_1_CCl4(dim58) = (/ &
      -8.6298E-20, -9.2445E-20, -9.8725E-20, -1.0500E-19, -1.1128E-19, -1.1727E-19, &
      -1.2289E-19, -1.2832E-19, -1.3318E-19, -1.3773E-19, -1.4180E-19, -1.4559E-19, &
      -1.6231E-19, -2.0746E-19, -1.9791E-19, -2.0096E-19, -2.1757E-19, -2.0271E-19, &
      -2.0037E-19, -2.1159E-19, -1.8808E-19, -1.7736E-19, -1.8124E-19, -1.4862E-19, &
      -1.3107E-19, -7.8516E-20, -4.5331E-20, -3.1575E-20, -2.0552E-20, -1.2471E-20, &
      -7.5078E-21, -5.6612E-21, -6.6344E-21, -9.8408E-21, -1.4597E-20, -1.9950E-20, &
      -2.5130E-20, -2.9457E-20, -3.2569E-20, -3.4287E-20, -3.4640E-20, -3.3816E-20, &
      -3.2050E-20, -2.9607E-20, -2.6713E-20, -2.3588E-20, -2.0334E-20, -1.7207E-20, &
      -1.4318E-20, -1.1788E-20, -9.6655E-21, -7.8903E-21, -6.3975E-21, -5.1388E-21, &
      -4.0832E-21, -3.2174E-21, -2.4933E-21, -1.9701E-21 /)
    REAL, PARAMETER :: a0_1_2_CCl4(dim58) = (/ &
       5.3608E-18,  5.6325E-18,  5.9114E-18,  6.1912E-18,  6.4724E-18,  6.7421E-18, &
       6.9960E-18,  7.2425E-18,  7.4643E-18,  7.6728E-18,  7.8597E-18,  8.0348E-18, &
       8.8109E-18,  1.0915E-17,  1.0468E-17,  1.0611E-17,  1.1395E-17,  1.0691E-17, &
       1.0580E-17,  1.1116E-17,  9.9872E-18,  9.4704E-18,  9.6585E-18,  8.0729E-18, &
       7.2166E-18,  4.6415E-18,  3.0088E-18,  2.3292E-18,  1.7825E-18,  1.3800E-18, &
       1.1319E-18,  1.0392E-18,  1.0882E-18,  1.2505E-18,  1.4921E-18,  1.7651E-18, &
       2.0303E-18,  2.2527E-18,  2.4133E-18,  2.5023E-18,  2.5206E-18,  2.4776E-18, &
       2.3851E-18,  2.2566E-18,  2.1038E-18,  1.9381E-18,  1.7650E-18,  1.5981E-18, &
       1.4432E-18,  1.3071E-18,  1.1925E-18,  1.0963E-18,  1.0151E-18,  9.4633E-19, &
       8.8849E-19,  8.4087E-19,  8.0089E-19,  7.7191E-19 /)
    REAL, PARAMETER :: a0_2_1_CCl4(dim58) = (/ &
      -4.4957E-22, -4.9715E-22, -5.4984E-22, -6.0799E-22, -6.7110E-22, -7.3912E-22, &
      -8.1213E-22, -8.8842E-22, -9.7030E-22, -1.0568E-21, -1.1496E-21, -1.2484E-21, &
      -1.1521E-21, -6.5332E-22, -9.6538E-22, -1.0849E-21, -1.0181E-21, -1.3449E-21, &
      -1.4797E-21, -1.4232E-21, -1.7396E-21, -1.8544E-21, -1.7686E-21, -2.0285E-21, &
      -2.0811E-21, -2.4455E-21, -2.5792E-21, -2.4987E-21, -2.3789E-21, -2.2227E-21, &
      -2.0297E-21, -1.8026E-21, -1.5477E-21, -1.2753E-21, -1.0005E-21, -7.3869E-22, &
      -5.0558E-22, -3.1076E-22, -1.5940E-22, -5.1820E-23,  1.6267E-23,  5.2516E-23, &
       6.6302E-23,  6.6774E-23,  6.0913E-23,  5.2782E-23,  4.4061E-23,  3.5842E-23, &
       2.8456E-23,  2.2180E-23,  1.7113E-23,  1.3038E-23,  9.7578E-24,  7.1038E-24, &
       5.0006E-24,  3.4570E-24,  2.3736E-24,  1.7546E-24 /)
    REAL, PARAMETER :: a0_2_2_CCl4(dim58) = (/ &
       2.9631E-20,  3.1735E-20,  3.4074E-20,  3.6668E-20,  3.9495E-20,  4.2556E-20, &
       4.5856E-20,  4.9319E-20,  5.3053E-20,  5.7016E-20,  6.1285E-20,  6.5847E-20, &
       6.1381E-20,  3.8137E-20,  5.2741E-20,  5.8358E-20,  5.5205E-20,  7.0696E-20, &
       7.7110E-20,  7.4414E-20,  8.9597E-20,  9.5133E-20,  9.0979E-20,  1.0361E-19, &
       1.0618E-19,  1.2404E-19,  1.3061E-19,  1.2664E-19,  1.2069E-19,  1.1291E-19, &
       1.0326E-19,  9.1865E-20,  7.9014E-20,  6.5231E-20,  5.1275E-20,  3.7921E-20, &
       2.5985E-20,  1.5972E-20,  8.1616E-21,  2.5889E-21, -9.5157E-22, -2.8437E-21, &
      -3.5661E-21, -3.5910E-21, -3.2815E-21, -2.8506E-21, -2.3866E-21, -1.9477E-21, &
      -1.5518E-21, -1.2142E-21, -9.4059E-22, -7.1968E-22, -5.4126E-22, -3.9635E-22, &
      -2.8110E-22, -1.9620E-22, -1.3640E-22, -1.0210E-22 /)
    REAL, PARAMETER :: a1_1_CCl4(dim55) = (/ &
       8.5349E-21,  8.2950E-21,  8.2063E-21,  7.6416E-21,  7.2612E-21,  6.6269E-21, &
       6.1568E-21,  5.6021E-21,  5.1548E-21,  4.7209E-21,  4.3369E-21,  4.0124E-21, &
       3.6908E-21,  3.4550E-21,  3.1846E-21,  3.0121E-21,  2.7791E-21,  2.6572E-21, &
       2.4502E-21,  2.3669E-21,  2.1812E-21,  2.1237E-21,  1.9570E-21,  1.9193E-21, &
       1.7681E-21,  1.7460E-21,  1.6066E-21,  1.5979E-21,  1.4668E-21,  1.4695E-21, &
       1.3475E-21,  1.3572E-21,  1.2427E-21,  1.2581E-21,  1.1528E-21,  1.1725E-21, &
       1.0717E-21,  1.0961E-21,  1.0003E-21,  1.0282E-21,  9.0514E-22,  7.9705E-22, &
       6.9210E-22,  6.2694E-22,  5.5439E-22,  5.1220E-22,  4.5792E-22,  4.2909E-22, &
       3.6751E-22,  3.3856E-22,  3.1242E-22,  2.8884E-22,  2.6729E-22,  2.4814E-22, &
       2.3015E-22 /)
    REAL, PARAMETER :: b1_1_CCl4(dim55) = (/ &
       1.4329E-19,  1.4401E-19,  1.4449E-19,  1.4901E-19,  1.5301E-19,  1.6125E-19, &
       1.6854E-19,  1.7852E-19,  1.8769E-19,  1.9767E-19,  2.0746E-19,  2.1655E-19, &
       2.2636E-19,  2.3414E-19,  2.4374E-19,  2.5029E-19,  2.5973E-19,  2.6497E-19, &
       2.7439E-19,  2.7839E-19,  2.8777E-19,  2.9082E-19,  3.0007E-19,  3.0225E-19, &
       3.1140E-19,  3.1280E-19,  3.2193E-19,  3.2251E-19,  3.3176E-19,  3.3156E-19, &
       3.4077E-19,  3.4002E-19,  3.4923E-19,  3.4796E-19,  3.5696E-19,  3.5522E-19, &
       3.6434E-19,  3.6208E-19,  3.7123E-19,  3.6849E-19,  3.8086E-19,  3.9307E-19, &
       4.0624E-19,  4.1524E-19,  4.2616E-19,  4.3303E-19,  4.4256E-19,  4.4798E-19, &
       4.6032E-19,  4.6649E-19,  4.7239E-19,  4.7800E-19,  4.8340E-19,  4.8843E-19, &
       4.9339E-19 /)
    REAL, PARAMETER :: a1_2_CCl4(dim55) = (/ &
      -2.1184E-23, -1.1352E-23, -1.0415E-23, -2.1675E-24, -9.6645E-25,  4.1470E-24, &
       4.8813E-24,  7.2123E-24,  7.5516E-24,  8.1263E-24,  8.2815E-24,  7.9209E-24, &
       8.0789E-24,  7.2706E-24,  7.5118E-24,  6.5193E-24,  6.8723E-24,  5.7900E-24, &
       6.2456E-24,  5.1511E-24,  5.6571E-24,  4.5927E-24,  5.1423E-24,  4.1095E-24, &
       4.6762E-24,  3.6918E-24,  4.2613E-24,  3.3171E-24,  3.8974E-24,  2.9968E-24, &
       3.5680E-24,  2.7145E-24,  3.2721E-24,  2.4744E-24,  2.9985E-24,  2.2482E-24, &
       2.7695E-24,  2.0525E-24,  2.5563E-24,  1.8746E-24,  1.9825E-24,  1.5495E-24, &
       1.3850E-24,  1.1054E-24,  1.0238E-24,  8.3112E-25,  7.9442E-25,  6.5359E-25, &
       7.4753E-25,  6.8109E-25,  6.2624E-25,  5.7972E-25,  5.4007E-25,  5.0416E-25, &
       4.7364E-25 /)
    REAL, PARAMETER :: b1_2_CCl4(dim55) = (/ &
      -5.7265E-22, -6.0215E-22, -6.0730E-22, -6.7328E-22, -6.8589E-22, -7.5237E-22, &
      -7.6375E-22, -8.0571E-22, -8.1266E-22, -8.2588E-22, -8.2984E-22, -8.1974E-22, &
      -8.2456E-22, -7.9789E-22, -8.0645E-22, -7.6873E-22, -7.8303E-22, -7.3649E-22, &
      -7.5722E-22, -7.0469E-22, -7.3024E-22, -6.7382E-22, -7.0433E-22, -6.4442E-22, &
      -6.7871E-22, -6.1669E-22, -6.5399E-22, -5.8979E-22, -6.3070E-22, -5.6496E-22, &
      -6.0808E-22, -5.4151E-22, -5.8640E-22, -5.2019E-22, -5.6500E-22, -4.9897E-22, &
      -5.4615E-22, -4.7947E-22, -5.2758E-22, -4.6078E-22, -4.7162E-22, -4.2269E-22, &
      -4.0204E-22, -3.6346E-22, -3.5117E-22, -3.1978E-22, -3.1333E-22, -2.8686E-22, &
      -3.0569E-22, -2.9154E-22, -2.7917E-22, -2.6810E-22, -2.5817E-22, -2.4873E-22, &
      -2.4031E-22 /)
    REAL, PARAMETER :: a2_CCl4(dim55) = (/ &
      -2.8676E-23, -2.4420E-23, -1.9364E-23, -1.4451E-23, -1.0276E-23, -7.0464E-24, &
      -4.7044E-24, -3.0820E-24, -1.9930E-24, -1.2781E-24, -8.1512E-25, -5.1824E-25, &
      -3.2908E-25, -2.0893E-25, -1.3278E-25, -8.4536E-26, -5.3944E-26, -3.4520E-26, &
      -2.2172E-26, -1.4287E-26, -9.2480E-27, -6.0112E-27, -3.9260E-27, -2.5760E-27, &
      -1.6990E-27, -1.1262E-27, -7.5028E-28, -5.0244E-28, -3.3812E-28, -2.2872E-28, &
      -1.5540E-28, -1.0610E-28, -7.2748E-29, -5.0080E-29, -3.4612E-29, -2.4008E-29, &
      -1.6703E-29, -1.1658E-29, -8.1588E-30, -5.7236E-30, -2.2555E-30, -4.0129E-31, &
      -7.3139E-32, -1.3494E-32, -2.5051E-33, -4.6634E-34, -8.6923E-35, -1.6209E-35, &
      -3.0229E-36, -5.6374E-37, -1.0512E-37, -1.9601E-38,  0.0000E+00,  0.0000E+00, &
       0.0000E+00 /)
    REAL, PARAMETER :: b2_CCl4(dim55) = (/ &
       3.0817E-22,  2.9540E-22,  2.6759E-22,  2.2829E-22,  1.8445E-22,  1.4246E-22, &
       1.0616E-22,  7.6960E-23,  5.4635E-23,  3.8192E-23,  2.6387E-23,  1.8074E-23, &
       1.2305E-23,  8.3400E-24,  5.6367E-24,  3.8033E-24,  2.5643E-24,  1.7291E-24, &
       1.1672E-24,  7.8877E-25,  5.3429E-25,  3.6274E-25,  2.4701E-25,  1.6871E-25, &
       1.1565E-25,  7.9560E-26,  5.4940E-26,  3.8086E-26,  2.6502E-26,  1.8516E-26, &
       1.2980E-26,  9.1343E-27,  6.4498E-27,  4.5683E-27,  3.2458E-27,  2.3127E-27, &
       1.6516E-27,  1.1824E-27,  8.4820E-28,  6.0955E-28,  2.6101E-28,  5.1483E-29, &
       1.0300E-29,  2.0694E-30,  4.1550E-31,  8.3179E-32,  1.6591E-32,  3.2963E-33, &
       6.5254E-34,  1.2874E-34,  2.5320E-35,  4.9662E-36,  9.7155E-37,  1.8964E-37, &
       3.6940E-38 /)

    jval_2d(ip_CCl4)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_CCl4(0) = &
          p1(a0_1_1_CCl4(i0(j,k))*dlv2(j,k) + &
          a0_1_2_CCl4(i0(j,k)), &
          a0_2_1_CCl4(i0(j,k))*dlv2(j,k) + &
          a0_2_2_CCl4(i0(j,k)),v3_du1(j,k))
        sig_CCl4(1) = &
          (p1(b1_1_CCl4(i1(j,k)),a1_1_CCl4(i1(j,k)), &
          v3_du1(j,k)) + &
          p1(b1_2_CCl4(i1(j,k)),a1_2_CCl4(i1(j,k)), &
          v3_du1(j,k)) * v2s_m(j,k))
        sig_CCl4(2) = &
          p1(b2_CCl4(i2(j,k)), a2_CCl4(i2(j,k)), &
          v3_du1(j,k))
        dj = 0. &
          + sig_CCl4(0) * fint(j,k,0) &
          + sig_CCl4(1) * fint(j,k,1) &
          + sig_CCl4(2) * fint(j,k,2)

        jval_2d(ip_CCl4)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,8)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_CCl4

  ! **************************************************************************

  SUBROUTINE jval_cal_CH3Cl

    ! CH_3Cl \TOHV\ \products

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_CH3Cl

    ! T-const parameters:
    REAL, PARAMETER :: a0_1_1_CH3Cl(dim58) = (/ &
      -6.5345E-21, -7.0180E-21, -7.5035E-21, -7.9990E-21, -8.4900E-21, -8.9681E-21, &
      -9.4157E-21, -9.8597E-21, -1.0257E-20, -1.0636E-20, -1.0980E-20, -1.1311E-20, &
      -1.2691E-20, -1.6351E-20, -1.5629E-20, -1.5929E-20, -1.7331E-20, -1.6213E-20, &
      -1.6106E-20, -1.7128E-20, -1.5345E-20, -1.4628E-20, -1.5099E-20, -1.2633E-20, &
      -1.1398E-20, -7.3335E-21, -4.8296E-21, -3.8922E-21, -3.1619E-21, -2.6563E-21, &
      -2.3902E-21, -2.3561E-21, -2.5330E-21, -2.8774E-21, -3.3329E-21, -3.8265E-21, &
      -4.3016E-21, -4.7080E-21, -5.0149E-21, -5.2120E-21, -5.2974E-21, -5.2815E-21, &
      -5.1796E-21, -5.0008E-21, -4.7590E-21, -4.4613E-21, -4.1147E-21, -3.7449E-21, &
      -3.3689E-21, -3.0083E-21, -2.6737E-21, -2.3667E-21, -2.0827E-21, -1.8150E-21, &
      -1.5591E-21, -1.3148E-21, -1.0714E-21, -8.7542E-22 /)
    REAL, PARAMETER :: a0_1_2_CH3Cl(dim58) = (/ &
       3.8983E-19,  4.1120E-19,  4.3276E-19,  4.5486E-19,  4.7685E-19,  4.9837E-19, &
       5.1860E-19,  5.3876E-19,  5.5688E-19,  5.7426E-19,  5.9007E-19,  6.0535E-19, &
       6.6939E-19,  8.3993E-19,  8.0613E-19,  8.2023E-19,  8.8642E-19,  8.3345E-19, &
       8.2833E-19,  8.7721E-19,  7.9159E-19,  7.5706E-19,  7.7984E-19,  6.6001E-19, &
       5.9970E-19,  4.0056E-19,  2.7737E-19,  2.3107E-19,  1.9484E-19,  1.6966E-19, &
       1.5636E-19,  1.5465E-19,  1.6356E-19,  1.8099E-19,  2.0413E-19,  2.2930E-19, &
       2.5363E-19,  2.7451E-19,  2.9035E-19,  3.0056E-19,  3.0500E-19,  3.0417E-19, &
       2.9883E-19,  2.8943E-19,  2.7666E-19,  2.6088E-19,  2.4244E-19,  2.2270E-19, &
       2.0254E-19,  1.8314E-19,  1.6508E-19,  1.4843E-19,  1.3298E-19,  1.1837E-19, &
       1.0435E-19,  9.0910E-20,  7.7474E-20,  6.6616E-20 /)
    REAL, PARAMETER :: a0_2_1_CH3Cl(dim58) = (/ &
      -3.3923E-23, -3.7459E-23, -4.1453E-23, -4.5836E-23, -5.0599E-23, -5.5698E-23, &
      -6.1214E-23, -6.6902E-23, -7.3061E-23, -7.9551E-23, -8.6536E-23, -9.3987E-23, &
      -8.5704E-23, -4.5070E-23, -6.9717E-23, -7.8776E-23, -7.2804E-23, -9.8658E-23, &
      -1.0909E-22, -1.0405E-22, -1.2926E-22, -1.3821E-22, -1.3117E-22, -1.5214E-22, &
      -1.5652E-22, -1.8624E-22, -1.9753E-22, -1.9158E-22, -1.8260E-22, -1.7070E-22, &
      -1.5588E-22, -1.3834E-22, -1.1854E-22, -9.7253E-23, -7.5690E-23, -5.5030E-23, &
      -3.6538E-23, -2.0974E-23, -8.8061E-24, -8.1081E-26,  5.4982E-24,  8.4985E-24, &
       9.6538E-24,  9.6712E-24,  9.1181E-24,  8.2849E-24,  7.3350E-24,  6.3602E-24, &
       5.4187E-24,  4.5652E-24,  3.8110E-24,  3.1504E-24,  2.5791E-24,  2.0743E-24, &
       1.6229E-24,  1.2443E-24,  9.2718E-25,  7.2782E-25 /)
    REAL, PARAMETER :: a0_2_2_CH3Cl(dim58) = (/ &
       2.2191E-21,  2.3754E-21,  2.5527E-21,  2.7482E-21,  2.9616E-21,  3.1910E-21, &
       3.4404E-21,  3.6986E-21,  3.9795E-21,  4.2767E-21,  4.5980E-21,  4.9422E-21, &
       4.5579E-21,  2.6644E-21,  3.8178E-21,  4.2436E-21,  3.9617E-21,  5.1872E-21, &
       5.6839E-21,  5.4427E-21,  6.6530E-21,  7.0844E-21,  6.7435E-21,  7.7627E-21, &
       7.9763E-21,  9.4329E-21,  9.9884E-21,  9.6944E-21,  9.2486E-21,  8.6560E-21, &
       7.9150E-21,  7.0350E-21,  6.0370E-21,  4.9597E-21,  3.8643E-21,  2.8107E-21, &
       1.8639E-21,  1.0639E-21,  4.3601E-22, -1.5942E-23, -3.0607E-22, -4.6268E-22, &
      -5.2322E-22, -5.2413E-22, -4.9493E-22, -4.5077E-22, -4.0024E-22, -3.4818E-22, &
      -2.9772E-22, -2.5180E-22, -2.1107E-22, -1.7527E-22, -1.4419E-22, -1.1663E-22, &
      -9.1890E-23, -7.1064E-23, -5.3561E-23, -4.2516E-23 /)
    REAL, PARAMETER :: a1_1_CH3Cl(dim55) = (/ &
       3.4063E-23,  3.4233E-23,  3.6192E-23,  3.4781E-23,  3.5500E-23,  3.3284E-23, &
       3.3368E-23,  3.0977E-23,  3.0864E-23,  2.8620E-23,  2.8522E-23,  2.6544E-23, &
       2.6500E-23,  2.4744E-23,  2.4785E-23,  2.3222E-23,  2.3344E-23,  2.1939E-23, &
       2.2086E-23,  2.0832E-23,  2.1021E-23,  1.9862E-23,  2.0092E-23,  1.9000E-23, &
       1.9245E-23,  1.8252E-23,  1.8520E-23,  1.7591E-23,  1.7842E-23,  1.6984E-23, &
       1.7251E-23,  1.6427E-23,  1.6725E-23,  1.5922E-23,  1.6228E-23,  1.5467E-23, &
       1.5776E-23,  1.5062E-23,  1.5353E-23,  1.4677E-23,  1.4429E-23,  1.3555E-23, &
       1.2954E-23,  1.2274E-23,  1.1789E-23,  1.1231E-23,  1.0807E-23,  1.0329E-23, &
       9.9523E-24,  9.4785E-24,  9.0315E-24,  8.6016E-24,  8.1972E-24,  7.8097E-24, &
       7.4468E-24 /)
    REAL, PARAMETER :: b1_1_CH3Cl(dim55) = (/ &
       4.0627E-22,  4.0576E-22,  3.9499E-22,  4.0628E-22,  3.9873E-22,  4.2754E-22, &
       4.2624E-22,  4.6926E-22,  4.7159E-22,  5.2318E-22,  5.2569E-22,  5.8109E-22, &
       5.8242E-22,  6.4036E-22,  6.3890E-22,  6.9831E-22,  6.9338E-22,  7.5378E-22, &
       7.4711E-22,  8.0729E-22,  7.9775E-22,  8.5914E-22,  8.4642E-22,  9.0973E-22, &
       8.9490E-22,  9.5745E-22,  9.3993E-22,  1.0031E-21,  9.8536E-22,  1.0480E-21, &
       1.0279E-21,  1.0922E-21,  1.0682E-21,  1.1348E-21,  1.1087E-21,  1.1756E-21, &
       1.1477E-21,  1.2140E-21,  1.1862E-21,  1.2525E-21,  1.2775E-21,  1.3761E-21, &
       1.4517E-21,  1.5454E-21,  1.6185E-21,  1.7093E-21,  1.7838E-21,  1.8738E-21, &
       1.9492E-21,  2.0501E-21,  2.1509E-21,  2.2532E-21,  2.3545E-21,  2.4564E-21, &
       2.5564E-21 /)
    REAL, PARAMETER :: a1_2_CH3Cl(dim55) = (/ &
      -1.4147E-25, -9.5958E-26, -1.1288E-25, -6.4733E-26, -7.8547E-26, -3.6524E-26, &
      -5.0240E-26, -1.6723E-26, -3.0892E-26, -4.8233E-27, -1.8910E-26,  1.5805E-27, &
      -1.1677E-26,  5.1441E-27, -7.2059E-27,  7.0552E-27, -4.4368E-27,  8.0131E-27, &
      -2.4351E-27,  8.4503E-27, -1.1699E-27,  8.5954E-27, -2.4416E-28,  8.6773E-27, &
       5.3981E-28,  8.5065E-27,  9.7232E-28,  8.2340E-27,  1.4070E-27,  8.0269E-27, &
       1.6123E-27,  7.8495E-27,  1.7668E-27,  7.6181E-27,  1.9072E-27,  7.3839E-27, &
       2.0109E-27,  7.0614E-27,  2.1143E-27,  6.8194E-27,  3.9715E-27,  4.5911E-27, &
       3.8097E-27,  4.3110E-27,  3.8199E-27,  4.1900E-27,  3.9218E-27,  4.1709E-27, &
       3.9739E-27,  4.4418E-27,  4.8446E-27,  5.2041E-27,  5.4979E-27,  5.7375E-27, &
       5.9152E-27 /)
    REAL, PARAMETER :: b1_2_CH3Cl(dim55) = (/ &
      -2.3125E-24, -2.4490E-24, -2.3559E-24, -2.7411E-24, -2.5961E-24, -3.1423E-24, &
      -2.9298E-24, -3.5331E-24, -3.2426E-24, -3.8422E-24, -3.4830E-24, -4.0567E-24, &
      -3.6524E-24, -4.2074E-24, -3.7690E-24, -4.3109E-24, -3.8455E-24, -4.3809E-24, &
      -3.9055E-24, -4.4280E-24, -3.9421E-24, -4.4597E-24, -3.9691E-24, -4.4866E-24, &
      -3.9942E-24, -4.4961E-24, -4.0026E-24, -4.4964E-24, -4.0151E-24, -4.4984E-24, &
      -4.0141E-24, -4.5006E-24, -4.0109E-24, -4.4966E-24, -4.0083E-24, -4.4903E-24, &
      -4.0040E-24, -4.4737E-24, -4.0012E-24, -4.4623E-24, -4.1761E-24, -4.2462E-24, &
      -4.1481E-24, -4.2173E-24, -4.1434E-24, -4.2037E-24, -4.1566E-24, -4.2034E-24, &
      -4.1639E-24, -4.2636E-24, -4.3544E-24, -4.4400E-24, -4.5136E-24, -4.5766E-24, &
      -4.6256E-24 /)
    ! T-dep parameters:
    REAL, PARAMETER :: c0_1_1_CH3Cl(dim58) = (/ &
      -6.0199E-02, -6.0199E-02, -6.0199E-02, -7.1567E-02, -8.4575E-02, -9.6054E-02, &
      -1.0728E-01, -1.1794E-01, -1.2568E-01, -1.3445E-01, -1.4107E-01, -1.4610E-01, &
      -1.5154E-01, -1.5824E-01, -1.6318E-01, -1.7043E-01, -1.7582E-01, -1.8204E-01, &
      -1.8748E-01, -1.8886E-01, -1.8536E-01, -1.7446E-01, -1.5396E-01, -1.2257E-01, &
      -8.0753E-02, -3.0375E-02,  2.5413E-02,  8.1498E-02,  1.3372E-01,  1.7836E-01, &
       2.1094E-01,  2.2906E-01,  2.3052E-01,  2.1499E-01,  1.8513E-01,  1.4420E-01, &
       9.8552E-02,  5.3957E-02,  1.6459E-02, -8.7379E-03, -1.6823E-02, -6.3029E-03, &
       2.2925E-02,  6.3085E-02,  1.0661E-01,  1.4115E-01,  1.6160E-01,  1.6645E-01, &
       1.6181E-01,  1.5632E-01,  1.6032E-01,  1.7850E-01,  2.1422E-01,  2.5819E-01, &
       2.9706E-01,  3.2535E-01,  3.5292E-01,  3.9504E-01 /)
    REAL, PARAMETER :: c0_1_2_CH3Cl(dim58) = (/ &
       2.6241E+00,  2.6241E+00,  2.6241E+00,  3.1311E+00,  3.7139E+00,  4.2304E+00, &
       4.7380E+00,  5.2218E+00,  5.5745E+00,  5.9763E+00,  6.2808E+00,  6.5132E+00, &
       6.7656E+00,  7.0781E+00,  7.3089E+00,  7.6497E+00,  7.9044E+00,  8.1989E+00, &
       8.4581E+00,  8.5239E+00,  8.3560E+00,  7.8309E+00,  6.8384E+00,  5.3127E+00, &
       3.2722E+00,  8.0373E-01, -1.9411E+00, -4.7117E+00, -7.3021E+00, -9.5251E+00, &
      -1.1154E+01, -1.2064E+01, -1.2137E+01, -1.1351E+01, -9.8345E+00, -7.7469E+00, &
      -5.4098E+00, -3.1176E+00, -1.1827E+00,  1.2245E-01,  5.4288E-01, -6.2764E-03, &
      -1.5378E+00, -3.6502E+00, -5.9482E+00, -7.7788E+00, -8.8672E+00, -9.1258E+00, &
      -8.8774E+00, -8.5820E+00, -8.7981E+00, -9.7833E+00, -1.1727E+01, -1.4127E+01, &
      -1.6257E+01, -1.7813E+01, -1.9335E+01, -2.1669E+01 /)
    REAL, PARAMETER :: c0_2_1_CH3Cl(dim58) = (/ &
      -2.4439E-02, -2.4439E-02, -2.4439E-02, -2.0444E-02, -3.2060E-02, -3.0103E-02, &
      -3.9738E-02, -3.4925E-02, -2.8081E-02, -2.6243E-02, -2.1549E-02, -1.2829E-02, &
       8.2226E-03,  1.9493E-02,  3.6583E-02,  6.1733E-02,  7.3183E-02,  1.0142E-01, &
       1.3408E-01,  1.6400E-01,  1.9990E-01,  2.3492E-01,  2.6981E-01,  2.9598E-01, &
       3.0628E-01,  2.9625E-01,  2.5665E-01,  1.9256E-01,  1.1167E-01,  2.4640E-02, &
      -4.5630E-02, -9.8255E-02, -1.2922E-01, -1.3813E-01, -1.3996E-01, -1.3298E-01, &
      -1.1973E-01, -1.0094E-01, -6.4663E-02, -1.3359E-02,  4.7622E-02,  1.0895E-01, &
       1.5210E-01,  1.5545E-01,  1.3061E-01,  9.5595E-02,  6.8135E-02,  6.1506E-02, &
       7.4644E-02,  8.3225E-02,  6.8366E-02,  1.0585E-02, -1.0227E-01, -2.3761E-01, &
      -3.4098E-01, -3.3574E-01, -2.2281E-01, -7.4433E-02 /)
    REAL, PARAMETER :: c0_2_2_CH3Cl(dim58) = (/ &
       1.0901E+00,  1.0901E+00,  1.0901E+00,  9.1196E-01,  1.4323E+00,  1.3443E+00, &
       1.7798E+00,  1.5613E+00,  1.2492E+00,  1.1650E+00,  9.4907E-01,  5.4623E-01, &
      -4.3058E-01, -9.5580E-01, -1.7556E+00, -2.9377E+00, -3.4781E+00, -4.8167E+00, &
      -6.3711E+00, -7.8011E+00, -9.5243E+00, -1.1212E+01, -1.2901E+01, -1.4173E+01, &
      -1.4676E+01, -1.4184E+01, -1.2236E+01, -9.0697E+00, -5.0574E+00, -7.2360E-01, &
       2.7899E+00,  5.4317E+00,  6.9923E+00,  7.4432E+00,  7.5361E+00,  7.1802E+00, &
       6.5020E+00,  5.5361E+00,  3.6640E+00,  1.0065E+00, -2.1645E+00, -5.3659E+00, &
      -7.6267E+00, -7.8032E+00, -6.4916E+00, -4.6357E+00, -3.1749E+00, -2.8209E+00, &
      -3.5251E+00, -3.9867E+00, -3.1844E+00, -5.2635E-02,  6.0867E+00,  1.3476E+01, &
       1.9141E+01,  1.8853E+01,  1.2619E+01,  4.3989E+00 /)
    REAL, PARAMETER :: c1_CH3Cl(3) = (/  1.0014E+00,  7.4887E-01,  5.1313E-01 /)

    jval_2d(ip_CH3Cl)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_CH3Cl(0) = &
          p2(1.,c0_1_1_CH3Cl(i0(j,k))*dlv2(j,k) + &
          c0_1_2_CH3Cl(i0(j,k)), &
          c0_2_1_CH3Cl(i0(j,k))*dlv2(j,k) + &
          c0_2_2_CH3Cl(i0(j,k)), tnorm_sr(j,k)) * &
          p1(a0_1_1_CH3Cl(i0(j,k))*dlv2(j,k) + &
          a0_1_2_CH3Cl(i0(j,k)), &
          a0_2_1_CH3Cl(i0(j,k))*dlv2(j,k) + &
          a0_2_2_CH3Cl(i0(j,k)),v3_du1(j,k))
        sig_CH3Cl(1) = &
          p2(c1_CH3Cl(1),c1_CH3Cl(2), &
          c1_CH3Cl(3),tnorm(j,k)) * &
          (p1(b1_1_CH3Cl(i1(j,k)),a1_1_CH3Cl(i1(j,k)), &
          v3_du1(j,k)) + &
          p1(b1_2_CH3Cl(i1(j,k)),a1_2_CH3Cl(i1(j,k)), &
          v3_du1(j,k)) * v2s_m(j,k))
        dj = 0. &
          + sig_CH3Cl(0) * fint(j,k,0) &
          + sig_CH3Cl(1) * fint(j,k,1)

        jval_2d(ip_CH3Cl)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,8)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_CH3Cl

  ! **************************************************************************

  SUBROUTINE jval_cal_CH3CCl3

    ! CH_3CCl_3 \TOHV\ \products

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_CH3CCl3

    ! T-const parameters:
    REAL, PARAMETER :: a0_1_1_CH3CCl3(dim58) = (/ &
      -3.5089E-20, -3.7907E-20, -4.0567E-20, -4.3442E-20, -4.6312E-20, -4.8955E-20, &
      -5.1853E-20, -5.4357E-20, -5.6938E-20, -5.9285E-20, -6.1731E-20, -6.4058E-20, &
      -7.2765E-20, -9.5517E-20, -9.1696E-20, -9.4092E-20, -1.0349E-19, -9.7593E-20, &
      -9.8013E-20, -1.0572E-19, -9.6311E-20, -9.3747E-20, -9.8762E-20, -8.5579E-20, &
      -8.0273E-20, -5.7029E-20, -4.3428E-20, -3.9458E-20, -3.6601E-20, -3.4941E-20, &
      -3.4717E-20, -3.5794E-20, -3.7959E-20, -4.1088E-20, -4.4745E-20, -4.8579E-20, &
      -5.2438E-20, -5.5613E-20, -5.8372E-20, -6.0493E-20, -6.1744E-20, -6.2447E-20, &
      -6.2466E-20, -6.1828E-20, -6.0495E-20, -5.8482E-20, -5.5717E-20, -5.2456E-20, &
      -4.8822E-20, -4.5079E-20, -4.1403E-20, -3.7807E-20, -3.4303E-20, -3.0797E-20, &
      -2.7279E-20, -2.3657E-20, -1.9725E-20, -1.6288E-20 /)
    REAL, PARAMETER :: a0_1_2_CH3CCl3(dim58) = (/ &
       3.0508E-18,  3.1753E-18,  3.2934E-18,  3.4217E-18,  3.5502E-18,  3.6692E-18, &
       3.8002E-18,  3.9139E-18,  4.0315E-18,  4.1390E-18,  4.2515E-18,  4.3591E-18, &
       4.7631E-18,  5.8233E-18,  5.6445E-18,  5.7571E-18,  6.2005E-18,  5.9212E-18, &
       5.9412E-18,  6.3096E-18,  5.8579E-18,  5.7344E-18,  5.9770E-18,  5.3364E-18, &
       5.0774E-18,  3.9385E-18,  3.2693E-18,  3.0732E-18,  2.9315E-18,  2.8488E-18, &
       2.8376E-18,  2.8917E-18,  3.0008E-18,  3.1591E-18,  3.3449E-18,  3.5405E-18, &
       3.7380E-18,  3.9012E-18,  4.0436E-18,  4.1535E-18,  4.2185E-18,  4.2552E-18, &
       4.2562E-18,  4.2226E-18,  4.1523E-18,  4.0456E-18,  3.8985E-18,  3.7243E-18, &
       3.5295E-18,  3.3282E-18,  3.1297E-18,  2.9348E-18,  2.7441E-18,  2.5527E-18, &
       2.3599E-18,  2.1607E-18,  1.9437E-18,  1.7533E-18 /)
    REAL, PARAMETER :: a0_2_1_CH3CCl3(dim58) = (/ &
      -1.8036E-22, -1.9775E-22, -2.1936E-22, -2.4123E-22, -2.6535E-22, -2.9258E-22, &
      -3.1954E-22, -3.5065E-22, -3.8216E-22, -4.1677E-22, -4.5255E-22, -4.9215E-22, &
      -4.3492E-22, -1.8080E-22, -3.2334E-22, -3.7211E-22, -3.2750E-22, -4.7770E-22, &
      -5.3466E-22, -4.9629E-22, -6.4645E-22, -6.9805E-22, -6.5324E-22, -7.8602E-22, &
      -8.1833E-22, -1.0132E-21, -1.0962E-21, -1.0729E-21, -1.0309E-21, -9.7030E-22, &
      -8.8995E-22, -7.9148E-22, -6.7800E-22, -5.5335E-22, -4.2575E-22, -3.0156E-22, &
      -1.8785E-22, -9.2051E-23, -1.5115E-23,  4.1232E-23,  7.7317E-23,  9.7600E-23, &
       1.0565E-22,  1.0586E-22,  1.0164E-22,  9.5005E-23,  8.6752E-23,  7.7761E-23, &
       6.8534E-23,  5.9758E-23,  5.1679E-23,  4.4311E-23,  3.7621E-23,  3.1310E-23, &
       2.5525E-23,  2.0266E-23,  1.5612E-23,  1.2347E-23 /)
    REAL, PARAMETER :: a0_2_2_CH3CCl3(dim58) = (/ &
       1.1599E-20,  1.2367E-20,  1.3327E-20,  1.4303E-20,  1.5383E-20,  1.6608E-20, &
       1.7827E-20,  1.9239E-20,  2.0676E-20,  2.2262E-20,  2.3907E-20,  2.5737E-20, &
       2.3081E-20,  1.1239E-20,  1.7910E-20,  2.0203E-20,  1.8097E-20,  2.5216E-20, &
       2.7928E-20,  2.6093E-20,  3.3301E-20,  3.5788E-20,  3.3620E-20,  4.0073E-20, &
       4.1650E-20,  5.1200E-20,  5.5279E-20,  5.4129E-20,  5.2046E-20,  4.9029E-20, &
       4.5012E-20,  4.0069E-20,  3.4350E-20,  2.8042E-20,  2.1560E-20,  1.5226E-20, &
       9.4045E-21,  4.4803E-21,  5.1036E-22, -2.4084E-21, -4.2848E-21, -5.3436E-21, &
      -5.7653E-21, -5.7766E-21, -5.5535E-21, -5.2020E-21, -4.7630E-21, -4.2828E-21, &
      -3.7883E-21, -3.3161E-21, -2.8799E-21, -2.4805E-21, -2.1166E-21, -1.7720E-21, &
      -1.4550E-21, -1.1657E-21, -9.0881E-22, -7.2795E-22 /)
    REAL, PARAMETER :: a1_1_CH3CCl3(dim55) = (/ &
       3.9165E-21,  3.9064E-21,  4.0524E-21,  3.8675E-21,  3.8647E-21,  3.6032E-21, &
       3.5267E-21,  3.2642E-21,  3.1713E-21,  2.9355E-21,  2.8500E-21,  2.6517E-21, &
       2.5773E-21,  2.4136E-21,  2.3519E-21,  2.2134E-21,  2.1595E-21,  2.0461E-21, &
       1.9994E-21,  1.9019E-21,  1.8615E-21,  1.7770E-21,  1.7420E-21,  1.6702E-21, &
       1.6373E-21,  1.5749E-21,  1.5457E-21,  1.4915E-21,  1.4626E-21,  1.4163E-21, &
       1.3918E-21,  1.3484E-21,  1.3265E-21,  1.2885E-21,  1.2675E-21,  1.2354E-21, &
       1.2140E-21,  1.1866E-21,  1.1647E-21,  1.1419E-21,  1.0818E-21,  9.9481E-22, &
       9.2146E-22,  8.6023E-22,  8.0484E-22,  7.5892E-22,  7.1342E-22,  6.7733E-22, &
       6.2922E-22,  5.9269E-22,  5.5867E-22,  5.2653E-22,  4.9742E-22,  4.6941E-22, &
       4.4367E-22 /)
    REAL, PARAMETER :: b1_1_CH3CCl3(dim55) = (/ &
       5.0199E-20,  5.0229E-20,  4.9426E-20,  5.0905E-20,  5.0934E-20,  5.4334E-20, &
       5.5519E-20,  6.0245E-20,  6.2148E-20,  6.7572E-20,  6.9754E-20,  7.5305E-20, &
       7.7576E-20,  8.2975E-20,  8.5166E-20,  9.0429E-20,  9.2612E-20,  9.7488E-20, &
       9.9612E-20,  1.0429E-19,  1.0634E-19,  1.1081E-19,  1.1276E-19,  1.1692E-19, &
       1.1891E-19,  1.2284E-19,  1.2476E-19,  1.2844E-19,  1.3047E-19,  1.3386E-19, &
       1.3571E-19,  1.3909E-19,  1.4085E-19,  1.4400E-19,  1.4580E-19,  1.4863E-19, &
       1.5057E-19,  1.5311E-19,  1.5521E-19,  1.5744E-19,  1.6348E-19,  1.7331E-19, &
       1.8252E-19,  1.9096E-19,  1.9930E-19,  2.0679E-19,  2.1477E-19,  2.2156E-19, &
       2.3120E-19,  2.3898E-19,  2.4665E-19,  2.5430E-19,  2.6160E-19,  2.6896E-19, &
       2.7605E-19 /)
    REAL, PARAMETER :: a1_2_CH3CCl3(dim55) = (/ &
      -1.4379E-23, -9.3594E-24, -1.0431E-23, -5.4450E-24, -6.1606E-24, -2.1575E-24, &
      -2.8567E-24, -2.1787E-26, -8.0765E-25,  1.1538E-24,  3.5429E-25,  1.6887E-24, &
       9.6018E-25,  1.8946E-24,  1.2480E-24,  1.9395E-24,  1.4015E-24,  1.8957E-24, &
       1.4498E-24,  1.8226E-24,  1.4605E-24,  1.7421E-24,  1.4281E-24,  1.6443E-24, &
       1.3911E-24,  1.5569E-24,  1.3411E-24,  1.4569E-24,  1.2976E-24,  1.3774E-24, &
       1.2289E-24,  1.2997E-24,  1.1699E-24,  1.2250E-24,  1.1187E-24,  1.1450E-24, &
       1.0692E-24,  1.0748E-24,  1.0246E-24,  1.0130E-24,  9.3064E-25,  8.2361E-25, &
       7.4246E-25,  6.6675E-25,  6.2136E-25,  5.6368E-25,  5.4370E-25,  4.9564E-25, &
       5.4166E-25,  5.3739E-25,  5.3415E-25,  5.3196E-25,  5.2694E-25,  5.2303E-25, &
       5.1654E-25 /)
    REAL, PARAMETER :: b1_2_CH3CCl3(dim55) = (/ &
      -2.6393E-22, -2.7899E-22, -2.7310E-22, -3.1298E-22, -3.0547E-22, -3.5751E-22, &
      -3.4667E-22, -3.9770E-22, -3.8159E-22, -4.2670E-22, -4.0632E-22, -4.4368E-22, &
      -4.2146E-22, -4.5229E-22, -4.2934E-22, -4.5562E-22, -4.3383E-22, -4.5508E-22, &
      -4.3479E-22, -4.5269E-22, -4.3440E-22, -4.4932E-22, -4.3190E-22, -4.4444E-22, &
      -4.2912E-22, -4.3956E-22, -4.2543E-22, -4.3331E-22, -4.2207E-22, -4.2790E-22, &
      -4.1669E-22, -4.2221E-22, -4.1176E-22, -4.1634E-22, -4.0724E-22, -4.0956E-22, &
      -4.0270E-22, -4.0322E-22, -3.9843E-22, -3.9729E-22, -3.8901E-22, -3.7692E-22, &
      -3.6673E-22, -3.5629E-22, -3.4945E-22, -3.4005E-22, -3.3655E-22, -3.2751E-22, &
      -3.3674E-22, -3.3583E-22, -3.3510E-22, -3.3458E-22, -3.3332E-22, -3.3229E-22, &
      -3.3050E-22 /)
    REAL, PARAMETER :: a2_CH3CCl3(dim55) = (/ &
      -3.0052E-24, -2.5872E-24, -2.0688E-24, -1.5531E-24, -1.1092E-24, -7.6240E-25, &
      -5.0932E-25, -3.3324E-25, -2.1487E-25, -1.3705E-25, -8.6752E-26, -5.4612E-26, &
      -3.4252E-26, -2.1414E-26, -1.3363E-26, -8.3252E-27, -5.1812E-27, -3.2216E-27, &
      -2.0018E-27, -1.2434E-27, -7.7196E-28, -4.7920E-28, -2.9736E-28, -1.8449E-28, &
      -1.1447E-28, -7.1004E-29, -4.4044E-29, -2.7316E-29, -1.6944E-29, -1.0507E-29, &
      -6.5156E-30, -4.0404E-30, -2.5052E-30, -1.5536E-30, -9.6324E-31, -5.9724E-31, &
      -3.7028E-31, -2.2957E-31, -1.4233E-31, -8.8236E-32, -2.6148E-32, -2.3930E-33, &
      -2.1889E-34, -2.0014E-35, -1.8293E-36, -1.6716E-37, -1.5273E-38,  0.0000E+00, &
       0.0000E+00,  0.0000E+00,  0.0000E+00,  0.0000E+00,  0.0000E+00,  0.0000E+00, &
       0.0000E+00 /)
    REAL, PARAMETER :: b2_CH3CCl3(dim55) = (/ &
       3.2785E-23,  3.1531E-23,  2.8679E-23,  2.4554E-23,  1.9893E-23,  1.5384E-23, &
       1.1462E-23,  8.2922E-24,  5.8657E-24,  4.0757E-24,  2.7932E-24,  1.8933E-24, &
       1.2723E-24,  8.4861E-25,  5.6281E-25,  3.7138E-25,  2.4404E-25,  1.5978E-25, &
       1.0428E-25,  6.7876E-26,  4.4070E-26,  2.8554E-26,  1.8462E-26,  1.1915E-26, &
       7.6789E-27,  4.9407E-27,  3.1748E-27,  2.0373E-27,  1.3060E-27,  8.3614E-28, &
       5.3480E-28,  3.4174E-28,  2.1815E-28,  1.3917E-28,  8.8694E-29,  5.6486E-29, &
       3.5946E-29,  2.2860E-29,  1.4529E-29,  9.2275E-30,  2.9876E-30,  3.0333E-31, &
       3.0483E-32,  3.0373E-33,  3.0048E-34,  2.9547E-35,  2.8904E-36,  2.8149E-37, &
       2.7304E-38,  0.0000E+00,  0.0000E+00,  0.0000E+00,  0.0000E+00,  0.0000E+00, &
       0.0000E+00 /)
    ! T-dep parameters:
    REAL, PARAMETER :: c0_1_1_CH3CCl3(dim58) = (/ &
      -2.7225E-02, -2.7225E-02, -2.7225E-02, -3.1706E-02, -3.6860E-02, -4.0747E-02, &
      -4.5006E-02, -4.8057E-02, -5.1203E-02, -5.2876E-02, -5.4032E-02, -5.4551E-02, &
      -5.4865E-02, -5.5342E-02, -5.4187E-02, -5.3398E-02, -5.3793E-02, -5.2199E-02, &
      -5.0525E-02, -4.8824E-02, -4.4399E-02, -3.9321E-02, -3.1574E-02, -2.0976E-02, &
      -1.0750E-02,  2.1733E-03,  1.4165E-02,  2.6358E-02,  3.6080E-02,  4.3085E-02, &
       4.6633E-02,  4.5275E-02,  4.1282E-02,  3.2177E-02,  2.1235E-02,  7.3436E-03, &
      -5.0292E-03, -1.7510E-02, -2.6224E-02, -3.1090E-02, -3.1264E-02, -2.5442E-02, &
      -1.4733E-02, -1.5814E-03,  1.1964E-02,  2.3262E-02,  3.0582E-02,  3.3783E-02, &
       3.4504E-02,  3.5383E-02,  3.9913E-02,  4.9548E-02,  6.5424E-02,  8.4579E-02, &
       1.0305E-01,  1.1814E-01,  1.3454E-01,  1.5575E-01 /)
    REAL, PARAMETER :: c0_1_2_CH3CCl3(dim58) = (/ &
       1.1717E+00,  1.1717E+00,  1.1717E+00,  1.3715E+00,  1.6024E+00,  1.7773E+00, &
       1.9699E+00,  2.1084E+00,  2.2518E+00,  2.3284E+00,  2.3816E+00,  2.4056E+00, &
       2.4202E+00,  2.4424E+00,  2.3884E+00,  2.3513E+00,  2.3699E+00,  2.2944E+00, &
       2.2147E+00,  2.1334E+00,  1.9210E+00,  1.6762E+00,  1.3013E+00,  7.8621E-01, &
       2.8717E-01, -3.4607E-01, -9.3606E-01, -1.5384E+00, -2.0206E+00, -2.3695E+00, &
      -2.5468E+00, -2.4787E+00, -2.2774E+00, -1.8167E+00, -1.2608E+00, -5.5241E-01, &
       8.1080E-02,  7.2259E-01,  1.1722E+00,  1.4243E+00,  1.4334E+00,  1.1294E+00, &
       5.6828E-01, -1.2349E-01, -8.3868E-01, -1.4375E+00, -1.8269E+00, -1.9978E+00, &
      -2.0365E+00, -2.0838E+00, -2.3284E+00, -2.8506E+00, -3.7143E+00, -4.7601E+00, &
      -5.7725E+00, -6.6024E+00, -7.5076E+00, -8.6827E+00 /)
    REAL, PARAMETER :: c0_2_1_CH3CCl3(dim58) = (/ &
      -7.4207E-03, -7.4207E-03, -7.4207E-03, -1.4696E-02, -1.2582E-02, -1.6469E-02, &
      -1.5412E-02, -2.1523E-02, -1.4388E-02, -1.4396E-02, -9.5426E-03, -9.2682E-03, &
       1.4459E-04,  4.6107E-04,  7.7135E-03,  1.2826E-02,  1.6128E-02,  2.8119E-02, &
       2.9789E-02,  3.3553E-02,  3.9556E-02,  4.6452E-02,  5.0930E-02,  4.5829E-02, &
       4.4136E-02,  4.1972E-02,  2.5570E-02,  1.7846E-02, -4.3154E-03, -1.5910E-02, &
      -3.9181E-02, -3.6075E-02, -4.7622E-02, -4.4748E-02, -4.0044E-02, -4.3400E-02, &
      -3.7866E-02, -3.0434E-02, -2.5193E-02, -1.2910E-02,  9.8065E-03,  2.3600E-02, &
       3.0726E-02,  3.4930E-02,  3.0422E-02,  2.1172E-02,  1.7185E-02,  1.5510E-02, &
       2.0187E-02,  2.3333E-02,  1.7751E-02, -1.6640E-03, -3.6372E-02, -8.0889E-02, &
      -1.1232E-01, -1.1414E-01, -7.6230E-02, -2.5701E-02 /)
    REAL, PARAMETER :: c0_2_2_CH3CCl3(dim58) = (/ &
       3.1316E-01,  3.1316E-01,  3.1316E-01,  6.3762E-01,  5.4295E-01,  7.1786E-01, &
       6.7006E-01,  9.4752E-01,  6.2217E-01,  6.2253E-01,  3.9926E-01,  3.8659E-01, &
      -5.0166E-02, -6.4914E-02, -4.0433E-01, -6.4461E-01, -8.0048E-01, -1.3689E+00, &
      -1.4483E+00, -1.6282E+00, -1.9164E+00, -2.2488E+00, -2.4655E+00, -2.2176E+00, &
      -2.1350E+00, -2.0290E+00, -1.2220E+00, -8.4043E-01,  2.5879E-01,  8.3618E-01, &
       1.9998E+00,  1.8438E+00,  2.4258E+00,  2.2804E+00,  2.0414E+00,  2.2125E+00, &
       1.9292E+00,  1.5472E+00,  1.2768E+00,  6.4052E-01, -5.4073E-01, -1.2608E+00, &
      -1.6342E+00, -1.8553E+00, -1.6172E+00, -1.1270E+00, -9.1492E-01, -8.2548E-01, &
      -1.0761E+00, -1.2454E+00, -9.4396E-01,  1.0832E-01,  1.9964E+00,  4.4271E+00, &
       6.1496E+00,  6.2498E+00,  4.1570E+00,  1.3577E+00 /)
    REAL, PARAMETER :: c1_CH3CCl3(3) = (/  9.9990E-01,  1.2218E-01,  5.3236E-02 /)
    REAL, PARAMETER :: c2_CH3CCl3(3) = (/  9.9998E-01, -1.5158E-01,  1.1681E-02 /)

    jval_2d(ip_CH3CCl3)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_CH3CCl3(0) = &
          p2(1.,c0_1_1_CH3CCl3(i0(j,k))*dlv2(j,k) + &
          c0_1_2_CH3CCl3(i0(j,k)), &
          c0_2_1_CH3CCl3(i0(j,k))*dlv2(j,k) + &
          c0_2_2_CH3CCl3(i0(j,k)), tnorm_sr(j,k)) * &
          p1(a0_1_1_CH3CCl3(i0(j,k))*dlv2(j,k) + &
          a0_1_2_CH3CCl3(i0(j,k)), &
          a0_2_1_CH3CCl3(i0(j,k))*dlv2(j,k) + &
          a0_2_2_CH3CCl3(i0(j,k)),v3_du1(j,k))
        sig_CH3CCl3(1) = &
          p2(c1_CH3CCl3(1),c1_CH3CCl3(2), &
          c1_CH3CCl3(3),tnorm(j,k)) * &
          (p1(b1_1_CH3CCl3(i1(j,k)),a1_1_CH3CCl3(i1(j,k)), &
          v3_du1(j,k)) + &
          p1(b1_2_CH3CCl3(i1(j,k)),a1_2_CH3CCl3(i1(j,k)), &
          v3_du1(j,k)) * v2s_m(j,k))
        sig_CH3CCl3(2) = &
          p2(c2_CH3CCl3(1),c2_CH3CCl3(2),c2_CH3CCl3(3),tnorm(j,k))* &
          p1(b2_CH3CCl3(i2(j,k)), a2_CH3CCl3(i2(j,k)), &
          v3_du1(j,k))
        dj = 0. &
          + sig_CH3CCl3(0) * fint(j,k,0) &
          + sig_CH3CCl3(1) * fint(j,k,1) &
          + sig_CH3CCl3(2) * fint(j,k,2)

        jval_2d(ip_CH3CCl3)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,8)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_CH3CCl3

  ! **************************************************************************

  SUBROUTINE jval_cal_CFCl3

    ! CFCl_3 \TOHV\ \products

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_CFCl3

    ! T-const parameters:
    REAL, PARAMETER :: a0_1_1_CFCl3(dim58) = (/ &
      -3.3055E-20, -3.5734E-20, -3.8375E-20, -4.1124E-20, -4.4016E-20, -4.6672E-20, &
      -4.9470E-20, -5.2061E-20, -5.4706E-20, -5.7260E-20, -5.9625E-20, -6.2235E-20, &
      -7.1211E-20, -9.4658E-20, -9.1033E-20, -9.3807E-20, -1.0388E-19, -9.8362E-20, &
      -9.9471E-20, -1.0824E-19, -9.9203E-20, -9.7534E-20, -1.0356E-19, -9.0648E-20, &
      -8.5624E-20, -6.1257E-20, -4.6633E-20, -4.2135E-20, -3.8695E-20, -3.6583E-20, &
      -3.5846E-20, -3.6604E-20, -3.8660E-20, -4.1775E-20, -4.5577E-20, -4.9578E-20, &
      -5.3461E-20, -5.6843E-20, -5.9570E-20, -6.1540E-20, -6.2714E-20, -6.3146E-20, &
      -6.2853E-20, -6.1857E-20, -6.0117E-20, -5.7685E-20, -5.4484E-20, -5.0852E-20, &
      -4.6881E-20, -4.2858E-20, -3.8962E-20, -3.5217E-20, -3.1612E-20, -2.8073E-20, &
      -2.4583E-20, -2.1075E-20, -1.7397E-20, -1.4299E-20 /)
    REAL, PARAMETER :: a0_1_2_CFCl3(dim58) = (/ &
       2.7211E-18,  2.8395E-18,  2.9567E-18,  3.0793E-18,  3.2089E-18,  3.3284E-18, &
       3.4549E-18,  3.5725E-18,  3.6931E-18,  3.8101E-18,  3.9189E-18,  4.0395E-18, &
       4.4560E-18,  5.5486E-18,  5.3789E-18,  5.5093E-18,  5.9846E-18,  5.7232E-18, &
       5.7760E-18,  6.1950E-18,  5.7614E-18,  5.6809E-18,  5.9724E-18,  5.3451E-18, &
       5.0999E-18,  3.9059E-18,  3.1864E-18,  2.9642E-18,  2.7936E-18,  2.6884E-18, &
       2.6516E-18,  2.6896E-18,  2.7932E-18,  2.9509E-18,  3.1440E-18,  3.3481E-18, &
       3.5468E-18,  3.7207E-18,  3.8614E-18,  3.9635E-18,  4.0245E-18,  4.0470E-18, &
       4.0317E-18,  3.9793E-18,  3.8874E-18,  3.7585E-18,  3.5882E-18,  3.3943E-18, &
       3.1814E-18,  2.9650E-18,  2.7546E-18,  2.5516E-18,  2.3555E-18,  2.1623E-18, &
       1.9710E-18,  1.7781E-18,  1.5751E-18,  1.4035E-18 /)
    REAL, PARAMETER :: a0_2_1_CFCl3(dim58) = (/ &
      -1.5340E-22, -1.6936E-22, -1.8810E-22, -2.0783E-22, -2.2902E-22, -2.5358E-22, &
      -2.7819E-22, -3.0661E-22, -3.3554E-22, -3.6726E-22, -4.0274E-22, -4.3914E-22, &
      -3.7924E-22, -1.1653E-22, -2.5876E-22, -3.0447E-22, -2.5538E-22, -4.0578E-22, &
      -4.6164E-22, -4.2009E-22, -5.7661E-22, -6.3352E-22, -5.9324E-22, -7.4230E-22, &
      -7.9046E-22, -1.0157E-21, -1.1256E-21, -1.1208E-21, -1.0937E-21, -1.0424E-21, &
      -9.6661E-22, -8.6652E-22, -7.4651E-22, -6.1221E-22, -4.7270E-22, -3.3635E-22, &
      -2.1214E-22, -1.0600E-22, -2.1607E-23,  3.9877E-23,  7.9805E-23,  1.0171E-22, &
       1.1025E-22,  1.1026E-22,  1.0539E-22,  9.7985E-23,  8.8760E-23,  7.9086E-23, &
       6.9194E-23,  5.9754E-23,  5.1214E-23,  4.3463E-23,  3.6422E-23,  2.9969E-23, &
       2.4124E-23,  1.8877E-23,  1.4330E-23,  1.1298E-23 /)
    REAL, PARAMETER :: a0_2_2_CFCl3(dim58) = (/ &
       1.0282E-20,  1.0987E-20,  1.1819E-20,  1.2699E-20,  1.3648E-20,  1.4754E-20, &
       1.5866E-20,  1.7156E-20,  1.8476E-20,  1.9928E-20,  2.1560E-20,  2.3242E-20, &
       2.0463E-20,  8.2205E-21,  1.4877E-20,  1.7025E-20,  1.4708E-20,  2.1837E-20, &
       2.4496E-20,  2.2510E-20,  3.0023E-20,  3.2766E-20,  3.0816E-20,  3.8061E-20, &
       4.0411E-20,  5.1449E-20,  5.6853E-20,  5.6618E-20,  5.5275E-20,  5.2716E-20, &
       4.8929E-20,  4.3905E-20,  3.7856E-20,  3.1060E-20,  2.3974E-20,  1.7020E-20, &
       1.0660E-20,  5.2042E-21,  8.4979E-22, -2.3351E-21, -4.4113E-21, -5.5550E-21, &
      -6.0024E-21, -6.0030E-21, -5.7458E-21, -5.3532E-21, -4.8624E-21, -4.3458E-21, &
      -3.8156E-21, -3.3078E-21, -2.8466E-21, -2.4265E-21, -2.0435E-21, -1.6911E-21, &
      -1.3708E-21, -1.0822E-21, -8.3120E-22, -6.6324E-22 /)
    REAL, PARAMETER :: a1_1_CFCl3(dim55) = (/ &
       2.4602E-21,  2.4575E-21,  2.5583E-21,  2.4456E-21,  2.4539E-21,  2.2902E-21, &
       2.2540E-21,  2.0863E-21,  2.0380E-21,  1.8882E-21,  1.8426E-21,  1.7149E-21, &
       1.6764E-21,  1.5680E-21,  1.5367E-21,  1.4463E-21,  1.4201E-21,  1.3434E-21, &
       1.3187E-21,  1.2551E-21,  1.2342E-21,  1.1770E-21,  1.1598E-21,  1.1100E-21, &
       1.0942E-21,  1.0509E-21,  1.0373E-21,  9.9737E-22,  9.8689E-22,  9.5099E-22, &
       9.3928E-22,  9.0955E-22,  8.9927E-22,  8.7061E-22,  8.6145E-22,  8.3646E-22, &
       8.2838E-22,  8.0594E-22,  7.9744E-22,  7.7587E-22,  7.4182E-22,  6.8492E-22, &
       6.3805E-22,  5.9745E-22,  5.6193E-22,  5.3055E-22,  5.0122E-22,  4.7656E-22, &
       4.4597E-22,  4.2100E-22,  3.9753E-22,  3.7596E-22,  3.5514E-22,  3.3635E-22, &
       3.1828E-22 /)
    REAL, PARAMETER :: b1_1_CFCl3(dim55) = (/ &
       3.1429E-20,  3.1437E-20,  3.0883E-20,  3.1785E-20,  3.1698E-20,  3.3826E-20, &
       3.4386E-20,  3.7405E-20,  3.8395E-20,  4.1840E-20,  4.3004E-20,  4.6580E-20, &
       4.7752E-20,  5.1332E-20,  5.2443E-20,  5.5877E-20,  5.6940E-20,  6.0236E-20, &
       6.1360E-20,  6.4412E-20,  6.5470E-20,  6.8498E-20,  6.9453E-20,  7.2343E-20, &
       7.3302E-20,  7.6027E-20,  7.6920E-20,  7.9633E-20,  8.0371E-20,  8.2992E-20, &
       8.3876E-20,  8.6195E-20,  8.7022E-20,  8.9402E-20,  9.0185E-20,  9.2384E-20, &
       9.3115E-20,  9.5202E-20,  9.6014E-20,  9.8127E-20,  1.0155E-19,  1.0798E-19, &
       1.1386E-19,  1.1946E-19,  1.2481E-19,  1.2993E-19,  1.3507E-19,  1.3971E-19, &
       1.4584E-19,  1.5116E-19,  1.5645E-19,  1.6159E-19,  1.6680E-19,  1.7174E-19, &
       1.7672E-19 /)
    REAL, PARAMETER :: a1_2_CFCl3(dim55) = (/ &
      -9.2473E-24, -6.0775E-24, -6.8517E-24, -3.6638E-24, -4.2150E-24, -1.5982E-24, &
      -2.1576E-24, -2.3859E-25, -8.3332E-25,  5.1311E-25, -7.7570E-26,  8.8188E-25, &
       3.3365E-25,  1.0459E-24,  5.5647E-25,  1.0868E-24,  6.6601E-25,  1.0797E-24, &
       7.3586E-25,  1.0477E-24,  7.5338E-25,  1.0140E-24,  7.5574E-25,  9.6869E-25, &
       7.4873E-25,  9.1879E-25,  7.3178E-25,  8.7304E-25,  7.0419E-25,  8.2319E-25, &
       6.8861E-25,  7.8072E-25,  6.5381E-25,  7.3788E-25,  6.3199E-25,  6.9946E-25, &
       6.0131E-25,  6.5865E-25,  5.7892E-25,  6.3066E-25,  5.5007E-25,  4.9982E-25, &
       4.5000E-25,  4.1211E-25,  3.8329E-25,  3.5605E-25,  3.4183E-25,  3.1704E-25, &
       3.4134E-25,  3.4356E-25,  3.4581E-25,  3.4712E-25,  3.4822E-25,  3.4735E-25, &
       3.4559E-25 /)
    REAL, PARAMETER :: b1_2_CFCl3(dim55) = (/ &
      -1.6603E-22, -1.7554E-22, -1.7128E-22, -1.9679E-22, -1.9100E-22, -2.2502E-22, &
      -2.1635E-22, -2.5089E-22, -2.3870E-22, -2.6966E-22, -2.5460E-22, -2.8147E-22, &
      -2.6475E-22, -2.8825E-22, -2.7087E-22, -2.9103E-22, -2.7399E-22, -2.9177E-22, &
      -2.7613E-22, -2.9110E-22, -2.7623E-22, -2.9005E-22, -2.7571E-22, -2.8807E-22, &
      -2.7476E-22, -2.8547E-22, -2.7322E-22, -2.8283E-22, -2.7092E-22, -2.7961E-22, &
      -2.6945E-22, -2.7663E-22, -2.6642E-22, -2.7340E-22, -2.6434E-22, -2.7028E-22, &
      -2.6140E-22, -2.6673E-22, -2.5912E-22, -2.6419E-22, -2.5609E-22, -2.5041E-22, &
      -2.4416E-22, -2.3893E-22, -2.3459E-22, -2.3015E-22, -2.2765E-22, -2.2299E-22, &
      -2.2787E-22, -2.2834E-22, -2.2885E-22, -2.2916E-22, -2.2943E-22, -2.2921E-22, &
      -2.2872E-22 /)
    REAL, PARAMETER :: a2_CFCl3(dim55) = (/ &
      -1.0106E-24, -8.6252E-25, -6.8448E-25, -5.1072E-25, -3.6276E-25, -2.4816E-25, &
      -1.6508E-25, -1.0761E-25, -6.9148E-26, -4.3976E-26, -2.7764E-26, -1.7437E-26, &
      -1.0914E-26, -6.8120E-27, -4.2440E-27, -2.6404E-27, -1.6415E-27, -1.0196E-27, &
      -6.3308E-28, -3.9292E-28, -2.4379E-28, -1.5126E-28, -9.3832E-29, -5.8200E-29, &
      -3.6096E-29, -2.2390E-29, -1.3885E-29, -8.6112E-30, -5.3400E-30, -3.3120E-30, &
      -2.0535E-30, -1.2735E-30, -7.8972E-31, -4.8968E-31, -3.0364E-31, -1.8829E-31, &
      -1.1674E-31, -7.2384E-32, -4.4880E-32, -2.7828E-32, -8.2472E-33, -7.5515E-34, &
      -6.9096E-35, -6.3194E-36, -5.7774E-37, -5.2804E-38,  0.0000E+00,  0.0000E+00, &
       0.0000E+00,  0.0000E+00,  0.0000E+00,  0.0000E+00,  0.0000E+00,  0.0000E+00, &
       0.0000E+00 /)
    REAL, PARAMETER :: b2_CFCl3(dim55) = (/ &
       1.0853E-23,  1.0409E-23,  9.4298E-24,  8.0398E-24,  6.4862E-24,  4.9964E-24, &
       3.7087E-24,  2.6742E-24,  1.8857E-24,  1.3067E-24,  8.9333E-25,  6.0417E-25, &
       4.0521E-25,  2.6986E-25,  1.7870E-25,  1.1776E-25,  7.7303E-26,  5.0562E-26, &
       3.2975E-26,  2.1448E-26,  1.3917E-26,  9.0126E-27,  5.8254E-27,  3.7587E-27, &
       2.4214E-27,  1.5580E-27,  1.0008E-27,  6.4223E-28,  4.1161E-28,  2.6357E-28, &
       1.6855E-28,  1.0771E-28,  6.8769E-29,  4.3866E-29,  2.7959E-29,  1.7808E-29, &
       1.1333E-29,  7.2079E-30,  4.5813E-30,  2.9102E-30,  9.4232E-31,  9.5722E-32, &
       9.6222E-33,  9.5902E-34,  9.4898E-35,  9.3334E-36,  9.1316E-37,  8.8937E-38, &
       0.0000E+00,  0.0000E+00,  0.0000E+00,  0.0000E+00,  0.0000E+00,  0.0000E+00, &
       0.0000E+00 /)
    ! T-dep parameters:
    REAL, PARAMETER :: c0_1_1_CFCl3(dim58) = (/ &
      -1.7613E-02, -1.7613E-02, -1.7613E-02, -2.1865E-02, -2.5975E-02, -2.9831E-02, &
      -3.3085E-02, -3.5491E-02, -3.8260E-02, -3.9377E-02, -4.0847E-02, -4.0426E-02, &
      -3.9400E-02, -3.9775E-02, -3.8873E-02, -3.7936E-02, -3.6102E-02, -3.6113E-02, &
      -3.3122E-02, -3.2366E-02, -2.7252E-02, -2.1794E-02, -1.4621E-02, -1.8131E-03, &
       1.0291E-02,  2.7019E-02,  4.3990E-02,  6.0893E-02,  7.6173E-02,  8.8152E-02, &
       9.5196E-02,  9.6560E-02,  9.1255E-02,  7.9802E-02,  6.3952E-02,  4.4717E-02, &
       2.5105E-02,  7.4714E-03, -6.2155E-03, -1.3848E-02, -1.4241E-02, -6.9197E-03, &
       7.1030E-03,  2.5284E-02,  4.3592E-02,  5.8244E-02,  6.6856E-02,  6.9407E-02, &
       6.8038E-02,  6.6924E-02,  6.9944E-02,  7.9979E-02,  9.7297E-02,  1.1873E-01, &
       1.3837E-01,  1.5366E-01,  1.6983E-01,  1.9283E-01 /)
    REAL, PARAMETER :: c0_1_2_CFCl3(dim58) = (/ &
       8.3404E-01,  8.3404E-01,  8.3404E-01,  1.0237E+00,  1.2078E+00,  1.3814E+00, &
       1.5284E+00,  1.6377E+00,  1.7639E+00,  1.8151E+00,  1.8827E+00,  1.8632E+00, &
       1.8157E+00,  1.8331E+00,  1.7909E+00,  1.7469E+00,  1.6603E+00,  1.6608E+00, &
       1.5185E+00,  1.4823E+00,  1.2369E+00,  9.7377E-01,  6.2658E-01,  4.1369E-03, &
      -5.8653E-01, -1.4062E+00, -2.2412E+00, -3.0762E+00, -3.8341E+00, -4.4306E+00, &
      -4.7828E+00, -4.8513E+00, -4.5840E+00, -4.0044E+00, -3.1993E+00, -2.2183E+00, &
      -1.2141E+00, -3.0775E-01,  3.9849E-01,  7.9388E-01,  8.1427E-01,  4.3212E-01, &
      -3.0267E-01, -1.2590E+00, -2.2257E+00, -3.0022E+00, -3.4604E+00, -3.5966E+00, &
      -3.5232E+00, -3.4633E+00, -3.6264E+00, -4.1703E+00, -5.1124E+00, -6.2827E+00, &
      -7.3589E+00, -8.1999E+00, -9.0922E+00, -1.0367E+01 /)
    REAL, PARAMETER :: c0_2_1_CFCl3(dim58) = (/ &
       7.4250E-04,  7.4250E-04,  7.4250E-04, -5.4514E-03, -4.3372E-03, -6.2590E-03, &
      -4.4403E-03, -9.0716E-03, -9.7198E-04, -5.1533E-03,  3.7212E-03,  3.5981E-03, &
       1.0666E-02,  1.1303E-02,  2.1541E-02,  2.7774E-02,  2.6688E-02,  3.5173E-02, &
       4.7068E-02,  4.3685E-02,  5.4482E-02,  5.3411E-02,  7.0863E-02,  6.3280E-02, &
       6.4301E-02,  5.6739E-02,  4.6675E-02,  2.9115E-02,  8.5887E-03, -1.3598E-02, &
      -3.2688E-02, -4.6851E-02, -5.6500E-02, -6.1129E-02, -6.2015E-02, -6.0565E-02, &
      -5.6161E-02, -4.8828E-02, -3.4738E-02, -1.6446E-02,  7.6624E-03,  3.1031E-02, &
       4.4293E-02,  4.8796E-02,  4.0908E-02,  2.9887E-02,  2.1514E-02,  2.1527E-02, &
       2.6617E-02,  3.1659E-02,  2.6596E-02,  2.5174E-03, -4.4073E-02, -9.6112E-02, &
      -1.3735E-01, -1.3148E-01, -7.8284E-02, -5.9803E-03 /)
    REAL, PARAMETER :: c0_2_2_CFCl3(dim58) = (/ &
      -1.8691E-02, -1.8691E-02, -1.8691E-02,  2.5756E-01,  2.0764E-01,  2.9412E-01, &
       2.1192E-01,  4.2218E-01,  5.2835E-02,  2.4434E-01, -1.6389E-01, -1.5820E-01, &
      -4.8614E-01, -5.1585E-01, -9.9497E-01, -1.2879E+00, -1.2367E+00, -1.6388E+00, &
      -2.2051E+00, -2.0434E+00, -2.5616E+00, -2.5100E+00, -3.3547E+00, -2.9861E+00, &
      -3.0360E+00, -2.6654E+00, -2.1702E+00, -1.3028E+00, -2.8470E-01,  8.2021E-01, &
       1.7747E+00,  2.4857E+00,  2.9720E+00,  3.2062E+00,  3.2512E+00,  3.1773E+00, &
       2.9518E+00,  2.5749E+00,  1.8478E+00,  9.0029E-01, -3.5333E-01, -1.5732E+00, &
      -2.2681E+00, -2.5049E+00, -2.0885E+00, -1.5043E+00, -1.0589E+00, -1.0596E+00, &
      -1.3324E+00, -1.6037E+00, -1.3303E+00, -2.5227E-02,  2.5093E+00,  5.3506E+00, &
       7.6103E+00,  7.2877E+00,  4.3512E+00,  3.4557E-01 /)
    REAL, PARAMETER :: c1_CFCl3(3) = (/  1.0000E+00,  5.6999E-01,  1.6426E-01 /)
    REAL, PARAMETER :: c2_CFCl3(3) = (/  9.9990E-01,  1.3503E+00,  9.0204E-01 /)

    jval_2d(ip_CFCl3)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_CFCl3(0) = &
          p2(1.,c0_1_1_CFCl3(i0(j,k))*dlv2(j,k) + &
          c0_1_2_CFCl3(i0(j,k)), &
          c0_2_1_CFCl3(i0(j,k))*dlv2(j,k) + &
          c0_2_2_CFCl3(i0(j,k)), tnorm_sr(j,k)) * &
          p1(a0_1_1_CFCl3(i0(j,k))*dlv2(j,k) + &
          a0_1_2_CFCl3(i0(j,k)), &
          a0_2_1_CFCl3(i0(j,k))*dlv2(j,k) + &
          a0_2_2_CFCl3(i0(j,k)),v3_du1(j,k))
        sig_CFCl3(1) = &
          p2(c1_CFCl3(1),c1_CFCl3(2), &
          c1_CFCl3(3),tnorm(j,k)) * &
          (p1(b1_1_CFCl3(i1(j,k)),a1_1_CFCl3(i1(j,k)), &
          v3_du1(j,k)) + &
          p1(b1_2_CFCl3(i1(j,k)),a1_2_CFCl3(i1(j,k)), &
          v3_du1(j,k)) * v2s_m(j,k))
        sig_CFCl3(2) = &
          p2(c2_CFCl3(1),c2_CFCl3(2),c2_CFCl3(3),tnorm(j,k))* &
          p1(b2_CFCl3(i2(j,k)), a2_CFCl3(i2(j,k)), &
          v3_du1(j,k))
        dj = 0. &
          + sig_CFCl3(0) * fint(j,k,0) &
          + sig_CFCl3(1) * fint(j,k,1) &
          + sig_CFCl3(2) * fint(j,k,2)

        jval_2d(ip_CFCl3)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,8)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_CFCl3

  ! **************************************************************************

  SUBROUTINE jval_cal_CF2Cl2

    ! CF_2Cl_2 \TOHV\ \products

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_CF2Cl2

    ! T-const parameters:
    REAL, PARAMETER :: a0_1_1_CF2Cl2(dim58) = (/ &
      -2.3417E-20, -2.5185E-20, -2.6973E-20, -2.8782E-20, -3.0599E-20, -3.2359E-20, &
      -3.4077E-20, -3.5712E-20, -3.7267E-20, -3.8754E-20, -4.0138E-20, -4.1447E-20, &
      -4.6829E-20, -6.0958E-20, -5.8375E-20, -5.9710E-20, -6.5357E-20, -6.1364E-20, &
      -6.1364E-20, -6.5761E-20, -5.9396E-20, -5.7204E-20, -5.9714E-20, -5.0708E-20, &
      -4.6464E-20, -3.0882E-20, -2.1267E-20, -1.7748E-20, -1.4969E-20, -1.3045E-20, &
      -1.2040E-20, -1.1964E-20, -1.2717E-20, -1.4154E-20, -1.6030E-20, -1.8059E-20, &
      -2.0001E-20, -2.1696E-20, -2.2954E-20, -2.3779E-20, -2.4154E-20, -2.4100E-20, &
      -2.3665E-20, -2.2910E-20, -2.1847E-20, -2.0528E-20, -1.8970E-20, -1.7296E-20, &
      -1.5578E-20, -1.3919E-20, -1.2379E-20, -1.0960E-20, -9.6421E-21, -8.3959E-21, &
      -7.2104E-21, -6.0751E-21, -4.9452E-21, -4.0390E-21 /)
    REAL, PARAMETER :: a0_1_2_CF2Cl2(dim58) = (/ &
       1.4401E-18,  1.5183E-18,  1.5976E-18,  1.6783E-18,  1.7597E-18,  1.8389E-18, &
       1.9166E-18,  1.9908E-18,  2.0617E-18,  2.1298E-18,  2.1935E-18,  2.2540E-18, &
       2.5037E-18,  3.1621E-18,  3.0412E-18,  3.1039E-18,  3.3705E-18,  3.1812E-18, &
       3.1812E-18,  3.3914E-18,  3.0859E-18,  2.9802E-18,  3.1017E-18,  2.6640E-18, &
       2.4569E-18,  1.6934E-18,  1.2204E-18,  1.0465E-18,  9.0867E-19,  8.1288E-19, &
       7.6260E-19,  7.5880E-19,  7.9677E-19,  8.6946E-19,  9.6476E-19,  1.0682E-18, &
       1.1677E-18,  1.2548E-18,  1.3197E-18,  1.3625E-18,  1.3819E-18,  1.3791E-18, &
       1.3563E-18,  1.3166E-18,  1.2605E-18,  1.1906E-18,  1.1077E-18,  1.0183E-18, &
       9.2621E-19,  8.3696E-19,  7.5380E-19,  6.7691E-19,  6.0520E-19,  5.3715E-19, &
       4.7219E-19,  4.0975E-19,  3.4738E-19,  2.9717E-19 /)
    REAL, PARAMETER :: a0_2_1_CF2Cl2(dim58) = (/ &
      -1.1593E-22, -1.2816E-22, -1.4183E-22, -1.5693E-22, -1.7323E-22, -1.9092E-22, &
      -2.0980E-22, -2.3006E-22, -2.5160E-22, -2.7468E-22, -2.9945E-22, -3.2637E-22, &
      -2.9278E-22, -1.3535E-22, -2.2705E-22, -2.5925E-22, -2.3365E-22, -3.3021E-22, &
      -3.6773E-22, -3.4635E-22, -4.4300E-22, -4.7825E-22, -4.5248E-22, -5.3870E-22, &
      -5.6184E-22, -6.8766E-22, -7.4246E-22, -7.2909E-22, -7.0273E-22, -6.6318E-22, &
      -6.1014E-22, -5.4444E-22, -4.6817E-22, -3.8473E-22, -2.9935E-22, -2.1696E-22, &
      -1.4286E-22, -8.0087E-23, -3.0893E-23,  4.5481E-24,  2.7327E-23,  3.9564E-23, &
       4.4196E-23,  4.4199E-23,  4.1675E-23,  3.7994E-23,  3.3730E-23,  2.9335E-23, &
       2.5056E-23,  2.1125E-23,  1.7655E-23,  1.4635E-23,  1.1979E-23,  9.6119E-24, &
       7.5369E-24,  5.7678E-24,  4.2921E-24,  3.3367E-24 /)
    REAL, PARAMETER :: a0_2_2_CF2Cl2(dim58) = (/ &
       7.7005E-21,  8.2412E-21,  8.8481E-21,  9.5213E-21,  1.0252E-20,  1.1048E-20, &
       1.1901E-20,  1.2821E-20,  1.3803E-20,  1.4860E-20,  1.6000E-20,  1.7244E-20, &
       1.5685E-20,  8.3487E-21,  1.2640E-20,  1.4154E-20,  1.2945E-20,  1.7522E-20, &
       1.9308E-20,  1.8286E-20,  2.2925E-20,  2.4624E-20,  2.3377E-20,  2.7567E-20, &
       2.8697E-20,  3.4862E-20,  3.7558E-20,  3.6898E-20,  3.5590E-20,  3.3621E-20, &
       3.0969E-20,  2.7670E-20,  2.3826E-20,  1.9604E-20,  1.5267E-20,  1.1065E-20, &
       7.2713E-21,  4.0445E-21,  1.5061E-21, -3.2973E-22, -1.5143E-21, -2.1530E-21, &
      -2.3957E-21, -2.3959E-21, -2.2626E-21, -2.0675E-21, -1.8407E-21, -1.6060E-21, &
      -1.3766E-21, -1.1651E-21, -9.7778E-22, -8.1406E-22, -6.6960E-22, -5.4034E-22, &
      -4.2663E-22, -3.2934E-22, -2.4788E-22, -1.9495E-22 /)
    REAL, PARAMETER :: a1_1_CF2Cl2(dim55) = (/ &
       1.0758E-22,  1.0900E-22,  1.1709E-22,  1.1333E-22,  1.1750E-22,  1.1077E-22, &
       1.1274E-22,  1.0511E-22,  1.0620E-22,  9.8769E-23,  9.9686E-23,  9.2835E-23, &
       9.3818E-23,  8.7608E-23,  8.8717E-23,  8.3069E-23,  8.4297E-23,  7.9121E-23, &
       8.0440E-23,  7.5647E-23,  7.7019E-23,  7.2572E-23,  7.3998E-23,  6.9838E-23, &
       7.1255E-23,  6.7372E-23,  6.8822E-23,  6.5130E-23,  6.6570E-23,  6.3096E-23, &
       6.4557E-23,  6.1239E-23,  6.2705E-23,  5.9535E-23,  6.0977E-23,  5.7973E-23, &
       5.9400E-23,  5.6527E-23,  5.7932E-23,  5.5174E-23,  5.4512E-23,  5.1324E-23, &
       4.9200E-23,  4.6675E-23,  4.4986E-23,  4.2865E-23,  4.1370E-23,  3.9561E-23, &
       3.8277E-23,  3.6532E-23,  3.4852E-23,  3.3282E-23,  3.1729E-23,  3.0311E-23, &
       2.8944E-23 /)
    REAL, PARAMETER :: b1_1_CF2Cl2(dim55) = (/ &
       1.1994E-21,  1.1951E-21,  1.1506E-21,  1.1807E-21,  1.1369E-21,  1.2245E-21, &
       1.1938E-21,  1.3313E-21,  1.3089E-21,  1.4798E-21,  1.4564E-21,  1.6482E-21, &
       1.6182E-21,  1.8232E-21,  1.7838E-21,  1.9984E-21,  1.9487E-21,  2.1713E-21, &
       2.1113E-21,  2.3413E-21,  2.2720E-21,  2.5077E-21,  2.4286E-21,  2.6698E-21, &
       2.5842E-21,  2.8288E-21,  2.7338E-21,  2.9848E-21,  2.8833E-21,  3.1369E-21, &
       3.0266E-21,  3.2855E-21,  3.1674E-21,  3.4305E-21,  3.3072E-21,  3.5716E-21, &
       3.4425E-21,  3.7097E-21,  3.5754E-21,  3.8458E-21,  3.9123E-21,  4.2725E-21, &
       4.5390E-21,  4.8875E-21,  5.1417E-21,  5.4875E-21,  5.7498E-21,  6.0899E-21, &
       6.3473E-21,  6.7190E-21,  7.0978E-21,  7.4716E-21,  7.8606E-21,  8.2334E-21, &
       8.6101E-21 /)
    REAL, PARAMETER :: a1_2_CF2Cl2(dim55) = (/ &
      -4.9262E-25, -3.4419E-25, -4.1565E-25, -2.5143E-25, -3.1166E-25, -1.6045E-25, &
      -2.1879E-25, -9.2870E-26, -1.5089E-25, -4.8816E-26, -1.0554E-25, -2.1438E-26, &
      -7.5653E-26, -4.9931E-27, -5.5422E-26,  5.3287E-27, -4.1305E-26,  1.1920E-26, &
      -3.1032E-26,  1.6308E-26, -2.3245E-26,  1.9232E-26, -1.7387E-26,  2.0997E-26, &
      -1.2617E-26,  2.2159E-26, -9.1502E-27,  2.2858E-26, -6.1322E-27,  2.3180E-26, &
      -3.9662E-27,  2.3241E-26, -2.1320E-27,  2.3102E-26, -5.2503E-28,  2.2836E-26, &
       6.5243E-28,  2.2485E-26,  1.7478E-27,  2.2114E-26,  1.0657E-26,  1.4317E-26, &
       1.1697E-26,  1.4366E-26,  1.2442E-26,  1.4446E-26,  1.3296E-26,  1.4633E-26, &
       1.3393E-26,  1.5255E-26,  1.6963E-26,  1.8318E-26,  1.9673E-26,  2.0590E-26, &
       2.1396E-26 /)
    REAL, PARAMETER :: b1_2_CF2Cl2(dim55) = (/ &
      -7.3279E-24, -7.7732E-24, -7.3802E-24, -8.6939E-24, -8.0615E-24, -1.0027E-23, &
      -9.1230E-24, -1.1390E-23, -1.0200E-23, -1.2548E-23, -1.1101E-23, -1.3456E-23, &
      -1.1803E-23, -1.4134E-23, -1.2344E-23, -1.4653E-23, -1.2764E-23, -1.5053E-23, &
      -1.3098E-23, -1.5371E-23, -1.3373E-23, -1.5625E-23, -1.3592E-23, -1.5819E-23, &
      -1.3785E-23, -1.5976E-23, -1.3925E-23, -1.6102E-23, -1.4058E-23, -1.6198E-23, &
      -1.4148E-23, -1.6270E-23, -1.4228E-23, -1.6322E-23, -1.4302E-23, -1.6358E-23, &
      -1.4350E-23, -1.6381E-23, -1.4400E-23, -1.6396E-23, -1.5245E-23, -1.5658E-23, &
      -1.5329E-23, -1.5698E-23, -1.5408E-23, -1.5735E-23, -1.5533E-23, -1.5784E-23, &
      -1.5536E-23, -1.5932E-23, -1.6317E-23, -1.6640E-23, -1.6979E-23, -1.7221E-23, &
      -1.7443E-23 /)
    ! T-dep parameters:
    REAL, PARAMETER :: c0_1_1_CF2Cl2(dim58) = (/ &
      -2.2415E-02, -2.2415E-02, -2.2415E-02, -2.9221E-02, -3.6333E-02, -4.2759E-02, &
      -4.9052E-02, -5.4153E-02, -5.7809E-02, -5.9986E-02, -6.1229E-02, -6.0912E-02, &
      -5.9796E-02, -5.7999E-02, -5.5747E-02, -5.2634E-02, -4.9705E-02, -4.5594E-02, &
      -4.0185E-02, -3.1716E-02, -2.0336E-02, -3.1083E-03,  2.0530E-02,  5.2333E-02, &
       9.1355E-02,  1.3711E-01,  1.8712E-01,  2.3834E-01,  2.8648E-01,  3.2636E-01, &
       3.5576E-01,  3.6925E-01,  3.6404E-01,  3.4054E-01,  2.9921E-01,  2.4786E-01, &
       1.8983E-01,  1.3514E-01,  8.8321E-02,  5.7513E-02,  4.6066E-02,  5.7617E-02, &
       8.9792E-02,  1.3357E-01,  1.7988E-01,  2.1685E-01,  2.3625E-01,  2.3923E-01, &
       2.3056E-01,  2.2098E-01,  2.2066E-01,  2.3686E-01,  2.7086E-01,  3.1428E-01, &
       3.5400E-01,  3.8245E-01,  4.1458E-01,  4.6471E-01 /)
    REAL, PARAMETER :: c0_1_2_CF2Cl2(dim58) = (/ &
       9.8138E-01,  9.8138E-01,  9.8138E-01,  1.2849E+00,  1.6035E+00,  1.8927E+00, &
       2.1771E+00,  2.4087E+00,  2.5754E+00,  2.6752E+00,  2.7323E+00,  2.7177E+00, &
       2.6659E+00,  2.5821E+00,  2.4768E+00,  2.3304E+00,  2.1922E+00,  1.9974E+00, &
       1.7399E+00,  1.3351E+00,  7.8882E-01, -4.1562E-02, -1.1856E+00, -2.7313E+00, &
      -4.6355E+00, -6.8777E+00, -9.3380E+00, -1.1868E+01, -1.4256E+01, -1.6242E+01, &
      -1.7712E+01, -1.8389E+01, -1.8126E+01, -1.6938E+01, -1.4838E+01, -1.2219E+01, &
      -9.2480E+00, -6.4369E+00, -4.0211E+00, -2.4253E+00, -1.8300E+00, -2.4330E+00, &
      -4.1189E+00, -6.4219E+00, -8.8671E+00, -1.0826E+01, -1.1858E+01, -1.2017E+01, &
      -1.1553E+01, -1.1038E+01, -1.1020E+01, -1.1898E+01, -1.3748E+01, -1.6119E+01, &
      -1.8295E+01, -1.9860E+01, -2.1634E+01, -2.4411E+01 /)
    REAL, PARAMETER :: c0_2_1_CF2Cl2(dim58) = (/ &
       1.5249E-02,  1.5249E-02,  1.5249E-02,  1.6905E-02,  1.7525E-02,  1.8765E-02, &
       2.1027E-02,  2.5025E-02,  3.1430E-02,  3.7910E-02,  4.5228E-02,  5.5410E-02, &
       6.5663E-02,  8.0207E-02,  9.4144E-02,  1.1044E-01,  1.2589E-01,  1.4524E-01, &
       1.6390E-01,  1.8227E-01,  2.0346E-01,  2.1695E-01,  2.3057E-01,  2.3791E-01, &
       2.2882E-01,  2.0820E-01,  1.7171E-01,  1.2162E-01,  5.4991E-02, -9.0289E-03, &
      -6.2844E-02, -1.0667E-01, -1.3738E-01, -1.4508E-01, -1.5355E-01, -1.6034E-01, &
      -1.5302E-01, -1.4883E-01, -1.1482E-01, -6.6638E-02,  4.3823E-03,  8.5172E-02, &
       1.4876E-01,  1.8362E-01,  1.8716E-01,  1.7124E-01,  1.5621E-01,  1.6302E-01, &
       1.8228E-01,  1.9680E-01,  1.9339E-01,  1.4814E-01,  6.0548E-02, -4.8034E-02, &
      -1.1425E-01, -7.5399E-02,  9.7272E-02,  3.2698E-01 /)
    REAL, PARAMETER :: c0_2_2_CF2Cl2(dim58) = (/ &
      -5.2775E-01, -5.2775E-01, -5.2775E-01, -6.0161E-01, -6.2938E-01, -6.8517E-01, &
      -7.8742E-01, -9.6893E-01, -1.2610E+00, -1.5578E+00, -1.8944E+00, -2.3648E+00, &
      -2.8406E+00, -3.5183E+00, -4.1705E+00, -4.9367E+00, -5.6657E+00, -6.5830E+00, &
      -7.4710E+00, -8.3490E+00, -9.3663E+00, -1.0017E+01, -1.0676E+01, -1.1032E+01, &
      -1.0589E+01, -9.5786E+00, -7.7830E+00, -5.3085E+00, -2.0039E+00,  1.1842E+00, &
       3.8750E+00,  6.0753E+00,  7.6229E+00,  8.0124E+00,  8.4427E+00,  8.7888E+00, &
       8.4141E+00,  8.1987E+00,  6.4438E+00,  3.9481E+00,  2.5508E-01, -3.9621E+00, &
      -7.2940E+00, -9.1276E+00, -9.3149E+00, -8.4707E+00, -7.6711E+00, -8.0351E+00, &
      -9.0676E+00, -9.8486E+00, -9.6646E+00, -7.2117E+00, -2.4468E+00,  3.4818E+00, &
       7.1105E+00,  4.9736E+00, -4.5579E+00, -1.7284E+01 /)
    REAL, PARAMETER :: c1_CF2Cl2(3) = (/  9.9929E-01,  2.2630E+00,  2.4705E+00 /)

    jval_2d(ip_CF2Cl2)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_CF2Cl2(0) = &
          p2(1.,c0_1_1_CF2Cl2(i0(j,k))*dlv2(j,k) + &
          c0_1_2_CF2Cl2(i0(j,k)), &
          c0_2_1_CF2Cl2(i0(j,k))*dlv2(j,k) + &
          c0_2_2_CF2Cl2(i0(j,k)), tnorm_sr(j,k)) * &
          p1(a0_1_1_CF2Cl2(i0(j,k))*dlv2(j,k) + &
          a0_1_2_CF2Cl2(i0(j,k)), &
          a0_2_1_CF2Cl2(i0(j,k))*dlv2(j,k) + &
          a0_2_2_CF2Cl2(i0(j,k)),v3_du1(j,k))
        sig_CF2Cl2(1) = &
          p2(c1_CF2Cl2(1),c1_CF2Cl2(2), &
          c1_CF2Cl2(3),tnorm(j,k)) * &
          (p1(b1_1_CF2Cl2(i1(j,k)),a1_1_CF2Cl2(i1(j,k)), &
          v3_du1(j,k)) + &
          p1(b1_2_CF2Cl2(i1(j,k)),a1_2_CF2Cl2(i1(j,k)), &
          v3_du1(j,k)) * v2s_m(j,k))
        dj = 0. &
          + sig_CF2Cl2(0) * fint(j,k,0) &
          + sig_CF2Cl2(1) * fint(j,k,1)

        jval_2d(ip_CF2Cl2)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,8)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_CF2Cl2

  ! **************************************************************************

  SUBROUTINE jval_cal_CH3Br

    ! CH_3Br \TOHV\ \products

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_CH3Br

    ! T-const parameters:
    REAL, PARAMETER :: a0_1_1_CH3Br(dim58) = (/ &
      -4.0518E-21, -4.3577E-21, -4.6922E-21, -5.0377E-21, -5.3261E-21, -5.5426E-21, &
      -5.6474E-21, -5.6105E-21, -5.4396E-21, -5.1442E-21, -4.7405E-21, -4.2771E-21, &
      -3.3714E-21, -1.4836E-21, -1.0086E-21, -1.3149E-23,  1.8005E-21,  2.7202E-21, &
       4.5109E-21,  7.6125E-21,  9.3268E-21,  1.2116E-20,  1.6363E-20,  1.7716E-20, &
       1.9745E-20,  1.7032E-20,  1.4803E-20,  1.3896E-20,  1.2793E-20,  1.1807E-20, &
       1.1175E-20,  1.1019E-20,  1.1353E-20,  1.2062E-20,  1.3024E-20,  1.4055E-20, &
       1.5056E-20,  1.5935E-20,  1.6615E-20,  1.7099E-20,  1.7348E-20,  1.7371E-20, &
       1.7199E-20,  1.6820E-20,  1.6219E-20,  1.5426E-20,  1.4421E-20,  1.3298E-20, &
       1.2100E-20,  1.0929E-20,  9.7874E-21,  8.7399E-21,  7.7336E-21,  6.7534E-21, &
       5.8131E-21,  4.8905E-21,  3.9788E-21,  3.2393E-21 /)
    REAL, PARAMETER :: a0_1_2_CH3Br(dim58) = (/ &
       8.6676E-19,  8.8028E-19,  8.9513E-19,  9.1054E-19,  9.2345E-19,  9.3320E-19, &
       9.3794E-19,  9.3626E-19,  9.2847E-19,  9.1494E-19,  8.9637E-19,  8.7496E-19, &
       8.3294E-19,  7.4496E-19,  7.2273E-19,  6.7595E-19,  5.9034E-19,  5.4675E-19, &
       4.6151E-19,  3.1326E-19,  2.3097E-19,  9.6522E-20, -1.0903E-19, -1.7478E-19, &
      -2.7379E-19, -1.4087E-19, -3.1186E-20,  1.3630E-20,  6.8341E-20,  1.1741E-19, &
       1.4901E-19,  1.5685E-19,  1.4003E-19,  1.0414E-19,  5.5254E-20,  2.6781E-21, &
      -4.8553E-20, -9.3747E-20, -1.2880E-19, -1.5389E-19, -1.6682E-19, -1.6807E-19, &
      -1.5905E-19, -1.3911E-19, -1.0738E-19, -6.5343E-20, -1.1876E-20,  4.8096E-20, &
       1.1229E-19,  1.7533E-19,  2.3696E-19,  2.9373E-19,  3.4848E-19,  4.0200E-19, &
       4.5353E-19,  5.0427E-19,  5.5460E-19,  5.9556E-19 /)
    REAL, PARAMETER :: a0_2_1_CH3Br(dim58) = (/ &
      -4.1659E-23, -4.8178E-23, -5.6154E-23, -6.5126E-23, -7.4738E-23, -8.4207E-23, &
      -9.3091E-23, -1.0120E-22, -1.0820E-22, -1.1435E-22, -1.1998E-22, -1.2557E-22, &
      -1.3740E-22, -1.6358E-22, -1.6934E-22, -1.8280E-22, -2.0608E-22, -2.1498E-22, &
      -2.3008E-22, -2.5250E-22, -2.4756E-22, -2.4223E-22, -2.3878E-22, -1.9139E-22, &
      -1.4294E-22, -4.3680E-23,  4.6383E-23,  1.1296E-22,  1.6646E-22,  2.0135E-22, &
       2.1541E-22,  2.1018E-22,  1.8962E-22,  1.5909E-22,  1.2385E-22,  8.8063E-23, &
       5.5016E-23,  2.6474E-23,  3.7888E-24, -1.2854E-23, -2.3638E-23, -2.9427E-23, &
      -3.1631E-23, -3.1479E-23, -2.9961E-23, -2.7692E-23, -2.4943E-23, -2.2022E-23, &
      -1.9101E-23, -1.6380E-23, -1.3839E-23, -1.1657E-23, -9.6732E-24, -7.8051E-24, &
      -6.2334E-24, -4.7680E-24, -3.6042E-24, -2.7351E-24 /)
    REAL, PARAMETER :: a0_2_2_CH3Br(dim58) = (/ &
       2.3254E-21,  2.6135E-21,  2.9677E-21,  3.3678E-21,  3.7984E-21,  4.2245E-21, &
       4.6261E-21,  4.9941E-21,  5.3132E-21,  5.5949E-21,  5.8539E-21,  6.1125E-21, &
       6.6614E-21,  7.8812E-21,  8.1509E-21,  8.7836E-21,  9.8824E-21,  1.0304E-20, &
       1.1023E-20,  1.2095E-20,  1.1858E-20,  1.1600E-20,  1.1434E-20,  9.1303E-21, &
       6.7662E-21,  1.9023E-21, -2.5288E-21, -5.8177E-21, -8.4714E-21, -1.0209E-20, &
      -1.0912E-20, -1.0649E-20, -9.6132E-21, -8.0683E-21, -6.2780E-21, -4.4529E-21, &
      -2.7609E-21, -1.2938E-21, -1.2329E-22,  7.3881E-22,  1.2996E-21,  1.6018E-21, &
       1.7172E-21,  1.7092E-21,  1.6291E-21,  1.5089E-21,  1.3626E-21,  1.2066E-21, &
       1.0500E-21,  9.0366E-22,  7.6644E-22,  6.4820E-22,  5.4027E-22,  4.3827E-22, &
       3.5214E-22,  2.7154E-22,  2.0730E-22,  1.5915E-22 /)
    REAL, PARAMETER :: a1_1_CH3Br(dim55) = (/ &
       1.2015E-20,  1.1440E-20,  1.0953E-20,  1.0012E-20,  9.2114E-21,  8.2659E-21, &
       7.4397E-21,  6.6748E-21,  5.9627E-21,  5.4050E-21,  4.8294E-21,  4.4420E-21, &
       3.9814E-21,  3.7185E-21,  3.3434E-21,  3.1677E-21,  2.8580E-21,  2.7373E-21, &
       2.4766E-21,  2.3978E-21,  2.1719E-21,  2.1209E-21,  1.9242E-21,  1.8959E-21, &
       1.7165E-21,  1.7066E-21,  1.5476E-21,  1.5463E-21,  1.3997E-21,  1.4119E-21, &
       1.2756E-21,  1.2949E-21,  1.1709E-21,  1.1916E-21,  1.0781E-21,  1.1058E-21, &
       9.9673E-22,  1.0280E-21,  9.2696E-22,  9.5959E-22,  8.3612E-22,  7.3190E-22, &
       6.3051E-22,  5.6989E-22,  5.0111E-22,  4.6276E-22,  4.1158E-22,  3.8579E-22, &
       3.2821E-22,  3.0162E-22,  2.7798E-22,  2.5666E-22,  2.3728E-22,  2.1929E-22, &
       2.0343E-22 /)
    REAL, PARAMETER :: b1_1_CH3Br(dim55) = (/ &
       2.7503E-19,  2.7676E-19,  2.7943E-19,  2.8696E-19,  2.9537E-19,  3.0766E-19, &
       3.2046E-19,  3.3423E-19,  3.4883E-19,  3.6166E-19,  3.7633E-19,  3.8718E-19, &
       4.0123E-19,  4.0991E-19,  4.2322E-19,  4.2990E-19,  4.4244E-19,  4.4763E-19, &
       4.5950E-19,  4.6328E-19,  4.7468E-19,  4.7739E-19,  4.8831E-19,  4.8995E-19, &
       5.0080E-19,  5.0142E-19,  5.1184E-19,  5.1192E-19,  5.2226E-19,  5.2137E-19, &
       5.3166E-19,  5.3016E-19,  5.4014E-19,  5.3842E-19,  5.4812E-19,  5.4569E-19, &
       5.5556E-19,  5.5265E-19,  5.6230E-19,  5.5910E-19,  5.7151E-19,  5.8329E-19, &
       5.9601E-19,  6.0438E-19,  6.1473E-19,  6.2098E-19,  6.2996E-19,  6.3481E-19, &
       6.4635E-19,  6.5202E-19,  6.5735E-19,  6.6242E-19,  6.6728E-19,  6.7201E-19, &
       6.7638E-19 /)
    REAL, PARAMETER :: a1_2_CH3Br(dim55) = (/ &
      -2.0548E-23, -7.8524E-24, -4.6073E-24,  4.5489E-24,  7.2503E-24,  1.1674E-23, &
       1.3204E-23,  1.4043E-23,  1.4756E-23,  1.3623E-23,  1.4029E-23,  1.2106E-23, &
       1.2501E-23,  1.0376E-23,  1.0882E-23,  8.8111E-24,  9.3969E-24,  7.5186E-24, &
       8.1481E-24,  6.4450E-24,  7.1206E-24,  5.5745E-24,  6.2582E-24,  4.8435E-24, &
       5.5580E-24,  4.2489E-24,  4.9352E-24,  3.7586E-24,  4.4261E-24,  3.3268E-24, &
       3.9797E-24,  2.9654E-24,  3.5908E-24,  2.6710E-24,  3.2557E-24,  2.3855E-24, &
       2.9634E-24,  2.1615E-24,  2.7031E-24,  1.9577E-24,  2.0479E-24,  1.5658E-24, &
       1.3805E-24,  1.0832E-24,  9.9429E-25,  7.9730E-25,  7.5866E-25,  6.1798E-25, &
       7.0538E-25,  6.4004E-25,  5.8556E-25,  5.4004E-25,  5.0091E-25,  4.6792E-25, &
       4.3786E-25 /)
    REAL, PARAMETER :: b1_2_CH3Br(dim55) = (/ &
      -8.0890E-22, -8.4699E-22, -8.6484E-22, -9.3809E-22, -9.6645E-22, -1.0240E-21, &
      -1.0477E-21, -1.0628E-21, -1.0774E-21, -1.0513E-21, -1.0617E-21, -1.0078E-21, &
      -1.0199E-21, -9.4977E-22, -9.6774E-22, -8.8903E-22, -9.1276E-22, -8.3199E-22, &
      -8.6063E-22, -7.7888E-22, -8.1300E-22, -7.3106E-22, -7.6900E-22, -6.8695E-22, &
      -7.3018E-22, -6.4770E-22, -6.9266E-22, -6.1265E-22, -6.5971E-22, -5.7946E-22, &
      -6.2875E-22, -5.4964E-22, -5.9998E-22, -5.2364E-22, -5.7363E-22, -4.9705E-22, &
      -5.4936E-22, -4.7477E-22, -5.2649E-22, -4.5345E-22, -4.6252E-22, -4.0804E-22, &
      -3.8478E-22, -3.4376E-22, -3.3037E-22, -2.9826E-22, -2.9148E-22, -2.6503E-22, &
      -2.8256E-22, -2.6864E-22, -2.5635E-22, -2.4552E-22, -2.3572E-22, -2.2704E-22, &
      -2.1876E-22 /)
    REAL, PARAMETER :: a2_CH3Br(dim55) = (/ &
      -1.6576E-22, -1.4058E-22, -1.1103E-22, -8.2588E-23, -5.8584E-23, -4.0096E-23, &
      -2.6748E-23, -1.7542E-23, -1.1379E-23, -7.3408E-24, -4.7304E-24, -3.0568E-24, &
      -1.9884E-24, -1.3064E-24, -8.7160E-25, -5.9240E-25, -4.1200E-25, -2.9480E-25, &
      -2.1688E-25, -1.6508E-25, -1.2960E-25, -1.0476E-25, -8.7000E-26, -7.3880E-26, &
      -6.4000E-26, -5.6240E-26, -5.0040E-26, -4.5000E-26, -4.0720E-26, -3.7120E-26, &
      -3.4000E-26, -3.1200E-26, -2.8800E-26, -2.6560E-26, -2.4640E-26, -2.2840E-26, &
      -2.1200E-26, -1.9760E-26, -1.8360E-26, -1.7120E-26, -1.4000E-26, -9.9920E-27, &
      -7.2000E-27, -5.2000E-27, -3.7680E-27, -2.7280E-27, -1.9760E-27, -1.4320E-27, &
      -1.0400E-27, -7.5200E-28, -5.5200E-28, -3.9200E-28, -2.8800E-28, -2.0800E-28, &
      -1.5200E-28 /)
    REAL, PARAMETER :: b2_CH3Br(dim55) = (/ &
       1.7806E-21,  1.7051E-21,  1.5425E-21,  1.3150E-21,  1.0629E-21,  8.2258E-22, &
       6.1568E-22,  4.4998E-22,  3.2364E-22,  2.3076E-22,  1.6419E-22,  1.1733E-22, &
       8.4743E-23,  6.2237E-23,  4.6802E-23,  3.6192E-23,  2.8886E-23,  2.3846E-23, &
       2.0301E-23,  1.7815E-23,  1.6023E-23,  1.4706E-23,  1.3721E-23,  1.2960E-23, &
       1.2362E-23,  1.1873E-23,  1.1467E-23,  1.1124E-23,  1.0823E-23,  1.0560E-23, &
       1.0324E-23,  1.0106E-23,  9.9126E-24,  9.7267E-24,  9.5625E-24,  9.4041E-24, &
       9.2557E-24,  9.1218E-24,  8.9881E-24,  8.8666E-24,  8.5530E-24,  8.1001E-24, &
       7.7497E-24,  7.4737E-24,  7.2582E-24,  7.0887E-24,  6.9567E-24,  6.8544E-24, &
       6.7758E-24,  6.7145E-24,  6.6694E-24,  6.6313E-24,  6.6052E-24,  6.5842E-24, &
       6.5688E-24 /)

    jval_2d(ip_CH3Br)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_CH3Br(0) = &
          p1(a0_1_1_CH3Br(i0(j,k))*dlv2(j,k) + &
          a0_1_2_CH3Br(i0(j,k)), &
          a0_2_1_CH3Br(i0(j,k))*dlv2(j,k) + &
          a0_2_2_CH3Br(i0(j,k)),v3_du1(j,k))
        sig_CH3Br(1) = &
          (p1(b1_1_CH3Br(i1(j,k)),a1_1_CH3Br(i1(j,k)), &
          v3_du1(j,k)) + &
          p1(b1_2_CH3Br(i1(j,k)),a1_2_CH3Br(i1(j,k)), &
          v3_du1(j,k)) * v2s_m(j,k))
        sig_CH3Br(2) = &
          p1(b2_CH3Br(i2(j,k)), a2_CH3Br(i2(j,k)), &
          v3_du1(j,k))
        dj = 0. &
          + sig_CH3Br(0) * fint(j,k,0) &
          + sig_CH3Br(1) * fint(j,k,1) &
          + sig_CH3Br(2) * fint(j,k,2)

        jval_2d(ip_CH3Br)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,8)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_CH3Br

  ! **************************************************************************

  SUBROUTINE jval_cal_CF2ClBr

    ! CF_2ClBr \TOHV\ \products

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_CF2ClBr

    ! T-const parameters:
    REAL, PARAMETER :: a0_1_1_CF2ClBr(dim58) = (/ &
       6.9412E-21,  7.5930E-21,  8.2706E-21,  8.9682E-21,  9.7017E-21,  1.0453E-20, &
       1.1232E-20,  1.2033E-20,  1.2854E-20,  1.3707E-20,  1.4583E-20,  1.5483E-20, &
       1.8436E-20,  2.5754E-20,  2.4997E-20,  2.6257E-20,  2.9832E-20,  2.8735E-20, &
       2.9795E-20,  3.3345E-20,  3.1557E-20,  3.2069E-20,  3.5231E-20,  3.2328E-20, &
       3.1933E-20,  2.5101E-20,  2.1220E-20,  2.0519E-20,  2.0084E-20,  1.9982E-20, &
       2.0281E-20,  2.1013E-20,  2.2142E-20,  2.3573E-20,  2.5201E-20,  2.6881E-20, &
       2.8516E-20,  2.9981E-20,  3.1236E-20,  3.2257E-20,  3.3002E-20,  3.3499E-20, &
       3.3700E-20,  3.3584E-20,  3.3114E-20,  3.2247E-20,  3.0972E-20,  2.9349E-20, &
       2.7529E-20,  2.5586E-20,  2.3660E-20,  2.1701E-20,  1.9811E-20,  1.7887E-20, &
       1.5891E-20,  1.3862E-20,  1.1604E-20,  9.5792E-21 /)
    REAL, PARAMETER :: a0_1_2_CF2ClBr(dim58) = (/ &
       4.5722E-19,  4.2841E-19,  3.9832E-19,  3.6721E-19,  3.3435E-19,  3.0054E-19, &
       2.6534E-19,  2.2895E-19,  1.9152E-19,  1.5244E-19,  1.1215E-19,  7.0591E-20, &
      -6.6415E-20, -4.0743E-19, -3.7204E-19, -4.3123E-19, -5.9999E-19, -5.4798E-19, &
      -5.9847E-19, -7.6815E-19, -6.8230E-19, -7.0700E-19, -8.6003E-19, -7.1894E-19, &
      -6.9966E-19, -3.6491E-19, -1.7397E-19, -1.3932E-19, -1.1775E-19, -1.1266E-19, &
      -1.2763E-19, -1.6437E-19, -2.2129E-19, -2.9369E-19, -3.7635E-19, -4.6206E-19, &
      -5.4578E-19, -6.2106E-19, -6.8584E-19, -7.3872E-19, -7.7746E-19, -8.0338E-19, &
      -8.1394E-19, -8.0785E-19, -7.8304E-19, -7.3704E-19, -6.6923E-19, -5.8254E-19, &
      -4.8499E-19, -3.8050E-19, -2.7650E-19, -1.7032E-19, -6.7463E-20,  3.7549E-20, &
       1.4695E-19,  2.5855E-19,  3.8316E-19,  4.9536E-19 /)
    REAL, PARAMETER :: a0_2_1_CF2ClBr(dim58) = (/ &
       2.4302E-23,  2.7086E-23,  2.9988E-23,  3.3315E-23,  3.6929E-23,  4.0877E-23, &
       4.5312E-23,  5.0227E-23,  5.5824E-23,  6.2032E-23,  6.8902E-23,  7.6687E-23, &
       5.4700E-23, -2.8250E-23,  1.0351E-23,  1.9763E-23, -6.3599E-26,  4.1605E-23, &
       5.4549E-23,  3.8368E-23,  8.4779E-23,  1.0252E-22,  9.0929E-23,  1.4267E-22, &
       1.6450E-22,  2.4706E-22,  2.9438E-22,  3.0480E-22,  3.0717E-22,  3.0036E-22, &
       2.8364E-22,  2.5730E-22,  2.2268E-22,  1.8206E-22,  1.3855E-22,  9.4989E-23, &
       5.4528E-23,  1.9311E-23, -9.1903E-24, -3.0390E-23, -4.4440E-23, -5.2410E-23, &
      -5.5639E-23, -5.5699E-23, -5.3840E-23, -5.0723E-23, -4.6932E-23, -4.2114E-23, &
      -3.7704E-23, -3.2988E-23, -2.8804E-23, -2.5070E-23, -2.1364E-23, -1.7990E-23, &
      -1.4546E-23, -1.1912E-23, -9.1409E-24, -7.1488E-24 /)
    REAL, PARAMETER :: a0_2_2_CF2ClBr(dim58) = (/ &
      -1.7223E-21, -1.8453E-21, -1.9742E-21, -2.1226E-21, -2.2845E-21, -2.4621E-21, &
      -2.6626E-21, -2.8857E-21, -3.1410E-21, -3.4253E-21, -3.7413E-21, -4.1010E-21, &
      -3.0807E-21,  7.8468E-22, -1.0218E-21, -1.4642E-21, -5.2838E-22, -2.5035E-21, &
      -3.1196E-21, -2.3462E-21, -4.5739E-21, -5.4288E-21, -4.8680E-21, -7.3826E-21, &
      -8.4479E-21, -1.2493E-20, -1.4821E-20, -1.5336E-20, -1.5454E-20, -1.5115E-20, &
      -1.4279E-20, -1.2956E-20, -1.1211E-20, -9.1560E-21, -6.9460E-21, -4.7242E-21, &
      -2.6526E-21, -8.4249E-22,  6.2818E-22,  1.7263E-21,  2.4569E-21,  2.8730E-21, &
       3.0421E-21,  3.0453E-21,  2.9471E-21,  2.7819E-21,  2.5803E-21,  2.3230E-21, &
       2.0866E-21,  1.8329E-21,  1.6069E-21,  1.4046E-21,  1.2030E-21,  1.0187E-21, &
       8.3004E-22,  6.8516E-22,  5.3219E-22,  4.2183E-22 /)
    REAL, PARAMETER :: a1_1_CF2ClBr(dim55) = (/ &
       1.9291E-20,  1.8146E-20,  1.7047E-20,  1.5397E-20,  1.3860E-20,  1.2298E-20, &
       1.0809E-20,  9.6023E-21,  8.3554E-21,  7.5195E-21,  6.5310E-21,  5.9821E-21, &
       5.2059E-21,  4.8553E-21,  4.2323E-21,  4.0176E-21,  3.5093E-21,  3.3728E-21, &
       2.9640E-21,  2.8667E-21,  2.5017E-21,  2.5045E-21,  2.1558E-21,  2.1649E-21, &
       1.8871E-21,  1.8991E-21,  1.6418E-21,  1.6827E-21,  1.4625E-21,  1.4976E-21, &
       1.2810E-21,  1.3362E-21,  1.1512E-21,  1.2046E-21,  1.0373E-21,  1.0960E-21, &
       9.1873E-22,  9.9492E-22,  8.4187E-22,  9.1089E-22,  7.3833E-22,  6.1562E-22, &
       4.9255E-22,  4.2930E-22,  3.4975E-22,  3.1345E-22,  2.5569E-22,  2.3652E-22, &
       1.6855E-22,  1.4944E-22,  1.3008E-22,  1.1344E-22,  9.9788E-23,  8.6674E-23, &
       7.6199E-23 /)
    REAL, PARAMETER :: b1_1_CF2ClBr(dim55) = (/ &
       5.8322E-19,  5.8665E-19,  5.9270E-19,  6.0590E-19,  6.2204E-19,  6.4235E-19, &
       6.6542E-19,  6.8714E-19,  7.1270E-19,  7.3193E-19,  7.5714E-19,  7.7250E-19, &
       7.9618E-19,  8.0775E-19,  8.2986E-19,  8.3802E-19,  8.5861E-19,  8.6448E-19, &
       8.8308E-19,  8.8775E-19,  9.0618E-19,  9.0603E-19,  9.2539E-19,  9.2486E-19, &
       9.4167E-19,  9.4091E-19,  9.5777E-19,  9.5498E-19,  9.7051E-19,  9.6794E-19, &
       9.8430E-19,  9.7999E-19,  9.9488E-19,  9.9045E-19,  1.0048E-18,  9.9959E-19, &
       1.0156E-18,  1.0085E-18,  1.0232E-18,  1.0164E-18,  1.0337E-18,  1.0476E-18, &
       1.0631E-18,  1.0718E-18,  1.0838E-18,  1.0897E-18,  1.0998E-18,  1.1034E-18, &
       1.1170E-18,  1.1211E-18,  1.1255E-18,  1.1294E-18,  1.1329E-18,  1.1363E-18, &
       1.1392E-18 /)
    REAL, PARAMETER :: a1_2_CF2ClBr(dim55) = (/ &
      -2.4400E-23, -5.0809E-24,  1.8400E-24,  1.4378E-23,  1.9863E-23,  2.4333E-23, &
       2.7534E-23,  2.6395E-23,  2.8164E-23,  2.4271E-23,  2.5503E-23,  2.0802E-23, &
       2.1937E-23,  1.7345E-23,  1.8575E-23,  1.4364E-23,  1.5680E-23,  1.2004E-23, &
       1.3265E-23,  1.0163E-23,  1.1545E-23,  8.4172E-24,  9.9746E-24,  7.3166E-24, &
       8.6247E-24,  6.3423E-24,  7.6419E-24,  5.5098E-24,  6.6734E-24,  4.8397E-24, &
       6.0218E-24,  4.2589E-24,  5.3792E-24,  3.7661E-24,  4.7497E-24,  3.3455E-24, &
       4.3930E-24,  2.9444E-24,  3.9232E-24,  2.6430E-24,  2.8669E-24,  2.1245E-24, &
       1.8479E-24,  1.4017E-24,  1.2688E-24,  9.8253E-25,  9.2555E-25,  7.2083E-25, &
       8.3673E-25,  7.2659E-25,  6.3939E-25,  5.6720E-25,  5.0405E-25,  4.5257E-25, &
       4.0643E-25 /)
    REAL, PARAMETER :: b1_2_CF2ClBr(dim55) = (/ &
      -1.3003E-21, -1.3583E-21, -1.3964E-21, -1.4967E-21, -1.5542E-21, -1.6124E-21, &
      -1.6620E-21, -1.6415E-21, -1.6777E-21, -1.5882E-21, -1.6196E-21, -1.4880E-21, &
      -1.5226E-21, -1.3711E-21, -1.4147E-21, -1.2547E-21, -1.3080E-21, -1.1499E-21, &
      -1.2073E-21, -1.0584E-21, -1.1282E-21, -9.6244E-22, -1.0489E-21, -8.9471E-22, &
      -9.7386E-22, -8.3006E-22, -9.1519E-22, -7.7020E-22, -8.5224E-22, -7.1838E-22, &
      -8.0763E-22, -6.7012E-22, -7.6030E-22, -6.2641E-22, -7.1051E-22, -5.8694E-22, &
      -6.8174E-22, -5.4702E-22, -6.4049E-22, -5.1504E-22, -5.3754E-22, -4.5365E-22, &
      -4.1894E-22, -3.5736E-22, -3.3736E-22, -2.9070E-22, -2.8070E-22, -2.4221E-22, &
      -2.6545E-22, -2.4199E-22, -2.2232E-22, -2.0514E-22, -1.8932E-22, -1.7579E-22, &
      -1.6307E-22 /)
    REAL, PARAMETER :: a2_CF2ClBr(dim55) = (/ &
      -1.0481E-21, -8.8496E-22, -6.9788E-22, -5.1988E-22, -3.7048E-22, -2.5580E-22, &
      -1.7296E-22, -1.1558E-22, -7.6948E-23, -5.1364E-23, -3.4584E-23, -2.3604E-23, &
      -1.6404E-23, -1.1664E-23, -8.5040E-24, -6.3760E-24, -4.9080E-24, -3.8920E-24, &
      -3.1560E-24, -2.6240E-24, -2.2240E-24, -1.9160E-24, -1.6760E-24, -1.4800E-24, &
      -1.3200E-24, -1.1880E-24, -1.0760E-24, -9.8000E-25, -8.9600E-25, -8.2000E-25, &
      -7.5600E-25, -7.0000E-25, -6.4400E-25, -5.9600E-25, -5.5600E-25, -5.1600E-25, &
      -4.7600E-25, -4.4800E-25, -4.1600E-25, -3.8800E-25, -3.1760E-25, -2.2720E-25, &
      -1.6400E-25, -1.1840E-25, -8.6400E-26, -6.1600E-26, -4.5600E-26, -3.2800E-26, &
      -2.3200E-26, -1.7600E-26, -1.2800E-26, -8.8000E-27, -6.4000E-27, -4.8000E-27, &
      -3.2000E-27 /)
    REAL, PARAMETER :: b2_CF2ClBr(dim55) = (/ &
       1.1658E-20,  1.1169E-20,  1.0140E-20,  8.7157E-21,  7.1470E-21,  5.6562E-21, &
       4.3722E-21,  3.3393E-21,  2.5474E-21,  1.9590E-21,  1.5311E-21,  1.2236E-21, &
       1.0040E-21,  8.4761E-22,  7.3543E-22,  6.5457E-22,  5.9511E-22,  5.5143E-22, &
       5.1794E-22,  4.9240E-22,  4.7220E-22,  4.5588E-22,  4.4256E-22,  4.3119E-22, &
       4.2151E-22,  4.1319E-22,  4.0586E-22,  3.9933E-22,  3.9341E-22,  3.8786E-22, &
       3.8303E-22,  3.7866E-22,  3.7415E-22,  3.7017E-22,  3.6675E-22,  3.6323E-22, &
       3.5961E-22,  3.5700E-22,  3.5395E-22,  3.5120E-22,  3.4413E-22,  3.3391E-22, &
       3.2598E-22,  3.1969E-22,  3.1487E-22,  3.1083E-22,  3.0802E-22,  3.0562E-22, &
       3.0369E-22,  3.0250E-22,  3.0142E-22,  3.0046E-22,  2.9986E-22,  2.9944E-22, &
       2.9900E-22 /)
    REAL, PARAMETER :: a3_CF2ClBr(dim55) = (/ &
      -4.0830E-25, -2.3388E-25, -1.1816E-25, -6.2399E-26, -3.6648E-26, -2.3772E-26, &
      -1.6635E-26, -1.2307E-26, -9.5157E-27, -7.6160E-27, -6.2650E-27, -5.2370E-27, &
      -4.4669E-27, -3.8685E-27, -3.3544E-27, -2.9784E-27, -2.6356E-27, -2.3610E-27, &
      -2.1233E-27, -1.9178E-27, -1.7436E-27, -1.5925E-27, -1.4555E-27, -1.3356E-27, &
      -1.2308E-27, -1.1301E-27, -1.0445E-27, -9.7603E-28, -9.0598E-28, -8.5616E-28, &
      -7.8767E-28, -7.1918E-28, -6.8376E-28, -6.5068E-28, -5.9932E-28, -5.6410E-28, &
      -5.3082E-28, -4.9658E-28, -4.6233E-28, -4.4444E-28, -3.6974E-28, -2.7388E-28, &
      -2.0876E-28, -1.5748E-28, -1.2325E-28, -9.2402E-29, -7.1893E-29, -5.8199E-29, &
      -4.4490E-29, -3.4235E-29, -2.3964E-29, -2.0534E-29, -1.7117E-29, -1.3694E-29, &
      -1.0267E-29 /)
    REAL, PARAMETER :: b3_CF2ClBr(dim55) = (/ &
       7.6472E-23,  6.6194E-23,  5.2614E-23,  4.2813E-23,  3.6781E-23,  3.3013E-23, &
       3.0508E-23,  2.8736E-23,  2.7429E-23,  2.6430E-23,  2.5640E-23,  2.4978E-23, &
       2.4438E-23,  2.3983E-23,  2.3563E-23,  2.3233E-23,  2.2912E-23,  2.2639E-23, &
       2.2389E-23,  2.2161E-23,  2.1957E-23,  2.1772E-23,  2.1596E-23,  2.1434E-23, &
       2.1287E-23,  2.1140E-23,  2.1010E-23,  2.0902E-23,  2.0788E-23,  2.0703E-23, &
       2.0583E-23,  2.0459E-23,  2.0393E-23,  2.0329E-23,  2.0227E-23,  2.0155E-23, &
       2.0085E-23,  2.0011E-23,  1.9935E-23,  1.9894E-23,  1.9719E-23,  1.9467E-23, &
       1.9277E-23,  1.9112E-23,  1.8992E-23,  1.8875E-23,  1.8791E-23,  1.8731E-23, &
       1.8667E-23,  1.8616E-23,  1.8562E-23,  1.8543E-23,  1.8523E-23,  1.8502E-23, &
       1.8480E-23 /)
    REAL, PARAMETER :: a4_CF2ClBr(4) = (/  8.9423E-24, -2.3878E-27,  5.0826E-31, -3.5913E-35 /)
    REAL, PARAMETER :: a5_CF2ClBr(4) = (/  5.5698E-25, -3.2739E-28,  6.6424E-32, -4.4813E-36 /)

    jval_2d(ip_CF2ClBr)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_CF2ClBr(0) = &
          p1(a0_1_1_CF2ClBr(i0(j,k))*dlv2(j,k) + &
          a0_1_2_CF2ClBr(i0(j,k)), &
          a0_2_1_CF2ClBr(i0(j,k))*dlv2(j,k) + &
          a0_2_2_CF2ClBr(i0(j,k)),v3_du1(j,k))
        sig_CF2ClBr(1) = &
          (p1(b1_1_CF2ClBr(i1(j,k)),a1_1_CF2ClBr(i1(j,k)), &
          v3_du1(j,k)) + &
          p1(b1_2_CF2ClBr(i1(j,k)),a1_2_CF2ClBr(i1(j,k)), &
          v3_du1(j,k)) * v2s_m(j,k))
        sig_CF2ClBr(2) = &
          p1(b2_CF2ClBr(i2(j,k)), a2_CF2ClBr(i2(j,k)), &
          v3_du1(j,k))
        sig_CF2ClBr(3) = &
          p1(b3_CF2ClBr(i3(j,k)), a3_CF2ClBr(i3(j,k)), &
          v3_du2(j,k))
        sig_CF2ClBr(4) = &
          p3(a4_CF2ClBr(1),a4_CF2ClBr(2),a4_CF2ClBr(3), &
          a4_CF2ClBr(4),v3_du2(j,k))
        sig_CF2ClBr(5) = &
          p3(a5_CF2ClBr(1),a5_CF2ClBr(2),a5_CF2ClBr(3), &
          a5_CF2ClBr(4),v3_du2(j,k))
        dj = 0. &
          + sig_CF2ClBr(0) * fint(j,k,0) &
          + sig_CF2ClBr(1) * fint(j,k,1) &
          + sig_CF2ClBr(2) * fint(j,k,2) &
          + sig_CF2ClBr(3) * fint(j,k,3) &
          + sig_CF2ClBr(4) * fint(j,k,4) &
          + sig_CF2ClBr(5) * fint(j,k,5)

        jval_2d(ip_CF2ClBr)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,8)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_CF2ClBr

  ! **************************************************************************

  SUBROUTINE jval_cal_CF3Br

    ! CF_3Br \TOHV\ \products

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_CF3Br

    ! T-const parameters:
    REAL, PARAMETER :: a0_1_1_CF3Br(dim58) = (/ &
       1.0548E-21,  1.1394E-21,  1.2285E-21,  1.3190E-21,  1.4103E-21,  1.5010E-21, &
       1.5938E-21,  1.6823E-21,  1.7716E-21,  1.8594E-21,  1.9444E-21,  2.0303E-21, &
       2.3404E-21,  3.1351E-21,  3.0171E-21,  3.1212E-21,  3.4698E-21,  3.2933E-21, &
       3.3465E-21,  3.6544E-21,  3.3721E-21,  3.3330E-21,  3.5643E-21,  3.1528E-21, &
       3.0108E-21,  2.2171E-21,  1.7518E-21,  1.6276E-21,  1.5378E-21,  1.4907E-21, &
       1.4898E-21,  1.5389E-21,  1.6220E-21,  1.7480E-21,  1.8961E-21,  2.0404E-21, &
       2.1856E-21,  2.3122E-21,  2.4259E-21,  2.5020E-21,  2.5579E-21,  2.5880E-21, &
       2.5967E-21,  2.5786E-21,  2.5209E-21,  2.4459E-21,  2.3316E-21,  2.1918E-21, &
       2.0418E-21,  1.8957E-21,  1.7283E-21,  1.5824E-21,  1.4319E-21,  1.2898E-21, &
       1.1339E-21,  9.9142E-22,  8.1621E-22,  6.7858E-22 /)
    REAL, PARAMETER :: a0_1_2_CF3Br(dim58) = (/ &
       4.0353E-20,  3.6614E-20,  3.2657E-20,  2.8619E-20,  2.4531E-20,  2.0447E-20, &
       1.6255E-20,  1.2235E-20,  8.1630E-21,  4.1445E-21,  2.3314E-22, -3.7375E-21, &
      -1.8123E-20, -5.5156E-20, -4.9636E-20, -5.4529E-20, -7.0984E-20, -6.2616E-20, &
      -6.5147E-20, -7.9864E-20, -6.6314E-20, -6.4431E-20, -7.5626E-20, -5.5626E-20, &
      -4.8698E-20, -9.8040E-21,  1.3087E-20,  1.9224E-20,  2.3674E-20,  2.6024E-20, &
       2.6066E-20,  2.3602E-20,  1.9416E-20,  1.3036E-20,  5.5143E-21, -1.8436E-21, &
      -9.2799E-21, -1.5786E-20, -2.1651E-20, -2.5594E-20, -2.8504E-20, -3.0074E-20, &
      -3.0530E-20, -2.9577E-20, -2.6530E-20, -2.2557E-20, -1.6475E-20, -9.0073E-21, &
      -9.6939E-22,  6.8925E-21,  1.5929E-20,  2.3840E-20,  3.2028E-20,  3.9783E-20, &
       4.8325E-20,  5.6164E-20,  6.5836E-20,  7.3460E-20 /)
    REAL, PARAMETER :: a0_2_1_CF3Br(dim58) = (/ &
       4.8564E-24,  5.3849E-24,  5.9501E-24,  6.5867E-24,  7.2796E-24,  8.0307E-24, &
       8.8235E-24,  9.7029E-24,  1.0631E-23,  1.1643E-23,  1.2741E-23,  1.3931E-23, &
       1.1823E-23,  2.9091E-24,  7.6366E-24,  9.0874E-24,  7.3466E-24,  1.2360E-23, &
       1.4146E-23,  1.2703E-23,  1.7911E-23,  1.9804E-23,  1.8392E-23,  2.3432E-23, &
       2.5064E-23,  3.2714E-23,  3.6475E-23,  3.6398E-23,  3.5574E-23,  3.3947E-23, &
       3.1488E-23,  2.8210E-23,  2.4279E-23,  1.9795E-23,  1.5215E-23,  1.0660E-23, &
       6.5170E-24,  2.9842E-24,  8.6489E-26, -1.9492E-24, -3.3077E-24, -4.0935E-24, &
      -4.3827E-24, -4.4241E-24, -4.2113E-24, -3.9853E-24, -3.6476E-24, -3.2317E-24, &
      -2.8900E-24, -2.5368E-24, -2.1515E-24, -1.8719E-24, -1.5774E-24, -1.3495E-24, &
      -1.0476E-24, -8.7441E-25, -6.3774E-25, -4.9995E-25 /)
    REAL, PARAMETER :: a0_2_2_CF3Br(dim58) = (/ &
      -3.2275E-22, -3.4611E-22, -3.7120E-22, -3.9959E-22, -4.3063E-22, -4.6443E-22, &
      -5.0027E-22, -5.4019E-22, -5.8250E-22, -6.2888E-22, -6.7938E-22, -7.3437E-22, &
      -6.3652E-22, -2.2115E-22, -4.4239E-22, -5.1059E-22, -4.2842E-22, -6.6607E-22, &
      -7.5109E-22, -6.8209E-22, -9.3210E-22, -1.0233E-21, -9.5499E-22, -1.1999E-21, &
      -1.2796E-21, -1.6544E-21, -1.8395E-21, -1.8356E-21, -1.7948E-21, -1.7138E-21, &
      -1.5908E-21, -1.4263E-21, -1.2281E-21, -1.0012E-21, -7.6855E-22, -5.3626E-22, &
      -3.2414E-22, -1.4256E-22,  6.9617E-24,  1.1241E-22,  1.8305E-22,  2.2407E-22, &
       2.3923E-22,  2.4141E-22,  2.3017E-22,  2.1819E-22,  2.0022E-22,  1.7801E-22, &
       1.5970E-22,  1.4070E-22,  1.1989E-22,  1.0474E-22,  8.8714E-23,  7.6274E-23, &
       5.9730E-23,  5.0203E-23,  3.7138E-23,  2.9505E-23 /)
    REAL, PARAMETER :: a1_1_CF3Br(dim55) = (/ &
       2.2804E-21,  2.1543E-21,  2.0343E-21,  1.8435E-21,  1.6665E-21,  1.4824E-21, &
       1.3066E-21,  1.1626E-21,  1.0132E-21,  9.1241E-22,  7.9295E-22,  7.2613E-22, &
       6.3141E-22,  5.8851E-22,  5.1181E-22,  4.8686E-22,  4.2305E-22,  4.0701E-22, &
       3.5517E-22,  3.4665E-22,  3.0100E-22,  2.9818E-22,  2.5839E-22,  2.5832E-22, &
       2.2188E-22,  2.2648E-22,  1.9492E-22,  1.9910E-22,  1.7120E-22,  1.7655E-22, &
       1.5092E-22,  1.5768E-22,  1.3387E-22,  1.4190E-22,  1.2003E-22,  1.2771E-22, &
       1.0810E-22,  1.1535E-22,  9.6473E-23,  1.0582E-22,  8.4816E-23,  7.0697E-23, &
       5.5822E-23,  4.8317E-23,  3.9152E-23,  3.4784E-23,  2.8440E-23,  2.6080E-23, &
       1.8354E-23,  1.6040E-23,  1.3915E-23,  1.2163E-23,  1.0642E-23,  9.3806E-24, &
       8.0287E-24 /)
    REAL, PARAMETER :: b1_1_CF3Br(dim55) = (/ &
       5.3584E-20,  5.3962E-20,  5.4622E-20,  5.6148E-20,  5.8007E-20,  6.0400E-20, &
       6.3125E-20,  6.5717E-20,  6.8780E-20,  7.1097E-20,  7.4144E-20,  7.6015E-20, &
       7.8904E-20,  8.0319E-20,  8.3042E-20,  8.3990E-20,  8.6574E-20,  8.7264E-20, &
       8.9623E-20,  9.0032E-20,  9.2337E-20,  9.2487E-20,  9.4695E-20,  9.4699E-20, &
       9.6904E-20,  9.6614E-20,  9.8681E-20,  9.8397E-20,  1.0036E-19,  9.9973E-20, &
       1.0191E-19,  1.0138E-19,  1.0330E-19,  1.0263E-19,  1.0450E-19,  1.0383E-19, &
       1.0560E-19,  1.0493E-19,  1.0673E-19,  1.0581E-19,  1.0792E-19,  1.0952E-19, &
       1.1139E-19,  1.1242E-19,  1.1380E-19,  1.1451E-19,  1.1563E-19,  1.1607E-19, &
       1.1762E-19,  1.1811E-19,  1.1859E-19,  1.1901E-19,  1.1939E-19,  1.1972E-19, &
       1.2009E-19 /)
    REAL, PARAMETER :: a1_2_CF3Br(dim55) = (/ &
      -3.1927E-24, -8.5097E-25, -3.5999E-26,  1.5264E-24,  2.1978E-24,  2.7987E-24, &
       3.2101E-24,  3.1169E-24,  3.3560E-24,  2.9132E-24,  3.0792E-24,  2.5232E-24, &
       2.6767E-24,  2.1204E-24,  2.2858E-24,  1.7580E-24,  1.9379E-24,  1.4785E-24, &
       1.6506E-24,  1.2406E-24,  1.4189E-24,  1.0531E-24,  1.2291E-24,  9.0649E-25, &
       1.0795E-24,  7.7990E-25,  9.4174E-25,  6.7651E-25,  8.3304E-25,  5.9653E-25, &
       7.3815E-25,  5.2405E-25,  6.5737E-25,  4.6170E-25,  5.8706E-25,  4.1012E-25, &
       5.2742E-25,  3.6820E-25,  4.7961E-25,  3.2306E-25,  3.4814E-25,  2.5522E-25, &
       2.2240E-25,  1.6697E-25,  1.5087E-25,  1.1641E-25,  1.0858E-25,  8.4098E-26, &
       9.7813E-26,  8.3857E-26,  7.4245E-26,  6.4868E-26,  5.7531E-26,  5.1119E-26, &
       4.5880E-26 /)
    REAL, PARAMETER :: b1_2_CF3Br(dim55) = (/ &
      -1.5347E-22, -1.6049E-22, -1.6497E-22, -1.7747E-22, -1.8452E-22, -1.9233E-22, &
      -1.9871E-22, -1.9703E-22, -2.0194E-22, -1.9175E-22, -1.9598E-22, -1.8042E-22, &
      -1.8510E-22, -1.6674E-22, -1.7261E-22, -1.5255E-22, -1.5984E-22, -1.4009E-22, &
      -1.4792E-22, -1.2824E-22, -1.3724E-22, -1.1785E-22, -1.2762E-22, -1.0891E-22, &
      -1.1938E-22, -1.0050E-22, -1.1110E-22, -9.3068E-23, -1.0410E-22, -8.6838E-23, &
      -9.7531E-23, -8.0830E-23, -9.1563E-23, -7.5322E-23, -8.6040E-23, -7.0469E-23, &
      -8.1086E-23, -6.6278E-23, -7.6917E-23, -6.1576E-23, -6.4096E-23, -5.3597E-23, &
      -4.9477E-23, -4.1828E-23, -3.9404E-23, -3.3788E-23, -3.2414E-23, -2.7811E-23, &
      -3.0561E-23, -2.7588E-23, -2.5421E-23, -2.3189E-23, -2.1351E-23, -1.9665E-23, &
      -1.8221E-23 /)
    REAL, PARAMETER :: a2_CF3Br(dim55) = (/ &
      -2.7176E-23, -2.3124E-23, -1.8312E-23, -1.3659E-23, -9.7084E-24, -6.6572E-24, &
      -4.4492E-24, -2.9212E-24, -1.8968E-24, -1.2248E-24, -7.8936E-25, -5.0992E-25, &
      -3.3140E-25, -2.1752E-25, -1.4476E-25, -9.8120E-26, -6.8040E-26, -4.8440E-26, &
      -3.5560E-26, -2.6920E-26, -2.1040E-26, -1.7000E-26, -1.4040E-26, -1.1920E-26, &
      -1.0320E-26, -9.0800E-27, -8.0400E-27, -7.2400E-27, -6.5600E-27, -6.0000E-27, &
      -5.4400E-27, -5.0400E-27, -4.6400E-27, -4.2800E-27, -4.0000E-27, -3.6800E-27, &
      -3.4400E-27, -3.1600E-27, -2.9600E-27, -2.8000E-27, -2.2560E-27, -1.6240E-27, &
      -1.1600E-27, -8.4800E-28, -6.0800E-28, -4.4000E-28, -3.2000E-28, -2.3200E-28, &
      -1.6800E-28, -1.2800E-28, -8.8000E-29, -6.4000E-29, -4.8000E-29, -3.2000E-29, &
      -2.4000E-29 /)
    REAL, PARAMETER :: b2_CF3Br(dim55) = (/ &
       2.9398E-22,  2.8182E-22,  2.5536E-22,  2.1813E-22,  1.7665E-22,  1.3699E-22, &
       1.0276E-22,  7.5258E-23,  5.4257E-23,  3.8800E-23,  2.7698E-23,  1.9873E-23, &
       1.4429E-23,  1.0671E-23,  8.0876E-24,  6.3153E-24,  5.0970E-24,  4.2542E-24, &
       3.6682E-24,  3.2535E-24,  2.9565E-24,  2.7424E-24,  2.5781E-24,  2.4552E-24, &
       2.3584E-24,  2.2802E-24,  2.2121E-24,  2.1577E-24,  2.1098E-24,  2.0689E-24, &
       2.0266E-24,  1.9954E-24,  1.9632E-24,  1.9333E-24,  1.9094E-24,  1.8812E-24, &
       1.8595E-24,  1.8335E-24,  1.8144E-24,  1.7987E-24,  1.7440E-24,  1.6726E-24, &
       1.6144E-24,  1.5713E-24,  1.5352E-24,  1.5078E-24,  1.4868E-24,  1.4702E-24, &
       1.4574E-24,  1.4489E-24,  1.4398E-24,  1.4341E-24,  1.4301E-24,  1.4259E-24, &
       1.4237E-24 /)
    REAL, PARAMETER :: a3_CF3Br(dim55) = (/ &
      -1.9097E-27, -1.0958E-27, -5.4929E-28, -2.8222E-28, -1.5702E-28, -9.3941E-29, &
      -5.9185E-29, -3.8663E-29, -2.5923E-29, -1.7736E-29, -1.2333E-29, -8.6788E-30, &
      -6.1672E-30, -4.4178E-30, -3.1826E-30, -2.3052E-30, -1.6759E-30, -1.2229E-30, &
      -8.9640E-31, -6.5839E-31, -4.8432E-31, -3.5832E-31, -2.6533E-31, -1.9693E-31, &
      -1.4622E-31, -1.0916E-31, -8.1507E-32, -6.0942E-32, -4.5564E-32, -3.4223E-32, &
      -2.5687E-32, -1.9301E-32, -1.4489E-32, -1.0923E-32, -8.2226E-33, -6.1846E-33, &
      -4.6676E-33, -3.5187E-33, -2.6529E-33, -1.9969E-33, -9.2770E-34, -2.2623E-34, &
      -5.5009E-35, -1.3337E-35, -3.2209E-36, -7.7510E-37, -1.8616E-37, -4.4597E-38, &
      -1.0661E-38,  0.0000E+00,  0.0000E+00,  0.0000E+00,  0.0000E+00,  0.0000E+00, &
       0.0000E+00 /)
    REAL, PARAMETER :: b3_CF3Br(dim55) = (/ &
       2.5060E-25,  2.0264E-25,  1.3851E-25,  9.1565E-26,  6.2242E-26,  4.3784E-26, &
       3.1583E-26,  2.3179E-26,  1.7218E-26,  1.2908E-26,  9.7491E-27,  7.3987E-27, &
       5.6365E-27,  4.3069E-27,  3.2959E-27,  2.5265E-27,  1.9379E-27,  1.4878E-27, &
       1.1442E-27,  8.7989E-28,  6.7641E-28,  5.2174E-28,  4.0215E-28,  3.1022E-28, &
       2.3908E-28,  1.8493E-28,  1.4290E-28,  1.1045E-28,  8.5288E-29,  6.6065E-29, &
       5.1099E-29,  3.9531E-29,  3.0531E-29,  2.3654E-29,  1.8288E-29,  1.4120E-29, &
       1.0928E-29,  8.4439E-30,  6.5213E-30,  5.0263E-30,  2.5269E-30,  6.8220E-31, &
       1.8193E-31,  4.7998E-32,  1.2532E-32,  3.2420E-33,  8.3295E-34,  2.1257E-34, &
       5.3929E-35,  1.3626E-35,  3.4279E-36,  8.5894E-37,  2.1472E-37,  5.3506E-38, &
       1.3297E-38 /)

    jval_2d(ip_CF3Br)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_CF3Br(0) = &
          p1(a0_1_1_CF3Br(i0(j,k))*dlv2(j,k) + &
          a0_1_2_CF3Br(i0(j,k)), &
          a0_2_1_CF3Br(i0(j,k))*dlv2(j,k) + &
          a0_2_2_CF3Br(i0(j,k)),v3_du1(j,k))
        sig_CF3Br(1) = &
          (p1(b1_1_CF3Br(i1(j,k)),a1_1_CF3Br(i1(j,k)), &
          v3_du1(j,k)) + &
          p1(b1_2_CF3Br(i1(j,k)),a1_2_CF3Br(i1(j,k)), &
          v3_du1(j,k)) * v2s_m(j,k))
        sig_CF3Br(2) = &
          p1(b2_CF3Br(i2(j,k)), a2_CF3Br(i2(j,k)), &
          v3_du1(j,k))
        sig_CF3Br(3) = &
          p1(b3_CF3Br(i3(j,k)), a3_CF3Br(i3(j,k)), &
          v3_du2(j,k))
        dj = 0. &
          + sig_CF3Br(0) * fint(j,k,0) &
          + sig_CF3Br(1) * fint(j,k,1) &
          + sig_CF3Br(2) * fint(j,k,2) &
          + sig_CF3Br(3) * fint(j,k,3)

        jval_2d(ip_CF3Br)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,6)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_CF3Br

  ! **************************************************************************

  SUBROUTINE jval_cal_CH3I

    ! CH_3I \TOHV\ \products

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_CH3I

    ! T-const parameters:
    REAL, PARAMETER :: a1_1_CH3I(dim55) = (/ &
      -5.9045E-21, -5.2000E-21, -4.4654E-21, -3.7868E-21, -3.1140E-21, -2.6109E-21, &
      -2.1079E-21, -1.7898E-21, -1.4501E-21, -1.2656E-21, -1.0443E-21, -9.4066E-22, &
      -7.9541E-22, -7.3654E-22, -6.3804E-22, -6.0332E-22, -5.3285E-22, -5.1165E-22, &
      -4.5874E-22, -4.4507E-22, -4.0344E-22, -3.9450E-22, -3.6028E-22, -3.5462E-22, &
      -3.2563E-22, -3.2221E-22, -2.9693E-22, -2.9538E-22, -2.7244E-22, -2.7263E-22, &
      -2.5192E-22, -2.5283E-22, -2.3392E-22, -2.3588E-22, -2.1814E-22, -2.2089E-22, &
      -2.0421E-22, -2.0772E-22, -1.9182E-22, -1.9585E-22, -1.7468E-22, -1.5506E-22, &
      -1.3558E-22, -1.2291E-22, -1.0834E-22, -9.9596E-23, -8.7755E-23, -8.1539E-23, &
      -6.6605E-23, -5.9485E-23, -5.3056E-23, -4.7281E-23, -4.2096E-23, -3.7440E-23, &
      -3.3272E-23 /)
    REAL, PARAMETER :: b1_1_CH3I(dim55) = (/ &
       1.3227E-19,  1.3016E-19,  1.2612E-19,  1.2069E-19,  1.1362E-19,  1.0708E-19, &
       9.9287E-20,  9.3561E-20,  8.6596E-20,  8.2353E-20,  7.6710E-20,  7.3808E-20, &
       6.9378E-20,  6.7435E-20,  6.3939E-20,  6.2619E-20,  5.9765E-20,  5.8853E-20, &
       5.6446E-20,  5.5790E-20,  5.3688E-20,  5.3214E-20,  5.1315E-20,  5.0986E-20, &
       4.9232E-20,  4.9017E-20,  4.7361E-20,  4.7256E-20,  4.5639E-20,  4.5652E-20, &
       4.4089E-20,  4.4160E-20,  4.2638E-20,  4.2800E-20,  4.1283E-20,  4.1525E-20, &
       4.0015E-20,  4.0342E-20,  3.8824E-20,  3.9218E-20,  3.7092E-20,  3.4875E-20, &
       3.2429E-20,  3.0681E-20,  2.8488E-20,  2.7063E-20,  2.4985E-20,  2.3816E-20, &
       2.0822E-20,  1.9305E-20,  1.7855E-20,  1.6481E-20,  1.5182E-20,  1.3958E-20, &
       1.2810E-20 /)
    REAL, PARAMETER :: a1_2_CH3I(dim55) = (/ &
      -4.7249E-24, -8.4611E-24, -1.0947E-23, -1.1640E-23, -1.2696E-23, -1.1228E-23, &
      -1.1278E-23, -9.0676E-24, -8.7457E-24, -6.6759E-24, -6.3512E-24, -4.7294E-24, &
      -4.5158E-24, -3.3412E-24, -3.2348E-24, -2.4040E-24, -2.3803E-24, -1.7834E-24, &
      -1.8095E-24, -1.3712E-24, -1.4247E-24, -1.0901E-24, -1.1597E-24, -8.9225E-25, &
      -9.6958E-25, -7.4851E-25, -8.2996E-25, -6.3980E-25, -7.2525E-25, -5.5598E-25, &
      -6.3997E-25, -4.9126E-25, -5.7357E-25, -4.3724E-25, -5.1880E-25, -3.9280E-25, &
      -4.7355E-25, -3.5511E-25, -4.3486E-25, -3.2368E-25, -3.3922E-25, -2.6911E-25, &
      -2.4699E-25, -2.0264E-25, -1.9538E-25, -1.6296E-25, -1.6310E-25, -1.3693E-25, &
      -1.6863E-25, -1.5947E-25, -1.5106E-25, -1.4312E-25, -1.3546E-25, -1.2801E-25, &
      -1.2071E-25 /)
    REAL, PARAMETER :: b1_2_CH3I(dim55) = (/ &
       4.0693E-22,  4.1814E-22,  4.3181E-22,  4.3735E-22,  4.4844E-22,  4.2935E-22, &
       4.3014E-22,  3.9035E-22,  3.8375E-22,  3.3614E-22,  3.2786E-22,  2.8245E-22, &
       2.7594E-22,  2.3718E-22,  2.3340E-22,  2.0183E-22,  2.0087E-22,  1.7520E-22, &
       1.7639E-22,  1.5535E-22,  1.5805E-22,  1.4032E-22,  1.4418E-22,  1.2867E-22, &
       1.3335E-22,  1.1942E-22,  1.2476E-22,  1.1182E-22,  1.1785E-22,  1.0549E-22, &
       1.1183E-22,  1.0023E-22,  1.0686E-22,  9.5545E-23,  1.0252E-22,  9.1430E-23, &
       9.8738E-23,  8.7723E-23,  9.5339E-23,  8.4443E-23,  8.6005E-23,  7.8083E-23, &
       7.5306E-23,  6.9186E-23,  6.8093E-23,  6.2809E-23,  6.2834E-23,  5.7914E-23, &
       6.4269E-23,  6.2319E-23,  6.0422E-23,  5.8533E-23,  5.6613E-23,  5.4654E-23, &
       5.2644E-23 /)
    REAL, PARAMETER :: a2_CH3I(dim55) = (/ &
      -3.1480E-20, -2.8332E-20, -2.3960E-20, -1.9280E-20, -1.4976E-20, -1.1376E-20, &
      -8.5560E-21, -6.4320E-21, -4.8600E-21, -3.7160E-21, -2.8840E-21, -2.2760E-21, &
      -1.8240E-21, -1.4880E-21, -1.2360E-21, -1.0360E-21, -8.8400E-22, -7.6400E-22, &
      -6.6800E-22, -5.8800E-22, -5.2400E-22, -4.6800E-22, -4.2000E-22, -3.8000E-22, &
      -3.4800E-22, -3.1600E-22, -2.9200E-22, -2.6400E-22, -2.4800E-22, -2.2800E-22, &
      -2.0800E-22, -1.9600E-22, -1.8400E-22, -1.6800E-22, -1.5600E-22, -1.4800E-22, &
      -1.3600E-22, -1.2400E-22, -1.2000E-22, -1.1200E-22, -9.1200E-23, -6.5600E-23, &
      -4.8000E-23, -3.4400E-23, -2.4800E-23, -1.8400E-23, -1.2800E-23, -9.6000E-24, &
      -7.2000E-24, -4.8000E-24, -4.0000E-24, -2.4000E-24, -1.6000E-24, -1.6000E-24, &
      -8.0000E-25 /)
    REAL, PARAMETER :: b2_CH3I(dim55) = (/ &
       5.6267E-19,  5.5323E-19,  5.2918E-19,  4.9174E-19,  4.4655E-19,  3.9975E-19, &
       3.5604E-19,  3.1781E-19,  2.8558E-19,  2.5927E-19,  2.3805E-19,  2.2103E-19, &
       2.0724E-19,  1.9615E-19,  1.8721E-19,  1.7961E-19,  1.7345E-19,  1.6829E-19, &
       1.6392E-19,  1.6008E-19,  1.5685E-19,  1.5388E-19,  1.5122E-19,  1.4890E-19, &
       1.4696E-19,  1.4495E-19,  1.4338E-19,  1.4147E-19,  1.4034E-19,  1.3888E-19, &
       1.3737E-19,  1.3644E-19,  1.3547E-19,  1.3414E-19,  1.3312E-19,  1.3241E-19, &
       1.3133E-19,  1.3021E-19,  1.2983E-19,  1.2905E-19,  1.2696E-19,  1.2406E-19, &
       1.2185E-19,  1.1998E-19,  1.1853E-19,  1.1749E-19,  1.1651E-19,  1.1590E-19, &
       1.1542E-19,  1.1491E-19,  1.1473E-19,  1.1435E-19,  1.1415E-19,  1.1415E-19, &
       1.1393E-19 /)
    REAL, PARAMETER :: a3_CH3I(dim55) = (/ &
      -1.5974E-22, -9.3046E-23, -4.8160E-23, -2.6219E-23, -1.5885E-23, -1.0628E-23, &
      -7.6502E-24, -5.8199E-24, -4.6038E-24, -3.7823E-24, -3.1667E-24, -2.7041E-24, &
      -2.3618E-24, -2.0712E-24, -1.8484E-24, -1.6433E-24, -1.4890E-24, -1.3516E-24, &
      -1.2158E-24, -1.1301E-24, -1.0427E-24, -9.4178E-25, -8.9041E-25, -8.2192E-25, &
      -7.5214E-25, -7.1918E-25, -6.5068E-25, -6.3356E-25, -5.6410E-25, -5.4795E-25, &
      -5.1370E-25, -4.6233E-25, -4.6154E-25, -4.1096E-25, -3.9384E-25, -3.7607E-25, &
      -3.5959E-25, -3.2534E-25, -3.0822E-25, -3.0769E-25, -2.4991E-25, -1.8829E-25, &
      -1.4716E-25, -1.0955E-25, -8.5587E-26, -6.8446E-26, -5.1352E-26, -4.1082E-26, &
      -3.0801E-26, -2.3964E-26, -2.0541E-26, -1.3689E-26, -1.3694E-26, -1.0270E-26, &
      -6.8446E-27 /)
    REAL, PARAMETER :: b3_CH3I(dim55) = (/ &
       3.5239E-20,  3.1309E-20,  2.6042E-20,  2.2185E-20,  1.9764E-20,  1.8226E-20, &
       1.7181E-20,  1.6431E-20,  1.5862E-20,  1.5430E-20,  1.5070E-20,  1.4772E-20, &
       1.4532E-20,  1.4311E-20,  1.4129E-20,  1.3949E-20,  1.3805E-20,  1.3668E-20, &
       1.3525E-20,  1.3430E-20,  1.3328E-20,  1.3204E-20,  1.3138E-20,  1.3046E-20, &
       1.2948E-20,  1.2900E-20,  1.2796E-20,  1.2769E-20,  1.2655E-20,  1.2628E-20, &
       1.2568E-20,  1.2475E-20,  1.2473E-20,  1.2376E-20,  1.2342E-20,  1.2305E-20, &
       1.2271E-20,  1.2196E-20,  1.2158E-20,  1.2157E-20,  1.2022E-20,  1.1860E-20, &
       1.1740E-20,  1.1619E-20,  1.1535E-20,  1.1470E-20,  1.1400E-20,  1.1355E-20, &
       1.1307E-20,  1.1273E-20,  1.1255E-20,  1.1217E-20,  1.1217E-20,  1.1196E-20, &
       1.1174E-20 /)
    REAL, PARAMETER :: a4_CH3I(4) = (/  6.7290E-21, -1.1970E-24,  2.5275E-28, -1.7797E-32 /)
    REAL, PARAMETER :: a5_CH3I(4) = (/  1.3777E-21, -3.4029E-25,  5.8481E-29, -3.6992E-33 /)
    REAL, PARAMETER :: a6_CH3I(4) = (/  1.9001E-23, -3.8395E-28,  4.7321E-33, -3.2223E-38 /)

    jval_2d(ip_CH3I)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_CH3I(1) = &
          (p1(b1_1_CH3I(i1(j,k)),a1_1_CH3I(i1(j,k)), &
          v3_du1(j,k)) + &
          p1(b1_2_CH3I(i1(j,k)),a1_2_CH3I(i1(j,k)), &
          v3_du1(j,k)) * v2s_m(j,k))
        sig_CH3I(2) = &
          p1(b2_CH3I(i2(j,k)), a2_CH3I(i2(j,k)), &
          v3_du1(j,k))
        sig_CH3I(3) = &
          p1(b3_CH3I(i3(j,k)), a3_CH3I(i3(j,k)), &
          v3_du2(j,k))
        sig_CH3I(4) = &
          p3(a4_CH3I(1),a4_CH3I(2),a4_CH3I(3), &
          a4_CH3I(4),v3_du2(j,k))
        sig_CH3I(5) = &
          p3(a5_CH3I(1),a5_CH3I(2),a5_CH3I(3), &
          a5_CH3I(4),v3_du2(j,k))
        sig_CH3I(6) = &
          p3(a6_CH3I(1),a6_CH3I(2),a6_CH3I(3), &
          a6_CH3I(4),v3_du2(j,k))
        dj = 0. &
          + sig_CH3I(1) * fint(j,k,1) &
          + sig_CH3I(2) * fint(j,k,2) &
          + sig_CH3I(3) * fint(j,k,3) &
          + sig_CH3I(4) * fint(j,k,4) &
          + sig_CH3I(5) * fint(j,k,5) &
          + sig_CH3I(6) * fint(j,k,6)

        jval_2d(ip_CH3I)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,2)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_CH3I

  ! **************************************************************************

  SUBROUTINE jval_cal_C3H7I

    ! C_3H_7I \TOHV\ \products

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_C3H7I

    ! T-const parameters:
    REAL, PARAMETER :: a1_1_C3H7I(dim55) = (/ &
      -5.6429E-21, -4.8252E-21, -3.9059E-21, -3.1653E-21, -2.3591E-21, -1.8483E-21, &
      -1.2596E-21, -9.6965E-22, -5.7987E-22, -4.4035E-22, -1.9149E-22, -1.3727E-22, &
       2.1932E-23,  3.3157E-23,  1.3781E-22,  1.2879E-22,  2.0047E-22,  1.8278E-22, &
       2.3376E-22,  2.1318E-22,  2.5063E-22,  2.2992E-22,  2.5812E-22,  2.3828E-22, &
       2.5978E-22,  2.4153E-22,  2.5798E-22,  2.4134E-22,  2.5408E-22,  2.3920E-22, &
       2.4862E-22,  2.3555E-22,  2.4230E-22,  2.3103E-22,  2.3540E-22,  2.2584E-22, &
       2.2815E-22,  2.2024E-22,  2.2048E-22,  2.1451E-22,  2.0546E-22,  1.8884E-22, &
       1.7131E-22,  1.5707E-22,  1.3973E-22,  1.2811E-22,  1.1122E-22,  1.0205E-22, &
       7.6473E-23,  6.3136E-23,  5.0844E-23,  3.9526E-23,  2.9144E-23,  1.9653E-23, &
       1.0998E-23 /)
    REAL, PARAMETER :: b1_1_C3H7I(dim55) = (/ &
       1.2377E-19,  1.2131E-19,  1.1626E-19,  1.1033E-19,  1.0187E-19,  9.5227E-20, &
       8.6101E-20,  8.0882E-20,  7.2892E-20,  6.9683E-20,  6.3337E-20,  6.1819E-20, &
       5.6963E-20,  5.6593E-20,  5.2877E-20,  5.3220E-20,  5.0317E-20,  5.1078E-20, &
       4.8758E-20,  4.9746E-20,  4.7855E-20,  4.8952E-20,  4.7388E-20,  4.8538E-20, &
       4.7238E-20,  4.8387E-20,  4.7309E-20,  4.8441E-20,  4.7543E-20,  4.8629E-20, &
       4.7918E-20,  4.8938E-20,  4.8394E-20,  4.9330E-20,  4.8956E-20,  4.9797E-20, &
       4.9588E-20,  5.0324E-20,  5.0300E-20,  5.0886E-20,  5.1796E-20,  5.3673E-20, &
       5.5873E-20,  5.7838E-20,  6.0449E-20,  6.2342E-20,  6.5307E-20,  6.7030E-20, &
       7.2159E-20,  7.5000E-20,  7.7771E-20,  8.0465E-20,  8.3066E-20,  8.5562E-20, &
       8.7946E-20 /)
    REAL, PARAMETER :: a1_2_C3H7I(dim55) = (/ &
      -1.0230E-23, -1.3080E-23, -1.6637E-23, -1.5832E-23, -1.7552E-23, -1.4416E-23, &
      -1.4925E-23, -1.1203E-23, -1.1252E-23, -7.9599E-24, -7.9630E-24, -5.4071E-24, &
      -5.4860E-24, -3.6138E-24, -3.7660E-24, -2.4145E-24, -2.6090E-24, -1.6276E-24, &
      -1.8336E-24, -1.1088E-24, -1.3067E-24, -7.6240E-25, -9.4218E-25, -5.2431E-25, &
      -6.8201E-25, -3.5766E-25, -4.9233E-25, -2.3730E-25, -3.5054E-25, -1.5057E-25, &
      -2.4111E-25, -8.5206E-26, -1.5597E-25, -3.5849E-26, -8.8303E-26,  1.6395E-27, &
      -3.3640E-26,  3.1149E-26,  1.1941E-26,  5.3068E-26,  7.7706E-26,  1.1720E-25, &
       1.5211E-25,  1.5677E-25,  1.8352E-25,  1.7147E-25,  1.9633E-25,  1.7512E-25, &
       2.5227E-25,  2.5857E-25,  2.6129E-25,  2.6123E-25,  2.5875E-25,  2.5421E-25, &
       2.4805E-25 /)
    REAL, PARAMETER :: b1_2_C3H7I(dim55) = (/ &
       3.9000E-22,  3.9855E-22,  4.1811E-22,  4.1167E-22,  4.2973E-22,  3.8897E-22, &
       3.9685E-22,  3.2986E-22,  3.3085E-22,  2.5514E-22,  2.5522E-22,  1.8365E-22, &
       1.8606E-22,  1.2428E-22,  1.2968E-22,  7.8323E-23,  8.6200E-23,  4.4003E-23, &
       5.3375E-23,  1.8582E-23,  2.8580E-23, -2.7037E-25,  9.7077E-24, -1.4529E-23, &
      -4.9880E-24, -2.5422E-23, -1.6601E-23, -3.3943E-23, -2.5960E-23, -4.0558E-23, &
      -3.3722E-23, -4.5882E-23, -4.0186E-23, -5.0156E-23, -4.5671E-23, -5.3586E-23, &
      -5.0393E-23, -5.6419E-23, -5.4584E-23, -5.8615E-23, -6.1091E-23, -6.5554E-23, &
      -6.9934E-23, -7.0578E-23, -7.4604E-23, -7.2639E-23, -7.7003E-23, -7.3015E-23, &
      -8.8483E-23, -8.9825E-23, -9.0440E-23, -9.0426E-23, -8.9803E-23, -8.8610E-23, &
      -8.6911E-23 /)
    REAL, PARAMETER :: a2_C3H7I(dim55) = (/ &
      -3.8260E-20, -3.5424E-20, -3.0784E-20, -2.5432E-20, -2.0272E-20, -1.5808E-20, &
      -1.2196E-20, -9.4000E-21, -7.2840E-21, -5.7000E-21, -4.5200E-21, -3.6400E-21, &
      -2.9720E-21, -2.4680E-21, -2.0760E-21, -1.7680E-21, -1.5280E-21, -1.3320E-21, &
      -1.1720E-21, -1.0400E-21, -9.3200E-22, -8.4000E-22, -7.6000E-22, -6.8800E-22, &
      -6.3200E-22, -5.7600E-22, -5.3200E-22, -4.9200E-22, -4.5200E-22, -4.1600E-22, &
      -3.9200E-22, -3.6000E-22, -3.3600E-22, -3.1200E-22, -2.9200E-22, -2.7200E-22, &
      -2.5200E-22, -2.4000E-22, -2.2000E-22, -2.0800E-22, -1.7040E-22, -1.2320E-22, &
      -8.9600E-23, -6.4000E-23, -4.7200E-23, -3.4400E-23, -2.4000E-23, -1.8400E-23, &
      -1.2800E-23, -9.6000E-24, -7.2000E-24, -4.8000E-24, -3.2000E-24, -3.2000E-24, &
      -1.6000E-24 /)
    REAL, PARAMETER :: b2_C3H7I(dim55) = (/ &
       8.5677E-19,  8.4826E-19,  8.2274E-19,  7.7993E-19,  7.2575E-19,  6.6771E-19, &
       6.1173E-19,  5.6140E-19,  5.1802E-19,  4.8159E-19,  4.5150E-19,  4.2686E-19, &
       4.0649E-19,  3.8985E-19,  3.7594E-19,  3.6423E-19,  3.5451E-19,  3.4609E-19, &
       3.3881E-19,  3.3247E-19,  3.2702E-19,  3.2214E-19,  3.1770E-19,  3.1352E-19, &
       3.1014E-19,  3.0661E-19,  3.0373E-19,  3.0101E-19,  2.9819E-19,  2.9556E-19, &
       2.9375E-19,  2.9125E-19,  2.8932E-19,  2.8733E-19,  2.8562E-19,  2.8386E-19, &
       2.8205E-19,  2.8093E-19,  2.7902E-19,  2.7784E-19,  2.7407E-19,  2.6873E-19, &
       2.6451E-19,  2.6098E-19,  2.5845E-19,  2.5637E-19,  2.5454E-19,  2.5349E-19, &
       2.5237E-19,  2.5168E-19,  2.5114E-19,  2.5057E-19,  2.5017E-19,  2.5017E-19, &
       2.4973E-19 /)
    REAL, PARAMETER :: a3_C3H7I(dim55) = (/ &
      -3.6856E-22, -2.1733E-22, -1.1410E-22, -6.2930E-23, -3.8514E-23, -2.5877E-23, &
      -1.8689E-23, -1.4225E-23, -1.1296E-23, -9.2418E-24, -7.7542E-24, -6.6233E-24, &
      -5.7676E-24, -5.0496E-24, -4.5011E-24, -4.0055E-24, -3.6283E-24, -3.2849E-24, &
      -2.9795E-24, -2.7397E-24, -2.5128E-24, -2.3116E-24, -2.1404E-24, -1.9863E-24, &
      -1.8462E-24, -1.7123E-24, -1.5925E-24, -1.4897E-24, -1.4017E-24, -1.3014E-24, &
      -1.2329E-24, -1.1473E-24, -1.0769E-24, -1.0103E-24, -9.5890E-25, -8.8889E-25, &
      -8.5616E-25, -8.0479E-25, -7.5342E-25, -7.0085E-25, -6.0253E-25, -4.5532E-25, &
      -3.4908E-25, -2.6703E-25, -2.0541E-25, -1.6085E-25, -1.2325E-25, -9.5858E-26, &
      -7.5291E-26, -5.8199E-26, -4.7929E-26, -3.7645E-26, -2.7388E-26, -2.0541E-26, &
      -2.0534E-26 /)
    REAL, PARAMETER :: b3_C3H7I(dim55) = (/ &
       8.1645E-20,  7.2734E-20,  6.0620E-20,  5.1625E-20,  4.5906E-20,  4.2208E-20, &
       3.9685E-20,  3.7857E-20,  3.6486E-20,  3.5405E-20,  3.4535E-20,  3.3808E-20, &
       3.3208E-20,  3.2662E-20,  3.2213E-20,  3.1778E-20,  3.1426E-20,  3.1084E-20, &
       3.0763E-20,  3.0497E-20,  3.0231E-20,  2.9985E-20,  2.9764E-20,  2.9557E-20, &
       2.9361E-20,  2.9165E-20,  2.8983E-20,  2.8821E-20,  2.8677E-20,  2.8507E-20, &
       2.8387E-20,  2.8231E-20,  2.8100E-20,  2.7971E-20,  2.7869E-20,  2.7726E-20, &
       2.7657E-20,  2.7546E-20,  2.7432E-20,  2.7312E-20,  2.7082E-20,  2.6695E-20, &
       2.6385E-20,  2.6121E-20,  2.5905E-20,  2.5736E-20,  2.5582E-20,  2.5462E-20, &
       2.5366E-20,  2.5281E-20,  2.5227E-20,  2.5170E-20,  2.5110E-20,  2.5068E-20, &
       2.5068E-20 /)
    REAL, PARAMETER :: a4_C3H7I(4) = (/  1.4399E-20, -2.8275E-24,  5.9790E-28, -4.2136E-32 /)
    REAL, PARAMETER :: a5_C3H7I(4) = (/  2.4535E-21, -6.4216E-25,  1.1393E-28, -7.3278E-33 /)
    REAL, PARAMETER :: a6_C3H7I(4) = (/  5.0943E-23, -7.6107E-28,  9.1621E-33, -6.2691E-38 /)
    ! T-dep parameters:
    REAL, PARAMETER :: c1_C3H7I(3) = (/  1.0000E+00,  1.0396E+00,  5.6570E+00 /)
    REAL, PARAMETER :: c2_C3H7I(3) = (/  1.0000E+00,  6.9868E-01,  3.8789E-01 /)
    REAL, PARAMETER :: c3_C3H7I(3) = (/  9.9999E-01,  2.2058E+00,  2.1518E+00 /)
    REAL, PARAMETER :: c4_C3H7I(3) = (/  1.0000E+00,  2.4083E+00,  2.6241E+00 /)
    REAL, PARAMETER :: c5_C3H7I(3) = (/  9.9999E-01,  2.6846E+00,  4.6983E+00 /)
    REAL, PARAMETER :: c6_C3H7I(3) = (/  9.9999E-01, -1.3789E+00,  2.1541E+01 /)

    jval_2d(ip_C3H7I)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_C3H7I(1) = &
          p2(c1_C3H7I(1),c1_C3H7I(2), &
          c1_C3H7I(3),tnorm(j,k)) * &
          (p1(b1_1_C3H7I(i1(j,k)),a1_1_C3H7I(i1(j,k)), &
          v3_du1(j,k)) + &
          p1(b1_2_C3H7I(i1(j,k)),a1_2_C3H7I(i1(j,k)), &
          v3_du1(j,k)) * v2s_m(j,k))
        sig_C3H7I(2) = &
          p2(c2_C3H7I(1),c2_C3H7I(2),c2_C3H7I(3),tnorm(j,k))* &
          p1(b2_C3H7I(i2(j,k)), a2_C3H7I(i2(j,k)), &
          v3_du1(j,k))
        sig_C3H7I(3) = &
          p2(c3_C3H7I(1),c3_C3H7I(2),c3_C3H7I(3),tnorm(j,k))* &
          p1(b3_C3H7I(i3(j,k)), a3_C3H7I(i3(j,k)), &
          v3_du2(j,k))
        sig_C3H7I(4) = &
          p2(c4_C3H7I(1),c4_C3H7I(2),c4_C3H7I(3),tnorm(j,k))* &
          p3(a4_C3H7I(1),a4_C3H7I(2),a4_C3H7I(3), &
          a4_C3H7I(4),v3_du2(j,k))
        sig_C3H7I(5) = &
          p2(c5_C3H7I(1),c5_C3H7I(2),c5_C3H7I(3),tnorm(j,k))* &
          p3(a5_C3H7I(1),a5_C3H7I(2),a5_C3H7I(3), &
          a5_C3H7I(4),v3_du2(j,k))
        sig_C3H7I(6) = &
          p2(c6_C3H7I(1),c6_C3H7I(2),c6_C3H7I(3),tnorm(j,k))* &
          p3(a6_C3H7I(1),a6_C3H7I(2),a6_C3H7I(3), &
          a6_C3H7I(4),v3_du2(j,k))
        dj = 0. &
          + sig_C3H7I(1) * fint(j,k,1) &
          + sig_C3H7I(2) * fint(j,k,2) &
          + sig_C3H7I(3) * fint(j,k,3) &
          + sig_C3H7I(4) * fint(j,k,4) &
          + sig_C3H7I(5) * fint(j,k,5) &
          + sig_C3H7I(6) * fint(j,k,6)

        jval_2d(ip_C3H7I)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,2)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_C3H7I

  ! **************************************************************************

  SUBROUTINE jval_cal_CH2ClI

    ! CH_2ClI \TOHV\ \products

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_CH2ClI

    ! T-const parameters:
    REAL, PARAMETER :: a1_1_CH2ClI(dim55) = (/ &
       7.4944E-23,  7.0192E-22,  1.6078E-21,  1.9971E-21,  2.6716E-21,  2.7995E-21, &
       3.2232E-21,  3.1683E-21,  3.4008E-21,  3.2557E-21,  3.3652E-21,  3.1897E-21, &
       3.2239E-21,  3.0520E-21,  3.0380E-21,  2.8827E-21,  2.8409E-21,  2.7096E-21, &
       2.6425E-21,  2.5369E-21,  2.4574E-21,  2.3726E-21,  2.2803E-21,  2.2171E-21, &
       2.1167E-21,  2.0720E-21,  1.9649E-21,  1.9379E-21,  1.8239E-21,  1.8133E-21, &
       1.6922E-21,  1.6971E-21,  1.5720E-21,  1.5900E-21,  1.4589E-21,  1.4896E-21, &
       1.3558E-21,  1.3951E-21,  1.2591E-21,  1.3084E-21,  1.1274E-21,  9.6759E-22, &
       7.8680E-22,  6.7818E-22,  5.3137E-22,  4.5721E-22,  3.3334E-22,  2.8415E-22, &
       1.0697E-22,  4.0183E-23, -1.8748E-23, -7.0566E-23, -1.1592E-22, -1.5590E-22, &
      -1.9048E-22 /)
    REAL, PARAMETER :: b1_1_CH2ClI(dim55) = (/ &
       1.9347E-19,  1.9158E-19,  1.8660E-19,  1.8349E-19,  1.7641E-19,  1.7474E-19, &
       1.6818E-19,  1.6916E-19,  1.6440E-19,  1.6774E-19,  1.6494E-19,  1.6986E-19, &
       1.6881E-19,  1.7449E-19,  1.7498E-19,  1.8089E-19,  1.8258E-19,  1.8823E-19, &
       1.9128E-19,  1.9634E-19,  2.0036E-19,  2.0486E-19,  2.0998E-19,  2.1364E-19, &
       2.1972E-19,  2.2253E-19,  2.2955E-19,  2.3138E-19,  2.3942E-19,  2.4020E-19, &
       2.4933E-19,  2.4896E-19,  2.5903E-19,  2.5753E-19,  2.6874E-19,  2.6604E-19, &
       2.7815E-19,  2.7449E-19,  2.8748E-19,  2.8265E-19,  3.0084E-19,  3.1890E-19, &
       3.4159E-19,  3.5658E-19,  3.7867E-19,  3.9076E-19,  4.1250E-19,  4.2175E-19, &
       4.5727E-19,  4.7150E-19,  4.8479E-19,  4.9712E-19,  5.0848E-19,  5.1900E-19, &
       5.2852E-19 /)
    REAL, PARAMETER :: a1_2_CH2ClI(dim55) = (/ &
      -2.4352E-23, -2.1264E-23, -2.5796E-23, -1.9621E-23, -2.2225E-23, -1.5075E-23, &
      -1.6534E-23, -1.0047E-23, -1.0982E-23, -5.8819E-24, -6.5986E-24, -2.8751E-24, &
      -3.4253E-24, -8.7122E-25, -1.2402E-24,  4.6082E-25,  2.3654E-25,  1.2798E-24, &
       1.2568E-24,  1.7969E-24,  1.9296E-24,  2.1136E-24,  2.3953E-24,  2.3008E-24, &
       2.7024E-24,  2.3963E-24,  2.8913E-24,  2.4287E-24,  3.0195E-24,  2.4136E-24, &
       3.0985E-24,  2.3821E-24,  3.1192E-24,  2.3257E-24,  3.1282E-24,  2.2623E-24, &
       3.1030E-24,  2.2003E-24,  3.0707E-24,  2.1207E-24,  2.5885E-24,  2.2280E-24, &
       2.2727E-24,  1.9159E-24,  1.9858E-24,  1.6524E-24,  1.7426E-24,  1.4336E-24, &
       1.9343E-24,  1.8273E-24,  1.7228E-24,  1.6194E-24,  1.5169E-24,  1.4180E-24, &
       1.3203E-24 /)
    REAL, PARAMETER :: b1_2_CH2ClI(dim55) = (/ &
       1.9877E-24, -7.2747E-24,  1.7653E-23, -3.1750E-23, -4.4081E-24, -9.7359E-23, &
      -7.4744E-23, -1.9152E-22, -1.7234E-22, -2.8965E-22, -2.7137E-22, -3.7563E-22, &
      -3.5885E-22, -4.4313E-22, -4.3003E-22, -4.9467E-22, -4.8559E-22, -5.3045E-22, &
      -5.2940E-22, -5.5533E-22, -5.6203E-22, -5.7178E-22, -5.8742E-22, -5.8193E-22, &
      -6.0623E-22, -5.8695E-22, -6.1937E-22, -5.8791E-22, -6.2956E-22, -5.8533E-22, &
      -6.3704E-22, -5.8116E-22, -6.4050E-22, -5.7464E-22, -6.4325E-22, -5.6705E-22, &
      -6.4314E-22, -5.5919E-22, -6.4231E-22, -5.4921E-22, -5.9622E-22, -5.5549E-22, &
      -5.6110E-22, -5.1186E-22, -5.2238E-22, -4.6804E-22, -4.8387E-22, -4.2576E-22, &
      -5.2615E-22, -5.0337E-22, -4.7982E-22, -4.5520E-22, -4.2953E-22, -4.0350E-22, &
      -3.7659E-22 /)
    REAL, PARAMETER :: a2_CH2ClI(dim55) = (/ &
      -9.7520E-21, -1.0872E-20, -1.1000E-20, -1.0356E-20, -9.2800E-21, -8.0400E-21, &
      -6.8360E-21, -5.7600E-21, -4.8400E-21, -4.0840E-21, -3.4600E-21, -2.9600E-21, &
      -2.5520E-21, -2.2200E-21, -1.9480E-21, -1.7200E-21, -1.5320E-21, -1.3720E-21, &
      -1.2400E-21, -1.1240E-21, -1.0240E-21, -9.3600E-22, -8.5600E-22, -7.9200E-22, &
      -7.3200E-22, -6.7200E-22, -6.2800E-22, -5.8000E-22, -5.4000E-22, -5.0400E-22, &
      -4.6800E-22, -4.4000E-22, -4.0800E-22, -3.8000E-22, -3.6000E-22, -3.3200E-22, &
      -3.1200E-22, -2.9600E-22, -2.7200E-22, -2.5600E-22, -2.1280E-22, -1.5440E-22, &
      -1.1200E-22, -8.0800E-23, -5.9200E-23, -4.3200E-23, -3.1200E-23, -2.2400E-23, &
      -1.6800E-23, -1.2000E-23, -8.0000E-24, -6.4000E-24, -4.8000E-24, -3.2000E-24, &
      -2.4000E-24 /)
    REAL, PARAMETER :: b2_CH2ClI(dim55) = (/ &
       9.7836E-19,  9.8172E-19,  9.8242E-19,  9.7727E-19,  9.6597E-19,  9.4985E-19, &
       9.3119E-19,  9.1182E-19,  8.9296E-19,  8.7557E-19,  8.5966E-19,  8.4566E-19, &
       8.3322E-19,  8.2226E-19,  8.1260E-19,  8.0394E-19,  7.9633E-19,  7.8945E-19, &
       7.8344E-19,  7.7787E-19,  7.7282E-19,  7.6816E-19,  7.6372E-19,  7.6001E-19, &
       7.5638E-19,  7.5260E-19,  7.4971E-19,  7.4645E-19,  7.4363E-19,  7.4100E-19, &
       7.3828E-19,  7.3610E-19,  7.3352E-19,  7.3120E-19,  7.2949E-19,  7.2703E-19, &
       7.2522E-19,  7.2373E-19,  7.2144E-19,  7.1987E-19,  7.1553E-19,  7.0893E-19, &
       7.0361E-19,  6.9930E-19,  6.9605E-19,  6.9344E-19,  6.9134E-19,  6.8968E-19, &
       6.8856E-19,  6.8754E-19,  6.8663E-19,  6.8625E-19,  6.8585E-19,  6.8543E-19, &
       6.8521E-19 /)
    REAL, PARAMETER :: a3_CH2ClI(dim55) = (/ &
      -1.0168E-21, -6.2818E-22, -3.4896E-22, -2.0349E-22, -1.3026E-22, -9.0536E-23, &
      -6.7260E-23, -5.2208E-23, -4.2102E-23, -3.4742E-23, -2.9613E-23, -2.5501E-23, &
      -2.2249E-23, -1.9856E-23, -1.7457E-23, -1.5748E-23, -1.4376E-23, -1.2831E-23, &
      -1.1815E-23, -1.0959E-23, -9.9145E-24, -9.2466E-24, -8.5616E-24, -7.8767E-24, &
      -7.3504E-24, -6.8493E-24, -6.3356E-24, -5.9932E-24, -5.6410E-24, -5.3082E-24, &
      -4.7945E-24, -4.6233E-24, -4.4444E-24, -4.1096E-24, -3.7671E-24, -3.5897E-24, &
      -3.4247E-24, -3.2534E-24, -3.0822E-24, -2.9060E-24, -2.4307E-24, -1.8487E-24, &
      -1.4031E-24, -1.0613E-24, -8.5587E-25, -6.5024E-25, -5.1352E-25, -3.7658E-25, &
      -3.0801E-25, -2.3964E-25, -2.0541E-25, -1.3689E-25, -1.0270E-25, -1.0270E-25, &
      -6.8446E-26 /)
    REAL, PARAMETER :: b3_CH2ClI(dim55) = (/ &
       3.4124E-19,  3.1834E-19,  2.8557E-19,  2.6000E-19,  2.4285E-19,  2.3122E-19, &
       2.2305E-19,  2.1689E-19,  2.1216E-19,  2.0829E-19,  2.0529E-19,  2.0264E-19, &
       2.0036E-19,  1.9854E-19,  1.9658E-19,  1.9508E-19,  1.9380E-19,  1.9226E-19, &
       1.9119E-19,  1.9024E-19,  1.8902E-19,  1.8820E-19,  1.8732E-19,  1.8640E-19, &
       1.8566E-19,  1.8493E-19,  1.8415E-19,  1.8361E-19,  1.8303E-19,  1.8247E-19, &
       1.8157E-19,  1.8126E-19,  1.8092E-19,  1.8028E-19,  1.7960E-19,  1.7923E-19, &
       1.7889E-19,  1.7851E-19,  1.7813E-19,  1.7773E-19,  1.7662E-19,  1.7509E-19, &
       1.7379E-19,  1.7269E-19,  1.7197E-19,  1.7119E-19,  1.7063E-19,  1.7003E-19, &
       1.6971E-19,  1.6937E-19,  1.6919E-19,  1.6881E-19,  1.6861E-19,  1.6861E-19, &
       1.6839E-19 /)
    REAL, PARAMETER :: a4_CH2ClI(4) = (/  1.1430E-19, -1.5472E-23,  3.2235E-27, -2.2544E-31 /)
    REAL, PARAMETER :: a5_CH2ClI(4) = (/  3.2958E-20, -6.0249E-24,  1.0139E-27, -6.3734E-32 /)
    REAL, PARAMETER :: a6_CH2ClI(4) = (/  1.0135E-21, -1.6595E-26,  1.9857E-31, -1.4761E-36 /)

    jval_2d(ip_CH2ClI)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_CH2ClI(1) = &
          (p1(b1_1_CH2ClI(i1(j,k)),a1_1_CH2ClI(i1(j,k)), &
          v3_du1(j,k)) + &
          p1(b1_2_CH2ClI(i1(j,k)),a1_2_CH2ClI(i1(j,k)), &
          v3_du1(j,k)) * v2s_m(j,k))
        sig_CH2ClI(2) = &
          p1(b2_CH2ClI(i2(j,k)), a2_CH2ClI(i2(j,k)), &
          v3_du1(j,k))
        sig_CH2ClI(3) = &
          p1(b3_CH2ClI(i3(j,k)), a3_CH2ClI(i3(j,k)), &
          v3_du2(j,k))
        sig_CH2ClI(4) = &
          p3(a4_CH2ClI(1),a4_CH2ClI(2),a4_CH2ClI(3), &
          a4_CH2ClI(4),v3_du2(j,k))
        sig_CH2ClI(5) = &
          p3(a5_CH2ClI(1),a5_CH2ClI(2),a5_CH2ClI(3), &
          a5_CH2ClI(4),v3_du2(j,k))
        sig_CH2ClI(6) = &
          p3(a6_CH2ClI(1),a6_CH2ClI(2),a6_CH2ClI(3), &
          a6_CH2ClI(4),v3_du2(j,k))
        dj = 0. &
          + sig_CH2ClI(1) * fint(j,k,1) &
          + sig_CH2ClI(2) * fint(j,k,2) &
          + sig_CH2ClI(3) * fint(j,k,3) &
          + sig_CH2ClI(4) * fint(j,k,4) &
          + sig_CH2ClI(5) * fint(j,k,5) &
          + sig_CH2ClI(6) * fint(j,k,6)

        jval_2d(ip_CH2ClI)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,2)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_CH2ClI

  ! **************************************************************************

  SUBROUTINE jval_cal_CH2I2

    ! CH_2I_2 \TOHV\ \products

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_CH2I2

    ! T-const parameters:
    REAL, PARAMETER :: a1_1_CH2I2(dim55) = (/ &
       5.3661E-20,  5.1029E-20,  4.8085E-20,  4.3653E-20,  3.8939E-20,  3.4568E-20, &
       2.9594E-20,  2.6185E-20,  2.1796E-20,  1.9482E-20,  1.5760E-20,  1.4396E-20, &
       1.1291E-20,  1.0561E-20,  7.9353E-21,  7.7015E-21,  5.4044E-21,  5.4769E-21, &
       3.4519E-21,  3.7422E-21,  1.9364E-21,  2.3690E-21,  6.8932E-22,  1.2456E-21, &
      -2.7585E-22,  3.4549E-22, -1.0723E-21, -4.1015E-22, -1.7397E-21, -1.0357E-21, &
      -2.2832E-21, -1.5507E-21, -2.7472E-21, -1.9794E-21, -3.1298E-21, -2.3578E-21, &
      -3.4365E-21, -2.6791E-21, -3.7030E-21, -2.9410E-21, -3.7738E-21, -3.9870E-21, &
      -4.3925E-21, -4.4056E-21, -4.6405E-21, -4.5587E-21, -4.6982E-21, -4.5717E-21, &
      -4.8347E-21, -4.7318E-21, -4.6202E-21, -4.5041E-21, -4.3858E-21, -4.2647E-21, &
      -4.1431E-21 /)
    REAL, PARAMETER :: b1_1_CH2I2(dim55) = (/ &
       2.0846E-18,  2.0925E-18,  2.1087E-18,  2.1441E-18,  2.1936E-18,  2.2504E-18, &
       2.3275E-18,  2.3889E-18,  2.4789E-18,  2.5321E-18,  2.6270E-18,  2.6652E-18, &
       2.7599E-18,  2.7840E-18,  2.8772E-18,  2.8861E-18,  2.9791E-18,  2.9760E-18, &
       3.0681E-18,  3.0542E-18,  3.1454E-18,  3.1225E-18,  3.2157E-18,  3.1834E-18, &
       3.2755E-18,  3.2363E-18,  3.3292E-18,  3.2842E-18,  3.3779E-18,  3.3265E-18, &
       3.4207E-18,  3.3636E-18,  3.4599E-18,  3.3961E-18,  3.4945E-18,  3.4266E-18, &
       3.5242E-18,  3.4538E-18,  3.5515E-18,  3.4769E-18,  3.5606E-18,  3.5847E-18, &
       3.6355E-18,  3.6373E-18,  3.6727E-18,  3.6594E-18,  3.6839E-18,  3.6601E-18, &
       3.7128E-18,  3.6909E-18,  3.6657E-18,  3.6381E-18,  3.6085E-18,  3.5766E-18, &
       3.5431E-18 /)
    REAL, PARAMETER :: a1_2_CH2I2(dim55) = (/ &
      -7.7916E-23, -2.0590E-23,  7.3092E-24,  4.4282E-23,  7.0531E-23,  8.0878E-23, &
       1.0154E-22,  9.2292E-23,  1.0760E-22,  8.8216E-23,  1.0153E-22,  7.8026E-23, &
       9.0547E-23,  6.6894E-23,  7.9255E-23,  5.6462E-23,  6.8983E-23,  4.7815E-23, &
       6.0176E-23,  4.0684E-23,  5.2644E-23,  3.4699E-23,  4.6634E-23,  2.9958E-23, &
       4.1181E-23,  2.5851E-23,  3.6704E-23,  2.2511E-23,  3.2864E-23,  1.9724E-23, &
       2.9538E-23,  1.7237E-23,  2.6720E-23,  1.5096E-23,  2.4176E-23,  1.3380E-23, &
       2.1897E-23,  1.1885E-23,  1.9923E-23,  1.0524E-23,  1.3551E-23,  9.3685E-24, &
       8.6087E-24,  5.8771E-24,  5.6385E-24,  3.7462E-24,  3.7277E-24,  2.3546E-24, &
       3.4950E-24,  2.6409E-24,  1.9057E-24,  1.2773E-24,  7.3316E-25,  2.5934E-25, &
      -1.4537E-25 /)
    REAL, PARAMETER :: b1_2_CH2I2(dim55) = (/ &
      -3.5753E-21, -3.7472E-21, -3.9007E-21, -4.1965E-21, -4.4721E-21, -4.6066E-21, &
      -4.9268E-21, -4.7604E-21, -5.0741E-21, -4.6284E-21, -4.9679E-21, -4.3098E-21, &
      -4.6917E-21, -3.9111E-21, -4.3499E-21, -3.4838E-21, -3.9909E-21, -3.0807E-21, &
      -3.6431E-21, -2.7075E-21, -3.3114E-21, -2.3604E-21, -3.0228E-21, -2.0556E-21, &
      -2.7346E-21, -1.7688E-21, -2.4796E-21, -1.5145E-21, -2.2444E-21, -1.2852E-21, &
      -2.0262E-21, -1.0667E-21, -1.8300E-21, -8.6528E-22, -1.6416E-21, -6.9153E-22, &
      -1.4623E-21, -5.3118E-22, -1.2989E-21, -3.7776E-22, -6.8193E-22, -2.0932E-22, &
      -1.1397E-22,  2.6299E-22,  2.9890E-22,  6.0735E-22,  6.1059E-22,  8.6873E-22, &
       6.4008E-22,  8.2201E-22,  9.8780E-22,  1.1373E-21,  1.2737E-21,  1.3983E-21, &
       1.5098E-21 /)
    REAL, PARAMETER :: a2_CH2I2(dim55) = (/ &
       8.5800E-20,  7.8640E-20,  6.7520E-20,  5.5000E-20,  4.3200E-20,  3.3120E-20, &
       2.5040E-20,  1.8920E-20,  1.4280E-20,  1.0920E-20,  8.4000E-21,  6.6000E-21, &
       5.2400E-21,  4.2000E-21,  3.4800E-21,  2.8400E-21,  2.4000E-21,  2.0400E-21, &
       1.7600E-21,  1.5200E-21,  1.3200E-21,  1.1600E-21,  1.0800E-21,  9.2000E-22, &
       8.4000E-22,  7.6000E-22,  6.8000E-22,  6.4000E-22,  5.6000E-22,  5.2000E-22, &
       4.8000E-22,  4.4000E-22,  4.4000E-22,  3.6000E-22,  3.6000E-22,  3.2000E-22, &
       3.2000E-22,  2.8000E-22,  2.4000E-22,  2.4000E-22,  2.0000E-22,  1.4400E-22, &
       1.0400E-22,  7.2000E-23,  4.8000E-23,  4.0000E-23,  3.2000E-23,  1.6000E-23, &
       1.6000E-23,  8.0000E-24,  8.0000E-24,  8.0000E-24,  8.0000E-24,  0.0000E+00, &
       0.0000E+00 /)
    REAL, PARAMETER :: b2_CH2I2(dim55) = (/ &
       2.5064E-18,  2.5279E-18,  2.5890E-18,  2.6892E-18,  2.8131E-18,  2.9441E-18, &
       3.0694E-18,  3.1795E-18,  3.2747E-18,  3.3519E-18,  3.4162E-18,  3.4666E-18, &
       3.5081E-18,  3.5424E-18,  3.5680E-18,  3.5923E-18,  3.6101E-18,  3.6256E-18, &
       3.6383E-18,  3.6498E-18,  3.6599E-18,  3.6684E-18,  3.6729E-18,  3.6821E-18, &
       3.6870E-18,  3.6920E-18,  3.6973E-18,  3.7000E-18,  3.7056E-18,  3.7085E-18, &
       3.7116E-18,  3.7147E-18,  3.7147E-18,  3.7213E-18,  3.7213E-18,  3.7248E-18, &
       3.7248E-18,  3.7286E-18,  3.7324E-18,  3.7324E-18,  3.7364E-18,  3.7427E-18, &
       3.7477E-18,  3.7522E-18,  3.7558E-18,  3.7571E-18,  3.7585E-18,  3.7615E-18, &
       3.7615E-18,  3.7632E-18,  3.7632E-18,  3.7632E-18,  3.7632E-18,  3.7653E-18, &
       3.7653E-18 /)
    REAL, PARAMETER :: a3_CH2I2(dim55) = (/ &
      -1.0731E-21, -7.3601E-22, -4.5867E-22, -2.9779E-22, -2.0541E-22, -1.5403E-22, &
      -1.1809E-22, -9.7569E-23, -7.8727E-23, -6.6747E-23, -5.8199E-23, -5.1343E-23, &
      -4.4498E-23, -4.1082E-23, -3.5940E-23, -3.2523E-23, -2.9095E-23, -2.7374E-23, &
      -2.3973E-23, -2.2260E-23, -2.0513E-23, -2.0548E-23, -1.7123E-23, -1.7123E-23, &
      -1.5385E-23, -1.5411E-23, -1.3699E-23, -1.1986E-23, -1.1966E-23, -1.0274E-23, &
      -1.1986E-23, -8.5616E-24, -1.0256E-23, -8.5616E-24, -8.5616E-24, -6.8376E-24, &
      -6.8493E-24, -6.8493E-24, -6.8493E-24, -6.8376E-24, -5.1352E-24, -4.1082E-24, &
      -3.0801E-24, -2.3964E-24, -1.7117E-24, -1.3689E-24, -1.0270E-24, -1.0270E-24, &
      -6.8446E-25, -6.8470E-25, -3.4235E-25, -3.4223E-25,  0.0000E+00, -3.4235E-25, &
       0.0000E+00 /)
    REAL, PARAMETER :: b3_CH2I2(dim55) = (/ &
       3.6178E-18,  3.5980E-18,  3.5654E-18,  3.5371E-18,  3.5155E-18,  3.5005E-18, &
       3.4879E-18,  3.4795E-18,  3.4706E-18,  3.4643E-18,  3.4593E-18,  3.4549E-18, &
       3.4501E-18,  3.4475E-18,  3.4433E-18,  3.4403E-18,  3.4371E-18,  3.4354E-18, &
       3.4318E-18,  3.4299E-18,  3.4279E-18,  3.4279E-18,  3.4235E-18,  3.4235E-18, &
       3.4211E-18,  3.4211E-18,  3.4185E-18,  3.4158E-18,  3.4158E-18,  3.4129E-18, &
       3.4159E-18,  3.4097E-18,  3.4129E-18,  3.4096E-18,  3.4096E-18,  3.4061E-18, &
       3.4061E-18,  3.4061E-18,  3.4061E-18,  3.4061E-18,  3.4021E-18,  3.3994E-18, &
       3.3964E-18,  3.3942E-18,  3.3918E-18,  3.3905E-18,  3.3891E-18,  3.3891E-18, &
       3.3875E-18,  3.3875E-18,  3.3857E-18,  3.3857E-18,  3.3837E-18,  3.3858E-18, &
       3.3836E-18 /)
    REAL, PARAMETER :: a4_CH2I2(4) = (/  3.1277E-18, -9.6592E-23,  1.8884E-26, -1.2758E-30 /)
    REAL, PARAMETER :: a5_CH2I2(4) = (/  1.8900E-18, -1.6931E-22,  2.5552E-26, -1.5374E-30 /)
    REAL, PARAMETER :: a6_CH2I2(4) = (/  9.0292E-20, -1.5286E-24,  1.8144E-29, -1.2740E-34 /)

    jval_2d(ip_CH2I2)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_CH2I2(1) = &
          (p1(b1_1_CH2I2(i1(j,k)),a1_1_CH2I2(i1(j,k)), &
          v3_du1(j,k)) + &
          p1(b1_2_CH2I2(i1(j,k)),a1_2_CH2I2(i1(j,k)), &
          v3_du1(j,k)) * v2s_m(j,k))
        sig_CH2I2(2) = &
          p1(b2_CH2I2(i2(j,k)), a2_CH2I2(i2(j,k)), &
          v3_du1(j,k))
        sig_CH2I2(3) = &
          p1(b3_CH2I2(i3(j,k)), a3_CH2I2(i3(j,k)), &
          v3_du2(j,k))
        sig_CH2I2(4) = &
          p3(a4_CH2I2(1),a4_CH2I2(2),a4_CH2I2(3), &
          a4_CH2I2(4),v3_du2(j,k))
        sig_CH2I2(5) = &
          p3(a5_CH2I2(1),a5_CH2I2(2),a5_CH2I2(3), &
          a5_CH2I2(4),v3_du2(j,k))
        sig_CH2I2(6) = &
          p3(a6_CH2I2(1),a6_CH2I2(2),a6_CH2I2(3), &
          a6_CH2I2(4),v3_du2(j,k))
        dj = 0. &
          + sig_CH2I2(1) * fint(j,k,1) &
          + sig_CH2I2(2) * fint(j,k,2) &
          + sig_CH2I2(3) * fint(j,k,3) &
          + sig_CH2I2(4) * fint(j,k,4) &
          + sig_CH2I2(5) * fint(j,k,5) &
          + sig_CH2I2(6) * fint(j,k,6)

        jval_2d(ip_CH2I2)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,1)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_CH2I2

  ! **************************************************************************

  SUBROUTINE jval_cal_IO

    ! IO \TOHV\ I + O

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_IO

    ! T-const parameters:
    REAL, PARAMETER :: a6_IO(4) = (/  5.2381E-18,  1.1589E-23, -1.1794E-28,  7.4466E-34 /)
    REAL, PARAMETER :: a7_IO(4) = (/  5.1427E-19,  3.1959E-23,  5.3076E-28, -1.1572E-32 /)

    jval_2d(ip_IO)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_IO(6) = &
          p3(a6_IO(1),a6_IO(2),a6_IO(3), &
          a6_IO(4),v3_du2(j,k))
        sig_IO(7) = &
          p3(a7_IO(1),a7_IO(2),a7_IO(3), &
          a7_IO(4),v3_du2(j,k))
        dj = 0. &
          + sig_IO(6) * fint(j,k,6) &
          + sig_IO(7) * fint(j,k,7)

        jval_2d(ip_IO)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,1)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_IO

  ! **************************************************************************

  SUBROUTINE jval_cal_HOI

    ! HOI \TOHV\ \products

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_HOI

    ! T-const parameters:
    REAL, PARAMETER :: a2_HOI(dim55) = (/ &
       1.2032E-22,  1.2024E-22,  1.1296E-22,  1.0120E-22,  8.7840E-23,  7.4800E-23, &
       6.3240E-23,  5.3440E-23,  4.5440E-23,  3.8920E-23,  3.3680E-23,  2.9360E-23, &
       2.5920E-23,  2.3000E-23,  2.0600E-23,  1.8560E-23,  1.6840E-23,  1.5320E-23, &
       1.4040E-23,  1.2880E-23,  1.1840E-23,  1.0960E-23,  1.0120E-23,  9.4000E-24, &
       8.7600E-24,  8.1200E-24,  7.5600E-24,  7.0800E-24,  6.5600E-24,  6.1600E-24, &
       5.7600E-24,  5.4000E-24,  5.0400E-24,  4.6800E-24,  4.4400E-24,  4.1200E-24, &
       3.8800E-24,  3.6400E-24,  3.4000E-24,  3.2000E-24,  2.6560E-24,  1.9200E-24, &
       1.4080E-24,  1.0160E-24,  7.4400E-25,  5.3600E-25,  3.9200E-25,  2.8800E-25, &
       2.0000E-25,  1.5200E-25,  1.1200E-25,  8.0000E-26,  5.6000E-26,  4.0000E-26, &
       3.2000E-26 /)
    REAL, PARAMETER :: b2_HOI(dim55) = (/ &
       1.0736E-21,  1.0739E-21,  1.1139E-21,  1.2080E-21,  1.3483E-21,  1.5178E-21, &
       1.6970E-21,  1.8734E-21,  2.0374E-21,  2.1873E-21,  2.3210E-21,  2.4419E-21, &
       2.5468E-21,  2.6432E-21,  2.7284E-21,  2.8059E-21,  2.8756E-21,  2.9409E-21, &
       2.9992E-21,  3.0549E-21,  3.1074E-21,  3.1540E-21,  3.2006E-21,  3.2424E-21, &
       3.2811E-21,  3.3214E-21,  3.3581E-21,  3.3908E-21,  3.4274E-21,  3.4566E-21, &
       3.4868E-21,  3.5149E-21,  3.5439E-21,  3.5738E-21,  3.5943E-21,  3.6224E-21, &
       3.6442E-21,  3.6665E-21,  3.6894E-21,  3.7090E-21,  3.7637E-21,  3.8468E-21, &
       3.9111E-21,  3.9652E-21,  4.0061E-21,  4.0400E-21,  4.0653E-21,  4.0849E-21, &
       4.1025E-21,  4.1127E-21,  4.1217E-21,  4.1294E-21,  4.1354E-21,  4.1396E-21, &
       4.1418E-21 /)
    REAL, PARAMETER :: a3_HOI(dim55) = (/ &
       1.2912E-22,  9.1745E-23,  5.9336E-23,  3.9774E-23,  2.8518E-23,  2.1650E-23, &
       1.7166E-23,  1.4088E-23,  1.1843E-23,  1.0166E-23,  8.8668E-24,  7.8042E-24, &
       6.9485E-24,  6.2479E-24,  5.6478E-24,  5.1181E-24,  4.6894E-24,  4.2943E-24, &
       3.9555E-24,  3.6644E-24,  3.3846E-24,  3.1336E-24,  2.9281E-24,  2.7226E-24, &
       2.5470E-24,  2.3973E-24,  2.2260E-24,  2.0890E-24,  1.9658E-24,  1.8664E-24, &
       1.7295E-24,  1.6438E-24,  1.5385E-24,  1.4555E-24,  1.3870E-24,  1.2991E-24, &
       1.2158E-24,  1.1644E-24,  1.0959E-24,  1.0427E-24,  8.7984E-25,  6.7785E-25, &
       5.1677E-25,  4.0055E-25,  3.1154E-25,  2.4298E-25,  1.8829E-25,  1.4721E-25, &
       1.1636E-25,  8.9011E-26,  7.1893E-26,  5.4757E-26,  4.4505E-26,  3.4235E-26, &
       2.7379E-26 /)
    REAL, PARAMETER :: b3_HOI(dim55) = (/ &
       2.6094E-20,  2.8297E-20,  3.2100E-20,  3.5539E-20,  3.8175E-20,  4.0185E-20, &
       4.1759E-20,  4.3019E-20,  4.4069E-20,  4.4952E-20,  4.5712E-20,  4.6395E-20, &
       4.6996E-20,  4.7528E-20,  4.8019E-20,  4.8484E-20,  4.8885E-20,  4.9278E-20, &
       4.9634E-20,  4.9957E-20,  5.0284E-20,  5.0593E-20,  5.0857E-20,  5.1133E-20, &
       5.1379E-20,  5.1598E-20,  5.1858E-20,  5.2074E-20,  5.2276E-20,  5.2445E-20, &
       5.2685E-20,  5.2840E-20,  5.3037E-20,  5.3197E-20,  5.3333E-20,  5.3513E-20, &
       5.3688E-20,  5.3799E-20,  5.3951E-20,  5.4073E-20,  5.4453E-20,  5.4984E-20, &
       5.5455E-20,  5.5829E-20,  5.6141E-20,  5.6401E-20,  5.6625E-20,  5.6805E-20, &
       5.6949E-20,  5.7085E-20,  5.7175E-20,  5.7270E-20,  5.7330E-20,  5.7393E-20, &
       5.7437E-20 /)
    REAL, PARAMETER :: a4_HOI(4) = (/  9.8670E-20,  1.5891E-23, -3.1155E-27,  2.1097E-31 /)
    REAL, PARAMETER :: a5_HOI(4) = (/  2.9533E-19,  2.4524E-23, -3.9037E-27,  2.3880E-31 /)
    REAL, PARAMETER :: a6_HOI(4) = (/  2.6801E-19, -2.8674E-25,  2.9821E-30, -6.2075E-36 /)
    REAL, PARAMETER :: a7_HOI(4) = (/  1.1676E-20,  7.3109E-25,  1.2391E-29, -2.5829E-34 /)

    jval_2d(ip_HOI)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_HOI(2) = &
          p1(b2_HOI(i2(j,k)), a2_HOI(i2(j,k)), &
          v3_du1(j,k))
        sig_HOI(3) = &
          p1(b3_HOI(i3(j,k)), a3_HOI(i3(j,k)), &
          v3_du2(j,k))
        sig_HOI(4) = &
          p3(a4_HOI(1),a4_HOI(2),a4_HOI(3), &
          a4_HOI(4),v3_du2(j,k))
        sig_HOI(5) = &
          p3(a5_HOI(1),a5_HOI(2),a5_HOI(3), &
          a5_HOI(4),v3_du2(j,k))
        sig_HOI(6) = &
          p3(a6_HOI(1),a6_HOI(2),a6_HOI(3), &
          a6_HOI(4),v3_du2(j,k))
        sig_HOI(7) = &
          p3(a7_HOI(1),a7_HOI(2),a7_HOI(3), &
          a7_HOI(4),v3_du2(j,k))
        dj = 0. &
          + sig_HOI(2) * fint(j,k,2) &
          + sig_HOI(3) * fint(j,k,3) &
          + sig_HOI(4) * fint(j,k,4) &
          + sig_HOI(5) * fint(j,k,5) &
          + sig_HOI(6) * fint(j,k,6) &
          + sig_HOI(7) * fint(j,k,7)

        jval_2d(ip_HOI)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,1)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_HOI

  ! **************************************************************************

  SUBROUTINE jval_cal_I2

    ! I_2 \TOHV\ 2 I

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_I2

    ! T-const parameters:
    REAL, PARAMETER :: a0_1_1_I2(dim58) = (/ &
       1.1706E-19,  1.2121E-19,  1.2509E-19,  1.2746E-19,  1.3015E-19,  1.3217E-19, &
       1.3121E-19,  1.2916E-19,  1.2671E-19,  1.2304E-19,  1.1552E-19,  1.0814E-19, &
       9.6049E-20,  7.6500E-20,  6.5777E-20,  4.7459E-20,  2.4766E-20,  3.4823E-21, &
      -2.5618E-20, -6.3369E-20, -9.8373E-20, -1.4079E-19, -1.9342E-19, -2.3624E-19, &
      -2.8520E-19, -3.1640E-19, -3.5137E-19, -3.9065E-19, -4.2684E-19, -4.5994E-19, &
      -4.8918E-19, -5.1455E-19, -5.3643E-19, -5.5521E-19, -5.7046E-19, -5.8350E-19, &
      -5.9521E-19, -6.0601E-19, -6.1561E-19, -6.2459E-19, -6.3151E-19, -6.3558E-19, &
      -6.3524E-19, -6.2895E-19, -6.1515E-19, -5.9321E-19, -5.6288E-19, -5.2680E-19, &
      -4.8659E-19, -4.4549E-19, -4.0539E-19, -3.6669E-19, -3.2947E-19, -2.9305E-19, &
      -2.5717E-19, -2.2121E-19, -1.8355E-19, -1.5141E-19 /)
    REAL, PARAMETER :: a0_1_2_I2(dim58) = (/ &
       5.7282E-18,  5.5449E-18,  5.3722E-18,  5.2668E-18,  5.1462E-18,  5.0551E-18, &
       5.0987E-18,  5.1916E-18,  5.3037E-18,  5.4714E-18,  5.8174E-18,  6.1585E-18, &
       6.7195E-18,  7.6305E-18,  8.1323E-18,  8.9932E-18,  1.0064E-17,  1.1073E-17, &
       1.2458E-17,  1.4263E-17,  1.5943E-17,  1.7988E-17,  2.0535E-17,  2.2616E-17, &
       2.5005E-17,  2.6534E-17,  2.8255E-17,  3.0195E-17,  3.1990E-17,  3.3638E-17, &
       3.5100E-17,  3.6374E-17,  3.7477E-17,  3.8427E-17,  3.9202E-17,  3.9866E-17, &
       4.0466E-17,  4.1022E-17,  4.1517E-17,  4.1982E-17,  4.2342E-17,  4.2554E-17, &
       4.2536E-17,  4.2206E-17,  4.1477E-17,  4.0314E-17,  3.8700E-17,  3.6774E-17, &
       3.4619E-17,  3.2407E-17,  3.0242E-17,  2.8145E-17,  2.6120E-17,  2.4131E-17, &
       2.2165E-17,  2.0187E-17,  1.8108E-17,  1.6328E-17 /)
    REAL, PARAMETER :: a0_2_1_I2(dim58) = (/ &
       8.1318E-22,  8.9084E-22,  9.7546E-22,  1.0773E-21,  1.1806E-21,  1.2897E-21, &
       1.4194E-21,  1.5536E-21,  1.6880E-21,  1.8273E-21,  1.9866E-21,  2.1430E-21, &
       2.3439E-21,  2.6205E-21,  2.7395E-21,  2.9100E-21,  3.1076E-21,  3.2135E-21, &
       3.3454E-21,  3.5002E-21,  3.5165E-21,  3.5310E-21,  3.5591E-21,  3.3972E-21, &
       3.2394E-21,  2.8672E-21,  2.5223E-21,  2.2408E-21,  1.9666E-21,  1.7168E-21, &
       1.4947E-21,  1.3031E-21,  1.1460E-21,  1.0252E-21,  9.3886E-22,  8.9524E-22, &
       8.9226E-22,  9.2480E-22,  9.7861E-22,  1.0420E-21,  1.0969E-21,  1.1309E-21, &
       1.1376E-21,  1.1156E-21,  1.0679E-21,  9.9826E-22,  9.1173E-22,  8.1515E-22, &
       7.1523E-22,  6.1881E-22,  5.3047E-22,  4.4985E-22,  3.7697E-22,  3.0994E-22, &
       2.4917E-22,  1.9508E-22,  1.4887E-22,  1.1716E-22 /)
    REAL, PARAMETER :: a0_2_2_I2(dim58) = (/ &
      -5.4516E-20, -5.7948E-20, -6.1705E-20, -6.6248E-20, -7.0877E-20, -7.5784E-20, &
      -8.1646E-20, -8.7741E-20, -9.3866E-20, -1.0025E-19, -1.0758E-19, -1.1480E-19, &
      -1.2412E-19, -1.3701E-19, -1.4258E-19, -1.5059E-19, -1.5992E-19, -1.6494E-19, &
      -1.7122E-19, -1.7862E-19, -1.7940E-19, -1.8010E-19, -1.8146E-19, -1.7359E-19, &
      -1.6589E-19, -1.4765E-19, -1.3069E-19, -1.1678E-19, -1.0318E-19, -9.0738E-20, &
      -7.9632E-20, -7.0017E-20, -6.2097E-20, -5.5988E-20, -5.1599E-20, -4.9375E-20, &
      -4.9223E-20, -5.0895E-20, -5.3672E-20, -5.6957E-20, -5.9811E-20, -6.1587E-20, &
      -6.1934E-20, -6.0779E-20, -5.8259E-20, -5.4569E-20, -4.9966E-20, -4.4808E-20, &
      -3.9452E-20, -3.4265E-20, -2.9495E-20, -2.5125E-20, -2.1161E-20, -1.7501E-20, &
      -1.4171E-20, -1.1195E-20, -8.6446E-21, -6.8883E-21 /)
    REAL, PARAMETER :: a1_1_I2(dim55) = (/ &
       4.9229E-20,  4.6774E-20,  4.4984E-20,  4.1150E-20,  3.8153E-20,  3.4356E-20, &
       3.1355E-20,  2.8213E-20,  2.5727E-20,  2.3369E-20,  2.1400E-20,  1.9725E-20, &
       1.8183E-20,  1.6965E-20,  1.5748E-20,  1.4876E-20,  1.3895E-20,  1.3235E-20, &
       1.2439E-20,  1.1910E-20,  1.1242E-20,  1.0855E-20,  1.0271E-20,  9.9626E-21, &
       9.4571E-21,  9.2113E-21,  8.7578E-21,  8.5640E-21,  8.1671E-21,  8.0188E-21, &
       7.6488E-21,  7.5400E-21,  7.2076E-21,  7.1134E-21,  6.8077E-21,  6.7386E-21, &
       6.4702E-21,  6.4125E-21,  6.1623E-21,  6.1173E-21,  5.6753E-21,  5.1632E-21, &
       4.7121E-21,  4.3820E-21,  4.0596E-21,  3.8185E-21,  3.5678E-21,  3.3862E-21, &
       3.1257E-21,  2.9425E-21,  2.7750E-21,  2.6178E-21,  2.4702E-21,  2.3367E-21, &
       2.2098E-21 /)
    REAL, PARAMETER :: b1_1_I2(dim55) = (/ &
       2.7175E-18,  2.7249E-18,  2.7348E-18,  2.7654E-18,  2.7969E-18,  2.8462E-18, &
       2.8928E-18,  2.9493E-18,  3.0003E-18,  3.0545E-18,  3.1047E-18,  3.1516E-18, &
       3.1987E-18,  3.2389E-18,  3.2821E-18,  3.3152E-18,  3.3549E-18,  3.3833E-18, &
       3.4195E-18,  3.4449E-18,  3.4787E-18,  3.4991E-18,  3.5316E-18,  3.5495E-18, &
       3.5800E-18,  3.5955E-18,  3.6252E-18,  3.6384E-18,  3.6664E-18,  3.6772E-18, &
       3.7052E-18,  3.7136E-18,  3.7404E-18,  3.7482E-18,  3.7744E-18,  3.7804E-18, &
       3.8047E-18,  3.8101E-18,  3.8340E-18,  3.8384E-18,  3.8828E-18,  3.9407E-18, &
       3.9973E-18,  4.0429E-18,  4.0914E-18,  4.1307E-18,  4.1747E-18,  4.2088E-18, &
       4.2611E-18,  4.3001E-18,  4.3378E-18,  4.3752E-18,  4.4122E-18,  4.4473E-18, &
       4.4823E-18 /)
    REAL, PARAMETER :: a1_2_I2(dim55) = (/ &
      -8.6279E-23, -3.4275E-23, -2.5673E-23,  1.2660E-23,  1.9496E-23,  3.9439E-23, &
       4.1297E-23,  4.8745E-23,  4.7112E-23,  4.7130E-23,  4.4929E-23,  4.1622E-23, &
       3.9788E-23,  3.5711E-23,  3.4510E-23,  3.0217E-23,  2.9688E-23,  2.5869E-23, &
       2.5586E-23,  2.2417E-23,  2.2403E-23,  1.9432E-23,  1.9720E-23,  1.7118E-23, &
       1.7511E-23,  1.5096E-23,  1.5743E-23,  1.3564E-23,  1.4117E-23,  1.2085E-23, &
       1.2806E-23,  1.0887E-23,  1.1613E-23,  9.9396E-24,  1.0601E-23,  9.0195E-24, &
       9.6935E-24,  8.2736E-24,  8.8769E-24,  7.5485E-24,  7.2634E-24,  5.8916E-24, &
       5.1674E-24,  4.3226E-24,  3.9501E-24,  3.4135E-24,  3.2318E-24,  2.8355E-24, &
       3.0661E-24,  2.9516E-24,  2.8608E-24,  2.7844E-24,  2.7258E-24,  2.6590E-24, &
       2.6044E-24 /)
    REAL, PARAMETER :: b1_2_I2(dim55) = (/ &
      -3.3262E-21, -3.4822E-21, -3.5295E-21, -3.8362E-21, -3.9080E-21, -4.1672E-21, &
      -4.1960E-21, -4.3301E-21, -4.2966E-21, -4.2971E-21, -4.2409E-21, -4.1483E-21, &
      -4.0924E-21, -3.9578E-21, -3.9152E-21, -3.7521E-21, -3.7307E-21, -3.5664E-21, &
      -3.5536E-21, -3.4015E-21, -3.4007E-21, -3.2433E-21, -3.2592E-21, -3.1084E-21, &
      -3.1321E-21, -2.9800E-21, -3.0224E-21, -2.8742E-21, -2.9131E-21, -2.7648E-21, &
      -2.8193E-21, -2.6696E-21, -2.7280E-21, -2.5891E-21, -2.6457E-21, -2.5065E-21, &
      -2.5675E-21, -2.4355E-21, -2.4931E-21, -2.3629E-21, -2.3342E-21, -2.1792E-21, &
      -2.0883E-21, -1.9718E-21, -1.9157E-21, -1.8282E-21, -1.7963E-21, -1.7218E-21, &
      -1.7681E-21, -1.7437E-21, -1.7232E-21, -1.7050E-21, -1.6903E-21, -1.6728E-21, &
      -1.6577E-21 /)
    REAL, PARAMETER :: a2_I2(dim55) = (/ &
      -2.0532E-20, -1.8176E-20, -1.5132E-20, -1.1996E-20, -9.1880E-21, -6.9040E-21, &
      -5.1400E-21, -3.8400E-21, -2.8960E-21, -2.2160E-21, -1.7280E-21, -1.3760E-21, &
      -1.1160E-21, -9.2400E-22, -7.7600E-22, -6.6400E-22, -5.8000E-22, -5.0400E-22, &
      -4.4800E-22, -4.0000E-22, -3.6000E-22, -3.2800E-22, -3.0000E-22, -2.7200E-22, &
      -2.4800E-22, -2.2800E-22, -2.1600E-22, -1.9600E-22, -1.8000E-22, -1.6800E-22, &
      -1.6000E-22, -1.4400E-22, -1.3600E-22, -1.2800E-22, -1.2000E-22, -1.1200E-22, &
      -1.0400E-22, -9.6000E-23, -9.2000E-23, -8.4000E-23, -7.0400E-23, -5.0400E-23, &
      -3.6800E-23, -2.7200E-23, -1.9200E-23, -1.4400E-23, -1.0400E-23, -7.2000E-24, &
      -5.6000E-24, -3.2000E-24, -3.2000E-24, -2.4000E-24, -8.0000E-25, -1.6000E-24, &
      -8.0000E-25 /)
    REAL, PARAMETER :: b2_I2(dim55) = (/ &
       7.0382E-19,  6.9675E-19,  6.8001E-19,  6.5492E-19,  6.2543E-19,  5.9574E-19, &
       5.6840E-19,  5.4500E-19,  5.2565E-19,  5.1001E-19,  4.9756E-19,  4.8771E-19, &
       4.7978E-19,  4.7344E-19,  4.6819E-19,  4.6393E-19,  4.6053E-19,  4.5726E-19, &
       4.5471E-19,  4.5241E-19,  4.5039E-19,  4.4869E-19,  4.4714E-19,  4.4552E-19, &
       4.4406E-19,  4.4280E-19,  4.4202E-19,  4.4066E-19,  4.3953E-19,  4.3865E-19, &
       4.3805E-19,  4.3680E-19,  4.3616E-19,  4.3549E-19,  4.3481E-19,  4.3411E-19, &
       4.3338E-19,  4.3264E-19,  4.3226E-19,  4.3147E-19,  4.3011E-19,  4.2785E-19, &
       4.2614E-19,  4.2481E-19,  4.2361E-19,  4.2283E-19,  4.2213E-19,  4.2152E-19, &
       4.2120E-19,  4.2069E-19,  4.2069E-19,  4.2050E-19,  4.2010E-19,  4.2031E-19, &
       4.2009E-19 /)
    REAL, PARAMETER :: a3_I2(dim55) = (/ &
      -3.8629E-22, -2.4425E-22, -1.3965E-22, -8.3861E-23, -5.5460E-23, -3.9363E-23, &
      -2.9779E-23, -2.3622E-23, -1.9168E-23, -1.6088E-23, -1.3694E-23, -1.1980E-23, &
      -1.0440E-23, -9.4146E-24, -8.3861E-24, -7.5317E-24, -6.6747E-24, -6.3302E-24, &
      -5.6507E-24, -5.1370E-24, -4.7863E-24, -4.4521E-24, -4.1096E-24, -3.9384E-24, &
      -3.5897E-24, -3.2534E-24, -3.0822E-24, -2.9110E-24, -2.7350E-24, -2.5685E-24, &
      -2.3973E-24, -2.2260E-24, -2.2222E-24, -1.8836E-24, -1.8836E-24, -1.8803E-24, &
      -1.5411E-24, -1.7123E-24, -1.3699E-24, -1.3675E-24, -1.1982E-24, -9.2434E-25, &
      -6.8446E-25, -5.4776E-25, -4.1082E-25, -3.4223E-25, -2.3964E-25, -2.0541E-25, &
      -1.3689E-25, -1.3694E-25, -6.8470E-26, -1.0267E-25, -3.4235E-26, -6.8470E-26, &
      -3.4223E-26 /)
    REAL, PARAMETER :: b3_I2(dim55) = (/ &
       3.0082E-19,  2.9245E-19,  2.8018E-19,  2.7037E-19,  2.6372E-19,  2.5901E-19, &
       2.5564E-19,  2.5312E-19,  2.5104E-19,  2.4942E-19,  2.4802E-19,  2.4692E-19, &
       2.4583E-19,  2.4506E-19,  2.4421E-19,  2.4346E-19,  2.4266E-19,  2.4232E-19, &
       2.4161E-19,  2.4104E-19,  2.4063E-19,  2.4021E-19,  2.3977E-19,  2.3954E-19, &
       2.3906E-19,  2.3856E-19,  2.3830E-19,  2.3803E-19,  2.3775E-19,  2.3746E-19, &
       2.3716E-19,  2.3685E-19,  2.3685E-19,  2.3619E-19,  2.3619E-19,  2.3619E-19, &
       2.3547E-19,  2.3584E-19,  2.3508E-19,  2.3508E-19,  2.3468E-19,  2.3396E-19, &
       2.3326E-19,  2.3282E-19,  2.3234E-19,  2.3208E-19,  2.3166E-19,  2.3151E-19, &
       2.3119E-19,  2.3119E-19,  2.3083E-19,  2.3102E-19,  2.3062E-19,  2.3083E-19, &
       2.3061E-19 /)
    REAL, PARAMETER :: a4_I2(4) = (/  1.8603E-19, -1.2896E-23,  2.6964E-27, -1.8892E-31 /)
    REAL, PARAMETER :: a5_I2(4) = (/  9.6290E-20, -9.3286E-24,  1.4590E-27, -8.9173E-32 /)
    REAL, PARAMETER :: a6_I2(4) = (/  2.9742E-20, -3.4303E-26,  4.4978E-31, -5.3359E-36 /)
    REAL, PARAMETER :: a7_I2(4) = (/  1.1367E-18, -5.7340E-26, -3.3879E-28,  1.8412E-33 /)

    jval_2d(ip_I2)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_I2(0) = &
          p1(a0_1_1_I2(i0(j,k))*dlv2(j,k) + &
          a0_1_2_I2(i0(j,k)), &
          a0_2_1_I2(i0(j,k))*dlv2(j,k) + &
          a0_2_2_I2(i0(j,k)),v3_du1(j,k))
        sig_I2(1) = &
          (p1(b1_1_I2(i1(j,k)),a1_1_I2(i1(j,k)), &
          v3_du1(j,k)) + &
          p1(b1_2_I2(i1(j,k)),a1_2_I2(i1(j,k)), &
          v3_du1(j,k)) * v2s_m(j,k))
        sig_I2(2) = &
          p1(b2_I2(i2(j,k)), a2_I2(i2(j,k)), &
          v3_du1(j,k))
        sig_I2(3) = &
          p1(b3_I2(i3(j,k)), a3_I2(i3(j,k)), &
          v3_du2(j,k))
        sig_I2(4) = &
          p3(a4_I2(1),a4_I2(2),a4_I2(3), &
          a4_I2(4),v3_du2(j,k))
        sig_I2(5) = &
          p3(a5_I2(1),a5_I2(2),a5_I2(3), &
          a5_I2(4),v3_du2(j,k))
        sig_I2(6) = &
          p3(a6_I2(1),a6_I2(2),a6_I2(3), &
          a6_I2(4),v3_du2(j,k))
        sig_I2(7) = &
          p3(a7_I2(1),a7_I2(2),a7_I2(3), &
          a7_I2(4),v3_du2(j,k))
        dj = 0. &
          + sig_I2(0) * fint(j,k,0) &
          + sig_I2(1) * fint(j,k,1) &
          + sig_I2(2) * fint(j,k,2) &
          + sig_I2(3) * fint(j,k,3) &
          + sig_I2(4) * fint(j,k,4) &
          + sig_I2(5) * fint(j,k,5) &
          + sig_I2(6) * fint(j,k,6) &
          + sig_I2(7) * fint(j,k,7)

        jval_2d(ip_I2)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,1)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_I2

  ! **************************************************************************

  SUBROUTINE jval_cal_ICl

    ! ICl \TOHV\ \products

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_ICl

    ! T-const parameters:
    REAL, PARAMETER :: a1_1_ICl(dim55) = (/ &
      -8.7776E-21, -8.2668E-21, -7.7873E-21, -7.0446E-21, -6.3649E-21, -5.6535E-21, &
      -4.9974E-21, -4.4407E-21, -3.8959E-21, -3.5070E-21, -3.0799E-21, -2.8214E-21, &
      -2.4879E-21, -2.3188E-21, -2.0585E-21, -1.9492E-21, -1.7379E-21, -1.6673E-21, &
      -1.4951E-21, -1.4489E-21, -1.3026E-21, -1.2768E-21, -1.1504E-21, -1.1365E-21, &
      -1.0254E-21, -1.0212E-21, -9.2166E-22, -9.2510E-22, -8.3522E-22, -8.4317E-22, &
      -7.6186E-22, -7.7380E-22, -6.9767E-22, -7.1381E-22, -6.4337E-22, -6.6134E-22, &
      -5.9521E-22, -6.1515E-22, -5.5326E-22, -5.7455E-22, -4.9889E-22, -4.3577E-22, &
      -3.7213E-22, -3.3389E-22, -2.8857E-22, -2.6351E-22, -2.2838E-22, -2.1134E-22, &
      -1.6789E-22, -1.4909E-22, -1.3235E-22, -1.1742E-22, -1.0409E-22, -9.2249E-23, &
      -8.1691E-23 /)
    REAL, PARAMETER :: b1_1_ICl(dim55) = (/ &
       3.0272E-19,  3.0118E-19,  2.9855E-19,  2.9260E-19,  2.8547E-19,  2.7622E-19, &
       2.6605E-19,  2.5603E-19,  2.4486E-19,  2.3592E-19,  2.2502E-19,  2.1779E-19, &
       2.0762E-19,  2.0204E-19,  1.9279E-19,  1.8864E-19,  1.8008E-19,  1.7705E-19, &
       1.6921E-19,  1.6700E-19,  1.5961E-19,  1.5824E-19,  1.5122E-19,  1.5042E-19, &
       1.4370E-19,  1.4344E-19,  1.3691E-19,  1.3715E-19,  1.3081E-19,  1.3139E-19, &
       1.2525E-19,  1.2618E-19,  1.2005E-19,  1.2139E-19,  1.1537E-19,  1.1695E-19, &
       1.1097E-19,  1.1282E-19,  1.0691E-19,  1.0900E-19,  1.0139E-19,  9.4262E-20, &
       8.6275E-20,  8.0997E-20,  7.4177E-20,  7.0092E-20,  6.3928E-20,  6.0724E-20, &
       5.2011E-20,  4.8007E-20,  4.4232E-20,  4.0679E-20,  3.7341E-20,  3.4226E-20, &
       3.1317E-20 /)
    REAL, PARAMETER :: a1_2_ICl(dim55) = (/ &
       1.1724E-23,  2.8054E-24, -1.7455E-25, -6.0133E-24, -8.3244E-24, -1.0598E-23, &
      -1.1818E-23, -1.1585E-23, -1.2112E-23, -1.0632E-23, -1.0911E-23, -9.0398E-24, &
      -9.3248E-24, -7.4965E-24, -7.7971E-24, -6.1575E-24, -6.5185E-24, -5.0887E-24, &
      -5.4870E-24, -4.2623E-24, -4.6756E-24, -3.5905E-24, -4.0206E-24, -3.0717E-24, &
      -3.4966E-24, -2.6483E-24, -3.0741E-24, -2.3042E-24, -2.7171E-24, -2.0293E-24, &
      -2.4179E-24, -1.7914E-24, -2.1816E-24, -1.5938E-24, -1.9638E-24, -1.4284E-24, &
      -1.7860E-24, -1.2896E-24, -1.6286E-24, -1.1667E-24, -1.2363E-24, -9.5193E-25, &
      -8.5737E-25, -6.8210E-25, -6.4435E-25, -5.2312E-25, -5.1299E-25, -4.2099E-25, &
      -5.0860E-25, -4.6914E-25, -4.3453E-25, -4.0360E-25, -3.7557E-25, -3.4952E-25, &
      -3.2524E-25 /)
    REAL, PARAMETER :: b1_2_ICl(dim55) = (/ &
       5.9214E-22,  6.1889E-22,  6.3528E-22,  6.8199E-22,  7.0626E-22,  7.3582E-22, &
       7.5472E-22,  7.5054E-22,  7.6133E-22,  7.2730E-22,  7.3442E-22,  6.8201E-22, &
       6.9070E-22,  6.3037E-22,  6.4104E-22,  5.7874E-22,  5.9336E-22,  5.3188E-22, &
       5.5000E-22,  4.9122E-22,  5.1209E-22,  4.5458E-22,  4.7844E-22,  4.2341E-22, &
       4.4912E-22,  3.9567E-22,  4.2357E-22,  3.7121E-22,  4.0032E-22,  3.5011E-22, &
       3.7945E-22,  3.3058E-22,  3.6199E-22,  3.1321E-22,  3.4484E-22,  2.9773E-22, &
       3.3009E-22,  2.8392E-22,  3.1629E-22,  2.7103E-22,  2.7803E-22,  2.4589E-22, &
       2.3403E-22,  2.0984E-22,  2.0416E-22,  1.8440E-22,  1.8262E-22,  1.6532E-22, &
       1.8289E-22,  1.7448E-22,  1.6668E-22,  1.5932E-22,  1.5230E-22,  1.4544E-22, &
       1.3876E-22 /)
    REAL, PARAMETER :: a2_ICl(dim55) = (/ &
      -1.0124E-20, -8.9720E-21, -7.4840E-21, -5.9360E-21, -4.5520E-21, -3.4160E-21, &
      -2.5440E-21, -1.8920E-21, -1.4224E-21, -1.0828E-21, -8.3800E-22, -6.6160E-22, &
      -5.3240E-22, -4.3640E-22, -3.6400E-22, -3.0880E-22, -2.6560E-22, -2.3080E-22, &
      -2.0360E-22, -1.8080E-22, -1.6200E-22, -1.4600E-22, -1.3240E-22, -1.2040E-22, &
      -1.1040E-22, -1.0160E-22, -9.3200E-23, -8.6400E-23, -8.0000E-23, -7.4000E-23, &
      -6.8800E-23, -6.4400E-23, -5.9600E-23, -5.5600E-23, -5.2000E-23, -4.8400E-23, &
      -4.5200E-23, -4.2400E-23, -3.9600E-23, -3.7200E-23, -3.0640E-23, -2.2160E-23, &
      -1.6080E-23, -1.1680E-23, -8.4800E-24, -6.0800E-24, -4.4800E-24, -3.2800E-24, &
      -2.3200E-24, -1.7600E-24, -1.2000E-24, -8.8000E-25, -7.2000E-25, -4.0000E-25, &
      -4.0000E-25 /)
    REAL, PARAMETER :: b2_ICl(dim55) = (/ &
       2.1742E-19,  2.1397E-19,  2.0578E-19,  1.9340E-19,  1.7887E-19,  1.6410E-19, &
       1.5058E-19,  1.3885E-19,  1.2922E-19,  1.2141E-19,  1.1517E-19,  1.1023E-19, &
       1.0629E-19,  1.0312E-19,  1.0055E-19,  9.8450E-20,  9.6701E-20,  9.5204E-20, &
       9.3967E-20,  9.2872E-20,  9.1923E-20,  9.1075E-20,  9.0320E-20,  8.9624E-20, &
       8.9019E-20,  8.8465E-20,  8.7915E-20,  8.7452E-20,  8.7001E-20,  8.6563E-20, &
       8.6170E-20,  8.5827E-20,  8.5441E-20,  8.5109E-20,  8.4801E-20,  8.4484E-20, &
       8.4195E-20,  8.3934E-20,  8.3667E-20,  8.3432E-20,  8.2772E-20,  8.1814E-20, &
       8.1051E-20,  8.0444E-20,  7.9962E-20,  7.9571E-20,  7.9290E-20,  7.9065E-20, &
       7.8872E-20,  7.8753E-20,  7.8627E-20,  7.8550E-20,  7.8510E-20,  7.8426E-20, &
       7.8426E-20 /)
    REAL, PARAMETER :: a3_ICl(dim55) = (/ &
      -1.1923E-22, -7.7829E-23, -4.6089E-23, -2.8581E-23, -1.9274E-23, -1.3965E-23, &
      -1.0679E-23, -8.5074E-24, -6.9827E-24, -5.8874E-24, -5.0325E-24, -4.3813E-24, &
      -3.8679E-24, -3.4235E-24, -3.0806E-24, -2.7559E-24, -2.5158E-24, -2.2926E-24, &
      -2.0890E-24, -1.9178E-24, -1.7778E-24, -1.6438E-24, -1.5068E-24, -1.4212E-24, &
      -1.2991E-24, -1.2329E-24, -1.1473E-24, -1.0616E-24, -1.0085E-24, -9.4178E-25, &
      -8.7329E-25, -8.3904E-25, -7.6923E-25, -7.3630E-25, -6.8493E-25, -6.4957E-25, &
      -6.1644E-25, -5.8219E-25, -5.4795E-25, -5.1282E-25, -4.4163E-25, -3.3208E-25, &
      -2.5667E-25, -1.9514E-25, -1.5406E-25, -1.1636E-25, -9.2434E-26, -7.1893E-26, &
      -5.4757E-26, -4.4505E-26, -3.4235E-26, -2.7379E-26, -2.0541E-26, -1.7117E-26, &
      -1.3689E-26 /)
    REAL, PARAMETER :: b3_ICl(dim55) = (/ &
       3.9304E-20,  3.6864E-20,  3.3140E-20,  3.0062E-20,  2.7882E-20,  2.6329E-20, &
       2.5175E-20,  2.4286E-20,  2.3572E-20,  2.2996E-20,  2.2496E-20,  2.2077E-20, &
       2.1717E-20,  2.1379E-20,  2.1098E-20,  2.0814E-20,  2.0589E-20,  2.0367E-20, &
       2.0153E-20,  1.9963E-20,  1.9799E-20,  1.9635E-20,  1.9459E-20,  1.9344E-20, &
       1.9172E-20,  1.9075E-20,  1.8945E-20,  1.8810E-20,  1.8723E-20,  1.8610E-20, &
       1.8490E-20,  1.8428E-20,  1.8298E-20,  1.8234E-20,  1.8132E-20,  1.8060E-20, &
       1.7990E-20,  1.7916E-20,  1.7840E-20,  1.7760E-20,  1.7593E-20,  1.7305E-20, &
       1.7085E-20,  1.6887E-20,  1.6743E-20,  1.6600E-20,  1.6502E-20,  1.6412E-20, &
       1.6332E-20,  1.6281E-20,  1.6227E-20,  1.6189E-20,  1.6149E-20,  1.6128E-20, &
       1.6106E-20 /)
    REAL, PARAMETER :: a4_ICl(4) = (/  3.2519E-21, -2.4924E-24,  5.9303E-28, -4.4142E-32 /)
    REAL, PARAMETER :: a6_ICl(4) = (/  1.4133E-19,  3.7580E-25, -3.8610E-30,  3.4006E-35 /)
    REAL, PARAMETER :: a7_ICl(4) = (/  1.3487E-19,  5.5231E-24,  4.1422E-29, -2.4220E-33 /)

    jval_2d(ip_ICl)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_ICl(1) = &
          (p1(b1_1_ICl(i1(j,k)),a1_1_ICl(i1(j,k)), &
          v3_du1(j,k)) + &
          p1(b1_2_ICl(i1(j,k)),a1_2_ICl(i1(j,k)), &
          v3_du1(j,k)) * v2s_m(j,k))
        sig_ICl(2) = &
          p1(b2_ICl(i2(j,k)), a2_ICl(i2(j,k)), &
          v3_du1(j,k))
        sig_ICl(3) = &
          p1(b3_ICl(i3(j,k)), a3_ICl(i3(j,k)), &
          v3_du2(j,k))
        sig_ICl(4) = &
          p3(a4_ICl(1),a4_ICl(2),a4_ICl(3), &
          a4_ICl(4),v3_du2(j,k))
        sig_ICl(6) = &
          p3(a6_ICl(1),a6_ICl(2),a6_ICl(3), &
          a6_ICl(4),v3_du2(j,k))
        sig_ICl(7) = &
          p3(a7_ICl(1),a7_ICl(2),a7_ICl(3), &
          a7_ICl(4),v3_du2(j,k))
        dj = 0. &
          + sig_ICl(1) * fint(j,k,1) &
          + sig_ICl(2) * fint(j,k,2) &
          + sig_ICl(3) * fint(j,k,3) &
          + sig_ICl(4) * fint(j,k,4) &
          + sig_ICl(6) * fint(j,k,6) &
          + sig_ICl(7) * fint(j,k,7)

        jval_2d(ip_ICl)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,1)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_ICl

  ! **************************************************************************

  SUBROUTINE jval_cal_IBr

    ! IBr \TOHV\ \products

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_IBr

    ! T-const parameters:
    REAL, PARAMETER :: a1_1_IBr(dim55) = (/ &
      -2.0907E-21, -1.9286E-21, -1.7607E-21, -1.5618E-21, -1.3634E-21, -1.1896E-21, &
      -1.0105E-21, -8.8479E-22, -7.4004E-22, -6.5809E-22, -5.4616E-22, -4.9586E-22, &
      -4.0886E-22, -3.7955E-22, -3.1032E-22, -2.9468E-22, -2.3839E-22, -2.3126E-22, &
      -1.8448E-22, -1.8300E-22, -1.4338E-22, -1.4559E-22, -1.1169E-22, -1.1625E-22, &
      -8.6992E-23, -9.3022E-23, -6.7624E-23, -7.4553E-23, -5.2408E-23, -5.9775E-23, &
      -4.0430E-23, -4.7947E-23, -3.0993E-23, -3.8446E-23, -2.3574E-23, -3.0799E-23, &
      -1.7764E-23, -2.4649E-23, -1.3204E-23, -1.9705E-23, -9.9107E-24, -5.8194E-24, &
      -1.9463E-24, -1.1342E-24,  1.6465E-25,  1.0940E-25,  5.2375E-25,  3.1833E-25, &
       6.4717E-25,  4.1640E-25,  2.6577E-25,  1.6845E-25,  1.0611E-25,  6.6475E-26, &
       4.1429E-26 /)
    REAL, PARAMETER :: b1_1_IBr(dim55) = (/ &
       4.5493E-20,  4.5007E-20,  4.4084E-20,  4.2492E-20,  4.0409E-20,  3.8150E-20, &
       3.5374E-20,  3.3111E-20,  3.0144E-20,  2.8259E-20,  2.5404E-20,  2.3996E-20, &
       2.1342E-20,  2.0375E-20,  1.7917E-20,  1.7323E-20,  1.5044E-20,  1.4737E-20, &
       1.2609E-20,  1.2537E-20,  1.0537E-20,  1.0654E-20,  8.7723E-21,  9.0367E-21, &
       7.2667E-21,  7.6466E-21,  5.9830E-21,  6.4542E-21,  4.8930E-21,  5.4308E-21, &
       3.9702E-21,  4.5565E-21,  3.1918E-21,  3.8103E-21,  2.5387E-21,  3.1746E-21, &
       1.9949E-21,  2.6352E-21,  1.5422E-21,  2.1793E-21,  1.1950E-21,  7.3266E-22, &
       2.4659E-22,  1.3452E-22, -6.0961E-23, -5.1955E-23, -1.2467E-22, -8.6055E-23, &
      -1.5199E-22, -1.0283E-22, -6.8866E-23, -4.5705E-23, -3.0088E-23, -1.9664E-23, &
      -1.2764E-23 /)
    REAL, PARAMETER :: a1_2_IBr(dim55) = (/ &
       1.2242E-24, -6.4295E-25, -1.5549E-24, -2.5464E-24, -3.2169E-24, -3.3260E-24, &
      -3.7200E-24, -3.2814E-24, -3.5270E-24, -2.8707E-24, -3.0613E-24, -2.3804E-24, &
      -2.5652E-24, -1.9397E-24, -2.1301E-24, -1.5775E-24, -1.7703E-24, -1.2918E-24, &
      -1.4805E-24, -1.0654E-24, -1.2461E-24, -8.8500E-25, -1.0533E-24, -7.3932E-25, &
      -8.9394E-25, -6.2041E-25, -7.6068E-25, -5.2220E-25, -6.4836E-25, -4.4054E-25, &
      -5.5331E-25, -3.7210E-25, -4.7252E-25, -3.1473E-25, -4.0367E-25, -2.6648E-25, &
      -3.4494E-25, -2.2573E-25, -2.9475E-25, -1.9134E-25, -1.9026E-25, -1.1839E-25, &
      -8.5994E-26, -5.3277E-26, -3.9068E-26, -2.4125E-26, -1.7853E-26, -1.0995E-26, &
      -9.4083E-27, -5.8531E-27, -3.6274E-27, -2.2402E-27, -1.3788E-27, -8.4596E-28, &
      -5.1742E-28 /)
    REAL, PARAMETER :: b1_2_IBr(dim55) = (/ &
       1.4138E-22,  1.4698E-22,  1.5200E-22,  1.5993E-22,  1.6697E-22,  1.6839E-22, &
       1.7449E-22,  1.6660E-22,  1.7164E-22,  1.5654E-22,  1.6140E-22,  1.4234E-22, &
       1.4797E-22,  1.2733E-22,  1.3409E-22,  1.1309E-22,  1.2090E-22,  1.0032E-22, &
       1.0891E-22,  8.8983E-23,  9.8107E-23,  7.8972E-23,  8.8314E-23,  7.0101E-23, &
       7.9456E-23,  6.2223E-23,  7.1411E-23,  5.5194E-23,  6.4089E-23,  4.8918E-23, &
       5.7432E-23,  4.3298E-23,  5.1381E-23,  3.8285E-23,  4.5889E-23,  3.3816E-23, &
       4.0917E-23,  2.9830E-23,  3.6422E-23,  2.6287E-23,  2.6179E-23,  1.8058E-23, &
       1.3992E-23,  9.4772E-24,  7.3386E-24,  4.9030E-24,  3.8022E-24,  2.5129E-24, &
       2.1948E-24,  1.4375E-24,  9.3561E-25,  6.0545E-25,  3.8967E-25,  2.4953E-25, &
       1.5902E-25 /)
    REAL, PARAMETER :: a2_IBr(dim55) = (/ &
      -7.1200E-22, -8.2800E-22, -8.6400E-22, -8.2800E-22, -7.5600E-22, -6.6800E-22, &
      -5.7600E-22, -4.8800E-22, -4.1600E-22, -3.5600E-22, -3.0400E-22, -2.6400E-22, &
      -2.2400E-22, -2.0000E-22, -1.7600E-22, -1.5600E-22, -1.4000E-22, -1.2400E-22, &
      -1.1600E-22, -1.0400E-22, -9.6000E-23, -8.4000E-23, -8.0000E-23, -7.6000E-23, &
      -6.8000E-23, -6.0000E-23, -6.0000E-23, -5.6000E-23, -4.8000E-23, -4.8000E-23, &
      -4.4000E-23, -4.4000E-23, -3.6000E-23, -3.6000E-23, -3.6000E-23, -2.8000E-23, &
      -3.2000E-23, -2.8000E-23, -2.4000E-23, -2.4000E-23, -2.0000E-23, -1.5200E-23, &
      -1.0400E-23, -7.2000E-24, -5.6000E-24, -4.8000E-24, -2.4000E-24, -2.4000E-24, &
      -1.6000E-24, -8.0000E-25, -8.0000E-25, -8.0000E-25, -8.0000E-25,  0.0000E+00, &
       0.0000E+00 /)
    REAL, PARAMETER :: b2_IBr(dim55) = (/ &
       2.0201E-19,  2.0235E-19,  2.0255E-19,  2.0226E-19,  2.0151E-19,  2.0036E-19, &
       1.9894E-19,  1.9735E-19,  1.9588E-19,  1.9450E-19,  1.9317E-19,  1.9205E-19, &
       1.9083E-19,  1.9004E-19,  1.8919E-19,  1.8843E-19,  1.8778E-19,  1.8709E-19, &
       1.8673E-19,  1.8615E-19,  1.8575E-19,  1.8511E-19,  1.8489E-19,  1.8466E-19, &
       1.8417E-19,  1.8367E-19,  1.8367E-19,  1.8340E-19,  1.8283E-19,  1.8283E-19, &
       1.8253E-19,  1.8253E-19,  1.8189E-19,  1.8189E-19,  1.8189E-19,  1.8118E-19, &
       1.8155E-19,  1.8117E-19,  1.8079E-19,  1.8079E-19,  1.8039E-19,  1.7985E-19, &
       1.7925E-19,  1.7880E-19,  1.7856E-19,  1.7843E-19,  1.7801E-19,  1.7801E-19, &
       1.7785E-19,  1.7768E-19,  1.7768E-19,  1.7768E-19,  1.7768E-19,  1.7747E-19, &
       1.7747E-19 /)
    REAL, PARAMETER :: a3_IBr(dim55) = (/ &
      -1.6431E-22, -1.0749E-22, -6.3837E-23, -3.9534E-23, -2.6703E-23, -1.9339E-23, &
      -1.4890E-23, -1.1640E-23, -9.7553E-24, -8.2150E-24, -7.0181E-24, -5.9901E-24, &
      -5.4766E-24, -4.7929E-24, -4.2786E-24, -3.7658E-24, -3.4229E-24, -3.2506E-24, &
      -2.9110E-24, -2.7397E-24, -2.3932E-24, -2.2260E-24, -2.2260E-24, -1.8836E-24, &
      -1.8803E-24, -1.7123E-24, -1.5411E-24, -1.5411E-24, -1.3675E-24, -1.3699E-24, &
      -1.1986E-24, -1.0274E-24, -1.1966E-24, -1.0274E-24, -8.5616E-25, -1.0256E-24, &
      -8.5616E-25, -6.8493E-25, -8.5616E-25, -6.8376E-25, -6.1623E-25, -4.4505E-25, &
      -3.7645E-25, -2.7388E-25, -2.0541E-25, -1.7112E-25, -1.0270E-25, -1.0270E-25, &
      -1.0267E-25, -3.4235E-26, -6.8470E-26, -3.4223E-26, -3.4235E-26,  0.0000E+00, &
      -3.4223E-26 /)
    REAL, PARAMETER :: b3_IBr(dim55) = (/ &
       1.3398E-19,  1.3063E-19,  1.2551E-19,  1.2124E-19,  1.1823E-19,  1.1608E-19, &
       1.1452E-19,  1.1319E-19,  1.1230E-19,  1.1149E-19,  1.1079E-19,  1.1013E-19, &
       1.0977E-19,  1.0925E-19,  1.0883E-19,  1.0838E-19,  1.0806E-19,  1.0789E-19, &
       1.0753E-19,  1.0734E-19,  1.0694E-19,  1.0673E-19,  1.0673E-19,  1.0627E-19, &
       1.0627E-19,  1.0602E-19,  1.0576E-19,  1.0576E-19,  1.0548E-19,  1.0548E-19, &
       1.0518E-19,  1.0487E-19,  1.0519E-19,  1.0486E-19,  1.0452E-19,  1.0487E-19, &
       1.0451E-19,  1.0414E-19,  1.0452E-19,  1.0413E-19,  1.0397E-19,  1.0352E-19, &
       1.0332E-19,  1.0299E-19,  1.0275E-19,  1.0262E-19,  1.0234E-19,  1.0234E-19, &
       1.0234E-19,  1.0200E-19,  1.0218E-19,  1.0199E-19,  1.0199E-19,  1.0178E-19, &
       1.0200E-19 /)
    REAL, PARAMETER :: a4_IBr(4) = (/  8.1801E-20, -5.6686E-24,  1.1921E-27, -8.3768E-32 /)
    REAL, PARAMETER :: a5_IBr(4) = (/  4.1905E-20, -4.1716E-24,  6.6704E-28, -4.1006E-32 /)
    REAL, PARAMETER :: a6_IBr(4) = (/  1.1618E-19,  2.4908E-25, -2.5108E-30,  1.0388E-35 /)
    REAL, PARAMETER :: a7_IBr(4) = (/  4.6448E-19,  1.1476E-23, -1.2301E-29, -4.8746E-33 /)

    jval_2d(ip_IBr)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_IBr(1) = &
          (p1(b1_1_IBr(i1(j,k)),a1_1_IBr(i1(j,k)), &
          v3_du1(j,k)) + &
          p1(b1_2_IBr(i1(j,k)),a1_2_IBr(i1(j,k)), &
          v3_du1(j,k)) * v2s_m(j,k))
        sig_IBr(2) = &
          p1(b2_IBr(i2(j,k)), a2_IBr(i2(j,k)), &
          v3_du1(j,k))
        sig_IBr(3) = &
          p1(b3_IBr(i3(j,k)), a3_IBr(i3(j,k)), &
          v3_du2(j,k))
        sig_IBr(4) = &
          p3(a4_IBr(1),a4_IBr(2),a4_IBr(3), &
          a4_IBr(4),v3_du2(j,k))
        sig_IBr(5) = &
          p3(a5_IBr(1),a5_IBr(2),a5_IBr(3), &
          a5_IBr(4),v3_du2(j,k))
        sig_IBr(6) = &
          p3(a6_IBr(1),a6_IBr(2),a6_IBr(3), &
          a6_IBr(4),v3_du2(j,k))
        sig_IBr(7) = &
          p3(a7_IBr(1),a7_IBr(2),a7_IBr(3), &
          a7_IBr(4),v3_du2(j,k))
        dj = 0. &
          + sig_IBr(1) * fint(j,k,1) &
          + sig_IBr(2) * fint(j,k,2) &
          + sig_IBr(3) * fint(j,k,3) &
          + sig_IBr(4) * fint(j,k,4) &
          + sig_IBr(5) * fint(j,k,5) &
          + sig_IBr(6) * fint(j,k,6) &
          + sig_IBr(7) * fint(j,k,7)

        jval_2d(ip_IBr)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,1)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_IBr

  ! **************************************************************************

  SUBROUTINE jval_cal_INO2

    ! INO_2 \TOHV\ \products

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_INO2

    ! T-const parameters:
    REAL, PARAMETER :: a1_1_INO2(dim55) = (/ &
      -6.4859E-20, -6.0742E-20, -5.6887E-20, -5.1139E-20, -4.6058E-20, -4.0694E-20, &
      -3.5958E-20, -3.1849E-20, -2.8097E-20, -2.5232E-20, -2.2457E-20, -2.0526E-20, &
      -1.8519E-20, -1.7199E-20, -1.5774E-20, -1.4818E-20, -1.3790E-20, -1.3093E-20, &
      -1.2335E-20, -1.1789E-20, -1.1201E-20, -1.0787E-20, -1.0350E-20, -9.9607E-21, &
      -9.6421E-21, -9.3212E-21, -9.0651E-21, -8.7725E-21, -8.5706E-21, -8.3349E-21, &
      -8.1348E-21, -7.9386E-21, -7.7650E-21, -7.5903E-21, -7.4400E-21, -7.2852E-21, &
      -7.1439E-21, -6.9997E-21, -6.8780E-21, -6.7504E-21, -6.4009E-21, -5.8953E-21, &
      -5.4284E-21, -5.0406E-21, -4.6311E-21, -4.3214E-21, -3.9423E-21, -3.6938E-21, &
      -3.1835E-21, -2.8734E-21, -2.5877E-21, -2.3260E-21, -2.0865E-21, -1.8688E-21, &
      -1.6709E-21 /)
    REAL, PARAMETER :: b1_1_INO2(dim55) = (/ &
       2.8282E-18,  2.8158E-18,  2.7946E-18,  2.7486E-18,  2.6953E-18,  2.6256E-18, &
       2.5521E-18,  2.4782E-18,  2.4013E-18,  2.3354E-18,  2.2646E-18,  2.2105E-18, &
       2.1493E-18,  2.1057E-18,  2.0552E-18,  2.0189E-18,  1.9772E-18,  1.9472E-18, &
       1.9127E-18,  1.8866E-18,  1.8569E-18,  1.8349E-18,  1.8106E-18,  1.7881E-18, &
       1.7688E-18,  1.7486E-18,  1.7318E-18,  1.7119E-18,  1.6977E-18,  1.6805E-18, &
       1.6654E-18,  1.6501E-18,  1.6361E-18,  1.6216E-18,  1.6087E-18,  1.5951E-18, &
       1.5823E-18,  1.5689E-18,  1.5573E-18,  1.5448E-18,  1.5097E-18,  1.4525E-18, &
       1.3939E-18,  1.3404E-18,  1.2788E-18,  1.2283E-18,  1.1618E-18,  1.1151E-18, &
       1.0128E-18,  9.4669E-19,  8.8226E-19,  8.1997E-19,  7.5999E-19,  7.0273E-19, &
       6.4822E-19 /)
    REAL, PARAMETER :: a1_2_INO2(dim55) = (/ &
       7.8085E-23,  1.2819E-23, -8.0001E-24, -5.0178E-23, -6.3678E-23, -7.9408E-23, &
      -8.4198E-23, -8.2425E-23, -8.1758E-23, -7.2506E-23, -6.9657E-23, -5.8962E-23, &
      -5.5806E-23, -4.6613E-23, -4.3667E-23, -3.6562E-23, -3.4043E-23, -2.8828E-23, &
      -2.6674E-23, -2.3005E-23, -2.1338E-23, -1.8602E-23, -1.7133E-23, -1.5528E-23, &
      -1.4053E-23, -1.2971E-23, -1.1704E-23, -1.1125E-23, -1.0049E-23, -9.4824E-24, &
      -8.7969E-24, -8.3701E-24, -7.8031E-24, -7.4811E-24, -6.9895E-24, -6.7728E-24, &
      -6.4275E-24, -6.1913E-24, -5.9352E-24, -5.7682E-24, -5.3230E-24, -4.7668E-24, &
      -4.6123E-24, -4.2989E-24, -4.4467E-24, -4.1124E-24, -4.3945E-24, -3.9863E-24, &
      -5.2086E-24, -5.3165E-24, -5.3620E-24, -5.3503E-24, -5.2889E-24, -5.1830E-24, &
      -5.0411E-24 /)
    REAL, PARAMETER :: b1_2_INO2(dim55) = (/ &
       4.3944E-21,  4.5902E-21,  4.7048E-21,  5.0422E-21,  5.1839E-21,  5.3884E-21, &
       5.4627E-21,  5.4307E-21,  5.4171E-21,  5.2043E-21,  5.1316E-21,  4.8322E-21, &
       4.7359E-21,  4.4325E-21,  4.3279E-21,  4.0580E-21,  3.9560E-21,  3.7317E-21, &
       3.6337E-21,  3.4576E-21,  3.3734E-21,  3.2284E-21,  3.1468E-21,  3.0538E-21, &
       2.9645E-21,  2.8964E-21,  2.8134E-21,  2.7740E-21,  2.6981E-21,  2.6568E-21, &
       2.6050E-21,  2.5717E-21,  2.5261E-21,  2.4994E-21,  2.4573E-21,  2.4383E-21, &
       2.4070E-21,  2.3851E-21,  2.3606E-21,  2.3442E-21,  2.2995E-21,  2.2366E-21, &
       2.2173E-21,  2.1740E-21,  2.1962E-21,  2.1418E-21,  2.1913E-21,  2.1145E-21, &
       2.3596E-21,  2.3826E-21,  2.3928E-21,  2.3901E-21,  2.3747E-21,  2.3468E-21, &
       2.3077E-21 /)
    REAL, PARAMETER :: a2_INO2(dim55) = (/ &
      -3.3920E-20, -2.7760E-20, -2.1320E-20, -1.5556E-20, -1.0904E-20, -7.4760E-21, &
      -5.0840E-21, -3.4800E-21, -2.4280E-21, -1.7520E-21, -1.3160E-21, -1.0280E-21, &
      -8.4000E-22, -7.1600E-22, -6.2000E-22, -5.5600E-22, -5.0000E-22, -4.6000E-22, &
      -4.2800E-22, -3.9600E-22, -3.6800E-22, -3.4400E-22, -3.2000E-22, -3.0000E-22, &
      -2.8400E-22, -2.6400E-22, -2.4800E-22, -2.3600E-22, -2.1600E-22, -2.0800E-22, &
      -1.9200E-22, -1.8000E-22, -1.7200E-22, -1.6000E-22, -1.4800E-22, -1.4400E-22, &
      -1.3200E-22, -1.2400E-22, -1.1600E-22, -1.0800E-22, -9.2000E-23, -6.6400E-23, &
      -4.8800E-23, -3.5200E-23, -2.5600E-23, -1.9200E-23, -1.3600E-23, -9.6000E-24, &
      -7.2000E-24, -5.6000E-24, -4.0000E-24, -2.4000E-24, -1.6000E-24, -1.6000E-24, &
      -1.6000E-24 /)
    REAL, PARAMETER :: b2_INO2(dim55) = (/ &
       1.2325E-18,  1.2140E-18,  1.1786E-18,  1.1324E-18,  1.0836E-18,  1.0390E-18, &
       1.0020E-18,  9.7309E-19,  9.5152E-19,  9.3598E-19,  9.2486E-19,  9.1679E-19, &
       9.1106E-19,  9.0697E-19,  9.0356E-19,  9.0113E-19,  8.9886E-19,  8.9714E-19, &
       8.9568E-19,  8.9415E-19,  8.9273E-19,  8.9146E-19,  8.9013E-19,  8.8897E-19, &
       8.8800E-19,  8.8674E-19,  8.8569E-19,  8.8488E-19,  8.8347E-19,  8.8288E-19, &
       8.8168E-19,  8.8074E-19,  8.8010E-19,  8.7910E-19,  8.7807E-19,  8.7772E-19, &
       8.7664E-19,  8.7589E-19,  8.7513E-19,  8.7434E-19,  8.7274E-19,  8.6984E-19, &
       8.6763E-19,  8.6576E-19,  8.6431E-19,  8.6327E-19,  8.6229E-19,  8.6153E-19, &
       8.6105E-19,  8.6071E-19,  8.6035E-19,  8.5997E-19,  8.5977E-19,  8.5977E-19, &
       8.5977E-19 /)
    REAL, PARAMETER :: a3_INO2(dim55) = (/ &
      -1.3348E-21, -8.1732E-22, -4.4155E-22, -2.4508E-22, -1.4721E-22, -9.5499E-23, &
      -6.6062E-23, -4.8271E-23, -3.6796E-23, -2.9266E-23, -2.3964E-23, -2.0195E-23, &
      -1.7114E-23, -1.4892E-23, -1.3178E-23, -1.1811E-23, -1.0440E-23, -9.4098E-24, &
      -8.7329E-24, -7.8767E-24, -7.1795E-24, -6.8493E-24, -6.1644E-24, -5.6507E-24, &
      -5.2991E-24, -4.9658E-24, -4.6233E-24, -4.4521E-24, -3.9316E-24, -3.9384E-24, &
      -3.4247E-24, -3.4247E-24, -3.0769E-24, -3.0822E-24, -2.7397E-24, -2.5641E-24, &
      -2.5685E-24, -2.3973E-24, -2.2260E-24, -2.0513E-24, -1.7802E-24, -1.3352E-24, &
      -1.0267E-24, -7.8740E-25, -6.1623E-25, -4.7912E-25, -3.7658E-25, -2.7388E-25, &
      -2.3956E-25, -1.7117E-25, -1.3694E-25, -1.0267E-25, -1.0270E-25, -6.8470E-26, &
      -3.4223E-26 /)
    REAL, PARAMETER :: b3_INO2(dim55) = (/ &
       5.1436E-19,  4.8386E-19,  4.3977E-19,  4.0523E-19,  3.8231E-19,  3.6718E-19, &
       3.5684E-19,  3.4956E-19,  3.4419E-19,  3.4022E-19,  3.3712E-19,  3.3470E-19, &
       3.3254E-19,  3.3085E-19,  3.2945E-19,  3.2825E-19,  3.2696E-19,  3.2594E-19, &
       3.2523E-19,  3.2428E-19,  3.2346E-19,  3.2306E-19,  3.2218E-19,  3.2149E-19, &
       3.2099E-19,  3.2051E-19,  3.1999E-19,  3.1972E-19,  3.1886E-19,  3.1888E-19, &
       3.1797E-19,  3.1797E-19,  3.1732E-19,  3.1733E-19,  3.1665E-19,  3.1629E-19, &
       3.1630E-19,  3.1593E-19,  3.1555E-19,  3.1516E-19,  3.1452E-19,  3.1335E-19, &
       3.1245E-19,  3.1168E-19,  3.1108E-19,  3.1056E-19,  3.1014E-19,  3.0969E-19, &
       3.0953E-19,  3.0919E-19,  3.0901E-19,  3.0882E-19,  3.0882E-19,  3.0861E-19, &
       3.0839E-19 /)
    REAL, PARAMETER :: a4_INO2(4) = (/  2.6009E-19, -8.8141E-24,  2.1461E-27, -1.6130E-31 /)
    REAL, PARAMETER :: a5_INO2(4) = (/  3.1010E-19,  9.7874E-24, -1.5957E-27,  9.9538E-32 /)
    REAL, PARAMETER :: a6_INO2(4) = (/  8.9076E-20, -7.3410E-25,  7.3933E-30, -4.7799E-35 /)

    jval_2d(ip_INO2)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_INO2(1) = &
          (p1(b1_1_INO2(i1(j,k)),a1_1_INO2(i1(j,k)), &
          v3_du1(j,k)) + &
          p1(b1_2_INO2(i1(j,k)),a1_2_INO2(i1(j,k)), &
          v3_du1(j,k)) * v2s_m(j,k))
        sig_INO2(2) = &
          p1(b2_INO2(i2(j,k)), a2_INO2(i2(j,k)), &
          v3_du1(j,k))
        sig_INO2(3) = &
          p1(b3_INO2(i3(j,k)), a3_INO2(i3(j,k)), &
          v3_du2(j,k))
        sig_INO2(4) = &
          p3(a4_INO2(1),a4_INO2(2),a4_INO2(3), &
          a4_INO2(4),v3_du2(j,k))
        sig_INO2(5) = &
          p3(a5_INO2(1),a5_INO2(2),a5_INO2(3), &
          a5_INO2(4),v3_du2(j,k))
        sig_INO2(6) = &
          p3(a6_INO2(1),a6_INO2(2),a6_INO2(3), &
          a6_INO2(4),v3_du2(j,k))
        dj = 0. &
          + sig_INO2(1) * fint(j,k,1) &
          + sig_INO2(2) * fint(j,k,2) &
          + sig_INO2(3) * fint(j,k,3) &
          + sig_INO2(4) * fint(j,k,4) &
          + sig_INO2(5) * fint(j,k,5) &
          + sig_INO2(6) * fint(j,k,6)

        jval_2d(ip_INO2)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,1)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_INO2

  ! **************************************************************************

  SUBROUTINE jval_cal_INO3

    ! INO_3 \TOHV\ \products

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_INO3

    ! T-const parameters:
    REAL, PARAMETER :: a2_INO3(dim55) = (/ &
      -7.9840E-20, -6.9360E-20, -5.7240E-20, -4.5520E-20, -3.5360E-20, -2.7240E-20, &
      -2.1040E-20, -1.6400E-20, -1.3000E-20, -1.0480E-20, -8.6400E-21, -7.2000E-21, &
      -6.1600E-21, -5.3200E-21, -4.6400E-21, -4.1200E-21, -3.6400E-21, -3.2800E-21, &
      -3.0000E-21, -2.6800E-21, -2.4800E-21, -2.2800E-21, -2.0800E-21, -1.9200E-21, &
      -1.7600E-21, -1.6400E-21, -1.5600E-21, -1.4000E-21, -1.3600E-21, -1.2400E-21, &
      -1.1200E-21, -1.0800E-21, -1.0400E-21, -9.2000E-22, -8.8000E-22, -8.4000E-22, &
      -7.6000E-22, -7.6000E-22, -6.8000E-22, -6.0000E-22, -5.2800E-22, -3.8400E-22, &
      -2.8000E-22, -2.0800E-22, -1.4400E-22, -1.1200E-22, -7.2000E-23, -5.6000E-23, &
      -4.0000E-23, -3.2000E-23, -2.4000E-23, -1.6000E-23, -8.0000E-24, -8.0000E-24, &
      -8.0000E-24 /)
    REAL, PARAMETER :: b2_INO3(dim55) = (/ &
       7.7645E-18,  7.7331E-18,  7.6664E-18,  7.5727E-18,  7.4660E-18,  7.3604E-18, &
       7.2643E-18,  7.1808E-18,  7.1111E-18,  7.0531E-18,  7.0062E-18,  6.9659E-18, &
       6.9342E-18,  6.9065E-18,  6.8823E-18,  6.8626E-18,  6.8431E-18,  6.8276E-18, &
       6.8149E-18,  6.7995E-18,  6.7894E-18,  6.7788E-18,  6.7677E-18,  6.7585E-18, &
       6.7488E-18,  6.7412E-18,  6.7360E-18,  6.7251E-18,  6.7223E-18,  6.7135E-18, &
       6.7045E-18,  6.7013E-18,  6.6981E-18,  6.6882E-18,  6.6847E-18,  6.6812E-18, &
       6.6740E-18,  6.6740E-18,  6.6663E-18,  6.6585E-18,  6.6513E-18,  6.6350E-18, &
       6.6219E-18,  6.6120E-18,  6.6024E-18,  6.5972E-18,  6.5901E-18,  6.5871E-18, &
       6.5839E-18,  6.5822E-18,  6.5804E-18,  6.5785E-18,  6.5765E-18,  6.5765E-18, &
       6.5765E-18 /)
    REAL, PARAMETER :: a3_INO3(dim55) = (/ &
      -3.4214E-21, -2.1379E-21, -1.1980E-21, -6.9998E-22, -4.4676E-22, -3.1148E-22, &
      -2.2762E-22, -1.7631E-22, -1.4205E-22, -1.1638E-22, -9.9281E-23, -8.5572E-23, &
      -7.5304E-23, -6.5046E-23, -5.8189E-23, -5.3064E-23, -4.7921E-23, -4.2772E-23, &
      -4.1096E-23, -3.5959E-23, -3.2479E-23, -3.2534E-23, -2.7397E-23, -2.7397E-23, &
      -2.3932E-23, -2.3973E-23, -2.2260E-23, -1.8836E-23, -1.8803E-23, -1.8836E-23, &
      -1.7123E-23, -1.5411E-23, -1.3675E-23, -1.3699E-23, -1.3699E-23, -1.1966E-23, &
      -1.1986E-23, -1.0274E-23, -1.1986E-23, -8.5470E-24, -8.5587E-24, -6.1623E-24, &
      -4.7912E-24, -3.7658E-24, -2.7388E-24, -2.3956E-24, -1.7117E-24, -1.3694E-24, &
      -1.0267E-24, -1.0270E-24, -3.4235E-25, -6.8446E-25, -3.4235E-25, -3.4235E-25, &
      -3.4223E-25 /)
    REAL, PARAMETER :: b3_INO3(dim55) = (/ &
       5.5375E-18,  5.4619E-18,  5.3516E-18,  5.2640E-18,  5.2047E-18,  5.1651E-18, &
       5.1357E-18,  5.1147E-18,  5.0987E-18,  5.0852E-18,  5.0752E-18,  5.0663E-18, &
       5.0591E-18,  5.0513E-18,  5.0457E-18,  5.0412E-18,  5.0364E-18,  5.0313E-18, &
       5.0295E-18,  5.0238E-18,  5.0198E-18,  5.0198E-18,  5.0132E-18,  5.0132E-18, &
       5.0084E-18,  5.0084E-18,  5.0058E-18,  5.0004E-18,  5.0004E-18,  5.0004E-18, &
       4.9974E-18,  4.9943E-18,  4.9911E-18,  4.9911E-18,  4.9911E-18,  4.9876E-18, &
       4.9876E-18,  4.9839E-18,  4.9877E-18,  4.9799E-18,  4.9799E-18,  4.9736E-18, &
       4.9696E-18,  4.9663E-18,  4.9627E-18,  4.9614E-18,  4.9586E-18,  4.9571E-18, &
       4.9555E-18,  4.9555E-18,  4.9519E-18,  4.9538E-18,  4.9518E-18,  4.9518E-18, &
       4.9518E-18 /)
    REAL, PARAMETER :: a4_INO3(4) = (/  4.6506E-18, -8.7545E-23,  1.8260E-26, -1.2778E-30 /)
    REAL, PARAMETER :: a5_INO3(4) = (/  3.9347E-18, -6.5708E-23,  1.1160E-26, -7.0836E-31 /)
    REAL, PARAMETER :: a6_INO3(4) = (/  1.5205E-18, -5.3649E-24,  5.4933E-29, -3.8169E-34 /)

    jval_2d(ip_INO3)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_INO3(2) = &
          p1(b2_INO3(i2(j,k)), a2_INO3(i2(j,k)), &
          v3_du1(j,k))
        sig_INO3(3) = &
          p1(b3_INO3(i3(j,k)), a3_INO3(i3(j,k)), &
          v3_du2(j,k))
        sig_INO3(4) = &
          p3(a4_INO3(1),a4_INO3(2),a4_INO3(3), &
          a4_INO3(4),v3_du2(j,k))
        sig_INO3(5) = &
          p3(a5_INO3(1),a5_INO3(2),a5_INO3(3), &
          a5_INO3(4),v3_du2(j,k))
        sig_INO3(6) = &
          p3(a6_INO3(1),a6_INO3(2),a6_INO3(3), &
          a6_INO3(4),v3_du2(j,k))
        dj = 0. &
          + sig_INO3(2) * fint(j,k,2) &
          + sig_INO3(3) * fint(j,k,3) &
          + sig_INO3(4) * fint(j,k,4) &
          + sig_INO3(5) * fint(j,k,5) &
          + sig_INO3(6) * fint(j,k,6)

        jval_2d(ip_INO3)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,1)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_INO3

  ! **************************************************************************

  SUBROUTINE jval_cal_SO3

    ! SO_3 \TOHV\ \products

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_SO3

    ! T-const parameters:
    REAL, PARAMETER :: a0_1_1_SO3(dim58) = (/ &
      -1.8112E-21, -1.9263E-21, -2.0580E-21, -2.1631E-21, -2.2907E-21, -2.4286E-21, &
      -2.5870E-21, -2.7728E-21, -2.9699E-21, -3.2138E-21, -3.4421E-21, -3.6818E-21, &
      -4.4933E-21, -6.5128E-21, -6.3155E-21, -6.6748E-21, -7.7059E-21, -7.4568E-21, &
      -7.8461E-21, -9.0802E-21, -8.7498E-21, -9.1626E-21, -1.0462E-20, -9.7403E-21, &
      -9.7368E-21, -7.2442E-21, -5.5547E-21, -4.8618E-21, -4.2236E-21, -3.7020E-21, &
      -3.3940E-21, -3.3092E-21, -3.4616E-21, -3.8027E-21, -4.2610E-21, -4.7653E-21, &
      -5.2575E-21, -5.6999E-21, -6.0502E-21, -6.3043E-21, -6.4506E-21, -6.4945E-21, &
      -6.4608E-21, -6.3529E-21, -6.1506E-21, -5.9197E-21, -5.6128E-21, -5.3082E-21, &
      -4.9862E-21, -4.6696E-21, -4.4119E-21, -4.1492E-21, -3.9008E-21, -3.6711E-21, &
      -3.4285E-21, -3.1377E-21, -2.7718E-21, -2.3617E-21 /)
    REAL, PARAMETER :: a0_1_2_SO3(dim58) = (/ &
       8.7342E-19,  8.7851E-19,  8.8435E-19,  8.8904E-19,  8.9475E-19,  9.0096E-19, &
       9.0812E-19,  9.1656E-19,  9.2554E-19,  9.3671E-19,  9.4722E-19,  9.5829E-19, &
       9.9594E-19,  1.0901E-18,  1.0808E-18,  1.0977E-18,  1.1464E-18,  1.1346E-18, &
       1.1531E-18,  1.2121E-18,  1.1962E-18,  1.2161E-18,  1.2790E-18,  1.2439E-18, &
       1.2438E-18,  1.1216E-18,  1.0385E-18,  1.0043E-18,  9.7263E-19,  9.4665E-19, &
       9.3125E-19,  9.2699E-19,  9.3468E-19,  9.5194E-19,  9.7522E-19,  1.0009E-18, &
       1.0261E-18,  1.0489E-18,  1.0670E-18,  1.0801E-18,  1.0877E-18,  1.0900E-18, &
       1.0882E-18,  1.0826E-18,  1.0719E-18,  1.0597E-18,  1.0433E-18,  1.0271E-18, &
       1.0098E-18,  9.9277E-19,  9.7885E-19,  9.6461E-19,  9.5110E-19,  9.3856E-19, &
       9.2527E-19,  9.0927E-19,  8.8907E-19,  8.6635E-19 /)
    REAL, PARAMETER :: a0_2_1_SO3(dim58) = (/ &
      -4.2203E-24, -4.0686E-24, -3.5600E-24, -3.1138E-24, -2.6132E-24, -2.3243E-24, &
      -2.2596E-24, -2.6738E-24, -3.5173E-24, -4.6754E-24, -6.2532E-24, -8.1473E-24, &
      -1.5086E-24,  2.2422E-23,  1.3571E-23,  1.3268E-23,  2.1888E-23,  1.3490E-23, &
       1.3157E-23,  2.1439E-23,  9.5572E-24,  4.4497E-24,  6.5329E-24, -1.5050E-23, &
      -2.9854E-23, -6.9131E-23, -9.8122E-23, -1.1363E-22, -1.2419E-22, -1.2853E-22, &
      -1.2600E-22, -1.1710E-22, -1.0313E-22, -8.5805E-23, -6.7184E-23, -4.8820E-23, &
      -3.2153E-23, -1.7888E-23, -6.6730E-24,  1.4352E-24,  6.6553E-24,  9.4283E-24, &
       1.0453E-23,  1.0460E-23,  9.7080E-24,  8.8399E-24,  7.7457E-24,  6.7530E-24, &
       5.7863E-24,  4.8773E-24,  4.2479E-24,  3.6614E-24,  3.1293E-24,  2.7627E-24, &
       2.3367E-24,  1.9593E-24,  1.6688E-24,  1.4536E-24 /)
    REAL, PARAMETER :: a0_2_2_SO3(dim58) = (/ &
       3.7637E-22,  3.6967E-22,  3.4708E-22,  3.2719E-22,  3.0476E-22,  2.9176E-22, &
       2.8883E-22,  3.0764E-22,  3.4610E-22,  3.9914E-22,  4.7172E-22,  5.5923E-22, &
       2.5119E-22, -8.6397E-22, -4.4976E-22, -4.3551E-22, -8.4236E-22, -4.4432E-22, &
      -4.2844E-22, -8.2431E-22, -2.5401E-22, -7.8268E-24, -1.0865E-22,  9.4026E-22, &
       1.6627E-21,  3.5873E-21,  5.0136E-21,  5.7796E-21,  6.3037E-21,  6.5195E-21, &
       6.3934E-21,  5.9465E-21,  5.2424E-21,  4.3656E-21,  3.4197E-21,  2.4831E-21, &
       1.6298E-21,  8.9654E-22,  3.1785E-22, -1.0216E-22, -3.7360E-22, -5.1835E-22, &
      -5.7206E-22, -5.7241E-22, -5.3270E-22, -4.8669E-22, -4.2849E-22, -3.7547E-22, &
      -3.2366E-22, -2.7475E-22, -2.4077E-22, -2.0898E-22, -1.8003E-22, -1.6001E-22, &
      -1.3667E-22, -1.1592E-22, -9.9882E-23, -8.7959E-23 /)
    REAL, PARAMETER :: a1_1_SO3(dim55) = (/ &
       7.8779E-21,  7.6518E-21,  7.5767E-21,  7.0607E-21,  6.7267E-21,  6.1443E-21, &
       5.7328E-21,  5.2203E-21,  4.8336E-21,  4.4275E-21,  4.0966E-21,  3.7928E-21, &
       3.5154E-21,  3.2927E-21,  3.0579E-21,  2.8931E-21,  2.6939E-21,  2.5708E-21, &
       2.3981E-21,  2.3059E-21,  2.1544E-21,  2.0866E-21,  1.9488E-21,  1.9016E-21, &
       1.7754E-21,  1.7428E-21,  1.6266E-21,  1.6073E-21,  1.4992E-21,  1.4884E-21, &
       1.3896E-21,  1.3847E-21,  1.2918E-21,  1.2945E-21,  1.2064E-21,  1.2138E-21, &
       1.1317E-21,  1.1425E-21,  1.0635E-21,  1.0800E-21,  9.6976E-22,  8.6451E-22, &
       7.6556E-22,  6.9986E-22,  6.3001E-22,  5.8589E-22,  5.3238E-22,  5.0113E-22, &
       4.4112E-22,  4.0909E-22,  3.8004E-22,  3.5373E-22,  3.2952E-22,  3.0717E-22, &
       2.8718E-22 /)
    REAL, PARAMETER :: b1_1_SO3(dim55) = (/ &
       1.6554E-19,  1.6622E-19,  1.6663E-19,  1.7076E-19,  1.7426E-19,  1.8184E-19, &
       1.8821E-19,  1.9744E-19,  2.0537E-19,  2.1470E-19,  2.2314E-19,  2.3165E-19, &
       2.4011E-19,  2.4746E-19,  2.5580E-19,  2.6206E-19,  2.7012E-19,  2.7542E-19, &
       2.8328E-19,  2.8770E-19,  2.9535E-19,  2.9895E-19,  3.0659E-19,  3.0933E-19, &
       3.1697E-19,  3.1902E-19,  3.2663E-19,  3.2794E-19,  3.3557E-19,  3.3636E-19, &
       3.4382E-19,  3.4419E-19,  3.5167E-19,  3.5145E-19,  3.5898E-19,  3.5833E-19, &
       3.6576E-19,  3.6475E-19,  3.7230E-19,  3.7068E-19,  3.8176E-19,  3.9366E-19, &
       4.0607E-19,  4.1514E-19,  4.2565E-19,  4.3284E-19,  4.4224E-19,  4.4811E-19, &
       4.6014E-19,  4.6697E-19,  4.7352E-19,  4.7978E-19,  4.8584E-19,  4.9172E-19, &
       4.9723E-19 /)
    REAL, PARAMETER :: a1_2_SO3(dim55) = (/ &
      -1.9692E-23, -1.0620E-23, -9.9637E-24, -2.3447E-24, -1.5077E-24,  3.3361E-24, &
       3.7648E-24,  6.1385E-24,  6.1846E-24,  6.9839E-24,  6.9058E-24,  6.8401E-24, &
       6.7865E-24,  6.2847E-24,  6.3373E-24,  5.6563E-24,  5.8139E-24,  5.0564E-24, &
       5.2863E-24,  4.5218E-24,  4.7985E-24,  4.0389E-24,  4.3855E-24,  3.6229E-24, &
       4.0023E-24,  3.2627E-24,  3.6624E-24,  2.9495E-24,  3.3494E-24,  2.6776E-24, &
       3.0698E-24,  2.4337E-24,  2.8253E-24,  2.2192E-24,  2.6059E-24,  2.0290E-24, &
       2.4027E-24,  1.8593E-24,  2.2329E-24,  1.7036E-24,  1.7620E-24,  1.4015E-24, &
       1.2524E-24,  1.0189E-24,  9.4496E-25,  7.8300E-25,  7.5041E-25,  6.2959E-25, &
       7.1573E-25,  6.6492E-25,  6.2296E-25,  5.8652E-25,  5.5491E-25,  5.2735E-25, &
       5.0099E-25 /)
    REAL, PARAMETER :: b1_2_SO3(dim55) = (/ &
      -5.2921E-22, -5.5643E-22, -5.6004E-22, -6.2099E-22, -6.2978E-22, -6.9275E-22, &
      -6.9939E-22, -7.4212E-22, -7.4307E-22, -7.6145E-22, -7.5946E-22, -7.5762E-22, &
      -7.5598E-22, -7.3942E-22, -7.4129E-22, -7.1541E-22, -7.2179E-22, -6.8922E-22, &
      -6.9969E-22, -6.6299E-22, -6.7696E-22, -6.3670E-22, -6.5594E-22, -6.1171E-22, &
      -6.3466E-22, -5.8807E-22, -6.1425E-22, -5.6577E-22, -5.9396E-22, -5.4493E-22, &
      -5.7454E-22, -5.2492E-22, -5.5644E-22, -5.0613E-22, -5.3919E-22, -4.8843E-22, &
      -5.2225E-22, -4.7172E-22, -5.0739E-22, -4.5552E-22, -4.6139E-22, -4.2065E-22, &
      -4.0194E-22, -3.6972E-22, -3.5859E-22, -3.3219E-22, -3.2647E-22, -3.0376E-22, &
      -3.2103E-22, -3.1021E-22, -3.0074E-22, -2.9207E-22, -2.8415E-22, -2.7690E-22, &
      -2.6964E-22 /)
    REAL, PARAMETER :: a2_SO3(dim55) = (/ &
      -3.4260E-22, -2.9460E-22, -2.3752E-22, -1.8160E-22, -1.3364E-22, -9.5840E-23, &
      -6.7840E-23, -4.7920E-23, -3.4040E-23, -2.4520E-23, -1.7920E-23, -1.3440E-23, &
      -1.0280E-23, -8.0800E-24, -6.5200E-24, -5.3200E-24, -4.4800E-24, -3.8400E-24, &
      -3.2800E-24, -2.9200E-24, -2.5600E-24, -2.2800E-24, -2.0800E-24, -1.8800E-24, &
      -1.6800E-24, -1.5600E-24, -1.4400E-24, -1.3200E-24, -1.2000E-24, -1.1200E-24, &
      -1.0400E-24, -9.6000E-25, -9.2000E-25, -8.4000E-25, -7.6000E-25, -7.2000E-25, &
      -6.8000E-25, -6.4000E-25, -6.0000E-25, -5.6000E-25, -4.5600E-25, -3.2800E-25, &
      -2.3200E-25, -1.7600E-25, -1.2000E-25, -9.6000E-26, -6.4000E-26, -4.8000E-26, &
      -3.2000E-26, -3.2000E-26, -1.6000E-26, -8.0000E-27, -1.6000E-26, -8.0000E-27, &
       0.0000E+00 /)
    REAL, PARAMETER :: b2_SO3(dim55) = (/ &
       5.1752E-21,  5.0312E-21,  4.7173E-21,  4.2699E-21,  3.7663E-21,  3.2749E-21, &
       2.8409E-21,  2.4824E-21,  2.1978E-21,  1.9789E-21,  1.8106E-21,  1.6851E-21, &
       1.5887E-21,  1.5161E-21,  1.4608E-21,  1.4152E-21,  1.3811E-21,  1.3536E-21, &
       1.3281E-21,  1.3109E-21,  1.2927E-21,  1.2778E-21,  1.2667E-21,  1.2551E-21, &
       1.2430E-21,  1.2355E-21,  1.2276E-21,  1.2195E-21,  1.2110E-21,  1.2052E-21, &
       1.1991E-21,  1.1929E-21,  1.1897E-21,  1.1830E-21,  1.1762E-21,  1.1727E-21, &
       1.1690E-21,  1.1653E-21,  1.1615E-21,  1.1576E-21,  1.1471E-21,  1.1327E-21, &
       1.1206E-21,  1.1129E-21,  1.1045E-21,  1.1005E-21,  1.0949E-21,  1.0919E-21, &
       1.0887E-21,  1.0887E-21,  1.0851E-21,  1.0832E-21,  1.0852E-21,  1.0831E-21, &
       1.0809E-21 /)
    REAL, PARAMETER :: a3_SO3(dim55) = (/ &
      -1.4673E-24, -9.0649E-25, -5.0402E-25, -2.9454E-25, -1.8932E-25, -1.3195E-25, &
      -9.7895E-26, -7.6001E-26, -6.1270E-26, -5.0659E-26, -4.2794E-26, -3.6625E-26, &
      -3.2004E-26, -2.8073E-26, -2.4987E-26, -2.2253E-26, -2.0195E-26, -1.8135E-26, &
      -1.6610E-26, -1.5068E-26, -1.3846E-26, -1.2671E-26, -1.1815E-26, -1.0959E-26, &
      -1.0085E-26, -9.2466E-27, -8.7329E-27, -8.2192E-27, -7.5214E-27, -7.1918E-27, &
      -6.6781E-27, -6.1644E-27, -5.9829E-27, -5.4795E-27, -5.1370E-27, -4.9573E-27, &
      -4.4521E-27, -4.4521E-27, -3.9384E-27, -3.9316E-27, -3.2523E-27, -2.4307E-27, &
      -1.8823E-27, -1.4379E-27, -1.0955E-27, -8.5558E-28, -6.8470E-28, -5.1352E-28, &
      -4.1068E-28, -3.0811E-28, -2.3964E-28, -2.0534E-28, -1.3694E-28, -1.3694E-28, &
      -1.0267E-28 /)
    REAL, PARAMETER :: b3_SO3(dim55) = (/ &
       5.3500E-22,  5.0196E-22,  4.5473E-22,  4.1790E-22,  3.9326E-22,  3.7647E-22, &
       3.6452E-22,  3.5555E-22,  3.4866E-22,  3.4307E-22,  3.3847E-22,  3.3451E-22, &
       3.3126E-22,  3.2828E-22,  3.2575E-22,  3.2335E-22,  3.2143E-22,  3.1938E-22, &
       3.1778E-22,  3.1607E-22,  3.1464E-22,  3.1319E-22,  3.1209E-22,  3.1094E-22, &
       3.0972E-22,  3.0849E-22,  3.0771E-22,  3.0690E-22,  3.0576E-22,  3.0520E-22, &
       3.0430E-22,  3.0337E-22,  3.0303E-22,  3.0206E-22,  3.0138E-22,  3.0101E-22, &
       2.9995E-22,  2.9995E-22,  2.9881E-22,  2.9879E-22,  2.9720E-22,  2.9504E-22, &
       2.9344E-22,  2.9201E-22,  2.9081E-22,  2.8990E-22,  2.8920E-22,  2.8845E-22, &
       2.8797E-22,  2.8746E-22,  2.8710E-22,  2.8691E-22,  2.8651E-22,  2.8651E-22, &
       2.8629E-22 /)
    REAL, PARAMETER :: a4_SO3(4) = (/  1.9715E-22, -2.5152E-26,  5.1914E-30, -3.6095E-34 /)
    REAL, PARAMETER :: a5_SO3(4) = (/  4.6310E-23, -1.3411E-26,  2.1474E-30, -1.3263E-34 /)

    jval_2d(ip_SO3)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_SO3(0) = &
          p1(a0_1_1_SO3(i0(j,k))*dlv2(j,k) + &
          a0_1_2_SO3(i0(j,k)), &
          a0_2_1_SO3(i0(j,k))*dlv2(j,k) + &
          a0_2_2_SO3(i0(j,k)),v3_du1(j,k))
        sig_SO3(1) = &
          (p1(b1_1_SO3(i1(j,k)),a1_1_SO3(i1(j,k)), &
          v3_du1(j,k)) + &
          p1(b1_2_SO3(i1(j,k)),a1_2_SO3(i1(j,k)), &
          v3_du1(j,k)) * v2s_m(j,k))
        sig_SO3(2) = &
          p1(b2_SO3(i2(j,k)), a2_SO3(i2(j,k)), &
          v3_du1(j,k))
        sig_SO3(3) = &
          p1(b3_SO3(i3(j,k)), a3_SO3(i3(j,k)), &
          v3_du2(j,k))
        sig_SO3(4) = &
          p3(a4_SO3(1),a4_SO3(2),a4_SO3(3), &
          a4_SO3(4),v3_du2(j,k))
        sig_SO3(5) = &
          p3(a5_SO3(1),a5_SO3(2),a5_SO3(3), &
          a5_SO3(4),v3_du2(j,k))
        dj = 0. &
          + sig_SO3(0) * fint(j,k,0) &
          + sig_SO3(1) * fint(j,k,1) &
          + sig_SO3(2) * fint(j,k,2) &
          + sig_SO3(3) * fint(j,k,3) &
          + sig_SO3(4) * fint(j,k,4) &
          + sig_SO3(5) * fint(j,k,5)

        jval_2d(ip_SO3)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,1)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_SO3

  ! **************************************************************************

  SUBROUTINE jval_cal_OCS

    ! OCS \TOHV\ \products

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_OCS

    ! T-const parameters:
    REAL, PARAMETER :: a0_1_1_OCS(dim58) = (/ &
       4.7058E-22,  5.0056E-22,  5.3163E-22,  5.6065E-22,  5.9004E-22,  6.1725E-22, &
       6.4398E-22,  6.6776E-22,  6.9005E-22,  7.0948E-22,  7.2767E-22,  7.4338E-22, &
       8.3187E-22,  1.0851E-21,  1.0435E-21,  1.0718E-21,  1.1867E-21,  1.1126E-21, &
       1.1147E-21,  1.2104E-21,  1.0757E-21,  1.0247E-21,  1.0802E-21,  8.6445E-22, &
       7.4935E-22,  3.4274E-22,  6.6507E-23, -5.7248E-23, -1.5659E-22, -2.2679E-22, &
      -2.5964E-22, -2.5427E-22, -2.1087E-22, -1.3358E-22, -2.9801E-23,  9.3146E-23, &
       2.2852E-22,  3.6977E-22,  5.1481E-22,  6.6123E-22,  8.1121E-22,  9.6064E-22, &
       1.1100E-21,  1.2515E-21,  1.3780E-21,  1.4815E-21,  1.5511E-21,  1.5904E-21, &
       1.5947E-21,  1.5720E-21,  1.5274E-21,  1.4661E-21,  1.3910E-21,  1.3024E-21, &
       1.1992E-21,  1.0781E-21,  9.2384E-22,  7.7019E-22 /)
    REAL, PARAMETER :: a0_1_2_OCS(dim58) = (/ &
       8.4988E-21,  7.1739E-21,  5.7944E-21,  4.4998E-21,  3.1834E-21,  1.9586E-21, &
       7.5072E-22, -3.2879E-22, -1.3456E-21, -2.2352E-21, -3.0721E-21, -3.7979E-21, &
      -7.9037E-21, -1.9704E-20, -1.7759E-20, -1.9088E-20, -2.4510E-20, -2.0997E-20, &
      -2.1099E-20, -2.5673E-20, -1.9208E-20, -1.6750E-20, -1.9435E-20, -8.9499E-21, &
      -3.3329E-21,  1.6591E-20,  3.0182E-20,  3.6295E-20,  4.1223E-20,  4.4718E-20, &
       4.6361E-20,  4.6091E-20,  4.3904E-20,  3.9993E-20,  3.4721E-20,  2.8451E-20, &
       2.1520E-20,  1.4260E-20,  6.7753E-21, -8.0943E-22, -8.6084E-21, -1.6409E-20, &
      -2.4233E-20, -3.1678E-20, -3.8358E-20, -4.3842E-20, -4.7543E-20, -4.9644E-20, &
      -4.9874E-20, -4.8654E-20, -4.6243E-20, -4.2924E-20, -3.8837E-20, -3.4001E-20, &
      -2.8344E-20, -2.1686E-20, -1.3168E-20, -4.6560E-21 /)
    REAL, PARAMETER :: a0_2_1_OCS(dim58) = (/ &
       2.4588E-24,  2.7657E-24,  3.0968E-24,  3.4722E-24,  3.8757E-24,  4.3162E-24, &
       4.7838E-24,  5.3060E-24,  5.8605E-24,  6.4710E-24,  7.1276E-24,  7.8494E-24, &
       7.5091E-24,  4.8433E-24,  6.6110E-24,  7.3350E-24,  6.9350E-24,  8.9560E-24, &
       9.8771E-24,  9.5921E-24,  1.1884E-23,  1.2971E-23,  1.2732E-23,  1.5181E-23, &
       1.6285E-23,  2.0059E-23,  2.2204E-23,  2.2593E-23,  2.2522E-23,  2.1958E-23, &
       2.0851E-23,  1.9226E-23,  1.7158E-23,  1.4749E-23,  1.2186E-23,  9.6103E-24, &
       7.1951E-24,  5.0580E-24,  3.2702E-24,  1.8594E-24,  7.9607E-25,  4.6567E-26, &
      -4.9098E-25, -8.6981E-25, -1.1572E-24, -1.3682E-24, -1.4949E-24, -1.5598E-24, &
      -1.5609E-24, -1.5191E-24, -1.4393E-24, -1.3396E-24, -1.2242E-24, -1.0910E-24, &
      -9.4389E-25, -7.9535E-25, -6.3819E-25, -5.2051E-25 /)
    REAL, PARAMETER :: a0_2_2_OCS(dim58) = (/ &
      -1.8428E-22, -1.9785E-22, -2.1255E-22, -2.2929E-22, -2.4737E-22, -2.6719E-22, &
      -2.8833E-22, -3.1203E-22, -3.3732E-22, -3.6528E-22, -3.9549E-22, -4.2883E-22, &
      -4.1304E-22, -2.8882E-22, -3.7154E-22, -4.0557E-22, -3.8669E-22, -4.8249E-22, &
      -5.2633E-22, -5.1271E-22, -6.2271E-22, -6.7511E-22, -6.6354E-22, -7.8255E-22, &
      -8.3644E-22, -1.0214E-21, -1.1269E-21, -1.1461E-21, -1.1426E-21, -1.1145E-21, &
      -1.0592E-21, -9.7758E-22, -8.7335E-22, -7.5149E-22, -6.2126E-22, -4.8990E-22, &
      -3.6624E-22, -2.5640E-22, -1.6414E-22, -9.1065E-23, -3.5773E-23,  3.3512E-24, &
       3.1519E-23,  5.1445E-23,  6.6617E-23,  7.7803E-23,  8.4543E-23,  8.8010E-23, &
       8.8069E-23,  8.5818E-23,  8.1510E-23,  7.6106E-23,  6.9825E-23,  6.2557E-23, &
       5.4494E-23,  4.6324E-23,  3.7649E-23,  3.1129E-23 /)
    REAL, PARAMETER :: a1_1_OCS(dim55) = (/ &
       2.3525E-21,  1.7510E-21,  9.7716E-22,  4.9154E-22, -1.3679E-22, -4.1512E-22, &
      -8.4046E-22, -9.4041E-22, -1.1939E-21, -1.1903E-21, -1.3199E-21, -1.2697E-21, &
      -1.3250E-21, -1.2596E-21, -1.2712E-21, -1.2040E-21, -1.1926E-21, -1.1326E-21, &
      -1.1062E-21, -1.0557E-21, -1.0209E-21, -9.8149E-22, -9.4242E-22, -9.1192E-22, &
      -8.6966E-22, -8.4664E-22, -8.0512E-22, -7.8686E-22, -7.4562E-22, -7.3505E-22, &
      -6.9548E-22, -6.8648E-22, -6.4665E-22, -6.4367E-22, -6.0521E-22, -6.0627E-22, &
      -5.6730E-22, -5.6979E-22, -5.3344E-22, -5.3986E-22, -4.8449E-22, -4.3077E-22, &
      -3.7873E-22, -3.4490E-22, -3.0802E-22, -2.8510E-22, -2.5686E-22, -2.4099E-22, &
      -2.0840E-22, -1.9242E-22, -1.7756E-22, -1.6436E-22, -1.5237E-22, -1.4146E-22, &
      -1.3144E-22 /)
    REAL, PARAMETER :: b1_1_OCS(dim55) = (/ &
       2.1101E-19,  2.1281E-19,  2.1707E-19,  2.2096E-19,  2.2755E-19,  2.3117E-19, &
       2.3776E-19,  2.3956E-19,  2.4476E-19,  2.4468E-19,  2.4798E-19,  2.4658E-19, &
       2.4826E-19,  2.4611E-19,  2.4652E-19,  2.4396E-19,  2.4350E-19,  2.4092E-19, &
       2.3972E-19,  2.3730E-19,  2.3554E-19,  2.3345E-19,  2.3128E-19,  2.2951E-19, &
       2.2696E-19,  2.2551E-19,  2.2279E-19,  2.2154E-19,  2.1864E-19,  2.1786E-19, &
       2.1488E-19,  2.1417E-19,  2.1097E-19,  2.1072E-19,  2.0743E-19,  2.0753E-19, &
       2.0400E-19,  2.0423E-19,  2.0076E-19,  2.0139E-19,  1.9582E-19,  1.8975E-19, &
       1.8322E-19,  1.7855E-19,  1.7300E-19,  1.6927E-19,  1.6431E-19,  1.6133E-19, &
       1.5479E-19,  1.5139E-19,  1.4804E-19,  1.4490E-19,  1.4190E-19,  1.3903E-19, &
       1.3627E-19 /)
    REAL, PARAMETER :: a1_2_OCS(dim55) = (/ &
       1.4347E-23,  1.4395E-23,  1.7956E-23,  1.5099E-23,  1.6884E-23,  1.2549E-23, &
       1.3185E-23,  8.8593E-24,  9.0462E-24,  5.5389E-24,  5.5457E-24,  3.0381E-24, &
       3.0235E-24,  1.3617E-24,  1.3402E-24,  2.6896E-25,  2.4933E-25, -3.8235E-25, &
      -4.2386E-25, -7.6682E-25, -8.4662E-25, -9.6694E-25, -1.0758E-24, -1.0628E-24, &
      -1.2014E-24, -1.1012E-24, -1.2443E-24, -1.1043E-24, -1.2603E-24, -1.0618E-24, &
      -1.2225E-24, -1.0232E-24, -1.1986E-24, -9.7091E-25, -1.1448E-24, -9.1051E-25, &
      -1.0964E-24, -8.6611E-25, -1.0396E-24, -8.0169E-25, -8.5651E-25, -6.9972E-25, &
      -6.4378E-25, -5.2874E-25, -4.9763E-25, -4.1305E-25, -3.9908E-25, -3.3372E-25, &
      -3.8482E-25, -3.5527E-25, -3.3133E-25, -3.0986E-25, -2.9067E-25, -2.7399E-25, &
      -2.5862E-25 /)
    REAL, PARAMETER :: b1_2_OCS(dim55) = (/ &
      -1.6597E-22, -1.6612E-22, -1.8571E-22, -1.6284E-22, -1.8159E-22, -1.2524E-22, &
      -1.3509E-22, -5.7230E-23, -6.1062E-23,  1.9605E-23,  1.9431E-23,  8.9645E-23, &
       9.0089E-23,  1.4493E-22,  1.4569E-22,  1.8640E-22,  1.8720E-22,  2.1436E-22, &
       2.1625E-22,  2.3271E-22,  2.3674E-22,  2.4311E-22,  2.4916E-22,  2.4841E-22, &
       2.5679E-22,  2.5047E-22,  2.5985E-22,  2.5033E-22,  2.6133E-22,  2.4683E-22, &
       2.5897E-22,  2.4342E-22,  2.5755E-22,  2.3864E-22,  2.5351E-22,  2.3290E-22, &
       2.4972E-22,  2.2830E-22,  2.4487E-22,  2.2155E-22,  2.2706E-22,  2.0935E-22, &
       2.0233E-22,  1.8645E-22,  1.8177E-22,  1.6798E-22,  1.6553E-22,  1.5324E-22, &
       1.6349E-22,  1.5719E-22,  1.5180E-22,  1.4669E-22,  1.4188E-22,  1.3749E-22, &
       1.3326E-22 /)
    REAL, PARAMETER :: a2_OCS(dim55) = (/ &
      -2.4816E-22, -2.1144E-22, -1.6780E-22, -1.2540E-22, -8.9472E-23, -6.1672E-23, &
      -4.1548E-23, -2.7620E-23, -1.8276E-23, -1.2128E-23, -8.1400E-24, -5.5708E-24, &
      -3.9116E-24, -2.8400E-24, -2.1408E-24, -1.6780E-24, -1.3652E-24, -1.1488E-24, &
      -9.9280E-25, -8.7720E-25, -7.8800E-25, -7.1600E-25, -6.5640E-25, -6.0560E-25, &
      -5.6080E-25, -5.2120E-25, -4.8560E-25, -4.5240E-25, -4.2320E-25, -3.9520E-25, &
      -3.6960E-25, -3.4600E-25, -3.2400E-25, -3.0320E-25, -2.8440E-25, -2.6640E-25, &
      -2.4960E-25, -2.3400E-25, -2.1920E-25, -2.0600E-25, -1.7040E-25, -1.2376E-25, &
      -9.0000E-26, -6.5440E-26, -4.7520E-26, -3.4560E-26, -2.5040E-26, -1.8240E-26, &
      -1.3200E-26, -9.6000E-27, -6.9600E-27, -5.0400E-27, -3.6800E-27, -2.6400E-27, &
      -1.9200E-27 /)
    REAL, PARAMETER :: b2_OCS(dim55) = (/ &
       2.7628E-21,  2.6526E-21,  2.4126E-21,  2.0734E-21,  1.6962E-21,  1.3348E-21, &
       1.0228E-21,  7.7213E-22,  5.8058E-22,  4.3917E-22,  3.3748E-22,  2.6554E-22, &
       2.1494E-22,  1.7957E-22,  1.5475E-22,  1.3717E-22,  1.2450E-22,  1.1519E-22, &
       1.0809E-22,  1.0255E-22,  9.8041E-23,  9.4225E-23,  9.0917E-23,  8.7971E-23, &
       8.5260E-23,  8.2766E-23,  8.0434E-23,  7.8176E-23,  7.6118E-23,  7.4074E-23, &
       7.2141E-23,  7.0300E-23,  6.8529E-23,  6.6803E-23,  6.5195E-23,  6.3611E-23, &
       6.2091E-23,  6.0640E-23,  5.9227E-23,  5.7933E-23,  5.4355E-23,  4.9085E-23, &
       4.4848E-23,  4.1459E-23,  3.8762E-23,  3.6649E-23,  3.4979E-23,  3.3700E-23, &
       3.2690E-23,  3.1923E-23,  3.1327E-23,  3.0871E-23,  3.0530E-23,  3.0256E-23, &
       3.0058E-23 /)
    REAL, PARAMETER :: a3_OCS(dim55) = (/ &
      -1.3480E-26, -6.8968E-27, -2.9091E-27, -1.1883E-27, -5.0818E-28, -2.3084E-28, &
      -1.0979E-28, -5.3596E-29, -2.6452E-29, -1.3093E-29, -6.4736E-30, -3.1898E-30, &
      -1.5661E-30, -7.6618E-31, -3.7340E-31, -1.8145E-31, -8.7886E-32, -4.2448E-32, &
      -2.0478E-32, -9.8498E-33, -4.7200E-33, -2.2654E-33, -1.0839E-33, -5.1769E-34, &
      -2.4653E-34, -1.1764E-34, -5.5978E-35, -2.6608E-35, -1.2611E-35, -5.9928E-36, &
      -2.8402E-36, -1.3450E-36, -6.3532E-37, -3.0092E-37, -1.4217E-37, -6.7022E-38, &
      -3.1682E-38, -1.4943E-38,  0.0000E+00,  0.0000E+00,  0.0000E+00,  0.0000E+00, &
       0.0000E+00,  0.0000E+00,  0.0000E+00,  0.0000E+00,  0.0000E+00,  0.0000E+00, &
       0.0000E+00,  0.0000E+00,  0.0000E+00,  0.0000E+00,  0.0000E+00,  0.0000E+00, &
       0.0000E+00 /)
    REAL, PARAMETER :: b3_OCS(dim55) = (/ &
       1.4924E-24,  1.1045E-24,  6.3658E-25,  3.3409E-25,  1.7480E-25,  9.3639E-26, &
       5.1143E-26,  2.8132E-26,  1.5431E-26,  8.3996E-27,  4.5288E-27,  2.4166E-27, &
       1.2774E-27,  6.6943E-28,  3.4796E-28,  1.7963E-28,  9.2119E-29,  4.6965E-29, &
       2.3847E-29,  1.2044E-29,  6.0472E-30,  3.0341E-30,  1.5148E-30,  7.5368E-31, &
       3.7333E-31,  1.8500E-31,  9.1289E-32,  4.4944E-32,  2.2039E-32,  1.0822E-32, &
       5.2947E-33,  2.5857E-33,  1.2586E-33,  6.1366E-34,  2.9822E-34,  1.4451E-34, &
       7.0155E-35,  3.3962E-35,  1.6419E-35,  7.9168E-36,  1.5201E-36,  3.8801E-38, &
       0.0000E+00,  0.0000E+00,  0.0000E+00,  0.0000E+00,  0.0000E+00,  0.0000E+00, &
       0.0000E+00,  0.0000E+00,  0.0000E+00,  0.0000E+00,  0.0000E+00,  0.0000E+00, &
       0.0000E+00 /)
    ! T-dep parameters:
    REAL, PARAMETER :: c0_1_1_OCS(dim58) = (/ &
       2.9787E-02,  2.9787E-02,  2.9787E-02,  3.3694E-02,  3.7265E-02,  4.1099E-02, &
       4.4063E-02,  4.6123E-02,  4.7590E-02,  4.8002E-02,  4.8026E-02,  4.7795E-02, &
       4.6402E-02,  4.5324E-02,  4.4277E-02,  4.3313E-02,  4.2017E-02,  4.0510E-02, &
       3.9484E-02,  3.7366E-02,  3.5689E-02,  3.2130E-02,  2.8729E-02,  2.4461E-02, &
       1.9817E-02,  1.5970E-02,  1.2458E-02,  1.0806E-02,  1.1201E-02,  1.4386E-02, &
       1.9369E-02,  2.6469E-02,  3.6094E-02,  4.6045E-02,  5.7109E-02,  6.7882E-02, &
       7.8237E-02,  8.7966E-02,  9.5937E-02,  1.0219E-01,  1.0492E-01,  1.0305E-01, &
       9.6272E-02,  8.4407E-02,  6.9343E-02,  5.2181E-02,  3.6283E-02,  2.2482E-02, &
       1.1214E-02,  1.3358E-04, -1.2009E-02, -2.8690E-02, -4.9438E-02, -7.3188E-02, &
      -9.6979E-02, -1.1797E-01, -1.4270E-01, -1.7128E-01 /)
    REAL, PARAMETER :: c0_1_2_OCS(dim58) = (/ &
      -1.6117E+00, -1.6117E+00, -1.6117E+00, -1.7860E+00, -1.9459E+00, -2.1185E+00, &
      -2.2525E+00, -2.3460E+00, -2.4129E+00, -2.4317E+00, -2.4328E+00, -2.4222E+00, &
      -2.3575E+00, -2.3073E+00, -2.2583E+00, -2.2130E+00, -2.1518E+00, -2.0804E+00, &
      -2.0316E+00, -1.9303E+00, -1.8498E+00, -1.6783E+00, -1.5137E+00, -1.3063E+00, &
      -1.0797E+00, -8.9112E-01, -7.1832E-01, -6.3671E-01, -6.5633E-01, -8.1493E-01, &
      -1.0641E+00, -1.4205E+00, -1.9056E+00, -2.4091E+00, -2.9712E+00, -3.5206E+00, &
      -4.0508E+00, -4.5509E+00, -4.9622E+00, -5.2859E+00, -5.4280E+00, -5.3306E+00, &
      -4.9752E+00, -4.3512E+00, -3.5558E+00, -2.6462E+00, -1.8004E+00, -1.0634E+00, &
      -4.5948E-01,  1.3667E-01,  7.9240E-01,  1.6965E+00,  2.8252E+00,  4.1219E+00, &
       5.4257E+00,  6.5800E+00,  7.9454E+00,  9.5286E+00 /)
    REAL, PARAMETER :: c0_2_1_OCS(dim58) = (/ &
       4.8739E-03,  4.8739E-03,  4.8739E-03,  7.1052E-03,  5.9096E-03,  9.0133E-03, &
       8.9800E-03,  1.1570E-02,  1.0946E-02,  9.1547E-03,  6.8874E-03,  1.0257E-02, &
       4.7255E-03,  2.4523E-03,  1.1173E-03, -1.3947E-03, -2.0149E-03, -7.0524E-04, &
       2.1184E-04, -8.5986E-04,  5.1322E-04,  4.0078E-03,  6.1570E-03,  6.8112E-03, &
       1.5665E-02,  1.8408E-02,  2.7538E-02,  3.0711E-02,  4.3749E-02,  4.5276E-02, &
       5.0257E-02,  5.3585E-02,  5.2630E-02,  5.3461E-02,  5.5397E-02,  5.8226E-02, &
       5.8443E-02,  5.9183E-02,  5.0328E-02,  3.2438E-02,  1.0634E-02, -1.7030E-02, &
      -5.0874E-02, -7.4560E-02, -8.6459E-02, -8.9752E-02, -8.7888E-02, -7.9763E-02, &
      -7.2613E-02, -6.6793E-02, -5.5678E-02, -3.8300E-02, -9.1051E-03,  2.2521E-02, &
       4.7977E-02,  4.9052E-02,  2.4562E-02, -1.4876E-02 /)
    REAL, PARAMETER :: c0_2_2_OCS(dim58) = (/ &
      -2.1045E-01, -2.1045E-01, -2.1045E-01, -3.0997E-01, -2.5640E-01, -3.9607E-01, &
      -3.9456E-01, -5.1213E-01, -4.8370E-01, -4.0165E-01, -2.9736E-01, -4.5303E-01, &
      -1.9637E-01, -9.0441E-02, -2.7965E-02,  9.0099E-02,  1.1937E-01,  5.7295E-02, &
       1.3642E-02,  6.4869E-02, -1.0390E-03, -1.6948E-01, -2.7350E-01, -3.0529E-01, &
      -7.3736E-01, -8.7179E-01, -1.3210E+00, -1.4777E+00, -2.1244E+00, -2.2004E+00, &
      -2.4495E+00, -2.6166E+00, -2.5684E+00, -2.6105E+00, -2.7088E+00, -2.8531E+00, &
      -2.8642E+00, -2.9023E+00, -2.4453E+00, -1.5186E+00, -3.8483E-01,  1.0593E+00, &
       2.8327E+00,  4.0785E+00,  4.7068E+00,  4.8814E+00,  4.7822E+00,  4.3483E+00, &
       3.9651E+00,  3.6520E+00,  3.0518E+00,  2.1099E+00,  5.2166E-01, -1.2051E+00, &
      -2.6001E+00, -2.6592E+00, -1.3074E+00,  8.7746E-01 /)
    REAL, PARAMETER :: c1_OCS(3) = (/  1.0000E+00, -1.2228E-02,  1.0177E-03 /)
    REAL, PARAMETER :: c2_OCS(3) = (/  9.7689E-01, -3.9295E+00,  1.7747E+00 /)
    REAL, PARAMETER :: c3_OCS(3) = (/  9.8445E-01, -2.5107E+00, -4.7643E+00 /)

    jval_2d(ip_OCS)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_OCS(0) = &
          p2(1.,c0_1_1_OCS(i0(j,k))*dlv2(j,k) + &
          c0_1_2_OCS(i0(j,k)), &
          c0_2_1_OCS(i0(j,k))*dlv2(j,k) + &
          c0_2_2_OCS(i0(j,k)), tnorm_sr(j,k)) * &
          p1(a0_1_1_OCS(i0(j,k))*dlv2(j,k) + &
          a0_1_2_OCS(i0(j,k)), &
          a0_2_1_OCS(i0(j,k))*dlv2(j,k) + &
          a0_2_2_OCS(i0(j,k)),v3_du1(j,k))
        sig_OCS(1) = &
          p2(c1_OCS(1),c1_OCS(2), &
          c1_OCS(3),tnorm(j,k)) * &
          (p1(b1_1_OCS(i1(j,k)),a1_1_OCS(i1(j,k)), &
          v3_du1(j,k)) + &
          p1(b1_2_OCS(i1(j,k)),a1_2_OCS(i1(j,k)), &
          v3_du1(j,k)) * v2s_m(j,k))
        sig_OCS(2) = &
          p2(c2_OCS(1),c2_OCS(2),c2_OCS(3),tnorm(j,k))* &
          p1(b2_OCS(i2(j,k)), a2_OCS(i2(j,k)), &
          v3_du1(j,k))
        sig_OCS(3) = &
          p2(c3_OCS(1),c3_OCS(2),c3_OCS(3),tnorm(j,k))* &
          p1(b3_OCS(i3(j,k)), a3_OCS(i3(j,k)), &
          v3_du2(j,k))
        dj = 0. &
          + sig_OCS(0) * fint(j,k,0) &
          + sig_OCS(1) * fint(j,k,1) &
          + sig_OCS(2) * fint(j,k,2) &
          + sig_OCS(3) * fint(j,k,3)

        jval_2d(ip_OCS)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,7)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_OCS

  ! **************************************************************************

  SUBROUTINE jval_cal_H2O

    ! H_2O \TOHV\ H + OH

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_H2O

    ! T-const parameters:
    REAL, PARAMETER :: a0_1_1_H2O(dim58) = (/ &
      -7.1091E-21, -7.5887E-21, -8.0786E-21, -8.5738E-21, -9.0470E-21, -9.4893E-21, &
      -9.8893E-21, -1.0236E-20, -1.0522E-20, -1.0758E-20, -1.0937E-20, -1.1076E-20, &
      -1.1983E-20, -1.4539E-20, -1.3739E-20, -1.3656E-20, -1.4275E-20, -1.3002E-20, &
      -1.2367E-20, -1.2327E-20, -1.0338E-20, -8.9852E-21, -8.2487E-21, -5.8608E-21, &
      -4.3202E-21, -1.6864E-21, -2.1575E-22,  3.1152E-22,  6.1396E-22,  7.4725E-22, &
       7.6519E-22,  7.0762E-22,  5.9846E-22,  4.5447E-22,  2.9127E-22,  1.2602E-22, &
      -2.3986E-23, -1.4670E-22, -2.3589E-22, -2.9174E-22, -3.1827E-22, -3.2203E-22, &
      -3.1014E-22, -2.8900E-22, -2.6328E-22, -2.3614E-22, -2.0898E-22, -1.8358E-22, &
      -1.6051E-22, -1.4050E-22, -1.2362E-22, -1.0929E-22, -9.6862E-23, -8.5626E-23, &
      -7.5196E-23, -6.5211E-23, -5.5088E-23, -4.6849E-23 /)
    REAL, PARAMETER :: a0_1_2_H2O(dim58) = (/ &
       3.6456E-19,  3.8576E-19,  4.0751E-19,  4.2960E-19,  4.5080E-19,  4.7070E-19, &
       4.8878E-19,  5.0452E-19,  5.1757E-19,  5.2839E-19,  5.3660E-19,  5.4303E-19, &
       5.8509E-19,  7.0422E-19,  6.6680E-19,  6.6290E-19,  6.9209E-19,  6.3176E-19, &
       6.0153E-19,  5.9962E-19,  5.0416E-19,  4.3894E-19,  4.0330E-19,  2.8724E-19, &
       2.1207E-19,  8.3009E-20,  1.0651E-20, -1.5396E-20, -3.0397E-20, -3.7035E-20, &
      -3.7932E-20, -3.5042E-20, -2.9540E-20, -2.2254E-20, -1.3964E-20, -5.5359E-21, &
       2.1442E-21,  8.4519E-21,  1.3054E-20,  1.5947E-20,  1.7326E-20,  1.7523E-20, &
       1.6900E-20,  1.5788E-20,  1.4430E-20,  1.2991E-20,  1.1546E-20,  1.0190E-20, &
       8.9537E-21,  7.8771E-21,  6.9652E-21,  6.1890E-21,  5.5127E-21,  4.8992E-21, &
       4.3276E-21,  3.7784E-21,  3.2196E-21,  2.7632E-21 /)
    REAL, PARAMETER :: a0_2_1_H2O(dim58) = (/ &
      -4.6487E-23, -5.1349E-23, -5.6828E-23, -6.2849E-23, -6.9437E-23, -7.6269E-23, &
      -8.3290E-23, -9.0438E-23, -9.7765E-23, -1.0519E-22, -1.1286E-22, -1.2091E-22, &
      -1.1720E-22, -8.9801E-23, -1.1209E-22, -1.2283E-22, -1.2325E-22, -1.4621E-22, &
      -1.5739E-22, -1.5753E-22, -1.7555E-22, -1.8000E-22, -1.7206E-22, -1.7627E-22, &
      -1.6697E-22, -1.6576E-22, -1.5196E-22, -1.3006E-22, -1.0881E-22, -8.9599E-23, &
      -7.3030E-23, -5.9043E-23, -4.7159E-23, -3.6855E-23, -2.7859E-23, -2.0078E-23, &
      -1.3632E-23, -8.5528E-24, -4.8090E-24, -2.2604E-24, -6.9413E-25,  1.3908E-25, &
       4.9098E-25,  5.7630E-25,  5.4373E-25,  4.7365E-25,  3.9775E-25,  3.2787E-25, &
       2.6670E-25,  2.1580E-25,  1.7473E-25,  1.4177E-25,  1.1485E-25,  9.2270E-26, &
       7.3279E-26,  5.7539E-26,  4.4405E-26,  3.5700E-26 /)
    REAL, PARAMETER :: a0_2_2_H2O(dim58) = (/ &
       2.8067E-21,  3.0216E-21,  3.2649E-21,  3.5334E-21,  3.8285E-21,  4.1360E-21, &
       4.4533E-21,  4.7779E-21,  5.1119E-21,  5.4518E-21,  5.8047E-21,  6.1767E-21, &
       6.0045E-21,  4.7278E-21,  5.7707E-21,  6.2755E-21,  6.2954E-21,  7.3837E-21, &
       7.9158E-21,  7.9229E-21,  8.7876E-21,  9.0020E-21,  8.6180E-21,  8.8223E-21, &
       8.3684E-21,  8.3091E-21,  7.6301E-21,  6.5483E-21,  5.4946E-21,  4.5378E-21, &
       3.7094E-21,  3.0072E-21,  2.4082E-21,  1.8869E-21,  1.4299E-21,  1.0331E-21, &
       7.0303E-22,  4.4194E-22,  2.4876E-22,  1.1674E-22,  3.5296E-23, -8.1976E-24, &
      -2.6637E-23, -3.1125E-23, -2.9406E-23, -2.5691E-23, -2.1653E-23, -1.7922E-23, &
      -1.4643E-23, -1.1904E-23, -9.6867E-24, -7.9004E-24, -6.4360E-24, -5.2030E-24, &
      -4.1623E-24, -3.2966E-24, -2.5716E-24, -2.0893E-24 /)

    jval_2d(ip_H2O)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_H2O(0) = &
          p1(a0_1_1_H2O(i0(j,k))*dlv2(j,k) + &
          a0_1_2_H2O(i0(j,k)), &
          a0_2_1_H2O(i0(j,k))*dlv2(j,k) + &
          a0_2_2_H2O(i0(j,k)),v3_du1(j,k))
        dj = 0. &
          + 1.48E-17 * r_m(j,k) * phi_la &
          + sig_H2O(0) * fint(j,k,0)

        jval_2d(ip_H2O)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,8)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_H2O

  ! **************************************************************************

  SUBROUTINE jval_cal_N2O

    ! N_2O \TOHV\ N_2 + O(^1D)

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_N2O

    ! T-const parameters:
    REAL, PARAMETER :: a0_1_1_N2O(dim58) = (/ &
      -1.3726E-21, -1.4877E-21, -1.6053E-21, -1.7255E-21, -1.8494E-21, -1.9736E-21, &
      -2.0983E-21, -2.2216E-21, -2.3449E-21, -2.4683E-21, -2.5882E-21, -2.7115E-21, &
      -3.1450E-21, -4.2474E-21, -4.0945E-21, -4.2485E-21, -4.7450E-21, -4.5177E-21, &
      -4.6098E-21, -5.0620E-21, -4.6962E-21, -4.6687E-21, -5.0248E-21, -4.4779E-21, &
      -4.3056E-21, -3.2065E-21, -2.5612E-21, -2.3906E-21, -2.2666E-21, -2.1997E-21, &
      -2.1976E-21, -2.2607E-21, -2.3854E-21, -2.5562E-21, -2.7590E-21, -2.9696E-21, &
      -3.1737E-21, -3.3548E-21, -3.5045E-21, -3.6180E-21, -3.6938E-21, -3.7325E-21, &
      -3.7343E-21, -3.6969E-21, -3.6176E-21, -3.4960E-21, -3.3292E-21, -3.1318E-21, &
      -2.9114E-21, -2.6843E-21, -2.4599E-21, -2.2445E-21, -2.0313E-21, -1.8198E-21, &
      -1.6076E-21, -1.3900E-21, -1.1564E-21, -9.5495E-22 /)
    REAL, PARAMETER :: a0_1_2_N2O(dim58) = (/ &
       1.2968E-19,  1.3477E-19,  1.3999E-19,  1.4535E-19,  1.5090E-19,  1.5649E-19, &
       1.6213E-19,  1.6773E-19,  1.7335E-19,  1.7900E-19,  1.8452E-19,  1.9021E-19, &
       2.1033E-19,  2.6170E-19,  2.5454E-19,  2.6178E-19,  2.8521E-19,  2.7444E-19, &
       2.7883E-19,  3.0044E-19,  2.8288E-19,  2.8156E-19,  2.9879E-19,  2.7221E-19, &
       2.6381E-19,  2.0995E-19,  1.7820E-19,  1.6977E-19,  1.6362E-19,  1.6029E-19, &
       1.6019E-19,  1.6335E-19,  1.6964E-19,  1.7828E-19,  1.8858E-19,  1.9932E-19, &
       2.0977E-19,  2.1908E-19,  2.2681E-19,  2.3268E-19,  2.3663E-19,  2.3865E-19, &
       2.3874E-19,  2.3677E-19,  2.3259E-19,  2.2614E-19,  2.1727E-19,  2.0673E-19, &
       1.9492E-19,  1.8269E-19,  1.7058E-19,  1.5890E-19,  1.4731E-19,  1.3576E-19, &
       1.2413E-19,  1.1216E-19,  9.9268E-20,  8.8106E-20 /)
    REAL, PARAMETER :: a0_2_1_N2O(dim58) = (/ &
      -5.9444E-24, -6.5835E-24, -7.3010E-24, -8.0946E-24, -8.9448E-24, -9.8736E-24, &
      -1.0879E-23, -1.1986E-23, -1.3168E-23, -1.4464E-23, -1.5884E-23, -1.7431E-23, &
      -1.4410E-23, -2.0077E-24, -8.4039E-24, -1.0280E-23, -7.7254E-24, -1.4535E-23, &
      -1.6901E-23, -1.4800E-23, -2.2010E-23, -2.4689E-23, -2.2813E-23, -3.0078E-23, &
      -3.2662E-23, -4.3842E-23, -4.9627E-23, -5.0000E-23, -4.9276E-23, -4.7342E-23, &
      -4.4139E-23, -3.9722E-23, -3.4257E-23, -2.8054E-23, -2.1534E-23, -1.5112E-23, &
      -9.2190E-24, -4.1413E-24, -7.7474E-26,  2.9049E-24,  4.8584E-24,  5.9401E-24, &
       6.3680E-24,  6.3671E-24,  6.1143E-24,  5.7164E-24,  5.2241E-24,  4.6851E-24, &
       4.1297E-24,  3.5961E-24,  3.1033E-24,  2.6660E-24,  2.2566E-24,  1.8746E-24, &
       1.5227E-24,  1.2043E-24,  9.2642E-25,  7.3864E-25 /)
    REAL, PARAMETER :: a0_2_2_N2O(dim58) = (/ &
       4.0276E-22,  4.3101E-22,  4.6287E-22,  4.9826E-22,  5.3635E-22,  5.7815E-22, &
       6.2360E-22,  6.7387E-22,  7.2774E-22,  7.8711E-22,  8.5242E-22,  9.2391E-22, &
       7.8372E-22,  2.0578E-22,  5.0512E-22,  5.9327E-22,  4.7272E-22,  7.9548E-22, &
       9.0813E-22,  8.0770E-22,  1.1538E-21,  1.2829E-21,  1.1921E-21,  1.5452E-21, &
       1.6713E-21,  2.2191E-21,  2.5037E-21,  2.5221E-21,  2.4862E-21,  2.3899E-21, &
       2.2298E-21,  2.0081E-21,  1.7326E-21,  1.4187E-21,  1.0875E-21,  7.5997E-22, &
       4.5826E-22,  1.9727E-22, -1.2422E-23, -1.6691E-22, -2.6849E-22, -3.2496E-22, &
      -3.4738E-22, -3.4733E-22, -3.3398E-22, -3.1289E-22, -2.8670E-22, -2.5792E-22, &
      -2.2815E-22, -1.9944E-22, -1.7283E-22, -1.4913E-22, -1.2686E-22, -1.0600E-22, &
      -8.6717E-23, -6.9205E-23, -5.3868E-23, -4.3465E-23 /)
    REAL, PARAMETER :: a1_1_N2O(dim55) = (/ &
       1.0514E-22,  1.0588E-22,  1.1208E-22,  1.0791E-22,  1.1011E-22,  1.0339E-22, &
       1.0344E-22,  9.6148E-23,  9.5483E-23,  8.8675E-23,  8.7896E-23,  8.1878E-23, &
       8.1243E-23,  7.6018E-23,  7.5555E-23,  7.0993E-23,  7.0678E-23,  6.6665E-23, &
       6.6465E-23,  6.2902E-23,  6.2796E-23,  5.9602E-23,  5.9580E-23,  5.6661E-23, &
       5.6700E-23,  5.4086E-23,  5.4130E-23,  5.1750E-23,  5.1823E-23,  4.9662E-23, &
       4.9742E-23,  4.7744E-23,  4.7867E-23,  4.6029E-23,  4.6149E-23,  4.4443E-23, &
       4.4578E-23,  4.2998E-23,  4.3134E-23,  4.1658E-23,  4.0298E-23,  3.7479E-23, &
       3.5290E-23,  3.3200E-23,  3.1481E-23,  2.9834E-23,  2.8375E-23,  2.7031E-23, &
       2.5574E-23,  2.4237E-23,  2.2936E-23,  2.1751E-23,  2.0625E-23,  1.9545E-23, &
       1.8550E-23 /)
    REAL, PARAMETER :: b1_1_N2O(dim55) = (/ &
       1.2331E-21,  1.2309E-21,  1.1968E-21,  1.2302E-21,  1.2070E-21,  1.2944E-21, &
       1.2937E-21,  1.4249E-21,  1.4385E-21,  1.5951E-21,  1.6150E-21,  1.7835E-21, &
       1.8029E-21,  1.9753E-21,  1.9917E-21,  2.1651E-21,  2.1778E-21,  2.3504E-21, &
       2.3595E-21,  2.5305E-21,  2.5359E-21,  2.7051E-21,  2.7064E-21,  2.8757E-21, &
       2.8733E-21,  3.0380E-21,  3.0351E-21,  3.1969E-21,  3.1918E-21,  3.3496E-21, &
       3.3435E-21,  3.4994E-21,  3.4894E-21,  3.6420E-21,  3.6317E-21,  3.7819E-21, &
       3.7696E-21,  3.9167E-21,  3.9036E-21,  4.0482E-21,  4.1850E-21,  4.5035E-21, &
       4.7782E-21,  5.0667E-21,  5.3254E-21,  5.5937E-21,  5.8499E-21,  6.1025E-21, &
       6.3947E-21,  6.6795E-21,  6.9727E-21,  7.2548E-21,  7.5370E-21,  7.8208E-21, &
       8.0950E-21 /)
    REAL, PARAMETER :: a1_2_N2O(dim55) = (/ &
      -4.4088E-25, -3.0016E-25, -3.5058E-25, -2.0186E-25, -2.4099E-25, -1.1191E-25, &
      -1.4906E-25, -4.7622E-26, -8.6092E-26, -8.9293E-27, -4.5972E-26,  1.2957E-26, &
      -2.1653E-26,  2.4704E-26, -6.5883E-27,  3.0888E-26,  2.9639E-27,  3.3954E-26, &
       9.2632E-27,  3.5438E-26,  1.3293E-26,  3.5772E-26,  1.5990E-26,  3.5594E-26, &
       1.7947E-26,  3.4670E-26,  1.9036E-26,  3.3803E-26,  1.9692E-26,  3.2606E-26, &
       2.0015E-26,  3.1540E-26,  1.9956E-26,  3.0258E-26,  1.9812E-26,  2.9098E-26, &
       1.9577E-26,  2.7935E-26,  1.9265E-26,  2.6788E-26,  2.1226E-26,  2.0802E-26, &
       1.8555E-26,  1.8128E-26,  1.6778E-26,  1.6345E-26,  1.5698E-26,  1.5166E-26, &
       1.5887E-26,  1.6453E-26,  1.7038E-26,  1.7451E-26,  1.7777E-26,  1.8065E-26, &
       1.8160E-26 /)
    REAL, PARAMETER :: b1_2_N2O(dim55) = (/ &
      -7.1154E-24, -7.5376E-24, -7.2603E-24, -8.4500E-24, -8.0391E-24, -9.7172E-24, &
      -9.1414E-24, -1.0967E-23, -1.0179E-23, -1.1953E-23, -1.1009E-23, -1.2659E-23, &
      -1.1603E-23, -1.3133E-23, -1.2022E-23, -1.3446E-23, -1.2315E-23, -1.3648E-23, &
      -1.2524E-23, -1.3781E-23, -1.2662E-23, -1.3854E-23, -1.2756E-23, -1.3893E-23, &
      -1.2825E-23, -1.3879E-23, -1.2855E-23, -1.3859E-23, -1.2864E-23, -1.3807E-23, &
      -1.2856E-23, -1.3755E-23, -1.2823E-23, -1.3678E-23, -1.2785E-23, -1.3602E-23, &
      -1.2740E-23, -1.3517E-23, -1.2689E-23, -1.3427E-23, -1.2868E-23, -1.2820E-23, &
      -1.2538E-23, -1.2479E-23, -1.2276E-23, -1.2205E-23, -1.2092E-23, -1.1992E-23, &
      -1.2136E-23, -1.2257E-23, -1.2389E-23, -1.2487E-23, -1.2569E-23, -1.2644E-23, &
      -1.2671E-23 /)
    ! T-dep parameters:
    REAL, PARAMETER :: c0_1_1_N2O(dim58) = (/ &
      -1.0618E-02, -1.0618E-02, -1.0618E-02, -1.3176E-02, -1.5798E-02, -1.8402E-02, &
      -2.0690E-02, -2.2799E-02, -2.4149E-02, -2.5130E-02, -2.5396E-02, -2.5253E-02, &
      -2.4760E-02, -2.4171E-02, -2.3058E-02, -2.2266E-02, -2.1485E-02, -2.0506E-02, &
      -1.9752E-02, -1.8425E-02, -1.6103E-02, -1.2443E-02, -6.9462E-03,  7.0292E-04, &
       1.0963E-02,  2.3460E-02,  3.7204E-02,  5.1420E-02,  6.4853E-02,  7.5700E-02, &
       8.2678E-02,  8.4623E-02,  8.0434E-02,  7.1184E-02,  5.7186E-02,  4.0177E-02, &
       2.2492E-02,  6.7859E-03, -5.4018E-03, -1.1803E-02, -1.0960E-02, -2.6243E-03, &
       1.2248E-02,  3.1145E-02,  5.0270E-02,  6.5821E-02,  7.5346E-02,  7.8761E-02, &
       7.8352E-02,  7.7989E-02,  8.1891E-02,  9.4060E-02,  1.1380E-01,  1.3863E-01, &
       1.6213E-01,  1.8091E-01,  2.0207E-01,  2.3046E-01 /)
    REAL, PARAMETER :: c0_1_2_N2O(dim58) = (/ &
       8.5861E-01,  8.5861E-01,  8.5861E-01,  9.7269E-01,  1.0902E+00,  1.2073E+00, &
       1.3107E+00,  1.4065E+00,  1.4681E+00,  1.5130E+00,  1.5252E+00,  1.5186E+00, &
       1.4958E+00,  1.4683E+00,  1.4162E+00,  1.3790E+00,  1.3421E+00,  1.2957E+00, &
       1.2598E+00,  1.1964E+00,  1.0849E+00,  9.0852E-01,  6.4249E-01,  2.7075E-01, &
      -2.2994E-01, -8.4228E-01, -1.5185E+00, -2.2208E+00, -2.8870E+00, -3.4272E+00, &
      -3.7761E+00, -3.8738E+00, -3.6626E+00, -3.1946E+00, -2.4835E+00, -1.6160E+00, &
      -7.1057E-01,  9.6730E-02,  7.2561E-01,  1.0572E+00,  1.0134E+00,  5.7824E-01, &
      -2.0106E-01, -1.1951E+00, -2.2048E+00, -3.0291E+00, -3.5358E+00, -3.7181E+00, &
      -3.6962E+00, -3.6767E+00, -3.8874E+00, -4.5469E+00, -5.6209E+00, -6.9764E+00, &
      -8.2644E+00, -9.2974E+00, -1.0465E+01, -1.2038E+01 /)
    REAL, PARAMETER :: c0_2_1_N2O(dim58) = (/ &
      -3.1295E-03, -3.1295E-03, -3.1295E-03, -3.0246E-03, -5.3161E-03, -6.6167E-03, &
      -6.5150E-03, -5.6971E-03, -7.1947E-03, -4.4413E-03, -3.0980E-03,  1.0580E-03, &
       3.6545E-03,  7.8998E-03,  1.1494E-02,  1.6746E-02,  2.0684E-02,  2.6171E-02, &
       2.9761E-02,  3.4635E-02,  3.9138E-02,  4.4521E-02,  4.9123E-02,  5.3490E-02, &
       5.8027E-02,  5.7612E-02,  5.5555E-02,  4.9628E-02,  3.7907E-02,  2.4321E-02, &
       9.8643E-03, -7.7527E-04, -1.2794E-02, -2.0605E-02, -2.6412E-02, -3.2147E-02, &
      -3.3087E-02, -3.1310E-02, -2.1506E-02, -5.9575E-03,  1.5104E-02,  3.8005E-02, &
       5.6576E-02,  6.1149E-02,  5.9458E-02,  5.0374E-02,  4.7415E-02,  4.6528E-02, &
       5.4924E-02,  5.8645E-02,  5.2898E-02,  3.2867E-02, -1.3898E-02, -6.6023E-02, &
      -1.0260E-01, -9.3842E-02, -3.3235E-02,  5.4550E-02 /)
    REAL, PARAMETER :: c0_2_2_N2O(dim58) = (/ &
       2.3708E-01,  2.3708E-01,  2.3708E-01,  2.3240E-01,  3.3506E-01,  3.9358E-01, &
       3.8899E-01,  3.5185E-01,  4.2014E-01,  2.9404E-01,  2.3224E-01,  4.0238E-02, &
      -8.0238E-02, -2.7807E-01, -4.4628E-01, -6.9311E-01, -8.7899E-01, -1.1391E+00, &
      -1.3100E+00, -1.5429E+00, -1.7591E+00, -2.0186E+00, -2.2413E+00, -2.4535E+00, &
      -2.6749E+00, -2.6546E+00, -2.5534E+00, -2.2606E+00, -1.6792E+00, -1.0027E+00, &
      -2.7981E-01,  2.5430E-01,  8.6004E-01,  1.2553E+00,  1.5503E+00,  1.8428E+00, &
       1.8909E+00,  1.7996E+00,  1.2937E+00,  4.8825E-01, -6.0695E-01, -1.8024E+00, &
      -2.7755E+00, -3.0160E+00, -2.9267E+00, -2.4453E+00, -2.2879E+00, -2.2405E+00, &
      -2.6905E+00, -2.8907E+00, -2.5804E+00, -1.4947E+00,  1.0493E+00,  3.8953E+00, &
       5.8997E+00,  5.4181E+00,  2.0725E+00, -2.7907E+00 /)
    REAL, PARAMETER :: c1_N2O(3) = (/  9.9986E-01,  1.3953E+00,  1.0008E+00 /)

    jval_2d(ip_N2O)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_N2O(0) = &
          p2(1.,c0_1_1_N2O(i0(j,k))*dlv2(j,k) + &
          c0_1_2_N2O(i0(j,k)), &
          c0_2_1_N2O(i0(j,k))*dlv2(j,k) + &
          c0_2_2_N2O(i0(j,k)), tnorm_sr(j,k)) * &
          p1(a0_1_1_N2O(i0(j,k))*dlv2(j,k) + &
          a0_1_2_N2O(i0(j,k)), &
          a0_2_1_N2O(i0(j,k))*dlv2(j,k) + &
          a0_2_2_N2O(i0(j,k)),v3_du1(j,k))
        sig_N2O(1) = &
          p2(c1_N2O(1),c1_N2O(2), &
          c1_N2O(3),tnorm(j,k)) * &
          (p1(b1_1_N2O(i1(j,k)),a1_1_N2O(i1(j,k)), &
          v3_du1(j,k)) + &
          p1(b1_2_N2O(i1(j,k)),a1_2_N2O(i1(j,k)), &
          v3_du1(j,k)) * v2s_m(j,k))
        dj = 0. &
          + sig_N2O(0) * fint(j,k,0) &
          + sig_N2O(1) * fint(j,k,1)

        jval_2d(ip_N2O)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,8)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_N2O

  ! **************************************************************************

  ! NOTE: this subroutine was not calculated by JVPP but simply copied
  ! from jval_cal_NO.f90

  SUBROUTINE jval_cal_NO

    ! NO -> N + O
    ! Allen + Frederick, J. Atmos. Sci. 39, 2066-2075, 1982

    ! mz_rs_20111006+
    ! \cite{2355}
    ! mz_rs_20111006-

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_NO 

    ! T-const parameters:
    REAL, PARAMETER :: a0_1_1_NO(dim58) = (/ &
      4.8294E-22, -2.6705E-22, -9.2287E-21, -2.1578E-20, -3.3937E-20, -4.4211E-20, &
      -5.1449E-20, -5.5561E-20, -5.7027E-20, -5.6724E-20, -5.5524E-20, -5.4432E-20, &
      -5.4184E-20, -5.5477E-20, -5.8313E-20, -6.3064E-20, -6.9663E-20, -7.7493E-20, &
      -8.6285E-20, -9.5515E-20, -1.0416E-19, -1.1214E-19, -1.1911E-19, -1.2427E-19, &
      -1.2818E-19, -1.3032E-19, -1.3125E-19, -1.3095E-19, -1.2923E-19, -1.2599E-19, &
      -1.2103E-19, -1.1422E-19, -1.0559E-19, -9.5234E-20, -8.3749E-20, -7.1719E-20, &
      -6.0169E-20, -4.9868E-20, -4.1403E-20, -3.4915E-20, -3.0102E-20, -2.6464E-20, &
      -2.3508E-20, -2.0890E-20, -1.8457E-20, -1.6152E-20, -1.3968E-20, -1.1999E-20, &
      -1.0344E-20, -9.1571E-21, -8.5636E-21, -8.5562E-21, -1.8846E-20, -1.3122E-20, &
      -6.0916E-21, -2.2562E-21, -6.2901E-22, -1.7769E-22 /)
    REAL, PARAMETER :: a0_1_2_NO(dim58) = (/ &
      6.2919E-19, 6.6234E-19, 1.0602E-18, 1.6110E-18, 2.1647E-18, 2.6270E-18, &
      2.9542E-18, 3.1409E-18, 3.2077E-18, 3.1938E-18, 3.1386E-18, 3.0882E-18, &
      3.0767E-18, 3.1370E-18, 3.2697E-18, 3.4930E-18, 3.8044E-18, 4.1756E-18, &
      4.5941E-18, 5.0353E-18, 5.4504E-18, 5.8346E-18, 6.1720E-18, 6.4230E-18, &
      6.6139E-18, 6.7186E-18, 6.7645E-18, 6.7497E-18, 6.6642E-18, 6.5028E-18, &
      6.2548E-18, 5.9133E-18, 5.4780E-18, 4.9541E-18, 4.3707E-18, 3.7571E-18, &
      3.1658E-18, 2.6363E-18, 2.1995E-18, 1.8634E-18, 1.6132E-18, 1.4233E-18, &
      1.2684E-18, 1.1307E-18, 1.0022E-18, 8.8004E-19, 7.6384E-19, 6.5871E-19, &
      5.6999E-19, 5.0613E-19, 4.7408E-19, 4.7367E-19, 1.0335E-18, 7.2090E-19, &
      3.3564E-19, 1.2470E-19, 3.4875E-20, 9.8725E-21 /)
    REAL, PARAMETER :: a0_2_1_NO(dim58) = (/ &
      -6.4112E-23, -8.3731E-23, -3.0543E-23, 5.6217E-23, 1.4808E-22, 2.2765E-22, &
      2.8591E-22, 3.2067E-22, 3.3430E-22, 3.3354E-22, 3.2478E-22, 3.1683E-22, &
      3.1700E-22, 3.3876E-22, 3.5573E-22, 3.9035E-22, 4.4412E-22, 4.9511E-22, &
      5.5721E-22, 6.2827E-22, 6.7845E-22, 7.2876E-22, 7.7624E-22, 7.9450E-22, &
      8.0973E-22, 8.0051E-22, 7.9258E-22, 7.8430E-22, 7.6869E-22, 7.4528E-22, &
      7.1196E-22, 6.6676E-22, 6.0960E-22, 5.3949E-22, 4.6097E-22, 3.7810E-22, &
      2.9876E-22, 2.2961E-22, 1.7558E-22, 1.3782E-22, 1.1363E-22, 9.8481E-23, &
      8.8190E-23, 7.9500E-23, 7.1498E-23, 6.3480E-23, 5.5503E-23, 4.7936E-23, &
      4.1291E-23, 3.6288E-23, 3.3633E-23, 3.3452E-23, 7.4318E-23, 5.1959E-23, &
      2.4218E-23, 9.0038E-24, 2.5179E-24, 7.1284E-25 /)
    REAL, PARAMETER :: a0_2_2_NO(dim58) = (/ &
      -8.8093E-22, -1.3754E-23, -2.3753E-21, -6.2448E-21, -1.0360E-20, -1.3941E-20, &
      -1.6574E-20, -1.8153E-20, -1.8774E-20, -1.8739E-20, -1.8336E-20, -1.7969E-20, &
      -1.7977E-20, -1.8991E-20, -1.9785E-20, -2.1412E-20, -2.3950E-20, -2.6367E-20, &
      -2.9323E-20, -3.2720E-20, -3.5128E-20, -3.7553E-20, -3.9851E-20, -4.0738E-20, &
      -4.1482E-20, -4.1030E-20, -4.0640E-20, -4.0231E-20, -3.9457E-20, -3.8291E-20, &
      -3.6625E-20, -3.4356E-20, -3.1475E-20, -2.7928E-20, -2.3939E-20, -1.9712E-20, &
      -1.5650E-20, -1.2095E-20, -9.3080E-21, -7.3518E-21, -6.0937E-21, -5.3031E-21, &
      -4.7638E-21, -4.3068E-21, -3.8842E-21, -3.4593E-21, -3.0349E-21, -2.6308E-21, &
      -2.2747E-21, -2.0055E-21, -1.8621E-21, -1.8523E-21, -4.0754E-21, -2.8546E-21, &
      -1.3344E-21, -4.9763E-22, -1.3960E-22, -3.9604E-23 /)
    REAL, PARAMETER :: a0_3_1_NO(dim58) = (/ &
      4.5919E-25, 5.7344E-25, 4.4437E-25, 1.9326E-25, -7.8876E-26, -3.2715E-25, &
      -5.1782E-25, -6.3429E-25, -6.7988E-25, -6.8079E-25, -6.5417E-25, -6.4150E-25, &
      -6.9416E-25, -9.4519E-25, -9.7579E-25, -1.1093E-24, -1.3672E-24, -1.4870E-24, &
      -1.6994E-24, -2.0044E-24, -2.0934E-24, -2.2478E-24, -2.4448E-24, -2.4161E-24, &
      -2.4352E-24, -2.2822E-24, -2.2060E-24, -2.1810E-24, -2.1364E-24, -2.0720E-24, &
      -1.9787E-24, -1.8478E-24, -1.6814E-24, -1.4701E-24, -1.2311E-24, -9.7562E-25, &
      -7.2985E-25, -5.1717E-25, -3.5557E-25, -2.4897E-25, -1.8826E-25, -1.5740E-25, &
      -1.4269E-25, -1.3135E-25, -1.2187E-25, -1.1072E-25, -9.8618E-26, -8.6156E-26, &
      -7.4548E-26, -6.5189E-26, -5.9951E-26, -5.9530E-26, -1.3382E-25, -9.4018E-26, &
      -4.4026E-26, -1.6438E-26, -4.6123E-27, -1.3090E-27 /)
    REAL, PARAMETER :: a0_3_2_NO(dim58) = (/ &
      -1.0611E-23, -1.5661E-23, -9.9299E-24, 1.2695E-24, 1.3461E-23, 2.4634E-23, &
      3.3252E-23, 3.8539E-23, 4.0619E-23, 4.0660E-23, 3.9436E-23, 3.8850E-23, &
      4.1294E-23, 5.2992E-23, 5.4424E-23, 6.0700E-23, 7.2873E-23, 7.8551E-23, &
      8.8659E-23, 1.0324E-22, 1.0751E-22, 1.1495E-22, 1.2449E-22, 1.2310E-22, &
      1.2403E-22, 1.1653E-22, 1.1278E-22, 1.1154E-22, 1.0933E-22, 1.0613E-22, &
      1.0146E-22, 9.4890E-23, 8.6503E-23, 7.5812E-23, 6.3667E-23, 5.0640E-23, &
      3.8057E-23, 2.7125E-23, 1.8786E-23, 1.3264E-23, 1.0108E-23, 8.4964E-24, &
      7.7258E-24, 7.1294E-24, 6.6286E-24, 6.0377E-24, 5.3941E-24, 4.7286E-24, &
      4.1064E-24, 3.6029E-24, 3.3200E-24, 3.2972E-24, 7.3386E-24, 5.1654E-24, &
      2.4259E-24, 9.0852E-25, 2.5573E-25, 7.2728E-26 /)
    REAL, PARAMETER :: a0_4_1_NO(dim58) = (/ &
      -9.8346E-28, -1.1835E-27, -1.0679E-27, -7.7518E-28, -4.7363E-28, -1.6377E-28, &
      8.9875E-29, 2.4372E-28, 2.9444E-28, 3.0025E-28, 2.6214E-28, 2.7906E-28, &
      5.2042E-28, 1.4125E-27, 1.3483E-27, 1.5636E-27, 2.1065E-27, 2.1079E-27, &
      2.3933E-27, 2.9482E-27, 2.8697E-27, 3.0409E-27, 3.3819E-27, 3.1568E-27, &
      3.1247E-27, 2.6968E-27, 2.5134E-27, 2.4933E-27, 2.4503E-27, 2.3853E-27, &
      2.2845E-27, 2.1347E-27, 1.9430E-27, 1.6905E-27, 1.4028E-27, 1.0915E-27, &
      7.8994E-28, 5.2857E-28, 3.3235E-28, 2.0616E-28, 1.3869E-28, 1.0889E-28, &
      1.0042E-28, 9.4681E-29, 9.1792E-29, 8.5801E-29, 7.8177E-29, 6.9375E-29, &
      6.0582E-29, 5.2845E-29, 4.8318E-29, 4.8101E-29, 1.0946E-28, 7.7243E-29, &
      3.6330E-29, 1.3616E-29, 3.8317E-30, 1.0900E-30 /)
    REAL, PARAMETER :: a0_4_2_NO(dim58) = (/ &
      3.2681E-26, 4.1522E-26, 3.6391E-26, 2.3334E-26, 9.8250E-27, -4.1188E-27, &
      -1.5584E-26, -2.2568E-26, -2.4881E-26, -2.5147E-26, -2.3394E-26, -2.4176E-26, &
      -3.5375E-26, -7.6945E-26, -7.3940E-26, -8.4059E-26, -1.0968E-25, -1.0975E-25, &
      -1.2334E-25, -1.4986E-25, -1.4610E-25, -1.5434E-25, -1.7085E-25, -1.5991E-25, &
      -1.5834E-25, -1.3737E-25, -1.2835E-25, -1.2736E-25, -1.2522E-25, -1.2199E-25, &
      -1.1695E-25, -1.0943E-25, -9.9769E-26, -8.6994E-26, -7.2374E-26, -5.6502E-26, &
      -4.1060E-26, -2.7625E-26, -1.7501E-26, -1.0964E-26, -7.4555E-27, -5.9003E-27, &
      -5.4565E-27, -5.1545E-27, -5.0019E-27, -4.6844E-27, -4.2788E-27, -3.8087E-27, &
      -3.3375E-27, -2.9212E-27, -2.6767E-27, -2.6650E-27, -6.0028E-27, -4.2438E-27, &
      -2.0018E-27, -7.5254E-28, -2.1245E-28, -6.0560E-29 /)

    jval_2d(ip_NO)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_NO(0) = p3(a0_1_1_NO(i0(j,k))*dlv2(j,k) + a0_1_2_NO(i0(j,k)), &
          a0_2_1_NO(i0(j,k))*dlv2(j,k) + a0_2_2_NO(i0(j,k)), &
          a0_3_1_NO(i0(j,k))*dlv2(j,k) + a0_3_2_NO(i0(j,k)), &
          a0_4_1_NO(i0(j,k))*dlv2(j,k) + a0_4_2_NO(i0(j,k)), &
          v3_du1(j,k))
        dj = 0. &
          + sig_NO(0) * fint(j,k,0)
        jval_2d(ip_NO)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,8)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_NO

  ! **************************************************************************

  SUBROUTINE jval_cal_CO2

    ! CO_2 \TOHV\ CO + O

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_CO2

    ! T-const parameters:
    REAL, PARAMETER :: a0_1_1_CO2(dim58) = (/ &
      -1.3492E-23, -1.4403E-23, -1.5348E-23, -1.6280E-23, -1.7201E-23, -1.8064E-23, &
      -1.8869E-23, -1.9611E-23, -2.0254E-23, -2.0841E-23, -2.1329E-23, -2.1750E-23, &
      -2.3933E-23, -2.9871E-23, -2.8385E-23, -2.8535E-23, -3.0449E-23, -2.8094E-23, &
      -2.7334E-23, -2.8244E-23, -2.4561E-23, -2.2523E-23, -2.2251E-23, -1.7467E-23, &
      -1.4678E-23, -7.9405E-24, -3.8129E-24, -2.1370E-24, -8.8406E-25, -3.6499E-26, &
       4.2656E-25,  5.3930E-25,  3.5079E-25, -7.8256E-26, -6.5875E-25, -1.2944E-24, &
      -1.9020E-24, -2.4133E-24, -2.7935E-24, -3.0286E-24, -3.1289E-24, -3.1155E-24, &
      -3.0157E-24, -2.8558E-24, -2.6555E-24, -2.4303E-24, -2.1884E-24, -1.9459E-24, &
      -1.7111E-24, -1.4949E-24, -1.3019E-24, -1.1296E-24, -9.7344E-25, -8.2814E-25, &
      -6.9100E-25, -5.6187E-25, -4.3982E-25, -3.4969E-25 /)
    REAL, PARAMETER :: a0_1_2_CO2(dim58) = (/ &
       7.1674E-22,  7.5699E-22,  7.9897E-22,  8.4051E-22,  8.8178E-22,  9.2062E-22, &
       9.5702E-22,  9.9068E-22,  1.0200E-21,  1.0469E-21,  1.0694E-21,  1.0888E-21, &
       1.1901E-21,  1.4668E-21,  1.3973E-21,  1.4043E-21,  1.4946E-21,  1.3830E-21, &
       1.3468E-21,  1.3903E-21,  1.2136E-21,  1.1153E-21,  1.1022E-21,  8.6967E-22, &
       7.3355E-22,  4.0342E-22,  2.0034E-22,  1.1755E-22,  5.5408E-23,  1.3199E-23, &
      -9.9537E-24, -1.5613E-23, -6.1119E-24,  1.5598E-23,  4.5087E-23,  7.7507E-23, &
       1.0861E-22,  1.3489E-22,  1.5451E-22,  1.6669E-22,  1.7191E-22,  1.7121E-22, &
       1.6598E-22,  1.5757E-22,  1.4699E-22,  1.3506E-22,  1.2219E-22,  1.0924E-22, &
       9.6652E-23,  8.5020E-23,  7.4598E-23,  6.5259E-23,  5.6765E-23,  4.8831E-23, &
       4.1316E-23,  3.4214E-23,  2.7476E-23,  2.2483E-23 /)
    REAL, PARAMETER :: a0_2_1_CO2(dim58) = (/ &
      -7.9517E-26, -8.7678E-26, -9.6650E-26, -1.0662E-25, -1.1738E-25, -1.2888E-25, &
      -1.4096E-25, -1.5355E-25, -1.6678E-25, -1.8048E-25, -1.9502E-25, -2.1047E-25, &
      -1.9928E-25, -1.3427E-25, -1.7922E-25, -1.9832E-25, -1.9250E-25, -2.3892E-25, &
      -2.5908E-25, -2.5369E-25, -2.9509E-25, -3.0816E-25, -2.9415E-25, -3.2028E-25, &
      -3.1789E-25, -3.4950E-25, -3.5109E-25, -3.2736E-25, -3.0041E-25, -2.7144E-25, &
      -2.4095E-25, -2.0918E-25, -1.7648E-25, -1.4345E-25, -1.1145E-25, -8.1769E-26, &
      -5.5910E-26, -3.4688E-26, -1.8464E-26, -7.0742E-27,  1.0169E-28,  3.9587E-27, &
       5.5363E-27,  5.7950E-27,  5.4322E-27,  4.8419E-27,  4.1910E-27,  3.5574E-27, &
       2.9711E-27,  2.4565E-27,  2.0190E-27,  1.6493E-27,  1.3328E-27,  1.0569E-27, &
       8.1599E-28,  6.1158E-28,  4.4336E-28,  3.3591E-28 /)
    REAL, PARAMETER :: a0_2_2_CO2(dim58) = (/ &
       4.9954E-24,  5.3562E-24,  5.7545E-24,  6.1992E-24,  6.6810E-24,  7.1989E-24, &
       7.7445E-24,  8.3162E-24,  8.9197E-24,  9.5469E-24,  1.0216E-23,  1.0930E-23, &
       1.0410E-23,  7.3812E-24,  9.4849E-24,  1.0382E-23,  1.0108E-23,  1.2308E-23, &
       1.3268E-23,  1.3010E-23,  1.4997E-23,  1.5627E-23,  1.4949E-23,  1.6219E-23, &
       1.6102E-23,  1.7651E-23,  1.7730E-23,  1.6557E-23,  1.5220E-23,  1.3778E-23, &
       1.2253E-23,  1.0658E-23,  9.0102E-24,  7.3392E-24,  5.7135E-24,  4.1997E-24, &
       2.8757E-24,  1.7849E-24,  9.4774E-25,  3.5775E-25, -1.5398E-26, -2.1673E-25, &
      -2.9940E-25, -3.1301E-25, -2.9385E-25, -2.6256E-25, -2.2794E-25, -1.9410E-25, &
      -1.6268E-25, -1.3499E-25, -1.1137E-25, -9.1331E-26, -7.4110E-26, -5.9050E-26, &
      -4.5846E-26, -3.4604E-26, -2.5318E-26, -1.9365E-26 /)
    REAL, PARAMETER :: a1_1_CO2(dim55) = (/ &
       6.2776E-27,  5.9092E-27,  5.5872E-27,  5.0634E-27,  4.6164E-27,  4.1190E-27, &
       3.6906E-27,  3.3039E-27,  2.9529E-27,  2.6721E-27,  2.4016E-27,  2.2082E-27, &
       1.9974E-27,  1.8663E-27,  1.7023E-27,  1.6080E-27,  1.4773E-27,  1.4076E-27, &
       1.3013E-27,  1.2511E-27,  1.1603E-27,  1.1247E-27,  1.0426E-27,  1.0193E-27, &
       9.4951E-28,  9.3142E-28,  8.6865E-28,  8.5644E-28,  8.0010E-28,  7.9240E-28, &
       7.4180E-28,  7.3714E-28,  6.9072E-28,  6.8971E-28,  6.4670E-28,  6.4707E-28, &
       6.0857E-28,  6.1073E-28,  5.7335E-28,  5.7673E-28,  5.2477E-28,  4.7143E-28, &
       4.2315E-28,  3.9041E-28,  3.5777E-28,  3.3522E-28,  3.1094E-28,  2.9464E-28, &
       2.7001E-28,  2.5485E-28,  2.4034E-28,  2.2736E-28,  2.1551E-28,  2.0417E-28, &
       1.9383E-28 /)
    REAL, PARAMETER :: b1_1_CO2(dim55) = (/ &
       5.3794E-25,  5.3905E-25,  5.4082E-25,  5.4501E-25,  5.4970E-25,  5.5617E-25, &
       5.6281E-25,  5.6977E-25,  5.7697E-25,  5.8343E-25,  5.9032E-25,  5.9574E-25, &
       6.0217E-25,  6.0649E-25,  6.1232E-25,  6.1590E-25,  6.2119E-25,  6.2419E-25, &
       6.2902E-25,  6.3144E-25,  6.3602E-25,  6.3791E-25,  6.4246E-25,  6.4382E-25, &
       6.4804E-25,  6.4918E-25,  6.5329E-25,  6.5412E-25,  6.5809E-25,  6.5865E-25, &
       6.6247E-25,  6.6284E-25,  6.6657E-25,  6.6666E-25,  6.7033E-25,  6.7030E-25, &
       6.7379E-25,  6.7359E-25,  6.7716E-25,  6.7682E-25,  6.8205E-25,  6.8807E-25, &
       6.9413E-25,  6.9865E-25,  7.0356E-25,  7.0724E-25,  7.1150E-25,  7.1456E-25, &
       7.1950E-25,  7.2273E-25,  7.2600E-25,  7.2909E-25,  7.3206E-25,  7.3504E-25, &
       7.3789E-25 /)
    REAL, PARAMETER :: a1_2_CO2(dim55) = (/ &
      -8.5746E-30, -2.3377E-30, -7.0182E-31,  3.5283E-30,  4.6601E-30,  6.5380E-30, &
       7.0132E-30,  7.1669E-30,  7.2334E-30,  6.6609E-30,  6.5600E-30,  5.7009E-30, &
       5.6689E-30,  4.7560E-30,  4.7775E-30,  3.9842E-30,  4.0570E-30,  3.3601E-30, &
       3.4730E-30,  2.8656E-30,  3.0027E-30,  2.4703E-30,  2.6478E-30,  2.1460E-30, &
       2.3237E-30,  1.8916E-30,  2.0700E-30,  1.6721E-30,  1.8525E-30,  1.4923E-30, &
       1.6662E-30,  1.3363E-30,  1.5058E-30,  1.1996E-30,  1.3648E-30,  1.0857E-30, &
       1.2433E-30,  9.8143E-31,  1.1340E-30,  9.0030E-31,  8.8689E-31,  6.9446E-31, &
       6.0174E-31,  4.8579E-31,  4.3680E-31,  3.6355E-31,  3.3821E-31,  2.8744E-31, &
       3.0485E-31,  2.8223E-31,  2.6509E-31,  2.5131E-31,  2.3911E-31,  2.2911E-31, &
       2.2013E-31 /)
    REAL, PARAMETER :: b1_2_CO2(dim55) = (/ &
      -4.2475E-28, -4.4346E-28, -4.5246E-28, -4.8630E-28, -4.9819E-28, -5.2260E-28, &
      -5.2996E-28, -5.3273E-28, -5.3409E-28, -5.2093E-28, -5.1835E-28, -4.9430E-28, &
      -4.9332E-28, -4.6320E-28, -4.6396E-28, -4.3382E-28, -4.3676E-28, -4.0680E-28, &
      -4.1193E-28, -3.8278E-28, -3.8970E-28, -3.6149E-28, -3.7134E-28, -3.4223E-28, &
      -3.5298E-28, -3.2576E-28, -3.3744E-28, -3.1039E-28, -3.2311E-28, -2.9681E-28, &
      -3.0994E-28, -2.8421E-28, -2.9785E-28, -2.7244E-28, -2.8657E-28, -2.6200E-28, &
      -2.7627E-28, -2.5191E-28, -2.6648E-28, -2.4358E-28, -2.4223E-28, -2.2049E-28, &
      -2.0885E-28, -1.9285E-28, -1.8548E-28, -1.7354E-28, -1.6909E-28, -1.5954E-28, &
      -1.6304E-28, -1.5822E-28, -1.5435E-28, -1.5107E-28, -1.4802E-28, -1.4539E-28, &
      -1.4291E-28 /)
    REAL, PARAMETER :: a2_CO2(dim55) = (/ &
      -3.6440E-27, -3.2080E-27, -2.6520E-27, -2.0920E-27, -1.5880E-27, -1.1840E-27, &
      -8.7600E-28, -6.4800E-28, -4.8800E-28, -3.6800E-28, -2.8800E-28, -2.2800E-28, &
      -1.8400E-28, -1.5200E-28, -1.2800E-28, -1.1200E-28, -9.2000E-29, -8.4000E-29, &
      -7.6000E-29, -6.8000E-29, -6.0000E-29, -5.2000E-29, -5.2000E-29, -4.4000E-29, &
      -4.0000E-29, -4.0000E-29, -3.6000E-29, -3.2000E-29, -3.2000E-29, -2.8000E-29, &
      -2.8000E-29, -2.4000E-29, -2.4000E-29, -2.0000E-29, -2.0000E-29, -2.0000E-29, &
      -1.6000E-29, -2.0000E-29, -1.2000E-29, -1.6000E-29, -1.2000E-29, -8.8000E-30, &
      -6.4000E-30, -4.8000E-30, -3.2000E-30, -2.4000E-30, -1.6000E-30, -1.6000E-30, &
      -8.0000E-31, -8.0000E-31,  0.0000E+00, -8.0000E-31,  0.0000E+00,  0.0000E+00, &
       0.0000E+00 /)
    REAL, PARAMETER :: b2_CO2(dim55) = (/ &
       2.2654E-25,  2.2523E-25,  2.2218E-25,  2.1770E-25,  2.1240E-25,  2.0715E-25, &
       2.0238E-25,  1.9827E-25,  1.9499E-25,  1.9223E-25,  1.9019E-25,  1.8851E-25, &
       1.8717E-25,  1.8612E-25,  1.8526E-25,  1.8466E-25,  1.8385E-25,  1.8350E-25, &
       1.8314E-25,  1.8275E-25,  1.8235E-25,  1.8193E-25,  1.8193E-25,  1.8146E-25, &
       1.8122E-25,  1.8122E-25,  1.8096E-25,  1.8069E-25,  1.8069E-25,  1.8039E-25, &
       1.8039E-25,  1.8008E-25,  1.8008E-25,  1.7975E-25,  1.7975E-25,  1.7975E-25, &
       1.7939E-25,  1.7976E-25,  1.7900E-25,  1.7939E-25,  1.7899E-25,  1.7862E-25, &
       1.7832E-25,  1.7810E-25,  1.7786E-25,  1.7773E-25,  1.7759E-25,  1.7759E-25, &
       1.7743E-25,  1.7743E-25,  1.7725E-25,  1.7744E-25,  1.7724E-25,  1.7724E-25, &
       1.7724E-25 /)
    REAL, PARAMETER :: a3_CO2(dim55) = (/ &
      -5.5401E-28, -4.0607E-28, -2.6088E-28, -1.6606E-28, -1.0851E-28, -7.2771E-29, &
      -4.9825E-29, -3.4700E-29, -2.4475E-29, -1.7453E-29, -1.2552E-29, -9.0861E-30, &
      -6.6113E-30, -4.8340E-30, -3.5451E-30, -2.6090E-30, -1.9247E-30, -1.4233E-30, &
      -1.0563E-30, -7.8476E-31, -5.8342E-31, -4.3592E-31, -3.2580E-31, -2.4387E-31, &
      -1.8250E-31, -1.3721E-31, -1.0310E-31, -7.7568E-32, -5.8274E-32, -4.3993E-32, &
      -3.3161E-32, -2.5010E-32, -1.8839E-32, -1.4243E-32, -1.0753E-32, -8.1060E-33, &
      -6.1318E-33, -4.6296E-33, -3.4966E-33, -2.6361E-33, -1.2277E-33, -3.0049E-34, &
      -7.3193E-35, -1.7762E-35, -4.2915E-36, -1.0330E-36, -2.4813E-37, -5.9449E-38, &
      -1.4212E-38,  0.0000E+00,  0.0000E+00,  0.0000E+00,  0.0000E+00,  0.0000E+00, &
       0.0000E+00 /)
    REAL, PARAMETER :: b3_CO2(dim55) = (/ &
       1.0203E-25,  9.3310E-26,  7.6271E-26,  5.9604E-26,  4.6125E-26,  3.5667E-26, &
       2.7612E-26,  2.1418E-26,  1.6634E-26,  1.2938E-26,  1.0072E-26,  7.8424E-27, &
       6.1060E-27,  4.7552E-27,  3.7003E-27,  2.8794E-27,  2.2393E-27,  1.7411E-27, &
       1.3550E-27,  1.0534E-27,  8.1799E-28,  6.3694E-28,  4.9533E-28,  3.8519E-28, &
       2.9910E-28,  2.3293E-28,  1.8109E-28,  1.4081E-28,  1.0923E-28,  8.5028E-29, &
       6.6036E-29,  5.1269E-29,  3.9729E-29,  3.0865E-29,  2.3931E-29,  1.8516E-29, &
       1.4362E-29,  1.1114E-29,  8.5979E-30,  6.6367E-30,  3.3446E-30,  9.0621E-31, &
       2.4208E-31,  6.3927E-32,  1.6697E-32,  4.3208E-33,  1.1103E-33,  2.8335E-34, &
       7.1890E-35,  1.8166E-35,  4.5695E-36,  1.1450E-36,  2.8624E-37,  7.1328E-38, &
       1.7726E-38 /)

    jval_2d(ip_CO2)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_CO2(0) = &
          p1(a0_1_1_CO2(i0(j,k))*dlv2(j,k) + &
          a0_1_2_CO2(i0(j,k)), &
          a0_2_1_CO2(i0(j,k))*dlv2(j,k) + &
          a0_2_2_CO2(i0(j,k)),v3_du1(j,k))
        sig_CO2(1) = &
          (p1(b1_1_CO2(i1(j,k)),a1_1_CO2(i1(j,k)), &
          v3_du1(j,k)) + &
          p1(b1_2_CO2(i1(j,k)),a1_2_CO2(i1(j,k)), &
          v3_du1(j,k)) * v2s_m(j,k))
        sig_CO2(2) = &
          p1(b2_CO2(i2(j,k)), a2_CO2(i2(j,k)), &
          v3_du1(j,k))
        sig_CO2(3) = &
          p1(b3_CO2(i3(j,k)), a3_CO2(i3(j,k)), &
          v3_du2(j,k))
        dj = 0. &
          + 7.3E-20 * r_m(j,k) * phi_la &
          + sig_CO2(0) * fint(j,k,0) &
          + sig_CO2(1) * fint(j,k,1) &
          + sig_CO2(2) * fint(j,k,2) &
          + sig_CO2(3) * fint(j,k,3)

        jval_2d(ip_CO2)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,8)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_CO2

  ! **************************************************************************

  SUBROUTINE jval_cal_HCl

    ! HCl \TOHV\ H + Cl

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_HCl

    ! T-const parameters:
    REAL, PARAMETER :: a0_1_1_HCl(dim58) = (/ &
      -6.3414E-21, -6.8123E-21, -7.2753E-21, -7.7656E-21, -8.2452E-21, -8.7043E-21, &
      -9.1461E-21, -9.5825E-21, -9.9722E-21, -1.0346E-20, -1.0696E-20, -1.1012E-20, &
      -1.2366E-20, -1.5961E-20, -1.5265E-20, -1.5560E-20, -1.6950E-20, -1.5860E-20, &
      -1.5774E-20, -1.6787E-20, -1.5061E-20, -1.4382E-20, -1.4867E-20, -1.2483E-20, &
      -1.1307E-20, -7.3719E-21, -4.9656E-21, -4.0907E-21, -3.4133E-21, -2.9608E-21, &
      -2.7349E-21, -2.7334E-21, -2.9347E-21, -3.2944E-21, -3.7609E-21, -4.2620E-21, &
      -4.7463E-21, -5.1612E-21, -5.4806E-21, -5.6956E-21, -5.8008E-21, -5.8095E-21, &
      -5.7303E-21, -5.5749E-21, -5.3481E-21, -5.0587E-21, -4.7098E-21, -4.3295E-21, &
      -3.9322E-21, -3.5438E-21, -3.1772E-21, -2.8360E-21, -2.5159E-21, -2.2111E-21, &
      -1.9192E-21, -1.6362E-21, -1.3463E-21, -1.1084E-21 /)
    REAL, PARAMETER :: a0_1_2_HCl(dim58) = (/ &
       3.9299E-19,  4.1381E-19,  4.3436E-19,  4.5623E-19,  4.7772E-19,  4.9838E-19, &
       5.1835E-19,  5.3816E-19,  5.5593E-19,  5.7304E-19,  5.8914E-19,  6.0373E-19, &
       6.6659E-19,  8.3411E-19,  8.0155E-19,  8.1541E-19,  8.8102E-19,  8.2931E-19, &
       8.2524E-19,  8.7364E-19,  7.9082E-19,  7.5811E-19,  7.8154E-19,  6.6567E-19, &
       6.0829E-19,  4.1549E-19,  2.9710E-19,  2.5388E-19,  2.2028E-19,  1.9775E-19, &
       1.8645E-19,  1.8638E-19,  1.9652E-19,  2.1472E-19,  2.3842E-19,  2.6398E-19, &
       2.8877E-19,  3.1010E-19,  3.2658E-19,  3.3772E-19,  3.4319E-19,  3.4364E-19, &
       3.3949E-19,  3.3132E-19,  3.1934E-19,  3.0401E-19,  2.8544E-19,  2.6514E-19, &
       2.4384E-19,  2.2294E-19,  2.0315E-19,  1.8465E-19,  1.6724E-19,  1.5060E-19, &
       1.3460E-19,  1.1904E-19,  1.0304E-19,  8.9856E-20 /)
    REAL, PARAMETER :: a0_2_1_HCl(dim58) = (/ &
      -3.3006E-23, -3.6452E-23, -4.0411E-23, -4.4612E-23, -4.9217E-23, -5.4272E-23, &
      -5.9522E-23, -6.5077E-23, -7.1034E-23, -7.7378E-23, -8.4059E-23, -9.1357E-23, &
      -8.3163E-23, -4.3270E-23, -6.7345E-23, -7.6123E-23, -7.0241E-23, -9.5473E-23, &
      -1.0557E-22, -1.0064E-22, -1.2519E-22, -1.3386E-22, -1.2689E-22, -1.4732E-22, &
      -1.5150E-22, -1.8041E-22, -1.9132E-22, -1.8542E-22, -1.7663E-22, -1.6498E-22, &
      -1.5055E-22, -1.3352E-22, -1.1429E-22, -9.3632E-23, -7.2703E-23, -5.2639E-23, &
      -3.4661E-23, -1.9523E-23, -7.6726E-24,  8.5081E-25,  6.3079E-24,  9.2678E-24, &
       1.0423E-23,  1.0462E-23,  9.9157E-24,  9.0881E-24,  8.1156E-24,  7.1079E-24, &
       6.1149E-24,  5.1942E-24,  4.3677E-24,  3.6415E-24,  3.0031E-24,  2.4287E-24, &
       1.9183E-24,  1.4844E-24,  1.1088E-24,  8.7564E-25 /)
    REAL, PARAMETER :: a0_2_2_HCl(dim58) = (/ &
       2.1514E-21,  2.3037E-21,  2.4795E-21,  2.6669E-21,  2.8732E-21,  3.1007E-21, &
       3.3379E-21,  3.5902E-21,  3.8618E-21,  4.1523E-21,  4.4597E-21,  4.7969E-21, &
       4.4166E-21,  2.5576E-21,  3.6843E-21,  4.0969E-21,  3.8193E-21,  5.0153E-21, &
       5.4958E-21,  5.2600E-21,  6.4385E-21,  6.8568E-21,  6.5194E-21,  7.5122E-21, &
       7.7160E-21,  9.1325E-21,  9.6696E-21,  9.3781E-21,  8.9418E-21,  8.3616E-21, &
       7.6405E-21,  6.7852E-21,  5.8162E-21,  4.7709E-21,  3.7077E-21,  2.6845E-21, &
       1.7640E-21,  9.8587E-22,  3.7440E-22, -6.7110E-23, -3.5088E-22, -5.0539E-22, &
      -5.6591E-22, -5.6797E-22, -5.3913E-22, -4.9526E-22, -4.4353E-22, -3.8971E-22, &
      -3.3649E-22, -2.8695E-22, -2.4233E-22, -2.0297E-22, -1.6824E-22, -1.3687E-22, &
      -1.0890E-22, -8.5037E-23, -6.4304E-23, -5.1389E-23 /)
    REAL, PARAMETER :: a1_1_HCl(dim55) = (/ &
       6.7755E-23,  6.8231E-23,  7.2273E-23,  6.9590E-23,  7.1067E-23,  6.6713E-23, &
       6.6864E-23,  6.2164E-23,  6.1814E-23,  5.7432E-23,  5.7054E-23,  5.3149E-23, &
       5.2895E-23,  4.9441E-23,  4.9311E-23,  4.6302E-23,  4.6262E-23,  4.3569E-23, &
       4.3632E-23,  4.1226E-23,  4.1332E-23,  3.9158E-23,  3.9307E-23,  3.7328E-23, &
       3.7526E-23,  3.5692E-23,  3.5914E-23,  3.4236E-23,  3.4478E-23,  3.2920E-23, &
       3.3166E-23,  3.1737E-23,  3.1994E-23,  3.0651E-23,  3.0896E-23,  2.9669E-23, &
       2.9918E-23,  2.8743E-23,  2.9023E-23,  2.7905E-23,  2.7158E-23,  2.5343E-23, &
       2.3992E-23,  2.2629E-23,  2.1564E-23,  2.0478E-23,  1.9571E-23,  1.8671E-23, &
       1.7813E-23,  1.6919E-23,  1.6075E-23,  1.5278E-23,  1.4524E-23,  1.3816E-23, &
       1.3143E-23 /)
    REAL, PARAMETER :: b1_1_HCl(dim55) = (/ &
       7.8918E-22,  7.8776E-22,  7.6552E-22,  7.8699E-22,  7.7148E-22,  8.2808E-22, &
       8.2574E-22,  9.1035E-22,  9.1752E-22,  1.0183E-21,  1.0279E-21,  1.1373E-21, &
       1.1450E-21,  1.2590E-21,  1.2636E-21,  1.3780E-21,  1.3796E-21,  1.4954E-21, &
       1.4925E-21,  1.6080E-21,  1.6026E-21,  1.7179E-21,  1.7096E-21,  1.8244E-21, &
       1.8124E-21,  1.9279E-21,  1.9134E-21,  2.0275E-21,  2.0105E-21,  2.1242E-21, &
       2.1056E-21,  2.2171E-21,  2.1964E-21,  2.3079E-21,  2.2869E-21,  2.3949E-21, &
       2.3724E-21,  2.4816E-21,  2.4548E-21,  2.5645E-21,  2.6396E-21,  2.8447E-21, &
       3.0142E-21,  3.2023E-21,  3.3625E-21,  3.5396E-21,  3.6988E-21,  3.8680E-21, &
       4.0400E-21,  4.2304E-21,  4.4206E-21,  4.6105E-21,  4.7992E-21,  4.9854E-21, &
       5.1709E-21 /)
    REAL, PARAMETER :: a1_2_HCl(dim55) = (/ &
      -2.8509E-25, -1.9424E-25, -2.2784E-25, -1.3167E-25, -1.5810E-25, -7.3902E-26, &
      -9.9677E-26, -3.3392E-26, -5.9191E-26, -8.4228E-27, -3.4072E-26,  5.4427E-27, &
      -1.8647E-26,  1.3309E-26, -8.8138E-27,  1.7299E-26, -2.6171E-27,  1.9540E-26, &
       1.5298E-27,  2.0504E-26,  4.3789E-27,  2.0915E-26,  6.3688E-27,  2.0900E-26, &
       7.6499E-27,  2.0592E-26,  8.6719E-27,  2.0120E-26,  9.1530E-27,  1.9548E-26, &
       9.5569E-27,  1.8864E-26,  9.7409E-27,  1.8167E-26,  9.8950E-27,  1.7523E-26, &
       9.8183E-27,  1.6946E-26,  9.6828E-27,  1.6278E-26,  1.1868E-26,  1.2117E-26, &
       1.0578E-26,  1.0739E-26,  9.7663E-27,  9.8357E-27,  9.3179E-27,  9.2676E-27, &
       9.3273E-27,  9.8780E-27,  1.0364E-26,  1.0782E-26,  1.1126E-26,  1.1377E-26, &
       1.1566E-26 /)
    REAL, PARAMETER :: b1_2_HCl(dim55) = (/ &
      -4.5916E-24, -4.8642E-24, -4.6793E-24, -5.4488E-24, -5.1713E-24, -6.2658E-24, &
      -5.8663E-24, -7.0594E-24, -6.5305E-24, -7.6982E-24, -7.0441E-24, -8.1505E-24, &
      -7.4158E-24, -8.4704E-24, -7.6850E-24, -8.6773E-24, -7.8707E-24, -8.8235E-24, &
      -8.0040E-24, -8.9147E-24, -8.1004E-24, -8.9768E-24, -8.1695E-24, -9.0123E-24, &
      -8.2107E-24, -9.0260E-24, -8.2453E-24, -9.0237E-24, -8.2506E-24, -9.0094E-24, &
      -8.2551E-24, -8.9810E-24, -8.2466E-24, -8.9460E-24, -8.2387E-24, -8.9100E-24, &
      -8.2127E-24, -8.8756E-24, -8.1820E-24, -8.8283E-24, -8.3851E-24, -8.4132E-24, &
      -8.2200E-24, -8.2423E-24, -8.0959E-24, -8.1072E-24, -8.0164E-24, -8.0069E-24, &
      -8.0189E-24, -8.1362E-24, -8.2458E-24, -8.3452E-24, -8.4315E-24, -8.4976E-24, &
      -8.5494E-24 /)

    jval_2d(ip_HCl)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_HCl(0) = &
          p1(a0_1_1_HCl(i0(j,k))*dlv2(j,k) + &
          a0_1_2_HCl(i0(j,k)), &
          a0_2_1_HCl(i0(j,k))*dlv2(j,k) + &
          a0_2_2_HCl(i0(j,k)),v3_du1(j,k))
        sig_HCl(1) = &
          (p1(b1_1_HCl(i1(j,k)),a1_1_HCl(i1(j,k)), &
          v3_du1(j,k)) + &
          p1(b1_2_HCl(i1(j,k)),a1_2_HCl(i1(j,k)), &
          v3_du1(j,k)) * v2s_m(j,k))
        dj = 0. &
          + sig_HCl(0) * fint(j,k,0) &
          + sig_HCl(1) * fint(j,k,1)

        jval_2d(ip_HCl)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,8)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_HCl

  ! **************************************************************************

  SUBROUTINE jval_cal_CHCl2Br

    ! CHCl_2Br \TOHV\ \products

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_CHCl2Br

    ! T-const parameters:
    REAL, PARAMETER :: a0_1_1_CHCl2Br(dim58) = (/ &
       4.3238E-21,  4.7373E-21,  5.1781E-21,  5.6350E-21,  6.1161E-21,  6.6210E-21, &
       7.1494E-21,  7.7000E-21,  8.2783E-21,  8.8748E-21,  9.5281E-21,  1.0189E-20, &
       1.2344E-20,  1.7598E-20,  1.7135E-20,  1.8121E-20,  2.0772E-20,  2.0129E-20, &
       2.1031E-20,  2.3734E-20,  2.2680E-20,  2.3326E-20,  2.5852E-20,  2.4257E-20, &
       2.4514E-20,  2.0489E-20,  1.8679E-20,  1.9134E-20,  1.9829E-20,  2.0796E-20, &
       2.2070E-20,  2.3664E-20,  2.5532E-20,  2.7643E-20,  2.9936E-20,  3.2306E-20, &
       3.4747E-20,  3.7200E-20,  3.9639E-20,  4.2102E-20,  4.4562E-20,  4.7033E-20, &
       4.9473E-20,  5.1786E-20,  5.3857E-20,  5.5549E-20,  5.6634E-20,  5.7139E-20, &
       5.6934E-20,  5.6125E-20,  5.4800E-20,  5.3009E-20,  5.0866E-20,  4.8415E-20, &
       4.5619E-20,  4.2082E-20,  3.6664E-20,  3.0085E-20 /)
    REAL, PARAMETER :: a0_1_2_CHCl2Br(dim58) = (/ &
       3.5009E-21, -1.4777E-20, -3.4349E-20, -5.4725E-20, -7.6281E-20, -9.9002E-20, &
      -1.2288E-19, -1.4788E-19, -1.7425E-19, -2.0157E-19, -2.3162E-19, -2.6217E-19, &
      -3.6217E-19, -6.0698E-19, -5.8534E-19, -6.3168E-19, -7.5677E-19, -7.2632E-19, &
      -7.6924E-19, -8.9843E-19, -8.4786E-19, -8.7898E-19, -1.0013E-18, -9.2375E-19, &
      -9.3626E-19, -7.3907E-19, -6.4999E-19, -6.7246E-19, -7.0694E-19, -7.5510E-19, &
      -8.1882E-19, -8.9882E-19, -9.9297E-19, -1.0998E-18, -1.2163E-18, -1.3371E-18, &
      -1.4621E-18, -1.5882E-18, -1.7141E-18, -1.8416E-18, -1.9695E-18, -2.0985E-18, &
      -2.2264E-18, -2.3481E-18, -2.4574E-18, -2.5471E-18, -2.6048E-18, -2.6318E-18, &
      -2.6208E-18, -2.5773E-18, -2.5057E-18, -2.4086E-18, -2.2921E-18, -2.1582E-18, &
      -2.0050E-18, -1.8105E-18, -1.5114E-18, -1.1470E-18 /)
    REAL, PARAMETER :: a0_2_1_CHCl2Br(dim58) = (/ &
       2.2437E-23,  2.4710E-23,  2.7185E-23,  2.9979E-23,  3.2946E-23,  3.6101E-23, &
       3.9583E-23,  4.3271E-23,  4.7287E-23,  5.1728E-23,  5.6432E-23,  6.1776E-23, &
       4.5912E-23, -1.2981E-23,  1.4531E-23,  2.1323E-23,  7.4350E-24,  3.7031E-23, &
       4.6183E-23,  3.4375E-23,  6.6406E-23,  7.7464E-23,  6.7534E-23,  1.0086E-22, &
       1.1267E-22,  1.6543E-22,  1.9332E-22,  1.9650E-22,  1.9520E-22,  1.8897E-22, &
       1.7724E-22,  1.6008E-22,  1.3821E-22,  1.1259E-22,  8.5054E-23,  5.7266E-23, &
       3.1146E-23,  7.8713E-24, -1.1346E-23, -2.6273E-23, -3.6833E-23, -4.3669E-23, &
      -4.7576E-23, -4.9441E-23, -5.0013E-23, -4.9681E-23, -4.8473E-23, -4.6692E-23, &
      -4.4338E-23, -4.1772E-23, -3.9124E-23, -3.6351E-23, -3.3442E-23, -3.0228E-23, &
      -2.6826E-23, -2.3075E-23, -1.9234E-23, -1.6242E-23 /)
    REAL, PARAMETER :: a0_2_2_CHCl2Br(dim58) = (/ &
      -1.2924E-21, -1.3929E-21, -1.5028E-21, -1.6274E-21, -1.7603E-21, -1.9023E-21, &
      -2.0597E-21, -2.2271E-21, -2.4102E-21, -2.6136E-21, -2.8300E-21, -3.0769E-21, &
      -2.3408E-21,  4.0359E-22, -8.8399E-22, -1.2032E-21, -5.4769E-22, -1.9506E-21, &
      -2.3862E-21, -1.8218E-21, -3.3592E-21, -3.8922E-21, -3.4116E-21, -5.0311E-21, &
      -5.6078E-21, -8.1927E-21, -9.5651E-21, -9.7220E-21, -9.6578E-21, -9.3473E-21, &
      -8.7610E-21, -7.8994E-21, -6.7972E-21, -5.5008E-21, -4.1020E-21, -2.6848E-21, &
      -1.3475E-21, -1.5115E-22,  8.4044E-22,  1.6137E-21,  2.1628E-21,  2.5196E-21, &
       2.7244E-21,  2.8224E-21,  2.8526E-21,  2.8350E-21,  2.7708E-21,  2.6757E-21, &
       2.5495E-21,  2.4115E-21,  2.2685E-21,  2.1182E-21,  1.9599E-21,  1.7845E-21, &
       1.5980E-21,  1.3917E-21,  1.1797E-21,  1.0139E-21 /)
    REAL, PARAMETER :: a1_1_CHCl2Br(dim55) = (/ &
       6.8560E-21,  6.0857E-21,  5.2372E-21,  4.4395E-21,  3.6164E-21,  3.0051E-21, &
       2.3568E-21,  1.9672E-21,  1.5169E-21,  1.2915E-21,  9.9874E-22,  8.7646E-22, &
       6.8930E-22,  6.2389E-22,  5.0762E-22,  4.7114E-22,  3.9903E-22,  3.7768E-22, &
       3.3361E-22,  3.1901E-22,  2.9402E-22,  2.8208E-22,  2.7090E-22,  2.5821E-22, &
       2.5751E-22,  2.4214E-22,  2.4874E-22,  2.3322E-22,  2.4336E-22,  2.2739E-22, &
       2.4108E-22,  2.2455E-22,  2.4156E-22,  2.2186E-22,  2.4044E-22,  2.2238E-22, &
       2.4238E-22,  2.2073E-22,  2.4215E-22,  2.2150E-22,  2.3581E-22,  2.3314E-22, &
       2.3857E-22,  2.3423E-22,  2.3798E-22,  2.3175E-22,  2.3362E-22,  2.2643E-22, &
       2.3312E-22,  2.2649E-22,  2.1976E-22,  2.1304E-22,  2.0597E-22,  1.9909E-22, &
       1.9231E-22 /)
    REAL, PARAMETER :: b1_1_CHCl2Br(dim55) = (/ &
       6.0623E-19,  6.0854E-19,  6.1320E-19,  6.1959E-19,  6.2823E-19,  6.3618E-19, &
       6.4622E-19,  6.5324E-19,  6.6247E-19,  6.6765E-19,  6.7512E-19,  6.7854E-19, &
       6.8425E-19,  6.8641E-19,  6.9054E-19,  6.9192E-19,  6.9484E-19,  6.9576E-19, &
       6.9777E-19,  6.9847E-19,  6.9973E-19,  7.0036E-19,  7.0098E-19,  7.0172E-19, &
       7.0176E-19,  7.0273E-19,  7.0230E-19,  7.0335E-19,  7.0264E-19,  7.0380E-19, &
       7.0277E-19,  7.0406E-19,  7.0269E-19,  7.0432E-19,  7.0274E-19,  7.0432E-19, &
       7.0251E-19,  7.0453E-19,  7.0248E-19,  7.0451E-19,  7.0307E-19,  7.0337E-19, &
       7.0269E-19,  7.0329E-19,  7.0272E-19,  7.0374E-19,  7.0341E-19,  7.0476E-19, &
       7.0342E-19,  7.0483E-19,  7.0635E-19,  7.0795E-19,  7.0972E-19,  7.1153E-19, &
       7.1340E-19 /)
    REAL, PARAMETER :: a1_2_CHCl2Br(dim55) = (/ &
       4.2328E-24,  9.1908E-24,  1.2956E-23,  1.4195E-23,  1.6148E-23,  1.4413E-23, &
       1.5004E-23,  1.2032E-23,  1.1942E-23,  9.0577E-24,  8.7258E-24,  6.3954E-24, &
       6.0906E-24,  4.4131E-24,  4.1402E-24,  2.9865E-24,  2.7657E-24,  2.0250E-24, &
       1.8260E-24,  1.3616E-24,  1.1750E-24,  9.1817E-25,  7.3039E-25,  6.1262E-25, &
       4.1220E-25,  4.0976E-25,  1.9526E-25,  2.6591E-25,  4.6435E-26,  1.5642E-25, &
      -5.5077E-26,  8.2528E-26, -1.3921E-25,  3.9041E-26, -1.8413E-25, -2.2585E-27, &
      -2.2430E-25, -1.8456E-26, -2.3961E-25, -3.6270E-26, -1.7613E-25, -1.3783E-25, &
      -1.6376E-25, -1.1142E-25, -1.2569E-25, -7.6242E-26, -8.5765E-26, -4.4042E-26, &
      -8.7718E-26, -5.7642E-26, -3.0448E-26, -7.4525E-27,  1.4179E-26,  3.2626E-26, &
       4.8154E-26 /)
    REAL, PARAMETER :: b1_2_CHCl2Br(dim55) = (/ &
      -4.7020E-22, -4.8508E-22, -5.0579E-22, -5.1570E-22, -5.3621E-22, -5.1364E-22, &
      -5.2282E-22, -4.6931E-22, -4.6747E-22, -4.0113E-22, -3.9266E-22, -3.2741E-22, &
      -3.1812E-22, -2.6276E-22, -2.5307E-22, -2.0923E-22, -2.0029E-22, -1.6844E-22, &
      -1.5938E-22, -1.3709E-22, -1.2767E-22, -1.1406E-22, -1.0364E-22, -9.6806E-23, &
      -8.4681E-23, -8.4527E-23, -7.0477E-23, -7.5281E-23, -5.9808E-23, -6.7837E-23, &
      -5.1869E-23, -6.2603E-23, -4.4752E-23, -5.9547E-23, -4.0467E-23, -5.6471E-23, &
      -3.6376E-23, -5.5520E-23, -3.4400E-23, -5.4327E-23, -4.0271E-23, -4.4599E-23, &
      -4.1345E-23, -4.8567E-23, -4.6420E-23, -5.4480E-23, -5.2809E-23, -6.0652E-23, &
      -5.1896E-23, -5.8302E-23, -6.4434E-23, -6.9907E-23, -7.5326E-23, -8.0177E-23, &
      -8.4455E-23 /)
    REAL, PARAMETER :: a2_CHCl2Br(dim55) = (/ &
      -3.5520E-21, -3.0228E-21, -2.4092E-21, -1.8192E-21, -1.3196E-21, -9.3080E-22, &
      -6.4716E-22, -4.4720E-22, -3.1008E-22, -2.1724E-22, -1.5468E-22, -1.1236E-22, &
      -8.3600E-23, -6.3760E-23, -4.9880E-23, -3.9960E-23, -3.2800E-23, -2.7440E-23, &
      -2.3400E-23, -2.0200E-23, -1.7680E-23, -1.5680E-23, -1.4000E-23, -1.2600E-23, &
      -1.1400E-23, -1.0400E-23, -9.4800E-24, -8.6800E-24, -8.0400E-24, -7.3600E-24, &
      -6.8400E-24, -6.3200E-24, -5.8800E-24, -5.4800E-24, -5.0800E-24, -4.7200E-24, &
      -4.4000E-24, -4.1200E-24, -3.8400E-24, -3.6000E-24, -2.9440E-24, -2.1200E-24, &
      -1.5360E-24, -1.1120E-24, -8.0000E-25, -5.8400E-25, -4.2400E-25, -3.1200E-25, &
      -2.2400E-25, -1.6000E-25, -1.2000E-25, -8.0000E-26, -6.4000E-26, -4.8000E-26, &
      -3.2000E-26 /)
    REAL, PARAMETER :: b2_CHCl2Br(dim55) = (/ &
       4.5294E-20,  4.3706E-20,  4.0332E-20,  3.5612E-20,  3.0366E-20,  2.5311E-20, &
       2.0915E-20,  1.7316E-20,  1.4505E-20,  1.2369E-20,  1.0774E-20,  9.5892E-21, &
       8.7120E-21,  8.0573E-21,  7.5645E-21,  7.1876E-21,  6.8976E-21,  6.6671E-21, &
       6.4833E-21,  6.3297E-21,  6.2024E-21,  6.0964E-21,  6.0032E-21,  5.9220E-21, &
       5.8494E-21,  5.7864E-21,  5.7261E-21,  5.6717E-21,  5.6266E-21,  5.5770E-21, &
       5.5377E-21,  5.4972E-21,  5.4617E-21,  5.4285E-21,  5.3943E-21,  5.3627E-21, &
       5.3337E-21,  5.3077E-21,  5.2809E-21,  5.2574E-21,  5.1915E-21,  5.0984E-21, &
       5.0251E-21,  4.9666E-21,  4.9196E-21,  4.8844E-21,  4.8563E-21,  4.8353E-21, &
       4.8176E-21,  4.8040E-21,  4.7950E-21,  4.7854E-21,  4.7814E-21,  4.7772E-21, &
       4.7728E-21 /)
    REAL, PARAMETER :: a3_CHCl2Br(dim55) = (/ &
      -7.0156E-24, -4.2672E-24, -2.3276E-24, -1.3349E-24, -8.4218E-25, -5.8018E-25, &
      -4.2615E-25, -3.2865E-25, -2.6425E-25, -2.1753E-25, -1.8333E-25, -1.5728E-25, &
      -1.3674E-25, -1.2016E-25, -1.0679E-25, -9.5515E-26, -8.6086E-26, -7.7844E-26, &
      -7.0890E-26, -6.4726E-26, -5.9316E-26, -5.4795E-26, -5.0685E-26, -4.6747E-26, &
      -4.3419E-26, -4.0411E-26, -3.7500E-26, -3.5274E-26, -3.2650E-26, -3.0822E-26, &
      -2.8767E-26, -2.7055E-26, -2.5299E-26, -2.3801E-26, -2.2603E-26, -2.1026E-26, &
      -1.9863E-26, -1.8836E-26, -1.7637E-26, -1.6752E-26, -1.4139E-26, -1.0716E-26, &
      -8.1793E-27, -6.2992E-27, -4.8613E-27, -3.7645E-27, -2.9100E-27, -2.2937E-27, &
      -1.7796E-27, -1.4036E-27, -1.0613E-27, -8.5558E-28, -6.8470E-28, -5.4776E-28, &
      -4.1068E-28 /)
    REAL, PARAMETER :: b3_CHCl2Br(dim55) = (/ &
       2.0139E-21,  1.8520E-21,  1.6243E-21,  1.4499E-21,  1.3344E-21,  1.2578E-21, &
       1.2037E-21,  1.1638E-21,  1.1336E-21,  1.1091E-21,  1.0891E-21,  1.0723E-21, &
       1.0579E-21,  1.0453E-21,  1.0343E-21,  1.0245E-21,  1.0156E-21,  1.0074E-21, &
       1.0001E-21,  9.9328E-22,  9.8696E-22,  9.8141E-22,  9.7613E-22,  9.7083E-22, &
       9.6616E-22,  9.6177E-22,  9.5734E-22,  9.5383E-22,  9.4954E-22,  9.4644E-22, &
       9.4284E-22,  9.3974E-22,  9.3645E-22,  9.3356E-22,  9.3118E-22,  9.2796E-22, &
       9.2551E-22,  9.2329E-22,  9.2063E-22,  9.1861E-22,  9.1250E-22,  9.0350E-22, &
       8.9609E-22,  8.9005E-22,  8.8500E-22,  8.8084E-22,  8.7734E-22,  8.7464E-22, &
       8.7224E-22,  8.7037E-22,  8.6857E-22,  8.6743E-22,  8.6643E-22,  8.6559E-22, &
       8.6471E-22 /)
    REAL, PARAMETER :: a4_CHCl2Br(4) = (/  5.1894E-22, -9.1094E-26,  1.8942E-29, -1.3220E-33 /)
    REAL, PARAMETER :: a5_CHCl2Br(4) = (/  5.0286E-23, -2.8942E-26,  5.7895E-30, -3.8700E-34 /)

    jval_2d(ip_CHCl2Br)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_CHCl2Br(0) = &
          p1(a0_1_1_CHCl2Br(i0(j,k))*dlv2(j,k) + &
          a0_1_2_CHCl2Br(i0(j,k)), &
          a0_2_1_CHCl2Br(i0(j,k))*dlv2(j,k) + &
          a0_2_2_CHCl2Br(i0(j,k)),v3_du1(j,k))
        sig_CHCl2Br(1) = &
          (p1(b1_1_CHCl2Br(i1(j,k)),a1_1_CHCl2Br(i1(j,k)), &
          v3_du1(j,k)) + &
          p1(b1_2_CHCl2Br(i1(j,k)),a1_2_CHCl2Br(i1(j,k)), &
          v3_du1(j,k)) * v2s_m(j,k))
        sig_CHCl2Br(2) = &
          p1(b2_CHCl2Br(i2(j,k)), a2_CHCl2Br(i2(j,k)), &
          v3_du1(j,k))
        sig_CHCl2Br(3) = &
          p1(b3_CHCl2Br(i3(j,k)), a3_CHCl2Br(i3(j,k)), &
          v3_du2(j,k))
        sig_CHCl2Br(4) = &
          p3(a4_CHCl2Br(1),a4_CHCl2Br(2),a4_CHCl2Br(3), &
          a4_CHCl2Br(4),v3_du2(j,k))
        sig_CHCl2Br(5) = &
          p3(a5_CHCl2Br(1),a5_CHCl2Br(2),a5_CHCl2Br(3), &
          a5_CHCl2Br(4),v3_du2(j,k))
        dj = 0. &
          + sig_CHCl2Br(0) * fint(j,k,0) &
          + sig_CHCl2Br(1) * fint(j,k,1) &
          + sig_CHCl2Br(2) * fint(j,k,2) &
          + sig_CHCl2Br(3) * fint(j,k,3) &
          + sig_CHCl2Br(4) * fint(j,k,4) &
          + sig_CHCl2Br(5) * fint(j,k,5)

        jval_2d(ip_CHCl2Br)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,7)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_CHCl2Br

  ! **************************************************************************

  SUBROUTINE jval_cal_CHClBr2

    ! CHClBr_2 \TOHV\ \products

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_CHClBr2

    ! T-const parameters:
    REAL, PARAMETER :: a0_1_1_CHClBr2(dim58) = (/ &
       1.1794E-20,  1.2902E-20,  1.4090E-20,  1.5346E-20,  1.6654E-20,  1.8023E-20, &
       1.9459E-20,  2.0954E-20,  2.2527E-20,  2.4182E-20,  2.5911E-20,  2.7750E-20, &
       3.3607E-20,  4.7920E-20,  4.6641E-20,  4.9328E-20,  5.6553E-20,  5.4784E-20, &
       5.7268E-20,  6.4597E-20,  6.1755E-20,  6.3483E-20,  7.0392E-20,  6.6036E-20, &
       6.6735E-20,  5.5787E-20,  5.0838E-20,  5.2084E-20,  5.3962E-20,  5.6621E-20, &
       6.0094E-20,  6.4414E-20,  6.9515E-20,  7.5247E-20,  8.1482E-20,  8.7954E-20, &
       9.4590E-20,  1.0128E-19,  1.0790E-19,  1.1462E-19,  1.2133E-19,  1.2806E-19, &
       1.3465E-19,  1.4099E-19,  1.4660E-19,  1.5124E-19,  1.5413E-19,  1.5558E-19, &
       1.5496E-19,  1.5282E-19,  1.4918E-19,  1.4432E-19,  1.3847E-19,  1.3180E-19, &
       1.2417E-19,  1.1446E-19,  9.9877E-20,  8.1902E-20 /)
    REAL, PARAMETER :: a0_1_2_CHClBr2(dim58) = (/ &
       8.4814E-21, -4.0496E-20, -9.3216E-20, -1.4923E-19, -2.0784E-19, -2.6944E-19, &
      -3.3436E-19, -4.0221E-19, -4.7396E-19, -5.4978E-19, -6.2928E-19, -7.1427E-19, &
      -9.8600E-19, -1.6530E-18, -1.5931E-18, -1.7194E-18, -2.0604E-18, -1.9766E-18, &
      -2.0949E-18, -2.4451E-18, -2.3088E-18, -2.3920E-18, -2.7264E-18, -2.5147E-18, &
      -2.5488E-18, -2.0124E-18, -1.7689E-18, -1.8304E-18, -1.9236E-18, -2.0560E-18, &
      -2.2297E-18, -2.4465E-18, -2.7036E-18, -2.9937E-18, -3.3104E-18, -3.6405E-18, &
      -3.9802E-18, -4.3243E-18, -4.6656E-18, -5.0140E-18, -5.3627E-18, -5.7139E-18, &
      -6.0593E-18, -6.3926E-18, -6.6890E-18, -6.9352E-18, -7.0885E-18, -7.1663E-18, &
      -7.1328E-18, -7.0179E-18, -6.8213E-18, -6.5576E-18, -6.2394E-18, -5.8752E-18, &
      -5.4571E-18, -4.9234E-18, -4.1182E-18, -3.1224E-18 /)
    REAL, PARAMETER :: a0_2_1_CHClBr2(dim58) = (/ &
       6.0883E-23,  6.7241E-23,  7.4107E-23,  8.1467E-23,  8.9663E-23,  9.8354E-23, &
       1.0770E-22,  1.1790E-22,  1.2878E-22,  1.4072E-22,  1.5373E-22,  1.6808E-22, &
       1.2496E-22, -3.5429E-23,  3.9627E-23,  5.8093E-23,  2.0157E-23,  1.0093E-22, &
       1.2565E-22,  9.3611E-23,  1.8072E-22,  2.1092E-22,  1.8383E-22,  2.7455E-22, &
       3.0671E-22,  4.5030E-22,  5.2634E-22,  5.3492E-22,  5.3152E-22,  5.1435E-22, &
       4.8246E-22,  4.3582E-22,  3.7619E-22,  3.0654E-22,  2.3164E-22,  1.5585E-22, &
       8.4793E-23,  2.1284E-23, -3.0781E-23, -7.1541E-23, -1.0051E-22, -1.1884E-22, &
      -1.2941E-22, -1.3454E-22, -1.3610E-22, -1.3546E-22, -1.3165E-22, -1.2723E-22, &
      -1.2067E-22, -1.1380E-22, -1.0651E-22, -9.8986E-23, -9.0996E-23, -8.2294E-23, &
      -7.2966E-23, -6.2289E-23, -5.2767E-23, -4.3995E-23 /)
    REAL, PARAMETER :: a0_2_2_CHClBr2(dim58) = (/ &
      -3.5097E-21, -3.7907E-21, -4.0956E-21, -4.4238E-21, -4.7910E-21, -5.1821E-21, &
      -5.6047E-21, -6.0677E-21, -6.5637E-21, -7.1107E-21, -7.7091E-21, -8.3720E-21, &
      -6.3711E-21,  1.1029E-21, -2.4097E-21, -3.2776E-21, -1.4870E-21, -5.3157E-21, &
      -6.4925E-21, -4.9609E-21, -9.1423E-21, -1.0598E-20, -9.2867E-21, -1.3695E-20, &
      -1.5265E-20, -2.2301E-20, -2.6042E-20, -2.6466E-20, -2.6297E-20, -2.5442E-20, &
      -2.3848E-20, -2.1507E-20, -1.8501E-20, -1.4977E-20, -1.1172E-20, -7.3068E-21, &
      -3.6684E-21, -4.0405E-22,  2.2825E-21,  4.3939E-21,  5.9000E-21,  6.8571E-21, &
       7.4111E-21,  7.6808E-21,  7.7629E-21,  7.7291E-21,  7.5265E-21,  7.2904E-21, &
       6.9389E-21,  6.5693E-21,  6.1755E-21,  5.7678E-21,  5.3332E-21,  4.8580E-21, &
       4.3468E-21,  3.7596E-21,  3.2340E-21,  2.7480E-21 /)
    REAL, PARAMETER :: a1_1_CHClBr2(dim55) = (/ &
       3.8024E-20,  3.6328E-20,  3.4885E-20,  3.1988E-20,  2.9413E-20,  2.6466E-20, &
       2.3742E-20,  2.1320E-20,  1.8892E-20,  1.7144E-20,  1.5178E-20,  1.3968E-20, &
       1.2326E-20,  1.1520E-20,  1.0190E-20,  9.6772E-21,  8.5299E-21,  8.2306E-21, &
       7.2435E-21,  7.0761E-21,  6.2122E-21,  6.1399E-21,  5.3899E-21,  5.3706E-21, &
       4.6878E-21,  4.7371E-21,  4.1146E-21,  4.2060E-21,  3.6233E-21,  3.7461E-21, &
       3.2168E-21,  3.3583E-21,  2.8617E-21,  3.0240E-21,  2.5655E-21,  2.7372E-21, &
       2.2898E-21,  2.4927E-21,  2.0714E-21,  2.2615E-21,  1.8111E-21,  1.4995E-21, &
       1.1710E-21,  1.0042E-21,  7.8859E-22,  6.9382E-22,  5.4247E-22,  4.8830E-22, &
       3.0573E-22,  2.4927E-22,  2.0360E-22,  1.6206E-22,  1.2714E-22,  9.7371E-23, &
       7.0556E-23 /)
    REAL, PARAMETER :: b1_1_CHClBr2(dim55) = (/ &
       1.8738E-18,  1.8789E-18,  1.8868E-18,  1.9100E-18,  1.9370E-18,  1.9753E-18, &
       2.0176E-18,  2.0612E-18,  2.1109E-18,  2.1511E-18,  2.2013E-18,  2.2351E-18, &
       2.2852E-18,  2.3118E-18,  2.3590E-18,  2.3785E-18,  2.4250E-18,  2.4379E-18, &
       2.4828E-18,  2.4908E-18,  2.5344E-18,  2.5383E-18,  2.5799E-18,  2.5810E-18, &
       2.6223E-18,  2.6192E-18,  2.6600E-18,  2.6538E-18,  2.6949E-18,  2.6859E-18, &
       2.7259E-18,  2.7148E-18,  2.7548E-18,  2.7413E-18,  2.7805E-18,  2.7654E-18, &
       2.8059E-18,  2.7870E-18,  2.8273E-18,  2.8086E-18,  2.8539E-18,  2.8891E-18, &
       2.9304E-18,  2.9534E-18,  2.9858E-18,  3.0013E-18,  3.0278E-18,  3.0380E-18, &
       3.0746E-18,  3.0866E-18,  3.0969E-18,  3.1068E-18,  3.1156E-18,  3.1234E-18, &
       3.1308E-18 /)
    REAL, PARAMETER :: a1_2_CHClBr2(dim55) = (/ &
      -6.8364E-23, -2.7549E-23, -1.6327E-23,  1.3057E-23,  2.3650E-23,  3.7536E-23, &
       4.4308E-23,  4.6564E-23,  5.0998E-23,  4.6046E-23,  4.8843E-23,  4.1389E-23, &
       4.4400E-23,  3.6073E-23,  3.9010E-23,  3.0781E-23,  3.4118E-23,  2.6390E-23, &
       2.9818E-23,  2.2624E-23,  2.6208E-23,  1.9677E-23,  2.2966E-23,  1.7163E-23, &
       2.0486E-23,  1.4975E-23,  1.8277E-23,  1.3187E-23,  1.6400E-23,  1.1700E-23, &
       1.4726E-23,  1.0414E-23,  1.3355E-23,  9.2858E-24,  1.2024E-23,  8.3136E-24, &
       1.0986E-23,  7.3999E-24,  1.0043E-23,  6.7335E-24,  7.3772E-24,  5.5091E-24, &
       4.8835E-24,  3.7045E-24,  3.4184E-24,  2.6411E-24,  2.5096E-24,  1.9574E-24, &
       2.3022E-24,  2.0098E-24,  1.7616E-24,  1.5543E-24,  1.3775E-24,  1.2257E-24, &
       1.0949E-24 /)
    REAL, PARAMETER :: b1_2_CHClBr2(dim55) = (/ &
      -2.5534E-21, -2.6759E-21, -2.7376E-21, -2.9727E-21, -3.0839E-21, -3.2644E-21, &
      -3.3694E-21, -3.4100E-21, -3.5009E-21, -3.3870E-21, -3.4583E-21, -3.2496E-21, &
      -3.3414E-21, -3.0666E-21, -3.1709E-21, -2.8582E-21, -2.9933E-21, -2.6610E-21, &
      -2.8170E-21, -2.4717E-21, -2.6527E-21, -2.3066E-21, -2.4891E-21, -2.1525E-21, &
      -2.3535E-21, -2.0064E-21, -2.2226E-21, -1.8765E-21, -2.1030E-21, -1.7600E-21, &
      -1.9884E-21, -1.6521E-21, -1.8888E-21, -1.5511E-21, -1.7852E-21, -1.4587E-21, &
      -1.7005E-21, -1.3670E-21, -1.6195E-21, -1.2951E-21, -1.3598E-21, -1.1487E-21, &
      -1.0702E-21, -9.0747E-22, -8.6441E-22, -7.3772E-22, -7.1465E-22, -6.1083E-22, &
      -6.7997E-22, -6.1768E-22, -5.6171E-22, -5.1237E-22, -4.6809E-22, -4.2816E-22, &
      -3.9213E-22 /)
    REAL, PARAMETER :: a2_CHClBr2(dim55) = (/ &
      -1.3784E-20, -1.1696E-20, -9.3016E-21, -7.0144E-21, -5.0816E-21, -3.5848E-21, &
      -2.4908E-21, -1.7228E-21, -1.1960E-21, -8.3920E-22, -5.9840E-22, -4.3600E-22, &
      -3.2440E-22, -2.4840E-22, -1.9440E-22, -1.5600E-22, -1.2800E-22, -1.0720E-22, &
      -9.1200E-23, -7.8800E-23, -6.9200E-23, -6.1200E-23, -5.4800E-23, -4.8800E-23, &
      -4.4400E-23, -4.0800E-23, -3.6800E-23, -3.4000E-23, -3.1200E-23, -2.8800E-23, &
      -2.6400E-23, -2.4800E-23, -2.2800E-23, -2.1200E-23, -1.9600E-23, -1.8400E-23, &
      -1.7200E-23, -1.6000E-23, -1.4800E-23, -1.4000E-23, -1.1520E-23, -8.2400E-24, &
      -5.9200E-24, -4.3200E-24, -3.1200E-24, -2.3200E-24, -1.6000E-24, -1.2000E-24, &
      -8.8000E-25, -6.4000E-25, -4.8000E-25, -3.2000E-25, -2.4000E-25, -1.6000E-25, &
      -1.6000E-25 /)
    REAL, PARAMETER :: b2_CHClBr2(dim55) = (/ &
       1.7061E-19,  1.6435E-19,  1.5118E-19,  1.3288E-19,  1.1259E-19,  9.3128E-20, &
       7.6171E-20,  6.2347E-20,  5.1548E-20,  4.3342E-20,  3.7201E-20,  3.2654E-20, &
       2.9250E-20,  2.6742E-20,  2.4825E-20,  2.3366E-20,  2.2232E-20,  2.1338E-20, &
       2.0610E-20,  2.0014E-20,  1.9530E-20,  1.9106E-20,  1.8750E-20,  1.8402E-20, &
       1.8136E-20,  1.7909E-20,  1.7647E-20,  1.7457E-20,  1.7260E-20,  1.7084E-20, &
       1.6903E-20,  1.6778E-20,  1.6617E-20,  1.6485E-20,  1.6348E-20,  1.6242E-20, &
       1.6134E-20,  1.6022E-20,  1.5907E-20,  1.5829E-20,  1.5580E-20,  1.5209E-20, &
       1.4918E-20,  1.4697E-20,  1.4517E-20,  1.4386E-20,  1.4260E-20,  1.4185E-20, &
       1.4120E-20,  1.4069E-20,  1.4033E-20,  1.3995E-20,  1.3975E-20,  1.3954E-20, &
       1.3954E-20 /)
    REAL, PARAMETER :: a3_CHClBr2(dim55) = (/ &
      -2.0051E-23, -1.1771E-23, -6.1441E-24, -3.3664E-24, -2.0472E-24, -1.3692E-24, &
      -9.8408E-25, -7.4632E-25, -5.8874E-25, -4.8092E-25, -4.0055E-25, -3.4229E-25, &
      -2.9437E-25, -2.5847E-25, -2.2762E-25, -2.0199E-25, -1.8141E-25, -1.6424E-25, &
      -1.4897E-25, -1.3527E-25, -1.2479E-25, -1.1301E-25, -1.0616E-25, -9.5890E-26, &
      -8.8889E-26, -8.3904E-26, -7.7055E-26, -7.1918E-26, -6.6667E-26, -6.3356E-26, &
      -5.8219E-26, -5.4795E-26, -5.1282E-26, -4.7945E-26, -4.6233E-26, -4.2735E-26, &
      -3.9384E-26, -3.7671E-26, -3.5959E-26, -3.4188E-26, -2.8073E-26, -2.1226E-26, &
      -1.6427E-26, -1.2325E-26, -9.5858E-27, -7.1869E-27, -5.8199E-27, -4.4505E-27, &
      -3.4223E-27, -2.7388E-27, -2.0541E-27, -1.7112E-27, -1.3694E-27, -1.0270E-27, &
      -6.8446E-28 /)
    REAL, PARAMETER :: b3_CHClBr2(dim55) = (/ &
       4.4374E-21,  3.9495E-21,  3.2892E-21,  2.8009E-21,  2.4920E-21,  2.2936E-21, &
       2.1584E-21,  2.0610E-21,  1.9873E-21,  1.9305E-21,  1.8835E-21,  1.8461E-21, &
       1.8124E-21,  1.7852E-21,  1.7599E-21,  1.7374E-21,  1.7182E-21,  1.7011E-21, &
       1.6850E-21,  1.6698E-21,  1.6576E-21,  1.6431E-21,  1.6343E-21,  1.6205E-21, &
       1.6107E-21,  1.6034E-21,  1.5930E-21,  1.5849E-21,  1.5763E-21,  1.5707E-21, &
       1.5617E-21,  1.5555E-21,  1.5489E-21,  1.5425E-21,  1.5391E-21,  1.5319E-21, &
       1.5249E-21,  1.5212E-21,  1.5174E-21,  1.5133E-21,  1.4990E-21,  1.4810E-21, &
       1.4670E-21,  1.4538E-21,  1.4442E-21,  1.4351E-21,  1.4295E-21,  1.4235E-21, &
       1.4187E-21,  1.4153E-21,  1.4117E-21,  1.4098E-21,  1.4078E-21,  1.4057E-21, &
       1.4035E-21 /)
    REAL, PARAMETER :: a4_CHClBr2(4) = (/  4.7869E-22, -3.2833E-25,  7.3186E-29, -5.2321E-33 /)

    jval_2d(ip_CHClBr2)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_CHClBr2(0) = &
          p1(a0_1_1_CHClBr2(i0(j,k))*dlv2(j,k) + &
          a0_1_2_CHClBr2(i0(j,k)), &
          a0_2_1_CHClBr2(i0(j,k))*dlv2(j,k) + &
          a0_2_2_CHClBr2(i0(j,k)),v3_du1(j,k))
        sig_CHClBr2(1) = &
          (p1(b1_1_CHClBr2(i1(j,k)),a1_1_CHClBr2(i1(j,k)), &
          v3_du1(j,k)) + &
          p1(b1_2_CHClBr2(i1(j,k)),a1_2_CHClBr2(i1(j,k)), &
          v3_du1(j,k)) * v2s_m(j,k))
        sig_CHClBr2(2) = &
          p1(b2_CHClBr2(i2(j,k)), a2_CHClBr2(i2(j,k)), &
          v3_du1(j,k))
        sig_CHClBr2(3) = &
          p1(b3_CHClBr2(i3(j,k)), a3_CHClBr2(i3(j,k)), &
          v3_du2(j,k))
        sig_CHClBr2(4) = &
          p3(a4_CHClBr2(1),a4_CHClBr2(2),a4_CHClBr2(3), &
          a4_CHClBr2(4),v3_du2(j,k))
        dj = 0. &
          + sig_CHClBr2(0) * fint(j,k,0) &
          + sig_CHClBr2(1) * fint(j,k,1) &
          + sig_CHClBr2(2) * fint(j,k,2) &
          + sig_CHClBr2(3) * fint(j,k,3) &
          + sig_CHClBr2(4) * fint(j,k,4)

        jval_2d(ip_CHClBr2)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,7)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_CHClBr2

  ! **************************************************************************

  SUBROUTINE jval_cal_CH2ClBr

    ! CH_2ClBr \TOHV\ \products

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_CH2ClBr

    ! T-const parameters:
    REAL, PARAMETER :: a0_1_1_CH2ClBr(dim58) = (/ &
       1.8498E-20,  1.9871E-20,  2.1244E-20,  2.2609E-20,  2.3990E-20,  2.5308E-20, &
       2.6589E-20,  2.7820E-20,  2.8969E-20,  3.0083E-20,  3.1073E-20,  3.2055E-20, &
       3.6309E-20,  4.7535E-20,  4.5628E-20,  4.6958E-20,  5.1764E-20,  4.8709E-20, &
       4.9044E-20,  5.3021E-20,  4.7796E-20,  4.6156E-20,  4.8641E-20,  4.0504E-20, &
       3.6276E-20,  2.1266E-20,  1.1001E-20,  6.3490E-21,  2.4410E-21, -6.4763E-22, &
      -2.6661E-21, -3.5484E-21, -3.4782E-21, -2.2110E-21, -4.1962E-22,  1.8219E-21, &
       4.1783E-21,  6.3481E-21,  8.4068E-21,  1.0073E-20,  1.1380E-20,  1.2366E-20, &
       1.3215E-20,  1.3730E-20,  1.4118E-20,  1.4234E-20,  1.3995E-20,  1.3783E-20, &
       1.3170E-20,  1.2421E-20,  1.1636E-20,  1.0766E-20,  9.8736E-21,  8.9575E-21, &
       7.9227E-21,  6.9220E-21,  5.7218E-21,  4.7168E-21 /)
    REAL, PARAMETER :: a0_1_2_CH2ClBr(dim58) = (/ &
       1.8281E-19,  1.2212E-19,  6.1162E-20,  2.6813E-22, -6.1604E-20, -1.2092E-19, &
      -1.7882E-19, -2.3469E-19, -2.8711E-19, -3.3812E-19, -3.8365E-19, -4.2901E-19, &
      -6.2638E-19, -1.1496E-18, -1.0603E-18, -1.1228E-18, -1.3496E-18, -1.2048E-18, &
      -1.2208E-18, -1.4109E-18, -1.1601E-18, -1.0810E-18, -1.2013E-18, -8.0582E-19, &
      -5.9952E-19,  1.3598E-19,  6.4100E-19,  8.7082E-19,  1.0647E-18,  1.2185E-18, &
       1.3194E-18,  1.3637E-18,  1.3601E-18,  1.2960E-18,  1.2050E-18,  1.0907E-18, &
       9.7006E-19,  8.5853E-19,  7.5230E-19,  6.6601E-19,  5.9804E-19,  5.4654E-19, &
       5.0207E-19,  4.7499E-19,  4.5448E-19,  4.4835E-19,  4.6106E-19,  4.7239E-19, &
       5.0526E-19,  5.4554E-19,  5.8793E-19,  6.3508E-19,  6.8362E-19,  7.3364E-19, &
       7.9035E-19,  8.4539E-19,  9.1164E-19,  9.6732E-19 /)
    REAL, PARAMETER :: a0_2_1_CH2ClBr(dim58) = (/ &
       7.8444E-23,  8.7858E-23,  9.8385E-23,  1.1010E-22,  1.2271E-22,  1.3656E-22, &
       1.5178E-22,  1.6817E-22,  1.8614E-22,  2.0561E-22,  2.2711E-22,  2.5040E-22, &
       2.2573E-22,  1.0158E-22,  1.7426E-22,  1.9949E-22,  1.7824E-22,  2.5795E-22, &
       2.9016E-22,  2.7434E-22,  3.6193E-22,  3.9985E-22,  3.8621E-22,  4.7767E-22, &
       5.1661E-22,  6.5499E-22,  7.3217E-22,  7.4349E-22,  7.3885E-22,  7.1719E-22, &
       6.7696E-22,  6.1956E-22,  5.4757E-22,  4.6379E-22,  3.7579E-22,  2.8852E-22, &
       2.0809E-22,  1.3886E-22,  8.2477E-23,  4.0259E-23,  1.1799E-23, -4.8314E-24, &
      -1.4506E-23, -1.8198E-23, -2.0191E-23, -1.9991E-23, -1.9150E-23, -1.8906E-23, &
      -1.7349E-23, -1.5650E-23, -1.3972E-23, -1.2377E-23, -1.0733E-23, -9.3233E-24, &
      -7.4362E-24, -6.3031E-24, -4.6252E-24, -3.5879E-24 /)
    REAL, PARAMETER :: a0_2_2_CH2ClBr(dim58) = (/ &
      -5.9382E-21, -6.3543E-21, -6.8217E-21, -7.3440E-21, -7.9091E-21, -8.5322E-21, &
      -9.2202E-21, -9.9644E-21, -1.0784E-20, -1.1675E-20, -1.2665E-20, -1.3740E-20, &
      -1.2596E-20, -6.8107E-21, -1.0212E-20, -1.1398E-20, -1.0395E-20, -1.4173E-20, &
      -1.5706E-20, -1.4950E-20, -1.9154E-20, -2.0982E-20, -2.0322E-20, -2.4767E-20, &
      -2.6667E-20, -3.3448E-20, -3.7245E-20, -3.7804E-20, -3.7574E-20, -3.6495E-20, &
      -3.4484E-20, -3.1602E-20, -2.7974E-20, -2.3735E-20, -1.9264E-20, -1.4814E-20, &
      -1.0696E-20, -7.1372E-21, -4.2278E-21, -2.0409E-21, -5.6103E-22,  3.0706E-22, &
       8.1402E-22,  1.0082E-21,  1.1134E-21,  1.1028E-21,  1.0581E-21,  1.0451E-21, &
       9.6161E-22,  8.7020E-22,  7.7961E-22,  6.9314E-22,  6.0371E-22,  5.2674E-22, &
       4.2333E-22,  3.6100E-22,  2.6839E-22,  2.1092E-22 /)
    REAL, PARAMETER :: a1_1_CH2ClBr(dim55) = (/ &
       1.8379E-20,  1.7422E-20,  1.6597E-20,  1.5115E-20,  1.3843E-20,  1.2391E-20, &
       1.1116E-20,  9.9545E-21,  8.8739E-21,  8.0382E-21,  7.1700E-21,  6.5969E-21, &
       5.9079E-21,  5.5188E-21,  4.9663E-21,  4.7031E-21,  4.2461E-21,  4.0694E-21, &
       3.6844E-21,  3.5691E-21,  3.2341E-21,  3.1624E-21,  2.8676E-21,  2.8291E-21, &
       2.5659E-21,  2.5490E-21,  2.3093E-21,  2.3088E-21,  2.1008E-21,  2.1094E-21, &
       1.9103E-21,  1.9397E-21,  1.7576E-21,  1.7854E-21,  1.6183E-21,  1.6478E-21, &
       1.5035E-21,  1.5362E-21,  1.3907E-21,  1.4462E-21,  1.2528E-21,  1.0978E-21, &
       9.4366E-22,  8.5097E-22,  7.4962E-22,  6.8741E-22,  6.1019E-22,  5.7203E-22, &
       4.8308E-22,  4.4213E-22,  4.0874E-22,  3.7266E-22,  3.4425E-22,  3.1872E-22, &
       2.9156E-22 /)
    REAL, PARAMETER :: b1_1_CH2ClBr(dim55) = (/ &
       5.0970E-19,  5.1257E-19,  5.1711E-19,  5.2896E-19,  5.4232E-19,  5.6120E-19, &
       5.8096E-19,  6.0187E-19,  6.2402E-19,  6.4324E-19,  6.6538E-19,  6.8143E-19, &
       7.0244E-19,  7.1528E-19,  7.3489E-19,  7.4489E-19,  7.6340E-19,  7.7100E-19, &
       7.8852E-19,  7.9405E-19,  8.1097E-19,  8.1477E-19,  8.3113E-19,  8.3336E-19, &
       8.4929E-19,  8.5036E-19,  8.6606E-19,  8.6609E-19,  8.8075E-19,  8.8012E-19, &
       8.9516E-19,  8.9286E-19,  9.0752E-19,  9.0522E-19,  9.1950E-19,  9.1690E-19, &
       9.2997E-19,  9.2692E-19,  9.4082E-19,  9.3538E-19,  9.5482E-19,  9.7233E-19, &
       9.9168E-19,  1.0045E-18,  1.0197E-18,  1.0299E-18,  1.0434E-18,  1.0506E-18, &
       1.0684E-18,  1.0771E-18,  1.0847E-18,  1.0933E-18,  1.1004E-18,  1.1071E-18, &
       1.1146E-18 /)
    REAL, PARAMETER :: a1_2_CH2ClBr(dim55) = (/ &
      -2.8837E-23, -9.8289E-24, -4.8109E-24,  8.5765E-24,  1.2601E-23,  1.8756E-23, &
       2.0912E-23,  2.1763E-23,  2.2664E-23,  2.0693E-23,  2.1209E-23,  1.8159E-23, &
       1.8687E-23,  1.5456E-23,  1.6108E-23,  1.3055E-23,  1.3877E-23,  1.1081E-23, &
       1.2004E-23,  9.4664E-24,  1.0485E-23,  8.1798E-24,  9.2156E-24,  7.1149E-24, &
       8.1572E-24,  6.2564E-24,  7.2850E-24,  5.5444E-24,  6.4906E-24,  4.9236E-24, &
       5.8886E-24,  4.3764E-24,  5.2893E-24,  3.9472E-24,  4.8144E-24,  3.5901E-24, &
       4.3545E-24,  3.2367E-24,  4.0134E-24,  2.8871E-24,  3.0629E-24,  2.3441E-24, &
       2.0786E-24,  1.6427E-24,  1.4997E-24,  1.2209E-24,  1.1577E-24,  9.4356E-25, &
       1.0847E-24,  9.8240E-25,  8.9496E-25,  8.3442E-25,  7.7142E-25,  7.1529E-25, &
       6.7749E-25 /)
    REAL, PARAMETER :: b1_2_CH2ClBr(dim55) = (/ &
      -1.2392E-21, -1.2962E-21, -1.3238E-21, -1.4309E-21, -1.4731E-21, -1.5532E-21, &
      -1.5866E-21, -1.6019E-21, -1.6204E-21, -1.5750E-21, -1.5882E-21, -1.5028E-21, &
      -1.5189E-21, -1.4123E-21, -1.4354E-21, -1.3194E-21, -1.3527E-21, -1.2324E-21, &
      -1.2745E-21, -1.1527E-21, -1.2041E-21, -1.0819E-21, -1.1394E-21, -1.0176E-21, &
      -1.0806E-21, -9.6087E-22, -1.0282E-21, -9.0989E-22, -9.7659E-22, -8.6220E-22, &
      -9.3506E-22, -8.1711E-22, -8.9060E-22, -7.7920E-22, -8.5335E-22, -7.4561E-22, &
      -8.1478E-22, -7.1083E-22, -7.8501E-22, -6.7463E-22, -6.9230E-22, -6.1107E-22, &
      -5.7775E-22, -5.1760E-22, -4.9608E-22, -4.5063E-22, -4.3953E-22, -3.9928E-22, &
      -4.2758E-22, -4.0579E-22, -3.8608E-22, -3.7167E-22, -3.5588E-22, -3.4112E-22, &
      -3.3071E-22 /)
    REAL, PARAMETER :: a2_CH2ClBr(dim55) = (/ &
      -7.3132E-22, -6.1680E-22, -4.8548E-22, -3.6064E-22, -2.5600E-22, -1.7580E-22, &
      -1.1798E-22, -7.8132E-23, -5.1396E-23, -3.3804E-23, -2.2344E-23, -1.4920E-23, &
      -1.0108E-23, -6.9840E-24, -4.9320E-24, -3.5800E-24, -2.6720E-24, -2.0520E-24, &
      -1.6200E-24, -1.3160E-24, -1.0920E-24, -9.2800E-25, -7.9600E-25, -7.0000E-25, &
      -6.2000E-25, -5.5200E-25, -5.0000E-25, -4.4800E-25, -4.1200E-25, -3.7600E-25, &
      -3.4800E-25, -3.1600E-25, -2.9600E-25, -2.7200E-25, -2.5200E-25, -2.3200E-25, &
      -2.2000E-25, -2.0000E-25, -1.8800E-25, -1.7600E-25, -1.4400E-25, -1.0240E-25, &
      -7.4400E-26, -5.2800E-26, -3.9200E-26, -2.8000E-26, -2.0000E-26, -1.5200E-26, &
      -1.0400E-26, -8.0000E-27, -5.6000E-27, -4.0000E-27, -2.4000E-27, -2.4000E-27, &
      -1.6000E-27 /)
    REAL, PARAMETER :: b2_CH2ClBr(dim55) = (/ &
       7.9769E-21,  7.6333E-21,  6.9110E-21,  5.9123E-21,  4.8136E-21,  3.7710E-21, &
       2.8748E-21,  2.1575E-21,  1.6094E-21,  1.2048E-21,  9.1259E-22,  7.0472E-22, &
       5.5795E-22,  4.5486E-22,  3.8202E-22,  3.3064E-22,  2.9387E-22,  2.6721E-22, &
       2.4755E-22,  2.3296E-22,  2.2165E-22,  2.1295E-22,  2.0563E-22,  2.0006E-22, &
       1.9522E-22,  1.9094E-22,  1.8753E-22,  1.8399E-22,  1.8146E-22,  1.7883E-22, &
       1.7671E-22,  1.7422E-22,  1.7261E-22,  1.7062E-22,  1.6891E-22,  1.6715E-22, &
       1.6606E-22,  1.6420E-22,  1.6305E-22,  1.6188E-22,  1.5866E-22,  1.5396E-22, &
       1.5045E-22,  1.4747E-22,  1.4542E-22,  1.4359E-22,  1.4219E-22,  1.4129E-22, &
       1.4033E-22,  1.3981E-22,  1.3927E-22,  1.3889E-22,  1.3849E-22,  1.3849E-22, &
       1.3827E-22 /)

    jval_2d(ip_CH2ClBr)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_CH2ClBr(0) = &
          p1(a0_1_1_CH2ClBr(i0(j,k))*dlv2(j,k) + &
          a0_1_2_CH2ClBr(i0(j,k)), &
          a0_2_1_CH2ClBr(i0(j,k))*dlv2(j,k) + &
          a0_2_2_CH2ClBr(i0(j,k)),v3_du1(j,k))
        sig_CH2ClBr(1) = &
          (p1(b1_1_CH2ClBr(i1(j,k)),a1_1_CH2ClBr(i1(j,k)), &
          v3_du1(j,k)) + &
          p1(b1_2_CH2ClBr(i1(j,k)),a1_2_CH2ClBr(i1(j,k)), &
          v3_du1(j,k)) * v2s_m(j,k))
        sig_CH2ClBr(2) = &
          p1(b2_CH2ClBr(i2(j,k)), a2_CH2ClBr(i2(j,k)), &
          v3_du1(j,k))
        dj = 0. &
          + sig_CH2ClBr(0) * fint(j,k,0) &
          + sig_CH2ClBr(1) * fint(j,k,1) &
          + sig_CH2ClBr(2) * fint(j,k,2)

        jval_2d(ip_CH2ClBr)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,7)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_CH2ClBr

  ! **************************************************************************

  SUBROUTINE jval_cal_CH2Br2

    ! CH_2Br_2 \TOHV\ \products

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_CH2Br2

    ! T-const parameters:
    REAL, PARAMETER :: a0_1_1_CH2Br2(dim58) = (/ &
       4.2834E-21,  4.7128E-21,  5.2160E-21,  5.6365E-21,  6.1764E-21,  6.6479E-21, &
       7.3018E-21,  7.8339E-21,  8.4883E-21,  9.2983E-21,  9.9757E-21,  1.0688E-20, &
       1.3032E-20,  1.9048E-20,  1.8619E-20,  1.9713E-20,  2.2941E-20,  2.2230E-20, &
       2.3451E-20,  2.6912E-20,  2.5701E-20,  2.6547E-20,  2.9836E-20,  2.7385E-20, &
       2.7060E-20,  2.0098E-20,  1.5514E-20,  1.3764E-20,  1.2063E-20,  1.0836E-20, &
       9.8580E-21,  9.4432E-21,  9.6024E-21,  1.0058E-20,  1.0940E-20,  1.1764E-20, &
       1.2647E-20,  1.3347E-20,  1.3840E-20,  1.3803E-20,  1.3681E-20,  1.3082E-20, &
       1.2171E-20,  1.1091E-20,  9.7769E-21,  8.2863E-21,  6.7252E-21,  5.2382E-21, &
       3.7657E-21,  2.6262E-21,  1.4740E-21,  7.2829E-22,  4.8780E-23, -4.4457E-22, &
      -8.3344E-22, -1.0364E-21, -1.0761E-21, -9.2785E-22 /)
    REAL, PARAMETER :: a0_1_2_CH2Br2(dim58) = (/ &
       1.9277E-18,  1.9087E-18,  1.8864E-18,  1.8676E-18,  1.8434E-18,  1.8222E-18, &
       1.7927E-18,  1.7685E-18,  1.7387E-18,  1.7016E-18,  1.6704E-18,  1.6375E-18, &
       1.5287E-18,  1.2484E-18,  1.2685E-18,  1.2170E-18,  1.0647E-18,  1.0984E-18, &
       1.0402E-18,  8.7484E-19,  9.3295E-19,  8.9218E-19,  7.3297E-19,  8.5214E-19, &
       8.6797E-19,  1.2091E-18,  1.4346E-18,  1.5211E-18,  1.6055E-18,  1.6666E-18, &
       1.7155E-18,  1.7363E-18,  1.7283E-18,  1.7052E-18,  1.6604E-18,  1.6184E-18, &
       1.5732E-18,  1.5372E-18,  1.5117E-18,  1.5137E-18,  1.5200E-18,  1.5513E-18, &
       1.5990E-18,  1.6558E-18,  1.7252E-18,  1.8042E-18,  1.8873E-18,  1.9667E-18, &
       2.0456E-18,  2.1069E-18,  2.1691E-18,  2.2095E-18,  2.2465E-18,  2.2734E-18, &
       2.2948E-18,  2.3059E-18,  2.3081E-18,  2.2999E-18 /)
    REAL, PARAMETER :: a0_2_1_CH2Br2(dim58) = (/ &
      -4.0636E-24, -3.8294E-24, -4.2802E-24, -4.0750E-24, -3.9361E-24, -3.3651E-24, &
      -2.9590E-24, -1.0999E-24,  1.6414E-24,  3.7265E-24,  7.8699E-24,  1.2534E-23, &
      -5.8717E-24, -7.5178E-23, -4.7759E-23, -4.3096E-23, -6.3662E-23, -3.2168E-23, &
      -2.4038E-23, -4.0464E-23,  8.3736E-25,  1.9589E-23,  1.4916E-23,  7.2855E-23, &
       1.0665E-22,  2.0320E-22,  2.6973E-22,  2.9943E-22,  3.1901E-22,  3.2481E-22, &
       3.1678E-22,  2.9488E-22,  2.6080E-22,  2.1913E-22,  1.7257E-22,  1.2633E-22, &
       8.2705E-23,  4.5060E-23,  1.4522E-23, -6.8422E-24, -2.1127E-23, -2.8369E-23, &
      -3.0068E-23, -2.9139E-23, -2.6311E-23, -2.2661E-23, -1.8754E-23, -1.5495E-23, &
      -1.1351E-23, -8.5065E-24, -5.8628E-24, -4.1991E-24, -2.5824E-24, -1.5244E-24, &
      -5.0690E-25,  6.1570E-27,  2.9653E-25,  1.5247E-25 /)
    REAL, PARAMETER :: a0_2_2_CH2Br2(dim58) = (/ &
      -3.4419E-22, -3.5454E-22, -3.3452E-22, -3.4368E-22, -3.4990E-22, -3.7559E-22, &
      -3.9395E-22, -4.7835E-22, -6.0336E-22, -6.9885E-22, -8.8945E-22, -1.1049E-21, &
      -2.5091E-22,  2.9787E-21,  1.6956E-21,  1.4764E-21,  2.4471E-21,  9.5428E-22, &
       5.6732E-22,  1.3525E-21, -6.2999E-22, -1.5338E-21, -1.3077E-21, -4.1235E-21, &
      -5.7725E-21, -1.0504E-20, -1.3777E-20, -1.5244E-20, -1.6215E-20, -1.6504E-20, &
      -1.6102E-20, -1.5003E-20, -1.3286E-20, -1.1177E-20, -8.8118E-21, -6.4536E-21, &
      -4.2200E-21, -2.2850E-21, -7.0926E-22,  3.9739E-22,  1.1402E-21,  1.5183E-21, &
       1.6073E-21,  1.5584E-21,  1.4091E-21,  1.2156E-21,  1.0078E-21,  8.3375E-22, &
       6.1164E-22,  4.5859E-22,  3.1583E-22,  2.2566E-22,  1.3771E-22,  7.9943E-23, &
       2.4187E-23, -4.0318E-24, -2.0061E-23, -1.2079E-23 /)
    REAL, PARAMETER :: a1_1_CH2Br2(dim55) = (/ &
       3.6157E-20,  3.1275E-20,  2.5441E-20,  2.0645E-20,  1.5136E-20,  1.1656E-20, &
       7.3723E-21,  5.3644E-21,  2.3930E-21,  1.4372E-21, -5.1355E-22, -8.5225E-22, &
      -2.0930E-21, -2.0823E-21, -2.8959E-21, -2.7341E-21, -3.2314E-21, -3.0391E-21, &
      -3.3347E-21, -3.1287E-21, -3.2777E-21, -3.1109E-21, -3.1722E-21, -3.0124E-21, &
      -3.0218E-21, -2.8988E-21, -2.8471E-21, -2.7599E-21, -2.6687E-21, -2.6242E-21, &
      -2.5016E-21, -2.4708E-21, -2.3340E-21, -2.3274E-21, -2.1889E-21, -2.1849E-21, &
      -2.0416E-21, -2.0691E-21, -1.9061E-21, -1.9401E-21, -1.7112E-21, -1.4906E-21, &
      -1.2642E-21, -1.1192E-21, -9.5812E-22, -8.6528E-22, -7.4541E-22, -6.8739E-22, &
      -5.4486E-22, -4.8782E-22, -4.4185E-22, -4.0248E-22, -3.6097E-22, -3.2909E-22, &
      -3.0291E-22 /)
    REAL, PARAMETER :: b1_1_CH2Br2(dim55) = (/ &
       2.1604E-18,  2.1751E-18,  2.2072E-18,  2.2455E-18,  2.3034E-18,  2.3486E-18, &
       2.4150E-18,  2.4512E-18,  2.5121E-18,  2.5341E-18,  2.5838E-18,  2.5933E-18, &
       2.6311E-18,  2.6308E-18,  2.6597E-18,  2.6535E-18,  2.6736E-18,  2.6654E-18, &
       2.6788E-18,  2.6689E-18,  2.6765E-18,  2.6676E-18,  2.6710E-18,  2.6618E-18, &
       2.6623E-18,  2.6546E-18,  2.6512E-18,  2.6453E-18,  2.6388E-18,  2.6356E-18, &
       2.6263E-18,  2.6239E-18,  2.6129E-18,  2.6124E-18,  2.6005E-18,  2.6002E-18, &
       2.5872E-18,  2.5898E-18,  2.5742E-18,  2.5775E-18,  2.5545E-18,  2.5296E-18, &
       2.5012E-18,  2.4812E-18,  2.4569E-18,  2.4418E-18,  2.4208E-18,  2.4098E-18, &
       2.3813E-18,  2.3691E-18,  2.3588E-18,  2.3494E-18,  2.3390E-18,  2.3306E-18, &
       2.3234E-18 /)
    REAL, PARAMETER :: a1_2_CH2Br2(dim55) = (/ &
       5.6413E-23,  7.9603E-23,  1.0866E-22,  1.0672E-22,  1.2359E-22,  1.0331E-22, &
       1.1130E-22,  8.4106E-23,  8.7332E-23,  6.1780E-23,  6.3386E-23,  4.2840E-23, &
       4.3800E-23,  2.8308E-23,  2.9431E-23,  1.8125E-23,  1.9137E-23,  1.1324E-23, &
       1.2021E-23,  6.5067E-24,  6.9684E-24,  3.3485E-24,  3.5740E-24,  1.1718E-24, &
       1.1700E-24, -2.1901E-25, -5.4940E-25, -1.1859E-24, -1.7304E-24, -1.8190E-24, &
      -2.4431E-24, -2.2598E-24, -3.0414E-24, -2.5041E-24, -3.3065E-24, -2.6948E-24, &
      -3.5359E-24, -2.6985E-24, -3.6236E-24, -2.7318E-24, -3.2552E-24, -2.8571E-24, &
      -2.8028E-24, -2.3460E-24, -2.2639E-24, -1.8665E-24, -1.8110E-24, -1.4729E-24, &
      -1.7284E-24, -1.5499E-24, -1.3863E-24, -1.2389E-24, -1.1356E-24, -1.0316E-24, &
      -9.3165E-25 /)
    REAL, PARAMETER :: b1_2_CH2Br2(dim55) = (/ &
      -2.4811E-21, -2.5506E-21, -2.7104E-21, -2.6949E-21, -2.8721E-21, -2.6084E-21, &
      -2.7322E-21, -2.2428E-21, -2.3089E-21, -1.7213E-21, -1.7622E-21, -1.1869E-21, &
      -1.2162E-21, -7.0494E-22, -7.4484E-22, -3.1519E-22, -3.5620E-22, -2.0210E-23, &
      -5.1940E-23,  2.1275E-22,  1.8943E-22,  3.8129E-22,  3.6877E-22,  5.0810E-22, &
       5.0821E-22,  5.9572E-22,  6.1736E-22,  6.6064E-22,  6.9903E-22,  7.0550E-22, &
       7.5261E-22,  7.3832E-22,  8.0123E-22,  7.5664E-22,  8.2524E-22,  7.7142E-22, &
       8.4753E-22,  7.6965E-22,  8.5801E-22,  7.7061E-22,  8.2321E-22,  7.7822E-22, &
       7.7141E-22,  7.0837E-22,  6.9601E-22,  6.3124E-22,  6.2150E-22,  5.5795E-22, &
       6.0916E-22,  5.7114E-22,  5.3425E-22,  4.9917E-22,  4.7330E-22,  4.4595E-22, &
       4.1841E-22 /)
    REAL, PARAMETER :: a2_CH2Br2(dim55) = (/ &
      -4.2356E-21, -3.5724E-21, -2.8096E-21, -2.0836E-21, -1.4753E-21, -1.0091E-21, &
      -6.7388E-22, -4.4296E-22, -2.8864E-22, -1.8752E-22, -1.2200E-22, -7.9880E-23, &
      -5.2828E-23, -3.5448E-23, -2.4240E-23, -1.6952E-23, -1.2168E-23, -8.9880E-24, &
      -6.8400E-24, -5.3600E-24, -4.3200E-24, -3.5680E-24, -3.0120E-24, -2.5920E-24, &
      -2.2600E-24, -2.0000E-24, -1.7880E-24, -1.6080E-24, -1.4600E-24, -1.3280E-24, &
      -1.2160E-24, -1.1160E-24, -1.0280E-24, -9.4800E-25, -8.8000E-25, -8.1200E-25, &
      -7.5600E-25, -7.0400E-25, -6.5200E-25, -6.1200E-25, -4.9680E-25, -3.5440E-25, &
      -2.5520E-25, -1.8400E-25, -1.3360E-25, -9.6800E-26, -6.9600E-26, -5.1200E-26, &
      -3.6800E-26, -2.6400E-26, -1.9200E-26, -1.4400E-26, -1.0400E-26, -7.2000E-27, &
      -4.8000E-27 /)
    REAL, PARAMETER :: b2_CH2Br2(dim55) = (/ &
       4.5467E-20,  4.3477E-20,  3.9282E-20,  3.3474E-20,  2.7087E-20,  2.1026E-20, &
       1.5830E-20,  1.1673E-20,  8.5099E-21,  6.1842E-21,  4.5134E-21,  3.3340E-21, &
       2.5090E-21,  1.9354E-21,  1.5375E-21,  1.2606E-21,  1.0668E-21,  9.3009E-22, &
       8.3236E-22,  7.6132E-22,  7.0880E-22,  6.6894E-22,  6.3809E-22,  6.1373E-22, &
       5.9364E-22,  5.7726E-22,  5.6337E-22,  5.5113E-22,  5.4070E-22,  5.3106E-22, &
       5.2261E-22,  5.1481E-22,  5.0772E-22,  5.0108E-22,  4.9527E-22,  4.8929E-22, &
       4.8422E-22,  4.7938E-22,  4.7442E-22,  4.7050E-22,  4.5892E-22,  4.4283E-22, &
       4.3038E-22,  4.2055E-22,  4.1297E-22,  4.0697E-22,  4.0219E-22,  3.9874E-22, &
       3.9585E-22,  3.9363E-22,  3.9201E-22,  3.9087E-22,  3.8987E-22,  3.8902E-22, &
       3.8836E-22 /)
    REAL, PARAMETER :: a3_CH2Br2(dim55) = (/ &
      -5.7016E-25, -3.2929E-25, -1.6685E-25, -8.7029E-26, -4.9346E-26, -3.0149E-26, &
      -1.9434E-26, -1.3002E-26, -8.9355E-27, -6.2685E-27, -4.4673E-27, -3.2209E-27, &
      -2.3438E-27, -1.7176E-27, -1.2649E-27, -9.3581E-28, -6.9434E-28, -5.1649E-28, &
      -3.8562E-28, -2.8822E-28, -2.1545E-28, -1.6187E-28, -1.2158E-28, -9.1404E-29, &
      -6.8701E-29, -5.1839E-29, -3.9092E-29, -2.9498E-29, -2.2231E-29, -1.6820E-29, &
      -1.2707E-29, -9.6045E-30, -7.2462E-30, -5.4880E-30, -4.1485E-30, -3.1306E-30, &
      -2.3709E-30, -1.7920E-30, -1.3543E-30, -1.0219E-30, -4.7653E-31, -1.1684E-31, &
      -2.8487E-32, -6.9161E-33, -1.6714E-33, -4.0239E-34, -9.6658E-35, -2.3157E-35, &
      -5.5363E-36, -1.3226E-36, -3.1548E-37, -7.5166E-38, -1.7908E-38,  0.0000E+00, &
       0.0000E+00 /)
    REAL, PARAMETER :: b3_CH2Br2(dim55) = (/ &
       7.6074E-23,  6.1880E-23,  4.2818E-23,  2.8787E-23,  1.9961E-23,  1.4344E-23, &
       1.0582E-23,  7.9484E-24,  6.0454E-24,  4.6417E-24,  3.5884E-24,  2.7867E-24, &
       2.1713E-24,  1.6953E-24,  1.3249E-24,  1.0363E-24,  8.1041E-25,  6.3367E-25, &
       4.9597E-25,  3.8780E-25,  3.0273E-25,  2.3696E-25,  1.8515E-25,  1.4459E-25, &
       1.1274E-25,  8.8102E-26,  6.8733E-26,  5.3593E-26,  4.1700E-26,  3.2530E-26, &
       2.5319E-26,  1.9697E-26,  1.5287E-26,  1.1896E-26,  9.2347E-27,  7.1528E-27, &
       5.5544E-27,  4.3026E-27,  3.3306E-27,  2.5731E-27,  1.2983E-27,  3.5236E-28, &
       9.4220E-29,  2.4891E-29,  6.5031E-30,  1.6830E-30,  4.3249E-31,  1.1038E-31, &
       2.8005E-32,  7.0762E-33,  1.7801E-33,  4.4607E-34,  1.1150E-34,  2.7786E-35, &
       6.9051E-36 /)
    ! T-dep parameters:
    REAL, PARAMETER :: c0_1_1_CH2Br2(dim58) = (/ &
       1.5606E-03,  1.5606E-03,  1.5606E-03,  1.4545E-03,  1.9735E-03,  1.8665E-03, &
       2.4356E-03,  3.1069E-03,  3.5165E-03,  4.5491E-03,  4.9498E-03,  5.6627E-03, &
       6.5269E-03,  7.3838E-03,  8.0269E-03,  8.7701E-03,  9.3481E-03,  1.0131E-02, &
       1.0845E-02,  1.1764E-02,  1.2156E-02,  1.2280E-02,  1.2001E-02,  1.0993E-02, &
       9.2432E-03,  6.4927E-03,  2.7687E-03, -1.1560E-03, -4.5538E-03, -8.3453E-03, &
      -1.1509E-02, -1.2704E-02, -1.3656E-02, -1.2962E-02, -1.1266E-02, -1.0210E-02, &
      -8.3955E-03, -6.7867E-03, -5.6288E-03, -5.5109E-03, -5.2447E-03, -6.0537E-03, &
      -6.7700E-03, -8.2133E-03, -8.4390E-03, -8.9124E-03, -8.2157E-03, -7.5794E-03, &
      -5.9712E-03, -4.5120E-03, -3.9780E-03, -3.2013E-03, -1.6981E-03, -8.7357E-04, &
      -4.8928E-05,  1.3573E-03,  2.9110E-03,  3.6854E-03 /)
    REAL, PARAMETER :: c0_1_2_CH2Br2(dim58) = (/ &
      -6.6647E-02, -6.6647E-02, -6.6647E-02, -6.1914E-02, -8.5165E-02, -8.0348E-02, &
      -1.0607E-01, -1.3655E-01, -1.5523E-01, -2.0252E-01, -2.2095E-01, -2.5389E-01, &
      -2.9399E-01, -3.3392E-01, -3.6402E-01, -3.9895E-01, -4.2623E-01, -4.6333E-01, &
      -4.9733E-01, -5.4124E-01, -5.6009E-01, -5.6603E-01, -5.5253E-01, -5.0354E-01, &
      -4.1816E-01, -2.8339E-01, -1.0017E-01,  9.3715E-02,  2.6224E-01,  4.5106E-01, &
       6.0924E-01,  6.6923E-01,  7.1724E-01,  6.8209E-01,  5.9594E-01,  5.4211E-01, &
       4.4919E-01,  3.6649E-01,  3.0674E-01,  3.0064E-01,  2.8679E-01,  3.2902E-01, &
       3.6656E-01,  4.4248E-01,  4.5439E-01,  4.7948E-01,  4.4242E-01,  4.0844E-01, &
       3.2224E-01,  2.4373E-01,  2.1490E-01,  1.7280E-01,  9.1027E-02,  4.6009E-02, &
       8.1846E-04, -7.6526E-02, -1.6229E-01, -2.0519E-01 /)
    REAL, PARAMETER :: c0_2_1_CH2Br2(dim58) = (/ &
       6.4270E-04,  6.4270E-04,  6.4270E-04,  3.2131E-03,  3.1834E-04,  2.5648E-03, &
       1.4381E-03, -5.1359E-03,  5.7608E-03,  2.5510E-03,  4.7807E-03, -1.9334E-05, &
       5.5601E-03,  3.1545E-03,  3.3011E-03,  2.1772E-03,  5.6515E-03,  3.0978E-03, &
       1.6579E-03,  2.1199E-03,  5.4056E-03, -5.8727E-04, -1.2173E-03, -5.5869E-03, &
      -7.8969E-03, -6.4589E-03, -1.4000E-02, -1.4840E-02, -1.6901E-02, -1.1745E-02, &
      -9.6925E-03, -6.2933E-03, -2.4670E-03,  5.6479E-04,  1.3108E-03,  1.8986E-03, &
       3.6943E-03,  4.5786E-03,  1.7018E-03, -7.0895E-04, -2.9628E-03, -7.1338E-04, &
      -5.3568E-03, -2.9573E-03,  1.3797E-03, -2.2158E-03,  6.4454E-03,  2.1061E-03, &
       4.3404E-03,  3.7376E-03,  2.3911E-03, -8.9420E-04,  5.5211E-03,  6.8650E-03, &
       2.2383E-03,  5.9697E-03,  1.1937E-03,  3.5806E-03 /)
    REAL, PARAMETER :: c0_2_2_CH2Br2(dim58) = (/ &
      -2.8375E-02, -2.8375E-02, -2.8375E-02, -1.4302E-01, -1.3329E-02, -1.1442E-01, &
      -6.3494E-02,  2.3496E-01, -2.6192E-01, -1.1492E-01, -2.1748E-01,  4.2812E-03, &
      -2.5461E-01, -1.4250E-01, -1.4937E-01, -9.6540E-02, -2.6053E-01, -1.3948E-01, &
      -7.0945E-02, -9.3027E-02, -2.5074E-01,  3.8116E-02,  6.8607E-02,  2.8097E-01, &
       3.9370E-01,  3.2324E-01,  6.9424E-01,  7.3574E-01,  8.3797E-01,  5.8120E-01, &
       4.7859E-01,  3.0795E-01,  1.1510E-01, -3.8306E-02, -7.6204E-02, -1.0618E-01, &
      -1.9812E-01, -2.4358E-01, -9.5130E-02,  2.9745E-02,  1.4695E-01,  2.9526E-02, &
       2.7284E-01,  1.4663E-01, -8.2369E-02,  1.0820E-01, -3.5258E-01, -1.2086E-01, &
      -2.4062E-01, -2.0819E-01, -1.3548E-01,  4.2585E-02, -3.0641E-01, -3.7978E-01, &
      -1.2624E-01, -3.3147E-01, -6.7832E-02, -2.0007E-01 /)
    REAL, PARAMETER :: c1_CH2Br2(3) = (/  1.0000E+00, -6.4582E-02,  1.8965E-02 /)
    REAL, PARAMETER :: c2_CH2Br2(3) = (/  9.9762E-01,  2.5823E+00,  3.9790E+00 /)
    REAL, PARAMETER :: c3_CH2Br2(3) = (/  9.8031E-01,  5.6247E+00,  1.3146E+01 /)

    jval_2d(ip_CH2Br2)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_CH2Br2(0) = &
          p2(1.,c0_1_1_CH2Br2(i0(j,k))*dlv2(j,k) + &
          c0_1_2_CH2Br2(i0(j,k)), &
          c0_2_1_CH2Br2(i0(j,k))*dlv2(j,k) + &
          c0_2_2_CH2Br2(i0(j,k)), tnorm_sr(j,k)) * &
          p1(a0_1_1_CH2Br2(i0(j,k))*dlv2(j,k) + &
          a0_1_2_CH2Br2(i0(j,k)), &
          a0_2_1_CH2Br2(i0(j,k))*dlv2(j,k) + &
          a0_2_2_CH2Br2(i0(j,k)),v3_du1(j,k))
        sig_CH2Br2(1) = &
          p2(c1_CH2Br2(1),c1_CH2Br2(2), &
          c1_CH2Br2(3),tnorm(j,k)) * &
          (p1(b1_1_CH2Br2(i1(j,k)),a1_1_CH2Br2(i1(j,k)), &
          v3_du1(j,k)) + &
          p1(b1_2_CH2Br2(i1(j,k)),a1_2_CH2Br2(i1(j,k)), &
          v3_du1(j,k)) * v2s_m(j,k))
        sig_CH2Br2(2) = &
          p2(c2_CH2Br2(1),c2_CH2Br2(2),c2_CH2Br2(3),tnorm(j,k))* &
          p1(b2_CH2Br2(i2(j,k)), a2_CH2Br2(i2(j,k)), &
          v3_du1(j,k))
        sig_CH2Br2(3) = &
          p2(c3_CH2Br2(1),c3_CH2Br2(2),c3_CH2Br2(3),tnorm(j,k))* &
          p1(b3_CH2Br2(i3(j,k)), a3_CH2Br2(i3(j,k)), &
          v3_du2(j,k))
        dj = 0. &
          + sig_CH2Br2(0) * fint(j,k,0) &
          + sig_CH2Br2(1) * fint(j,k,1) &
          + sig_CH2Br2(2) * fint(j,k,2) &
          + sig_CH2Br2(3) * fint(j,k,3)

        jval_2d(ip_CH2Br2)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,7)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_CH2Br2

  ! **************************************************************************

  SUBROUTINE jval_cal_CHBr3

    ! CHBr_3 \TOHV\ \products

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_CHBr3

    ! T-const parameters:
    REAL, PARAMETER :: a0_1_1_CHBr3(dim58) = (/ &
      -5.4997E-20, -5.8715E-20, -6.2729E-20, -6.6404E-20, -7.0227E-20, -7.3780E-20, &
      -7.7239E-20, -8.0250E-20, -8.3026E-20, -8.5582E-20, -8.7752E-20, -8.9614E-20, &
      -9.9206E-20, -1.2548E-19, -1.1937E-19, -1.2070E-19, -1.2990E-19, -1.2038E-19, &
      -1.1810E-19, -1.2382E-19, -1.0861E-19, -1.0081E-19, -1.0168E-19, -8.0018E-20, &
      -6.7350E-20, -3.2926E-20, -9.7506E-21,  1.5995E-21,  1.1321E-20,  1.9173E-20, &
       2.4940E-20,  2.8476E-20,  3.0085E-20,  2.9962E-20,  2.8751E-20,  2.6873E-20, &
       2.5203E-20,  2.4012E-20,  2.3566E-20,  2.4179E-20,  2.5461E-20,  2.8084E-20, &
       3.0606E-20,  3.3540E-20,  3.6369E-20,  3.8658E-20,  4.0200E-20,  4.1050E-20, &
       4.1175E-20,  4.0408E-20,  3.9174E-20,  3.7440E-20,  3.5513E-20,  3.2950E-20, &
       3.0147E-20,  2.6753E-20,  2.2721E-20,  1.8950E-20 /)
    REAL, PARAMETER :: a0_1_2_CHBr3(dim58) = (/ &
       6.8216E-18,  6.9860E-18,  7.1642E-18,  7.3281E-18,  7.4994E-18,  7.6592E-18, &
       7.8156E-18,  7.9523E-18,  8.0789E-18,  8.1959E-18,  8.2958E-18,  8.3818E-18, &
       8.8268E-18,  1.0051E-17,  9.7651E-18,  9.8277E-18,  1.0262E-17,  9.8106E-18, &
       9.7023E-18,  9.9757E-18,  9.2458E-18,  8.8697E-18,  8.9116E-18,  7.8590E-18, &
       7.2407E-18,  5.5540E-18,  4.4137E-18,  3.8531E-18,  3.3709E-18,  2.9799E-18, &
       2.6915E-18,  2.5140E-18,  2.4329E-18,  2.4391E-18,  2.5006E-18,  2.5964E-18, &
       2.6819E-18,  2.7431E-18,  2.7661E-18,  2.7344E-18,  2.6677E-18,  2.5308E-18, &
       2.3986E-18,  2.2443E-18,  2.0949E-18,  1.9736E-18,  1.8916E-18,  1.8462E-18, &
       1.8395E-18,  1.8808E-18,  1.9474E-18,  2.0414E-18,  2.1462E-18,  2.2862E-18, &
       2.4398E-18,  2.6264E-18,  2.8490E-18,  3.0579E-18 /)
    REAL, PARAMETER :: a0_2_1_CHBr3(dim58) = (/ &
      -2.7180E-22, -3.0181E-22, -3.3330E-22, -3.7036E-22, -4.0911E-22, -4.5177E-22, &
      -4.9579E-22, -5.4550E-22, -5.9725E-22, -6.5247E-22, -7.1165E-22, -7.7600E-22, &
      -7.2406E-22, -4.3332E-22, -6.2253E-22, -6.9642E-22, -6.6115E-22, -8.5815E-22, &
      -9.4290E-22, -9.1355E-22, -1.1078E-21, -1.1832E-21, -1.1392E-21, -1.3063E-21, &
      -1.3495E-21, -1.5842E-21, -1.6808E-21, -1.6439E-21, -1.5797E-21, -1.4884E-21, &
      -1.3703E-21, -1.2269E-21, -1.0629E-21, -8.8625E-22, -7.0817E-22, -5.3781E-22, &
      -3.8730E-22, -2.6229E-22, -1.6590E-22, -9.8904E-23, -5.6274E-23, -3.7231E-23, &
      -2.9192E-23, -3.0109E-23, -3.4476E-23, -3.8315E-23, -4.1115E-23, -4.2598E-23, &
      -4.3132E-23, -4.1439E-23, -3.9730E-23, -3.6318E-23, -3.4109E-23, -2.9665E-23, &
      -2.6096E-23, -2.1392E-23, -1.7101E-23, -1.4008E-23 /)
    REAL, PARAMETER :: a0_2_2_CHBr3(dim58) = (/ &
       1.8639E-20,  1.9965E-20,  2.1363E-20,  2.3016E-20,  2.4752E-20,  2.6672E-20, &
       2.8661E-20,  3.0918E-20,  3.3278E-20,  3.5807E-20,  3.8529E-20,  4.1502E-20, &
       3.9092E-20,  2.5544E-20,  3.4399E-20,  3.7871E-20,  3.6207E-20,  4.5545E-20, &
       4.9579E-20,  4.8176E-20,  5.7498E-20,  6.1133E-20,  5.9002E-20,  6.7124E-20, &
       6.9235E-20,  8.0734E-20,  8.5489E-20,  8.3666E-20,  8.0479E-20,  7.5933E-20, &
       7.0029E-20,  6.2828E-20,  5.4566E-20,  4.5625E-20,  3.6578E-20,  2.7890E-20, &
       2.0184E-20,  1.3758E-20,  8.7848E-21,  5.3145E-21,  3.0977E-21,  2.1037E-21, &
       1.6824E-21,  1.7306E-21,  1.9612E-21,  2.1647E-21,  2.3137E-21,  2.3928E-21, &
       2.4215E-21,  2.3304E-21,  2.2381E-21,  2.0532E-21,  1.9330E-21,  1.6904E-21, &
       1.4948E-21,  1.2361E-21,  9.9918E-22,  8.2782E-22 /)
    REAL, PARAMETER :: a1_1_CHBr3(dim55) = (/ &
       5.2272E-20,  4.4762E-20,  3.5646E-20,  2.8425E-20,  1.9865E-20,  1.4738E-20, &
       8.1984E-21,  5.3090E-21,  8.7207E-22, -4.5160E-22, -3.2861E-21, -3.6324E-21, &
      -5.4220E-21, -5.2707E-21, -6.3585E-21, -6.0421E-21, -6.6363E-21, -6.2658E-21, &
      -6.5691E-21, -6.2268E-21, -6.3303E-21, -6.0125E-21, -6.0135E-21, -5.7346E-21, &
      -5.6442E-21, -5.4469E-21, -5.2704E-21, -5.1265E-21, -4.9225E-21, -4.8121E-21, &
      -4.5732E-21, -4.5400E-21, -4.2599E-21, -4.2524E-21, -3.9719E-21, -3.9900E-21, &
      -3.7054E-21, -3.7490E-21, -3.4589E-21, -3.5237E-21, -3.1171E-21, -2.7167E-21, &
      -2.3234E-21, -2.0747E-21, -1.7880E-21, -1.6316E-21, -1.4141E-21, -1.3094E-21, &
      -1.0596E-21, -9.5445E-22, -8.6098E-22, -7.7926E-22, -7.0842E-22, -6.4339E-22, &
      -5.8755E-22 /)
    REAL, PARAMETER :: b1_1_CHBr3(dim55) = (/ &
       4.5986E-18,  4.6211E-18,  4.6713E-18,  4.7290E-18,  4.8189E-18,  4.8856E-18, &
       4.9869E-18,  5.0389E-18,  5.1299E-18,  5.1603E-18,  5.2326E-18,  5.2423E-18, &
       5.2969E-18,  5.2919E-18,  5.3305E-18,  5.3185E-18,  5.3426E-18,  5.3266E-18, &
       5.3404E-18,  5.3240E-18,  5.3292E-18,  5.3124E-18,  5.3124E-18,  5.2963E-18, &
       5.2908E-18,  5.2784E-18,  5.2668E-18,  5.2570E-18,  5.2426E-18,  5.2346E-18, &
       5.2165E-18,  5.2139E-18,  5.1914E-18,  5.1908E-18,  5.1668E-18,  5.1684E-18, &
       5.1426E-18,  5.1467E-18,  5.1190E-18,  5.1253E-18,  5.0845E-18,  5.0392E-18, &
       4.9899E-18,  4.9555E-18,  4.9124E-18,  4.8869E-18,  4.8487E-18,  4.8290E-18, &
       4.7790E-18,  4.7566E-18,  4.7355E-18,  4.7160E-18,  4.6983E-18,  4.6812E-18, &
       4.6658E-18 /)
    REAL, PARAMETER :: a1_2_CHBr3(dim55) = (/ &
       9.8328E-23,  1.3020E-22,  1.7669E-22,  1.6924E-22,  1.9664E-22,  1.6154E-22, &
       1.7391E-22,  1.2973E-22,  1.3416E-22,  9.3774E-23,  9.5643E-23,  6.3060E-23, &
       6.4553E-23,  4.0344E-23,  4.1579E-23,  2.4709E-23,  2.5482E-23,  1.3850E-23, &
       1.4491E-23,  6.8249E-24,  6.9745E-24,  2.0088E-24,  1.9584E-24, -1.0129E-24, &
      -1.5133E-24, -2.9360E-24, -3.7905E-24, -4.2145E-24, -5.1670E-24, -5.0046E-24, &
      -6.2738E-24, -5.2189E-24, -6.7925E-24, -5.4865E-24, -7.0476E-24, -5.5116E-24, &
      -7.1648E-24, -5.4329E-24, -7.1291E-24, -5.3448E-24, -6.0858E-24, -5.2097E-24, &
      -4.9761E-24, -4.1106E-24, -3.9567E-24, -3.2300E-24, -3.1599E-24, -2.5879E-24, &
      -3.0361E-24, -2.7443E-24, -2.4934E-24, -2.2805E-24, -2.0802E-24, -1.9142E-24, &
      -1.7536E-24 /)
    REAL, PARAMETER :: b1_2_CHBr3(dim55) = (/ &
      -3.5895E-21, -3.6851E-21, -3.9408E-21, -3.8812E-21, -4.1689E-21, -3.7126E-21, &
      -3.9044E-21, -3.1091E-21, -3.2000E-21, -2.2710E-21, -2.3187E-21, -1.4064E-21, &
      -1.4519E-21, -6.5300E-22, -6.9682E-22, -5.5796E-23, -8.7085E-23,  4.1310E-22, &
       3.8391E-22,  7.5190E-22,  7.4435E-22,  1.0075E-21,  1.0103E-21,  1.1827E-21, &
       1.2129E-21,  1.3026E-21,  1.3585E-21,  1.3874E-21,  1.4545E-21,  1.4427E-21, &
       1.5385E-21,  1.4562E-21,  1.5829E-21,  1.4745E-21,  1.6080E-21,  1.4728E-21, &
       1.6224E-21,  1.4613E-21,  1.6233E-21,  1.4485E-21,  1.5229E-21,  1.4239E-21, &
       1.3946E-21,  1.2752E-21,  1.2520E-21,  1.1336E-21,  1.1213E-21,  1.0137E-21, &
       1.1036E-21,  1.0414E-21,  9.8486E-22,  9.3419E-22,  8.8402E-22,  8.4036E-22, &
       7.9611E-22 /)
    REAL, PARAMETER :: a2_CHBr3(dim55) = (/ &
      -3.3236E-20, -2.8260E-20, -2.2528E-20, -1.7032E-20, -1.2376E-20, -8.7596E-21, &
      -6.1120E-21, -4.2460E-21, -2.9620E-21, -2.0896E-21, -1.4984E-21, -1.0968E-21, &
      -8.2200E-22, -6.3120E-22, -4.9640E-22, -4.0000E-22, -3.2920E-22, -2.7600E-22, &
      -2.3560E-22, -2.0360E-22, -1.7880E-22, -1.5800E-22, -1.4120E-22, -1.2680E-22, &
      -1.1520E-22, -1.0440E-22, -9.5600E-23, -8.7600E-23, -8.0400E-23, -7.4400E-23, &
      -6.8400E-23, -6.3600E-23, -5.9200E-23, -5.4800E-23, -5.0800E-23, -4.7600E-23, &
      -4.4400E-23, -4.1200E-23, -3.8400E-23, -3.6000E-23, -2.9600E-23, -2.1200E-23, &
      -1.5360E-23, -1.1120E-23, -8.0800E-24, -5.8400E-24, -4.2400E-24, -3.1200E-24, &
      -2.2400E-24, -1.6000E-24, -1.1200E-24, -8.8000E-25, -6.4000E-25, -4.0000E-25, &
      -3.2000E-25 /)
    REAL, PARAMETER :: b2_CHBr3(dim55) = (/ &
       4.1998E-19,  4.0505E-19,  3.7352E-19,  3.2956E-19,  2.8067E-19,  2.3365E-19, &
       1.9262E-19,  1.5903E-19,  1.3271E-19,  1.1264E-19,  9.7566E-20,  8.6321E-20, &
       7.7940E-20,  7.1644E-20,  6.6858E-20,  6.3195E-20,  6.0328E-20,  5.8040E-20, &
       5.6202E-20,  5.4666E-20,  5.3413E-20,  5.2311E-20,  5.1379E-20,  5.0543E-20, &
       4.9842E-20,  4.9161E-20,  4.8585E-20,  4.8041E-20,  4.7533E-20,  4.7095E-20, &
       4.6642E-20,  4.6268E-20,  4.5914E-20,  4.5548E-20,  4.5206E-20,  4.4925E-20, &
       4.4635E-20,  4.4338E-20,  4.4070E-20,  4.3835E-20,  4.3192E-20,  4.2243E-20, &
       4.1510E-20,  4.0925E-20,  4.0467E-20,  4.0102E-20,  3.9821E-20,  3.9611E-20, &
       3.9434E-20,  3.9298E-20,  3.9190E-20,  3.9132E-20,  3.9072E-20,  3.9009E-20, &
       3.8987E-20 /)
    REAL, PARAMETER :: a3_CHBr3(dim55) = (/ &
      -3.8496E-23, -2.1906E-23, -1.1034E-23, -5.8583E-24, -3.4937E-24, -2.3173E-24, &
      -1.6635E-24, -1.2633E-24, -1.0012E-24, -8.1636E-25, -6.8299E-25, -5.8360E-25, &
      -5.0317E-25, -4.3992E-25, -3.8850E-25, -3.4577E-25, -3.0977E-25, -2.7887E-25, &
      -2.5342E-25, -2.3116E-25, -2.1026E-25, -1.9178E-25, -1.7808E-25, -1.6438E-25, &
      -1.5043E-25, -1.4041E-25, -1.3185E-25, -1.2158E-25, -1.1282E-25, -1.0616E-25, &
      -9.7603E-26, -9.2466E-26, -8.7179E-26, -8.2192E-26, -7.5342E-26, -7.1795E-26, &
      -6.8493E-26, -6.3356E-26, -5.9932E-26, -5.6410E-26, -4.7586E-26, -3.5947E-26, &
      -2.7379E-26, -2.0883E-26, -1.6090E-26, -1.2320E-26, -9.5858E-27, -7.5317E-27, &
      -6.1602E-27, -4.4505E-27, -3.4235E-27, -3.0801E-27, -2.0541E-27, -1.7117E-27, &
      -1.3689E-27 /)
    REAL, PARAMETER :: b3_CHBr3(dim55) = (/ &
       7.5942E-21,  6.6166E-21,  5.3408E-21,  4.4311E-21,  3.8773E-21,  3.5330E-21, &
       3.3035E-21,  3.1396E-21,  3.0170E-21,  2.9197E-21,  2.8417E-21,  2.7778E-21, &
       2.7213E-21,  2.6733E-21,  2.6312E-21,  2.5937E-21,  2.5600E-21,  2.5293E-21, &
       2.5026E-21,  2.4778E-21,  2.4534E-21,  2.4307E-21,  2.4131E-21,  2.3947E-21, &
       2.3751E-21,  2.3605E-21,  2.3475E-21,  2.3312E-21,  2.3169E-21,  2.3056E-21, &
       2.2906E-21,  2.2813E-21,  2.2714E-21,  2.2618E-21,  2.2482E-21,  2.2409E-21, &
       2.2340E-21,  2.2229E-21,  2.2153E-21,  2.2073E-21,  2.1866E-21,  2.1560E-21, &
       2.1310E-21,  2.1101E-21,  2.0933E-21,  2.0790E-21,  2.0678E-21,  2.0588E-21, &
       2.0524E-21,  2.0439E-21,  2.0385E-21,  2.0366E-21,  2.0306E-21,  2.0285E-21, &
       2.0263E-21 /)
    REAL, PARAMETER :: a4_CHBr3(4) = (/  1.0147E-21, -2.4339E-25,  5.1459E-29, -3.6245E-33 /)
    REAL, PARAMETER :: a5_CHBr3(4) = (/  1.2354E-22, -4.0837E-26,  7.4044E-30, -4.7991E-34 /)
    REAL, PARAMETER :: a6_CHBr3(4) = (/  7.2595E-25, -1.5761E-29,  2.0156E-34,  0.0000E+00 /)
    REAL, PARAMETER :: a7_CHBr3(4) = (/  5.6100E-31,  3.5786E-35,  0.0000E+00,  0.0000E+00 /)
    ! T-dep parameters:
    REAL, PARAMETER :: c0_1_1_CHBr3(dim58) = (/ &
      -1.4526E-02, -1.4526E-02, -1.4526E-02, -1.6672E-02, -1.8979E-02, -2.1093E-02, &
      -2.2698E-02, -2.3952E-02, -2.4792E-02, -2.5393E-02, -2.4798E-02, -2.4567E-02, &
      -2.3994E-02, -2.2491E-02, -2.1166E-02, -1.9736E-02, -1.8038E-02, -1.5479E-02, &
      -1.2553E-02, -9.2131E-03, -4.7299E-03,  9.3376E-04,  6.9062E-03,  1.3987E-02, &
       2.1161E-02,  2.8057E-02,  3.4051E-02,  3.8930E-02,  4.2307E-02,  4.3554E-02, &
       4.3606E-02,  4.2117E-02,  3.9275E-02,  3.6176E-02,  3.2740E-02,  2.9130E-02, &
       2.6178E-02,  2.3813E-02,  2.1154E-02,  1.9142E-02,  1.7258E-02,  1.4995E-02, &
       1.3008E-02,  9.8315E-03,  7.2365E-03,  4.4967E-03,  1.9633E-03, -3.6979E-04, &
      -2.0026E-03, -3.6794E-03, -5.8764E-03, -8.9469E-03, -1.3223E-02, -1.8389E-02, &
      -2.2921E-02, -2.7366E-02, -3.1486E-02, -3.7243E-02 /)
    REAL, PARAMETER :: c0_1_2_CHBr3(dim58) = (/ &
       6.2878E-01,  6.2878E-01,  6.2878E-01,  7.2448E-01,  8.2785E-01,  9.2300E-01, &
       9.9555E-01,  1.0525E+00,  1.0908E+00,  1.1183E+00,  1.0909E+00,  1.0803E+00, &
       1.0537E+00,  9.8362E-01,  9.2162E-01,  8.5442E-01,  7.7425E-01,  6.5297E-01, &
       5.1368E-01,  3.5404E-01,  1.3885E-01, -1.3414E-01, -4.2321E-01, -7.6733E-01, &
      -1.1174E+00, -1.4553E+00, -1.7502E+00, -1.9913E+00, -2.1587E+00, -2.2208E+00, &
      -2.2234E+00, -2.1487E+00, -2.0055E+00, -1.8487E+00, -1.6741E+00, -1.4900E+00, &
      -1.3389E+00, -1.2173E+00, -1.0801E+00, -9.7589E-01, -8.7789E-01, -7.5977E-01, &
      -6.5565E-01, -4.8857E-01, -3.5156E-01, -2.0635E-01, -7.1575E-02,  5.3014E-02, &
       1.4053E-01,  2.3075E-01,  3.4938E-01,  5.1580E-01,  7.4845E-01,  1.0305E+00, &
       1.2788E+00,  1.5233E+00,  1.7507E+00,  2.0697E+00 /)
    REAL, PARAMETER :: c0_2_1_CHBr3(dim58) = (/ &
      -3.9343E-03, -3.9343E-03, -3.9343E-03, -7.0651E-03, -6.4982E-03, -7.9135E-03, &
      -7.0736E-03, -7.4463E-03, -6.6036E-03, -5.1755E-03, -3.3580E-03,  2.4556E-04, &
       1.8565E-03,  5.3553E-03,  6.6869E-03,  1.2958E-02,  1.4815E-02,  1.6423E-02, &
       2.2091E-02,  2.6340E-02,  2.6763E-02,  3.1611E-02,  3.2812E-02,  3.3331E-02, &
       2.9616E-02,  2.5354E-02,  1.7524E-02,  1.0663E-02, -2.6105E-03, -9.0995E-03, &
      -1.4555E-02, -2.1552E-02, -1.8672E-02, -1.9600E-02, -1.8479E-02, -1.5211E-02, &
      -1.0991E-02, -1.0189E-02, -1.0210E-02, -8.2081E-03, -7.6225E-03, -7.1985E-03, &
      -7.2720E-03, -7.6759E-03, -1.0320E-02, -8.6290E-03, -9.8382E-03, -9.6423E-03, &
      -1.0017E-02, -9.8961E-03, -7.1458E-03, -2.8470E-03,  3.8898E-03,  1.1087E-02, &
       2.0138E-02,  2.0251E-02,  1.4334E-02,  9.3550E-04 /)
    REAL, PARAMETER :: c0_2_2_CHBr3(dim58) = (/ &
       1.7024E-01,  1.7024E-01,  1.7024E-01,  3.0988E-01,  2.8448E-01,  3.4817E-01, &
       3.1020E-01,  3.2712E-01,  2.8870E-01,  2.2329E-01,  1.3969E-01, -2.6798E-02, &
      -1.0154E-01, -2.6459E-01, -3.2691E-01, -6.2164E-01, -7.0932E-01, -7.8553E-01, &
      -1.0553E+00, -1.2584E+00, -1.2787E+00, -1.5124E+00, -1.5705E+00, -1.5958E+00, &
      -1.4145E+00, -1.2056E+00, -8.2037E-01, -4.8147E-01,  1.7692E-01,  5.0007E-01, &
       7.7285E-01,  1.1241E+00,  9.7893E-01,  1.0259E+00,  9.6897E-01,  8.0227E-01, &
       5.8622E-01,  5.4498E-01,  5.4610E-01,  4.4238E-01,  4.1193E-01,  3.8980E-01, &
       3.9365E-01,  4.1489E-01,  5.5449E-01,  4.6488E-01,  5.2921E-01,  5.1875E-01, &
       5.3885E-01,  5.3233E-01,  3.8381E-01,  1.5082E-01, -2.1566E-01, -6.0863E-01, &
      -1.1046E+00, -1.1108E+00, -7.8422E-01, -4.1948E-02 /)
    REAL, PARAMETER :: c1_CHBr3(3) = (/  1.0000E+00, -2.2115E-03,  3.7904E-05 /)
    REAL, PARAMETER :: c2_CHBr3(3) = (/  1.0000E+00,  2.2056E-02,  1.5193E-03 /)
    REAL, PARAMETER :: c3_CHBr3(3) = (/  1.0210E+00,  2.4910E+00,  2.9514E+00 /)
    REAL, PARAMETER :: c4_CHBr3(3) = (/  1.0280E+00,  2.8933E+00,  3.7330E+00 /)
    REAL, PARAMETER :: c5_CHBr3(3) = (/  1.0442E+00,  3.7713E+00,  5.6843E+00 /)
    REAL, PARAMETER :: c6_CHBr3(3) = (/  1.0799E+00,  5.2425E+00,  9.4885E+00 /)
    REAL, PARAMETER :: c7_CHBr3(3) = (/  1.3197E+00,  1.5794E+01,  4.5173E+01 /)

    jval_2d(ip_CHBr3)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_CHBr3(0) = &
          p2(1.,c0_1_1_CHBr3(i0(j,k))*dlv2(j,k) + &
          c0_1_2_CHBr3(i0(j,k)), &
          c0_2_1_CHBr3(i0(j,k))*dlv2(j,k) + &
          c0_2_2_CHBr3(i0(j,k)), tnorm_sr(j,k)) * &
          p1(a0_1_1_CHBr3(i0(j,k))*dlv2(j,k) + &
          a0_1_2_CHBr3(i0(j,k)), &
          a0_2_1_CHBr3(i0(j,k))*dlv2(j,k) + &
          a0_2_2_CHBr3(i0(j,k)),v3_du1(j,k))
        sig_CHBr3(1) = &
          p2(c1_CHBr3(1),c1_CHBr3(2), &
          c1_CHBr3(3),tnorm(j,k)) * &
          (p1(b1_1_CHBr3(i1(j,k)),a1_1_CHBr3(i1(j,k)), &
          v3_du1(j,k)) + &
          p1(b1_2_CHBr3(i1(j,k)),a1_2_CHBr3(i1(j,k)), &
          v3_du1(j,k)) * v2s_m(j,k))
        sig_CHBr3(2) = &
          p2(c2_CHBr3(1),c2_CHBr3(2),c2_CHBr3(3),tnorm(j,k))* &
          p1(b2_CHBr3(i2(j,k)), a2_CHBr3(i2(j,k)), &
          v3_du1(j,k))
        sig_CHBr3(3) = &
          p2(c3_CHBr3(1),c3_CHBr3(2),c3_CHBr3(3),tnorm(j,k))* &
          p1(b3_CHBr3(i3(j,k)), a3_CHBr3(i3(j,k)), &
          v3_du2(j,k))
        sig_CHBr3(4) = &
          p2(c4_CHBr3(1),c4_CHBr3(2),c4_CHBr3(3),tnorm(j,k))* &
          p3(a4_CHBr3(1),a4_CHBr3(2),a4_CHBr3(3), &
          a4_CHBr3(4),v3_du2(j,k))
        sig_CHBr3(5) = &
          p2(c5_CHBr3(1),c5_CHBr3(2),c5_CHBr3(3),tnorm(j,k))* &
          p3(a5_CHBr3(1),a5_CHBr3(2),a5_CHBr3(3), &
          a5_CHBr3(4),v3_du2(j,k))
        sig_CHBr3(6) = &
          p2(c6_CHBr3(1),c6_CHBr3(2),c6_CHBr3(3),tnorm(j,k))* &
          p3(a6_CHBr3(1),a6_CHBr3(2),a6_CHBr3(3), &
          a6_CHBr3(4),v3_du2(j,k))
        sig_CHBr3(7) = &
          p2(c7_CHBr3(1),c7_CHBr3(2),c7_CHBr3(3),tnorm(j,k))* &
          p3(a7_CHBr3(1),a7_CHBr3(2),a7_CHBr3(3), &
          a7_CHBr3(4),v3_du2(j,k))
        dj = 0. &
          + sig_CHBr3(0) * fint(j,k,0) &
          + sig_CHBr3(1) * fint(j,k,1) &
          + sig_CHBr3(2) * fint(j,k,2) &
          + sig_CHBr3(3) * fint(j,k,3) &
          + sig_CHBr3(4) * fint(j,k,4) &
          + sig_CHBr3(5) * fint(j,k,5) &
          + sig_CHBr3(6) * fint(j,k,6) &
          + sig_CHBr3(7) * fint(j,k,7)

        jval_2d(ip_CHBr3)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,6)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_CHBr3

  ! **************************************************************************

  SUBROUTINE jval_cal_SF6

    ! SF_6 \TOHV\ \products

    INTEGER :: j, k
    REAL    :: dj

    jval_2d(ip_SF6)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        dj = 0. &
          + 1.76E-18 * r_m(j,k) * phi_la
        jval_2d(ip_SF6)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,8)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_SF6

  ! **************************************************************************

  SUBROUTINE jval_cal_ClONO2

    ! ClNO_3 \TOHV\ ClO + NO_2

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_ClONO2

    ! T-const parameters:
    REAL, PARAMETER :: a0_1_1_ClONO2(dim58) = (/ &
       1.1985E-20,  1.3108E-20,  1.4309E-20,  1.5566E-20,  1.6877E-20,  1.8247E-20, &
       1.9674E-20,  2.1157E-20,  2.2704E-20,  2.4314E-20,  2.6003E-20,  2.7749E-20, &
       3.3198E-20,  4.6370E-20,  4.5205E-20,  4.7683E-20,  5.4211E-20,  5.2534E-20, &
       5.4667E-20,  6.1109E-20,  5.8278E-20,  5.9519E-20,  6.5363E-20,  6.0954E-20, &
       6.1046E-20,  5.0559E-20,  4.5377E-20,  4.5701E-20,  4.6529E-20,  4.7937E-20, &
       4.9971E-20,  5.2595E-20,  5.5731E-20,  5.9204E-20,  6.2877E-20,  6.6444E-20, &
       6.9854E-20,  7.2934E-20,  7.5605E-20,  7.7946E-20,  7.9867E-20,  8.1361E-20, &
       8.2393E-20,  8.2772E-20,  8.2276E-20,  8.0686E-20,  7.7825E-20,  7.3902E-20, &
       6.8877E-20,  6.3302E-20,  5.7374E-20,  5.1234E-20,  4.4839E-20,  3.8133E-20, &
       3.0834E-20,  2.3435E-20,  1.6375E-20,  1.1766E-20 /)
    REAL, PARAMETER :: a0_1_2_ClONO2(dim58) = (/ &
       5.3787E-21, -4.4293E-20, -9.7597E-20, -1.5368E-19, -2.1242E-19, -2.7405E-19, &
      -3.3856E-19, -4.0588E-19, -4.7644E-19, -5.5015E-19, -6.2785E-19, -7.0851E-19, &
      -9.6133E-19, -1.5752E-18, -1.5207E-18, -1.6371E-18, -1.9452E-18, -1.8657E-18, &
      -1.9673E-18, -2.2752E-18, -2.1393E-18, -2.1991E-18, -2.4820E-18, -2.2677E-18, &
      -2.2722E-18, -1.7583E-18, -1.5034E-18, -1.5194E-18, -1.5604E-18, -1.6306E-18, &
      -1.7323E-18, -1.8640E-18, -2.0220E-18, -2.1978E-18, -2.3844E-18, -2.5663E-18, &
      -2.7409E-18, -2.8992E-18, -3.0370E-18, -3.1583E-18, -3.2582E-18, -3.3362E-18, &
      -3.3903E-18, -3.4102E-18, -3.3840E-18, -3.2997E-18, -3.1475E-18, -2.9380E-18, &
      -2.6687E-18, -2.3687E-18, -2.0486E-18, -1.7158E-18, -1.3679E-18, -1.0018E-18, &
      -6.0181E-19, -1.9489E-19,  1.9485E-19,  4.5016E-19 /)
    REAL, PARAMETER :: a0_2_1_ClONO2(dim58) = (/ &
       5.4610E-23,  6.0299E-23,  6.6493E-23,  7.3239E-23,  8.0627E-23,  8.8524E-23, &
       9.7064E-23,  1.0633E-22,  1.1630E-22,  1.2724E-22,  1.3909E-22,  1.5239E-22, &
       1.1283E-22, -3.4318E-23,  3.4530E-23,  5.1245E-23,  1.6769E-23,  9.0182E-23, &
       1.1244E-22,  8.3431E-23,  1.6209E-22,  1.8902E-22,  1.6392E-22,  2.4505E-22, &
       2.7287E-22,  4.0093E-22,  4.6789E-22,  4.7366E-22,  4.6813E-22,  4.4991E-22, &
       4.1813E-22,  3.7315E-22,  3.1658E-22,  2.5137E-22,  1.8188E-22,  1.1250E-22, &
       4.7770E-23, -9.1355E-24, -5.5669E-23, -9.1252E-23, -1.1586E-22, -1.3072E-22, &
      -1.3847E-22, -1.4090E-22, -1.3950E-22, -1.3540E-22, -1.2871E-22, -1.2053E-22, &
      -1.1015E-22, -9.9669E-23, -8.8769E-23, -7.8015E-23, -6.7014E-23, -5.6479E-23, &
      -4.4925E-23, -3.4185E-23, -2.4091E-23, -1.7480E-23 /)
    REAL, PARAMETER :: a0_2_2_ClONO2(dim58) = (/ &
      -3.3548E-21, -3.6063E-21, -3.8813E-21, -4.1821E-21, -4.5131E-21, -4.8685E-21, &
      -5.2545E-21, -5.6751E-21, -6.1299E-21, -6.6308E-21, -7.1760E-21, -7.7906E-21, &
      -5.9549E-21,  9.0226E-22, -2.3198E-21, -3.1054E-21, -1.4782E-21, -4.9579E-21, &
      -6.0175E-21, -4.6308E-21, -8.4065E-21, -9.7043E-21, -8.4894E-21, -1.2433E-20, &
      -1.3790E-20, -2.0065E-20, -2.3360E-20, -2.3645E-20, -2.3370E-20, -2.2463E-20, &
      -2.0874E-20, -1.8616E-20, -1.5765E-20, -1.2465E-20, -8.9352E-21, -5.3969E-21, &
      -2.0825E-21,  8.4246E-22,  3.2436E-21,  5.0868E-21,  6.3662E-21,  7.1421E-21, &
       7.5483E-21,  7.6758E-21,  7.6023E-21,  7.3850E-21,  7.0289E-21,  6.5923E-21, &
       6.0355E-21,  5.4718E-21,  4.8833E-21,  4.3004E-21,  3.7019E-21,  3.1267E-21, &
       2.4935E-21,  1.9028E-21,  1.3456E-21,  9.7940E-22 /)
    REAL, PARAMETER :: a1_1_ClONO2(dim55) = (/ &
       2.0709E-20,  1.8644E-20,  1.6235E-20,  1.3923E-20,  1.1352E-20,  9.4721E-21, &
       7.2938E-21,  6.0611E-21,  4.4088E-21,  3.7124E-21,  2.4967E-21,  2.1653E-21, &
       1.2990E-21,  1.1475E-21,  5.3235E-22,  5.1696E-22,  4.0779E-23,  7.8388E-23, &
      -2.5965E-22, -1.9789E-22, -4.7263E-22, -3.7570E-22, -5.9162E-22, -5.2147E-22, &
      -6.7533E-22, -6.0236E-22, -7.2759E-22, -6.4335E-22, -7.5435E-22, -6.8787E-22, &
      -7.6880E-22, -6.9481E-22, -7.7846E-22, -6.9844E-22, -7.6103E-22, -7.1408E-22, &
      -7.6444E-22, -6.9232E-22, -7.4335E-22, -6.9141E-22, -6.9622E-22, -6.4847E-22, &
      -6.1131E-22, -5.7077E-22, -5.2784E-22, -4.9689E-22, -4.5958E-22, -4.3310E-22, &
      -3.8967E-22, -3.6046E-22, -3.3433E-22, -3.0943E-22, -2.8866E-22, -2.6759E-22, &
      -2.4829E-22 /)
    REAL, PARAMETER :: b1_1_ClONO2(dim55) = (/ &
       9.7904E-19,  9.8524E-19,  9.9849E-19,  1.0170E-18,  1.0440E-18,  1.0684E-18, &
       1.1022E-18,  1.1244E-18,  1.1582E-18,  1.1743E-18,  1.2053E-18,  1.2145E-18, &
       1.2410E-18,  1.2460E-18,  1.2678E-18,  1.2684E-18,  1.2877E-18,  1.2861E-18, &
       1.3014E-18,  1.2985E-18,  1.3123E-18,  1.3072E-18,  1.3192E-18,  1.3151E-18, &
       1.3244E-18,  1.3198E-18,  1.3280E-18,  1.3223E-18,  1.3301E-18,  1.3253E-18, &
       1.3314E-18,  1.3256E-18,  1.3324E-18,  1.3257E-18,  1.3311E-18,  1.3269E-18, &
       1.3315E-18,  1.3248E-18,  1.3297E-18,  1.3246E-18,  1.3250E-18,  1.3196E-18, &
       1.3150E-18,  1.3094E-18,  1.3029E-18,  1.2979E-18,  1.2913E-18,  1.2864E-18, &
       1.2777E-18,  1.2714E-18,  1.2655E-18,  1.2596E-18,  1.2544E-18,  1.2489E-18, &
       1.2435E-18 /)
    REAL, PARAMETER :: a1_2_ClONO2(dim55) = (/ &
       5.8765E-24,  2.2896E-23,  3.6818E-23,  4.2164E-23,  5.1608E-23,  4.6972E-23, &
       5.2066E-23,  4.2181E-23,  4.4949E-23,  3.3886E-23,  3.6057E-23,  2.5747E-23, &
       2.7571E-23,  1.9345E-23,  2.0882E-23,  1.4128E-23,  1.5781E-23,  1.0575E-23, &
       1.1839E-23,  7.8556E-24,  9.1489E-24,  5.8193E-24,  6.9714E-24,  4.4596E-24, &
       5.3507E-24,  3.3556E-24,  4.1937E-24,  2.4280E-24,  3.2348E-24,  1.9031E-24, &
       2.5169E-24,  1.3639E-24,  1.9487E-24,  9.4731E-25,  1.4676E-24,  7.7068E-25, &
       1.1341E-24,  4.0991E-25,  8.4532E-25,  2.8659E-25,  2.8856E-25, -4.5602E-26, &
      -1.7479E-25, -2.7132E-25, -3.3789E-25, -3.4539E-25, -3.8075E-25, -3.6073E-25, &
      -4.4331E-25, -4.5311E-25, -4.5330E-25, -4.5242E-25, -4.4039E-25, -4.3394E-25, &
      -4.2491E-25 /)
    REAL, PARAMETER :: b1_2_ClONO2(dim55) = (/ &
      -1.4049E-21, -1.4559E-21, -1.5325E-21, -1.5753E-21, -1.6744E-21, -1.6142E-21, &
      -1.6931E-21, -1.5152E-21, -1.5719E-21, -1.3175E-21, -1.3729E-21, -1.0842E-21, &
      -1.1398E-21, -8.6835E-22, -9.2292E-22, -6.6627E-22, -7.3321E-22, -5.0934E-22, &
      -5.6683E-22, -3.7565E-22, -4.4096E-22, -2.6449E-22, -3.2843E-22, -1.8275E-22, &
      -2.3666E-22, -1.1097E-22, -1.6586E-22, -4.5798E-23, -1.0267E-22, -5.4614E-24, &
      -5.1805E-23,  3.8134E-23, -8.9470E-24,  7.4170E-23,  2.9681E-23,  9.1014E-23, &
       5.8125E-23,  1.2547E-22,  8.3893E-23,  1.3865E-22,  1.3845E-22,  1.7621E-22, &
       1.9242E-22,  2.0575E-22,  2.1576E-22,  2.1699E-22,  2.2319E-22,  2.1943E-22, &
       2.3599E-22,  2.3807E-22,  2.3812E-22,  2.3791E-22,  2.3489E-22,  2.3320E-22, &
       2.3071E-22 /)
    REAL, PARAMETER :: a2_ClONO2(dim55) = (/ &
      -4.1092E-21, -3.5852E-21, -2.9360E-21, -2.2852E-21, -1.7144E-21, -1.2576E-21, &
      -9.1280E-22, -6.6280E-22, -4.8520E-22, -3.6040E-22, -2.7320E-22, -2.1080E-22, &
      -1.6680E-22, -1.3520E-22, -1.1120E-22, -9.3600E-23, -8.0000E-23, -6.9200E-23, &
      -6.0800E-23, -5.4000E-23, -4.8000E-23, -4.3600E-23, -3.9200E-23, -3.6000E-23, &
      -3.2800E-23, -3.0000E-23, -2.8000E-23, -2.5600E-23, -2.3600E-23, -2.2000E-23, &
      -2.0400E-23, -1.8800E-23, -1.7600E-23, -1.6800E-23, -1.5200E-23, -1.4400E-23, &
      -1.3200E-23, -1.2800E-23, -1.1600E-23, -1.1200E-23, -9.0400E-24, -6.4800E-24, &
      -4.7200E-24, -3.4400E-24, -2.5600E-24, -1.7600E-24, -1.3600E-24, -9.6000E-25, &
      -6.4000E-25, -5.6000E-25, -3.2000E-25, -2.4000E-25, -2.4000E-25, -1.6000E-25, &
      -8.0000E-26 /)
    REAL, PARAMETER :: b2_ClONO2(dim55) = (/ &
       7.8572E-20,  7.7000E-20,  7.3429E-20,  6.8223E-20,  6.2229E-20,  5.6291E-20, &
       5.0946E-20,  4.6446E-20,  4.2806E-20,  3.9935E-20,  3.7712E-20,  3.5964E-20, &
       3.4622E-20,  3.3580E-20,  3.2728E-20,  3.2059E-20,  3.1508E-20,  3.1044E-20, &
       3.0661E-20,  3.0335E-20,  3.0032E-20,  2.9799E-20,  2.9555E-20,  2.9369E-20, &
       2.9175E-20,  2.8999E-20,  2.8868E-20,  2.8705E-20,  2.8564E-20,  2.8447E-20, &
       2.8326E-20,  2.8201E-20,  2.8105E-20,  2.8038E-20,  2.7902E-20,  2.7831E-20, &
       2.7723E-20,  2.7685E-20,  2.7571E-20,  2.7532E-20,  2.7315E-20,  2.7025E-20, &
       2.6804E-20,  2.6628E-20,  2.6495E-20,  2.6365E-20,  2.6295E-20,  2.6219E-20, &
       2.6155E-20,  2.6138E-20,  2.6084E-20,  2.6065E-20,  2.6065E-20,  2.6044E-20, &
       2.6022E-20 /)
    REAL, PARAMETER :: a3_ClONO2(dim55) = (/ &
      -3.4967E-23, -2.1356E-23, -1.1730E-23, -6.7859E-24, -4.3341E-24, -3.0156E-24, &
      -2.2369E-24, -1.7391E-24, -1.4017E-24, -1.1621E-24, -9.8254E-25, -8.4546E-25, &
      -7.3592E-25, -6.4875E-25, -5.7847E-25, -5.1523E-25, -4.6551E-25, -4.2258E-25, &
      -3.8356E-25, -3.5274E-25, -3.2137E-25, -2.9623E-25, -2.7397E-25, -2.5514E-25, &
      -2.3419E-25, -2.1918E-25, -2.0377E-25, -1.9007E-25, -1.7778E-25, -1.6610E-25, &
      -1.5582E-25, -1.4555E-25, -1.3675E-25, -1.2842E-25, -1.2158E-25, -1.1282E-25, &
      -1.0788E-25, -1.0103E-25, -9.4178E-26, -9.0598E-26, -7.6001E-26, -5.7515E-26, &
      -4.3806E-26, -3.3550E-26, -2.5676E-26, -2.0192E-26, -1.5406E-26, -1.2325E-26, &
      -9.2402E-27, -7.5317E-27, -5.8199E-27, -4.4490E-27, -3.7658E-27, -2.7388E-27, &
      -2.0534E-27 /)
    REAL, PARAMETER :: b3_ClONO2(dim55) = (/ &
       1.3307E-20,  1.2505E-20,  1.1376E-20,  1.0507E-20,  9.9325E-21,  9.5466E-21, &
       9.2733E-21,  9.0695E-21,  8.9116E-21,  8.7854E-21,  8.6805E-21,  8.5923E-21, &
       8.5154E-21,  8.4492E-21,  8.3917E-21,  8.3362E-21,  8.2897E-21,  8.2470E-21, &
       8.2060E-21,  8.1718E-21,  8.1351E-21,  8.1042E-21,  8.0756E-21,  8.0503E-21, &
       8.0209E-21,  7.9990E-21,  7.9755E-21,  7.9539E-21,  7.9338E-21,  7.9140E-21, &
       7.8960E-21,  7.8774E-21,  7.8609E-21,  7.8449E-21,  7.8313E-21,  7.8134E-21, &
       7.8030E-21,  7.7882E-21,  7.7729E-21,  7.7648E-21,  7.7307E-21,  7.6820E-21, &
       7.6420E-21,  7.6090E-21,  7.5814E-21,  7.5606E-21,  7.5410E-21,  7.5275E-21, &
       7.5131E-21,  7.5046E-21,  7.4956E-21,  7.4880E-21,  7.4840E-21,  7.4777E-21, &
       7.4733E-21 /)
    REAL, PARAMETER :: a4_ClONO2(4) = (/  5.1787E-21, -7.1891E-25,  1.4729E-28, -1.0199E-32 /)
    REAL, PARAMETER :: a5_ClONO2(4) = (/  1.3999E-21, -2.6798E-25,  4.5861E-29, -2.9017E-33 /)
    REAL, PARAMETER :: a6_ClONO2(4) = (/  4.4291E-23, -7.9639E-28,  9.2244E-33, -6.2068E-38 /)
    ! T-dep parameters:
    REAL, PARAMETER :: c0_1_1_ClONO2(dim58) = (/ &
       2.7361E-02,  2.7361E-02,  2.7361E-02,  3.1397E-02,  3.5328E-02,  3.8923E-02, &
       4.2296E-02,  4.5032E-02,  4.6728E-02,  4.7674E-02,  4.7618E-02,  4.7170E-02, &
       4.5863E-02,  4.4576E-02,  4.3131E-02,  4.1920E-02,  4.1248E-02,  4.0759E-02, &
       4.0407E-02,  4.0432E-02,  3.9537E-02,  3.7973E-02,  3.4656E-02,  2.9389E-02, &
       2.2260E-02,  1.3099E-02,  2.8509E-03, -7.7404E-03, -1.7499E-02, -2.5453E-02, &
      -3.0186E-02, -3.1007E-02, -2.7924E-02, -2.0755E-02, -1.0966E-02,  8.9309E-05, &
       1.0780E-02,  1.9072E-02,  2.3247E-02,  2.2073E-02,  1.4599E-02,  9.1780E-04, &
      -1.7202E-02, -3.6897E-02, -5.6701E-02, -7.1153E-02, -7.9526E-02, -8.1385E-02, &
      -7.8623E-02, -7.4743E-02, -7.4640E-02, -7.8211E-02, -8.5800E-02, -9.3845E-02, &
      -9.5229E-02, -8.8862E-02, -7.5884E-02, -6.8667E-02 /)
    REAL, PARAMETER :: c0_1_2_ClONO2(dim58) = (/ &
      -9.5568E-01, -9.5568E-01, -9.5568E-01, -1.1356E+00, -1.3118E+00, -1.4736E+00, &
      -1.6260E+00, -1.7502E+00, -1.8276E+00, -1.8709E+00, -1.8683E+00, -1.8476E+00, &
      -1.7869E+00, -1.7270E+00, -1.6594E+00, -1.6025E+00, -1.5707E+00, -1.5476E+00, &
      -1.5308E+00, -1.5320E+00, -1.4891E+00, -1.4136E+00, -1.2531E+00, -9.9714E-01, &
      -6.4926E-01, -2.0036E-01,  3.0386E-01,  8.2707E-01,  1.3111E+00,  1.7072E+00, &
       1.9438E+00,  1.9851E+00,  1.8297E+00,  1.4669E+00,  9.6965E-01,  4.0583E-01, &
      -1.4155E-01, -5.6773E-01, -7.8316E-01, -7.2235E-01, -3.3371E-01,  3.8045E-01, &
       1.3299E+00,  2.3659E+00,  3.4115E+00,  4.1775E+00,  4.6229E+00,  4.7222E+00, &
       4.5742E+00,  4.3654E+00,  4.3599E+00,  4.5534E+00,  4.9663E+00,  5.4055E+00, &
       5.4814E+00,  5.1312E+00,  4.4148E+00,  4.0150E+00 /)
    REAL, PARAMETER :: c0_2_1_ClONO2(dim58) = (/ &
       1.5888E-02,  1.5888E-02,  1.5888E-02,  1.8078E-02,  2.1436E-02,  2.4067E-02, &
       2.6721E-02,  2.7244E-02,  2.6159E-02,  2.5434E-02,  2.2776E-02,  1.9797E-02, &
       1.5392E-02,  1.2814E-02,  7.7038E-03,  4.1399E-03,  6.8757E-04, -1.6639E-03, &
      -4.5952E-03, -4.2417E-03, -6.4688E-03, -8.8231E-03, -9.6211E-03, -1.2827E-02, &
      -1.4724E-02, -1.8773E-02, -1.8280E-02, -1.8456E-02, -1.4525E-02, -1.0541E-02, &
      -6.2188E-03, -3.6509E-04,  3.3278E-03,  7.2836E-03,  7.7645E-03,  9.9237E-03, &
       8.7182E-03,  2.8690E-03, -7.5294E-03, -2.5202E-02, -4.6410E-02, -6.9096E-02, &
      -8.3053E-02, -8.4368E-02, -8.8924E-02, -7.4996E-02, -6.5196E-02, -6.4693E-02, &
      -5.9634E-02, -5.1545E-02, -4.4378E-02, -1.1914E-02,  4.4356E-02,  9.9337E-02, &
       1.4214E-01,  1.4250E-01,  9.5530E-02,  3.8039E-02 /)
    REAL, PARAMETER :: c0_2_2_ClONO2(dim58) = (/ &
      -1.1494E+00, -1.1494E+00, -1.1494E+00, -1.2470E+00, -1.3975E+00, -1.5159E+00, &
      -1.6359E+00, -1.6596E+00, -1.6101E+00, -1.5769E+00, -1.4546E+00, -1.3170E+00, &
      -1.1126E+00, -9.9251E-01, -7.5333E-01, -5.8583E-01, -4.2288E-01, -3.1142E-01, &
      -1.7189E-01, -1.8879E-01, -8.1886E-02,  3.1590E-02,  7.0216E-02,  2.2601E-01, &
       3.1860E-01,  5.1700E-01,  4.9275E-01,  5.0144E-01,  3.0644E-01,  1.0804E-01, &
      -1.0806E-01, -4.0191E-01, -5.8803E-01, -7.8820E-01, -8.1263E-01, -9.2275E-01, &
      -8.6103E-01, -5.6038E-01, -2.3816E-02,  8.9163E-01,  1.9944E+00,  3.1787E+00, &
       3.9100E+00,  3.9792E+00,  4.2197E+00,  3.4815E+00,  2.9602E+00,  2.9333E+00, &
       2.6622E+00,  2.2270E+00,  1.8399E+00,  8.0406E-02, -2.9807E+00, -5.9827E+00, &
      -8.3281E+00, -8.3483E+00, -5.7553E+00, -2.5703E+00 /)
    REAL, PARAMETER :: c1_ClONO2(3) = (/  1.0000E+00,  3.2624E-02, -5.1739E-01 /)
    REAL, PARAMETER :: c2_ClONO2(3) = (/  1.0000E+00,  6.8690E-01,  1.7650E-01 /)
    REAL, PARAMETER :: c3_ClONO2(3) = (/  1.0000E+00,  9.5955E-01,  7.0713E-01 /)
    REAL, PARAMETER :: c4_ClONO2(3) = (/  9.9999E-01,  1.0881E+00,  9.7293E-01 /)
    REAL, PARAMETER :: c5_ClONO2(3) = (/  1.0000E+00,  1.2093E+00,  1.8740E+00 /)
    REAL, PARAMETER :: c6_ClONO2(3) = (/  9.9999E-01,  7.1852E-01,  1.9122E+00 /)

    jval_2d(ip_ClONO2)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_ClONO2(0) = &
          p2(1.,c0_1_1_ClONO2(i0(j,k))*dlv2(j,k) + &
          c0_1_2_ClONO2(i0(j,k)), &
          c0_2_1_ClONO2(i0(j,k))*dlv2(j,k) + &
          c0_2_2_ClONO2(i0(j,k)), tnorm_sr(j,k)) * &
          p1(a0_1_1_ClONO2(i0(j,k))*dlv2(j,k) + &
          a0_1_2_ClONO2(i0(j,k)), &
          a0_2_1_ClONO2(i0(j,k))*dlv2(j,k) + &
          a0_2_2_ClONO2(i0(j,k)),v3_du1(j,k))
        sig_ClONO2(1) = &
          p2(c1_ClONO2(1),c1_ClONO2(2), &
          c1_ClONO2(3),tnorm(j,k)) * &
          (p1(b1_1_ClONO2(i1(j,k)),a1_1_ClONO2(i1(j,k)), &
          v3_du1(j,k)) + &
          p1(b1_2_ClONO2(i1(j,k)),a1_2_ClONO2(i1(j,k)), &
          v3_du1(j,k)) * v2s_m(j,k))
        sig_ClONO2(2) = &
          p2(c2_ClONO2(1),c2_ClONO2(2),c2_ClONO2(3),tnorm(j,k))* &
          p1(b2_ClONO2(i2(j,k)), a2_ClONO2(i2(j,k)), &
          v3_du1(j,k))
        sig_ClONO2(3) = &
          p2(c3_ClONO2(1),c3_ClONO2(2),c3_ClONO2(3),tnorm(j,k))* &
          p1(b3_ClONO2(i3(j,k)), a3_ClONO2(i3(j,k)), &
          v3_du2(j,k))
        sig_ClONO2(4) = &
          p2(c4_ClONO2(1),c4_ClONO2(2),c4_ClONO2(3),tnorm(j,k))* &
          p3(a4_ClONO2(1),a4_ClONO2(2),a4_ClONO2(3), &
          a4_ClONO2(4),v3_du2(j,k))
        sig_ClONO2(5) = &
          p2(c5_ClONO2(1),c5_ClONO2(2),c5_ClONO2(3),tnorm(j,k))* &
          p3(a5_ClONO2(1),a5_ClONO2(2),a5_ClONO2(3), &
          a5_ClONO2(4),v3_du2(j,k))
        sig_ClONO2(6) = &
          p2(c6_ClONO2(1),c6_ClONO2(2),c6_ClONO2(3),tnorm(j,k))* &
          p3(a6_ClONO2(1),a6_ClONO2(2),a6_ClONO2(3), &
          a6_ClONO2(4),v3_du2(j,k))
        dj = 0. &
          + sig_ClONO2(0) * fint(j,k,0) &
          + sig_ClONO2(1) * fint(j,k,1) &
          + sig_ClONO2(2) * fint(j,k,2) &
          + sig_ClONO2(3) * fint(j,k,3) &
          + sig_ClONO2(4) * fint(j,k,4) &
          + sig_ClONO2(5) * fint(j,k,5) &
          + sig_ClONO2(6) * fint(j,k,6)

        jval_2d(ip_ClONO2)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,3)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_ClONO2

  ! **************************************************************************

  ! NOTE: this subroutine was not calculated by JVPP but simply copied
  ! from jval_cal_MACR.f90

  SUBROUTINE jval_cal_MACR

    ! MACR -> products JPL 2006, total quantum yield fitted; first channel to CH2=CCH3 + CHO most likely, C3H6 not seen.

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_MACR

    REAL :: f6

    ! T-const parameters:
    REAL, PARAMETER :: a3_MACR(dim55) = (/ &
      2.2318E-25, 1.4224E-25, 8.4374E-26, 5.3568E-26, 3.7145E-26, 2.7383E-26, &
      2.1222E-26, 1.6775E-26, 1.3863E-26, 1.1467E-26, 9.7569E-27, 8.3861E-27, &
      7.3592E-27, 6.3334E-27, 5.6477E-27, 5.1353E-27, 4.4497E-27, 4.1061E-27, &
      3.7671E-27, 3.4247E-27, 3.2478E-27, 2.7398E-27, 2.7396E-27, 2.3973E-27, &
      2.3932E-27, 2.0547E-27, 2.0549E-27, 1.8835E-27, 1.7094E-27, 1.7124E-27, &
      1.3698E-27, 1.5410E-27, 1.3677E-27, 1.1986E-27, 1.1986E-27, 1.1966E-27, &
      1.0272E-27, 1.0275E-27, 8.5607E-28, 1.0257E-27, 7.1894E-28, 5.8200E-28, &
      4.1066E-28, 3.0813E-28, 2.3965E-28, 2.0531E-28, 1.3693E-28, 1.0271E-28, &
      6.8465E-29, 6.8445E-29, 3.4266E-29, 3.4211E-29, 3.4223E-29, 3.4223E-29, &
      -0.0000E+00 /)
    REAL, PARAMETER :: b3_MACR(dim55) = (/ &
      1.5812E-22, 1.6289E-22, 1.6968E-22, 1.7509E-22, 1.7894E-22, 1.8180E-22, &
      1.8396E-22, 1.8578E-22, 1.8714E-22, 1.8840E-22, 1.8940E-22, 1.9029E-22, &
      1.9101E-22, 1.9179E-22, 1.9235E-22, 1.9280E-22, 1.9344E-22, 1.9378E-22, &
      1.9414E-22, 1.9452E-22, 1.9472E-22, 1.9535E-22, 1.9535E-22, 1.9581E-22, &
      1.9581E-22, 1.9631E-22, 1.9631E-22, 1.9658E-22, 1.9686E-22, 1.9686E-22, &
      1.9746E-22, 1.9715E-22, 1.9747E-22, 1.9780E-22, 1.9780E-22, 1.9780E-22, &
      1.9816E-22, 1.9816E-22, 1.9854E-22, 1.9815E-22, 1.9887E-22, 1.9923E-22, &
      1.9973E-22, 2.0006E-22, 2.0030E-22, 2.0043E-22, 2.0071E-22, 2.0086E-22, &
      2.0102E-22, 2.0102E-22, 2.0120E-22, 2.0120E-22, 2.0120E-22, 2.0120E-22, &
      2.0142E-22 /)
    REAL, PARAMETER :: a4_MACR(2)= (/2.3481E-22,  1.9076E-27/)
    REAL, PARAMETER :: a5_MACR(2)= (/2.5435E-22, -1.2548E-27/)
    REAL, PARAMETER :: a6_MACR(2)= (/3.8102E-23, -2.5458E-28/)
    jval_2d(ip_MACR)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_MACR(3) = &
          p1(b3_MACR(i3(j,k)), a3_MACR(i3(j,k)), &
          v3_du2(j,k))
        sig_MACR(4) = &
          p1(a4_MACR(1),a4_MACR(2),v3_du2(j,k))
        sig_MACR(5) = &
          p1(a5_MACR(1),a5_MACR(2),v3_du2(j,k))
        sig_MACR(6) = &
          p1(a6_MACR(1),a6_MACR(2),v3_du2(j,k))
        f6=1025./0.5856/(1000.+0.0075*press(j,k))
        dj = 0. &
          + sig_MACR(3) *F6 * fint(j,k,3) &
          + sig_MACR(4) *F6 * fint(j,k,4) &
          + sig_MACR(5) *F6 * fint(j,k,5) &
          + sig_MACR(6) *F6 * fint(j,k,6)

        jval_2d(ip_MACR)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,6)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_MACR

  ! **************************************************************************

  ! NOTE: this subroutine was not calculated by JVPP but simply copied
  ! from jval_cal_MVK.f90

  SUBROUTINE jval_cal_MVK

    ! MVK -> products JPL 2006, cross sections and total quantum yield, channels: 60\% to C3H6 + CO, 20\% to CH2CHCO + CH3, 20\% to C2H3 + CH3CO (IUPAC)

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_MVK

    REAL :: f6

    ! T-const parameters:
    REAL, PARAMETER :: a3_MVK(dim55) = (/ &
      -7.8560E-25,-5.2719E-25,-3.3545E-25,-2.2933E-25,-1.6775E-25,-1.3178E-25, &
      -1.0782E-25,-8.9010E-26,-7.3594E-26,-6.5036E-26,-5.6485E-26,-4.9635E-26, &
      -4.4496E-26,-3.9370E-26,-3.4231E-26,-3.2522E-26,-2.9095E-26,-2.7374E-26, &
      -2.3971E-26,-2.2263E-26,-2.0512E-26,-1.8836E-26,-1.8836E-26,-1.7121E-26, &
      -1.5386E-26,-1.3697E-26,-1.3701E-26,-1.3697E-26,-1.1965E-26,-1.0274E-26, &
      -1.0277E-26,-1.0274E-26,-1.0256E-26,-8.5621E-27,-6.8469E-27,-8.5474E-27, &
      -6.8503E-27,-6.8504E-27,-6.8469E-27,-6.8386E-27,-5.1355E-27,-3.7652E-27, &
      -3.0804E-27,-2.0541E-27,-1.7118E-27,-1.3691E-27,-1.0267E-27,-6.8514E-28, &
      -3.4211E-28,-6.8445E-28,-3.4223E-28,-0.0000E+00,-3.4223E-28,-0.0000E+00, &
      -3.4280E-28 /)
    REAL, PARAMETER :: b3_MVK(dim55) = (/ &
      1.8978E-21, 1.8826E-21, 1.8601E-21, 1.8414E-21, 1.8270E-21, 1.8165E-21, &
      1.8081E-21, 1.8003E-21, 1.7931E-21, 1.7886E-21, 1.7836E-21, 1.7792E-21, &
      1.7756E-21, 1.7717E-21, 1.7675E-21, 1.7660E-21, 1.7628E-21, 1.7611E-21, &
      1.7575E-21, 1.7556E-21, 1.7536E-21, 1.7515E-21, 1.7515E-21, 1.7492E-21, &
      1.7468E-21, 1.7443E-21, 1.7443E-21, 1.7443E-21, 1.7415E-21, 1.7386E-21, &
      1.7386E-21, 1.7386E-21, 1.7386E-21, 1.7353E-21, 1.7319E-21, 1.7354E-21, &
      1.7318E-21, 1.7318E-21, 1.7318E-21, 1.7318E-21, 1.7278E-21, 1.7242E-21, &
      1.7222E-21, 1.7189E-21, 1.7177E-21, 1.7164E-21, 1.7150E-21, 1.7135E-21, &
      1.7119E-21, 1.7136E-21, 1.7118E-21, 1.7099E-21, 1.7119E-21, 1.7098E-21, &
      1.7120E-21/)
    REAL, PARAMETER :: a4_MVK(2)= (/1.4748E-21, -1.4195E-26/)
    REAL, PARAMETER :: a5_MVK(3)= (/8.0692E-22, -5.8770E-26,  4.5077E-30/)
    REAL, PARAMETER :: a6_MVK(2)= (/4.1874E-23, -3.9217E-28/)
    jval_2d(ip_MVK)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_MVK(3) = &
          p1(b3_MVK(i3(j,k)), a3_MVK(i3(j,k)), &
          v3_du2(j,k))
        sig_MVK(4) = &
          p1(a4_MVK(1),a4_MVK(2),v3_du2(j,k))
        sig_MVK(5) = &
          p2(a5_MVK(1),a5_MVK(2),a5_MVK(3),v3_du2(j,k))
        sig_MVK(6) = &
          p1(a6_MVK(1),a6_MVK(2),v3_du2(j,k))
        ! drel = dens(j,k)/dens_ref (32.16=denom with dens=2.90e19 used for fit in f6)
        f6=32.16/(5.5+9.2E-19*dens(j,k))
        dj = 0. &
          + sig_MVK(3) *F6 * fint(j,k,3)  &
          + sig_MVK(4) *F6 * fint(j,k,4)  &
          + sig_MVK(5) *F6 * fint(j,k,5)  &
          + sig_MVK(6) *F6 * fint(j,k,6)

        jval_2d(ip_MVK)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,6)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_MVK

  ! **************************************************************************

  ! NOTE: this subroutine was not calculated by JVPP but simply copied
  ! from jval_cal_GLYOX.f90

  SUBROUTINE jval_cal_GLYOX

    ! CHOCHO -> 2 CHO   (CHOCHO = glyox = glyoxal) Tadic et al, 2006, JPPA 177, only total yield

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_GLYOX

    REAL :: f6
    REAL :: prel

    ! T-const parameters:
    REAL, PARAMETER :: a3_GLYOX(dim55) = (/ &
      -2.1052E-24, -4.6556E-24, -5.3568E-24, -5.1857E-24, -4.7073E-24, -4.1759E-24, &
      -3.6967E-24, -3.2523E-24, -2.8752E-24, -2.5501E-24, -2.2766E-24, -2.0366E-24, &
      -1.8313E-24, -1.6604E-24, -1.4889E-24, -1.3694E-24, -1.2493E-24, -1.1463E-24, &
      -1.0616E-24, -9.7599E-25, -9.0600E-25, -8.3905E-25, -7.8765E-25, -7.3631E-25, &
      -6.8374E-25, -6.3356E-25, -5.9932E-25, -5.6507E-25, -5.1285E-25, -4.9657E-25, &
      -4.6232E-25, -4.4523E-25, -4.1022E-25, -3.9383E-25, -3.5963E-25, -3.4184E-25, &
      -3.2539E-25, -3.0818E-25, -2.9114E-25, -2.7346E-25, -2.2938E-25, -1.7117E-25, &
      -1.3004E-25, -9.5862E-26, -7.5320E-26, -5.4749E-26, -4.4513E-26, -3.0807E-26, &
      -2.3963E-26, -2.0531E-26, -1.3695E-26, -1.0273E-26, -1.0265E-26, -6.8473E-27, &
      -3.4280E-27 /)
    REAL, PARAMETER :: b3_GLYOX(dim55) = (/ &
      3.5916E-20, 3.6066E-20, 3.6149E-20, 3.6119E-20, 3.6007E-20, 3.5851E-20, &
      3.5683E-20, 3.5501E-20, 3.5324E-20, 3.5153E-20, 3.4993E-20, 3.4839E-20, &
      3.4695E-20, 3.4565E-20, 3.4425E-20, 3.4320E-20, 3.4208E-20, 3.4105E-20, &
      3.4016E-20, 3.3921E-20, 3.3839E-20, 3.3757E-20, 3.3691E-20, 3.3622E-20, &
      3.3548E-20, 3.3475E-20, 3.3423E-20, 3.3369E-20, 3.3283E-20, 3.3256E-20, &
      3.3196E-20, 3.3165E-20, 3.3099E-20, 3.3068E-20, 3.3000E-20, 3.2963E-20, &
      3.2929E-20, 3.2891E-20, 3.2854E-20, 3.2813E-20, 3.2710E-20, 3.2557E-20, &
      3.2437E-20, 3.2327E-20, 3.2255E-20, 3.2177E-20, 3.2135E-20, 3.2075E-20, &
      3.2043E-20, 3.2026E-20, 3.1990E-20, 3.1971E-20, 3.1971E-20, 3.1950E-20, &
      3.1928E-20 /)
    REAL, PARAMETER :: a4_GLYOX(2) = (/3.0906E-20, 1.9869E-25/)
    REAL, PARAMETER :: a5_GLYOX(3) = (/ 1.5819E-20,-1.1829E-24, 8.9498E-29/)
    REAL, PARAMETER :: a6_GLYOX(2) = (/1.7007E-21,-6.2818E-27/)
    REAL, PARAMETER :: a7_GLYOX(2) = (/1.9405E-23, 1.3357E-27/)
    jval_2d(ip_GLYOX)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j  = 1,kproma_day
        PREL = (MIN(1.E5,PRESS(J,K))/PRESS_REF)  !relative pressure
        sig_GLYOX(3) = &
          p1(b3_GLYOX(i3(j,k)), a3_GLYOX(i3(j,k)), &
          v3_du2(j,k))
        sig_GLYOX(4) = &
          p1(a4_GLYOX(1),a4_GLYOX(2),v3_du2(j,k))
        sig_GLYOX(5) = &
          p2(a5_GLYOX(1),a5_GLYOX(2),a5_GLYOX(3),v3_du2(j,k))
        sig_GLYOX(6) = &
          p1(a6_GLYOX(1),a6_GLYOX(2),v3_du2(j,k))
        sig_GLYOX(7) = &
          p1(a7_GLYOX(1),a7_GLYOX(2),v3_du2(j,k))
        f6=25.7/(6.8+ 1.89*prel)
        dj = 0. &
          + sig_GLYOX(3) *     fint(j,k,3) &
          + sig_GLYOX(4) *     fint(j,k,4) &
          + sig_GLYOX(5) *     fint(j,k,5) &
          + sig_GLYOX(6) * F6* fint(j,k,6) &
          + sig_GLYOX(7) * F6* fint(j,k,7)
        jval_2d(ip_GLYOX)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,6)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_GLYOX

  ! **************************************************************************

  SUBROUTINE jval_cal_HOCH2CHO

    ! HOCH_2CHO \TOHV\ \products

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_HOCH2CHO

    ! T-const parameters:
    REAL, PARAMETER :: a1_1_HOCH2CHO(dim55) = (/ &
       8.9704E-22,  9.2070E-22,  9.6862E-22,  9.4075E-22,  9.3524E-22,  8.8042E-22, &
       8.4165E-22,  7.8328E-22,  7.2870E-22,  6.7881E-22,  6.1841E-22,  5.8097E-22, &
       5.1943E-22,  4.9422E-22,  4.3282E-22,  4.1833E-22,  3.5802E-22,  3.5251E-22, &
       2.9309E-22,  2.9511E-22,  2.3644E-22,  2.4489E-22,  1.8735E-22,  2.0055E-22, &
       1.4429E-22,  1.6165E-22,  1.0624E-22,  1.2729E-22,  7.2751E-23,  9.6806E-23, &
       4.3292E-23,  6.9727E-23,  1.7015E-23,  4.5619E-23, -5.9694E-24,  2.3894E-23, &
      -2.6587E-23,  4.6715E-24, -4.4903E-23, -1.2582E-23, -5.9160E-23, -8.1300E-23, &
      -1.1204E-22, -1.2168E-22, -1.4174E-22, -1.4419E-22, -1.5709E-22, -1.5527E-22, &
      -1.7278E-22, -1.6991E-22, -1.6598E-22, -1.6120E-22, -1.5583E-22, -1.5000E-22, &
      -1.4388E-22 /)
    REAL, PARAMETER :: b1_1_HOCH2CHO(dim55) = (/ &
       1.9087E-20,  1.9016E-20,  1.8753E-20,  1.8976E-20,  1.9034E-20,  1.9746E-20, &
       2.0347E-20,  2.1398E-20,  2.2517E-20,  2.3664E-20,  2.5205E-20,  2.6253E-20, &
       2.8130E-20,  2.8962E-20,  3.1141E-20,  3.1692E-20,  3.4135E-20,  3.4371E-20, &
       3.7075E-20,  3.6978E-20,  3.9941E-20,  3.9493E-20,  4.2687E-20,  4.1921E-20, &
       4.5325E-20,  4.4231E-20,  4.7860E-20,  4.6429E-20,  5.0274E-20,  4.8518E-20, &
       5.2558E-20,  5.0496E-20,  5.4740E-20,  5.2366E-20,  5.6776E-20,  5.4148E-20, &
       5.8717E-20,  5.5810E-20,  6.0544E-20,  5.7377E-20,  6.2058E-20,  6.4560E-20, &
       6.8418E-20,  6.9748E-20,  7.2767E-20,  7.3166E-20,  7.5431E-20,  7.5088E-20, &
       7.8598E-20,  7.7987E-20,  7.7101E-20,  7.5963E-20,  7.4620E-20,  7.3085E-20, &
       7.1400E-20 /)
    REAL, PARAMETER :: a1_2_HOCH2CHO(dim55) = (/ &
      -3.7942E-24, -2.5831E-24, -2.6036E-24, -1.3842E-24, -1.1848E-24, -2.7846E-25, &
      -1.5389E-27,  4.9668E-25,  7.9411E-25,  9.4342E-25,  1.2606E-24,  1.1622E-24, &
       1.5005E-24,  1.2406E-24,  1.6071E-24,  1.2437E-24,  1.6342E-24,  1.2056E-24, &
       1.6152E-24,  1.1504E-24,  1.5724E-24,  1.0839E-24,  1.5129E-24,  1.0167E-24, &
       1.4457E-24,  9.4882E-25,  1.3770E-24,  8.8195E-25,  1.3071E-24,  8.1848E-25, &
       1.2366E-24,  7.5846E-25,  1.1696E-24,  7.0224E-25,  1.1026E-24,  6.5114E-25, &
       1.0402E-24,  6.0249E-25,  9.8018E-25,  5.5761E-25,  7.2145E-25,  5.4522E-25, &
       5.2187E-25,  3.8780E-25,  3.7626E-25,  2.7380E-25,  2.6790E-25,  1.8926E-25, &
       2.4073E-25,  1.8535E-25,  1.3637E-25,  9.3080E-26,  5.5168E-26,  2.1912E-26, &
      -6.8488E-27 /)
    REAL, PARAMETER :: b1_2_HOCH2CHO(dim55) = (/ &
      -5.8659E-23, -6.2293E-23, -6.2179E-23, -7.1935E-23, -7.4029E-23, -8.5811E-23, &
      -9.0103E-23, -9.9071E-23, -1.0517E-22, -1.0860E-22, -1.1669E-22, -1.1394E-22, &
      -1.2425E-22, -1.1568E-22, -1.2869E-22, -1.1488E-22, -1.3070E-22, -1.1227E-22, &
      -1.3090E-22, -1.0859E-22, -1.2990E-22, -1.0401E-22, -1.2782E-22, -9.9041E-23, &
      -1.2500E-22, -9.3692E-23, -1.2174E-22, -8.8074E-23, -1.1804E-22, -8.2379E-23, &
      -1.1395E-22, -7.6652E-23, -1.0975E-22, -7.0957E-23, -1.0519E-22, -6.5460E-23, &
      -1.0067E-22, -5.9962E-23, -9.6032E-23, -5.4620E-23, -7.1087E-23, -5.1172E-23, &
      -4.8241E-23, -2.9740E-23, -2.8003E-23, -1.1303E-23, -1.0267E-23,  4.5176E-24, &
      -5.8019E-24,  5.9934E-24,  1.7039E-23,  2.7342E-23,  3.6839E-23,  4.5585E-23, &
       5.3509E-23 /)
    REAL, PARAMETER :: a2_HOCH2CHO(dim55) = (/ &
       5.3640E-22,  4.0640E-22,  2.7720E-22,  1.6720E-22,  8.3600E-23,  2.6000E-23, &
      -1.0400E-23, -3.1600E-23, -4.2800E-23, -4.7200E-23, -4.8400E-23, -4.7200E-23, &
      -4.4800E-23, -4.2400E-23, -3.9200E-23, -3.6400E-23, -3.4000E-23, -3.1200E-23, &
      -2.9200E-23, -2.6800E-23, -2.5200E-23, -2.3200E-23, -2.1600E-23, -2.0400E-23, &
      -1.8800E-23, -1.7600E-23, -1.6400E-23, -1.5600E-23, -1.4400E-23, -1.3600E-23, &
      -1.2400E-23, -1.2000E-23, -1.1200E-23, -1.0400E-23, -1.0000E-23, -9.2000E-24, &
      -8.4000E-24, -8.0000E-24, -7.6000E-24, -7.2000E-24, -5.9200E-24, -4.3200E-24, &
      -3.2000E-24, -2.3200E-24, -1.6800E-24, -1.2000E-24, -8.8000E-25, -6.4000E-25, &
      -4.8000E-25, -3.2000E-25, -2.4000E-25, -1.6000E-25, -1.6000E-25, -8.0000E-26, &
      -8.0000E-26 /)
    REAL, PARAMETER :: b2_HOCH2CHO(dim55) = (/ &
       5.9606E-20,  5.9996E-20,  6.0706E-20,  6.1586E-20,  6.2464E-20,  6.3213E-20, &
       6.3777E-20,  6.4159E-20,  6.4388E-20,  6.4490E-20,  6.4520E-20,  6.4487E-20, &
       6.4413E-20,  6.4334E-20,  6.4221E-20,  6.4114E-20,  6.4017E-20,  6.3897E-20, &
       6.3806E-20,  6.3690E-20,  6.3610E-20,  6.3504E-20,  6.3415E-20,  6.3345E-20, &
       6.3248E-20,  6.3173E-20,  6.3094E-20,  6.3040E-20,  6.2955E-20,  6.2897E-20, &
       6.2806E-20,  6.2775E-20,  6.2711E-20,  6.2644E-20,  6.2610E-20,  6.2540E-20, &
       6.2467E-20,  6.2430E-20,  6.2392E-20,  6.2353E-20,  6.2224E-20,  6.2043E-20, &
       6.1903E-20,  6.1781E-20,  6.1685E-20,  6.1607E-20,  6.1550E-20,  6.1505E-20, &
       6.1473E-20,  6.1439E-20,  6.1421E-20,  6.1402E-20,  6.1402E-20,  6.1381E-20, &
       6.1381E-20 /)
    REAL, PARAMETER :: a3_HOCH2CHO(dim55) = (/ &
      -8.3283E-23, -5.4927E-23, -3.3014E-23, -2.0863E-23, -1.4327E-23, -1.0543E-23, &
      -8.1294E-24, -6.5217E-24, -5.3911E-24, -4.5353E-24, -3.8685E-24, -3.3716E-24, &
      -2.9608E-24, -2.6018E-24, -2.3276E-24, -2.0883E-24, -1.8826E-24, -1.7109E-24, &
      -1.5582E-24, -1.4212E-24, -1.2991E-24, -1.1986E-24, -1.0959E-24, -1.0274E-24, &
      -9.4017E-25, -8.7329E-25, -8.2192E-25, -7.5342E-25, -7.1795E-25, -6.5068E-25, &
      -6.3356E-25, -5.6507E-25, -5.4701E-25, -5.1370E-25, -4.7945E-25, -4.4444E-25, &
      -4.2808E-25, -3.9384E-25, -3.7671E-25, -3.5897E-25, -2.9442E-25, -2.2595E-25, &
      -1.6769E-25, -1.3009E-25, -1.0270E-25, -7.5291E-26, -5.8199E-26, -4.7929E-26, &
      -3.7645E-26, -2.7388E-26, -2.0541E-26, -1.7112E-26, -1.3694E-26, -1.0270E-26, &
      -1.0267E-26 /)
    REAL, PARAMETER :: b3_HOCH2CHO(dim55) = (/ &
       4.1290E-20,  3.9619E-20,  3.7047E-20,  3.4911E-20,  3.3381E-20,  3.2273E-20, &
       3.1426E-20,  3.0768E-20,  3.0239E-20,  2.9788E-20,  2.9398E-20,  2.9079E-20, &
       2.8790E-20,  2.8518E-20,  2.8293E-20,  2.8083E-20,  2.7891E-20,  2.7720E-20, &
       2.7560E-20,  2.7407E-20,  2.7265E-20,  2.7141E-20,  2.7009E-20,  2.6917E-20, &
       2.6795E-20,  2.6697E-20,  2.6619E-20,  2.6511E-20,  2.6453E-20,  2.6339E-20, &
       2.6309E-20,  2.6185E-20,  2.6151E-20,  2.6087E-20,  2.6019E-20,  2.5947E-20, &
       2.5913E-20,  2.5839E-20,  2.5801E-20,  2.5760E-20,  2.5609E-20,  2.5429E-20, &
       2.5259E-20,  2.5138E-20,  2.5042E-20,  2.4938E-20,  2.4868E-20,  2.4823E-20, &
       2.4775E-20,  2.4724E-20,  2.4688E-20,  2.4669E-20,  2.4649E-20,  2.4628E-20, &
       2.4628E-20 /)
    REAL, PARAMETER :: a4_HOCH2CHO(4) = (/  1.6079E-20, -2.5919E-24,  5.2213E-28, -3.5928E-32 /)
    REAL, PARAMETER :: a5_HOCH2CHO(4) = (/  2.2066E-21, -8.2295E-25,  1.4575E-28, -9.3474E-33 /)

    jval_2d(ip_HOCH2CHO)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_HOCH2CHO(1) = &
          (p1(b1_1_HOCH2CHO(i1(j,k)),a1_1_HOCH2CHO(i1(j,k)), &
          v3_du1(j,k)) + &
          p1(b1_2_HOCH2CHO(i1(j,k)),a1_2_HOCH2CHO(i1(j,k)), &
          v3_du1(j,k)) * v2s_m(j,k))
        sig_HOCH2CHO(2) = &
          p1(b2_HOCH2CHO(i2(j,k)), a2_HOCH2CHO(i2(j,k)), &
          v3_du1(j,k))
        sig_HOCH2CHO(3) = &
          p1(b3_HOCH2CHO(i3(j,k)), a3_HOCH2CHO(i3(j,k)), &
          v3_du2(j,k))
        sig_HOCH2CHO(4) = &
          p3(a4_HOCH2CHO(1),a4_HOCH2CHO(2),a4_HOCH2CHO(3), &
          a4_HOCH2CHO(4),v3_du2(j,k))
        sig_HOCH2CHO(5) = &
          p3(a5_HOCH2CHO(1),a5_HOCH2CHO(2),a5_HOCH2CHO(3), &
          a5_HOCH2CHO(4),v3_du2(j,k))
        dj = 0. &
          + sig_HOCH2CHO(1) * fint(j,k,1) &
          + sig_HOCH2CHO(2) * fint(j,k,2) &
          + sig_HOCH2CHO(3) * fint(j,k,3) &
          + sig_HOCH2CHO(4) * fint(j,k,4) &
          + sig_HOCH2CHO(5) * fint(j,k,5)

        jval_2d(ip_HOCH2CHO)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,5)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_HOCH2CHO

  ! **************************************************************************

  SUBROUTINE jval_cal_CH4

    ! CH_4 \TOHV\ \products

    INTEGER :: j, k
    REAL    :: dj

    jval_2d(ip_CH4)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        dj = 0. &
          + 1.8E-17 * r_m(j,k) * phi_la
        jval_2d(ip_CH4)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,8)),dp)
      ENDDO
    ENDDO

  END SUBROUTINE jval_cal_CH4

  ! **************************************************************************

  ! NOTE: this subroutine was not calculated by JVPP but simply copied
  ! from jval_cal_H2SO4.f90

  SUBROUTINE jval_cal_H2SO4

    ! vibrational overtones: Vaida et al 2003 Science 299, Hintze et al 2003,
    !  J.Ph.Ch. A107; Lyalpha: Mills et al, 2005, JGR 110, D24208

    ! mz_rs_20111006+
    ! \cite{2649,2651}, Lyman-alpha from \cite{2650}. However, it is
    ! unclear which spectrum was used to derive the parameters
    ! \verb|a7_H2SO4(:)|.
    ! mz_rs_20111006-

    INTEGER :: j, k
    REAL    :: dj
    REAL, DIMENSION(0:MAXWAV) :: sig_H2SO4

    ! T-const parameters:
    REAL, PARAMETER :: a7_H2SO4(2) = (/4.2204E-25, 6.9058E-30/)

    jval_2d(ip_H2SO4)%ptr(:,:) = 0.0_dp
    DO k = 1,klev
      DO j = 1,kproma_day
        sig_H2SO4(7) = p1(a7_H2SO4(1),a7_H2SO4(2),v3_du2(j,k))
        dj = 0. &
          + 6.4e-18 * r_m(j,k) * phi_la &
          + sig_H2SO4(7) * fint(j,k,7)
        jval_2d(ip_H2SO4)%ptr(iu0(j),k) = REAL(MAX(0.0, dj*fj_corr(j,1)),dp)
      ENDDO
    ENDDO
    
  END SUBROUTINE jval_cal_H2SO4

  ! **************************************************************************

