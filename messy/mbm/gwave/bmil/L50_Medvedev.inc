  !r Routine to populate wind and temperature fields with
  !r values sent by Alex Medvedev. The idea is to put these 
  !r numbers through the scheme to test the drag calculated,
  !r thus self-testing this file.
  !r
  !r You'll see from the results that they are not exactly
  !r the same, but pretty close. Even overiding usq and
  !r omeg as per a second email from Alex, left me with a 
  !r difference. At this time I put it down to rounding
  !r errors in the data sent. One decimal place in velocity
  !r isn't accurate enough.
  !r
  !r If you input Alex's usq and omega, you'll get :
  !r
  !r        CMAT         ALEX
  !r 41   -6.956       -3.407
  !r 42  -86.746      -67.846
  !r 43 -202.624     -177.432
  !r 44 -181.012     -173.394
  !r 45  -68.675      -71.052
  !r 46  -13.099      -13.446
  !r
  !r The data sent is in file. 
  !r  
  !r cmat2f90/input_params/gwave_regression.dat
  !r
  !r Note, to run this routine plve must be set to 50 in 
  !r module header.
  !r 
  !r Here is Alex's first email, dated Jan 24 2005 :
  !r
  !r  Hi Matthew,
  !r  
  !r  I attached the file with the calculations for one vertical profile.
  !r  This was done for only "extrawaves", i.e. the subroutine mkgwd was
  !r  called only once in the part of the code marked by
  !r  
  !r  "c Eastward waves (c>0), ............ x-direction"
  !r  
  !r  The following parameters were used (hopefully I am not missing something)
  !r  pi=3.1415926
  !r  rgas=287.
  !r  grav=9.81
  !r  gamma=1.4
  !r  cpres=1000.
  !r  
  !r  levgws=5
  !r  gwkh=2.*pi/1.e5
  !r  xkz1=19.e3
  !r  xkz2=900.
  !r  ampl=100.; xm=0.006
  !r  nhar=15
  !r  
  !r  And here is what was printed out:
  !r   do j=1,nhar
  !r      omeg(j,levgws) = om(j) - gwkh * uu(levgws)
  !r   end do
  !r  
  !r   call mkgwd(uu, pf, ph, tf, th, bvfr, dpf, ax, ttpgw)
  !r  
  !r   do l=1, plev
  !r  
  !r      zzz=float(l-1)*2.
  !r      print 99,l,zzz,uu(l),pf(l),ph(l),tf(l),th(l),bvfr(l), rms(l),       &
  !r             ax(l)*86400.,ttpgw(l)*86400.
  !r   enddo
  !r   99 format(i2,1x,f5.1,1x,f4.1,1x,g10.5,1x,g10.5,1x,f6.2,1x,f6.2,1x,
  !r             f9.3,1x,2(f9.3,1x))
  !r  

!!$ l   zzz   uu    pf         ph         tf      th      bvfr       rms    ax*86400 ,ttpgw*86400.
!!$ 1   0.0  1.1 .10000E+06 .10000E+06 291.70   0.00     0.010     0.000     0.000 0.000
!!$ 2   2.0  6.9 78181.     89091.     277.74 284.72     0.010     0.000     0.000 0.000
!!$ 3   4.0 14.0 59505.     68843.     263.38 270.56     0.010     0.000     0.000 0.000
!!$ 4   6.0 22.1 43887.     51696.     249.03 256.20     0.011     0.000     0.000 0.000
!!$ 5   8.0 31.1 31363.     37625.     235.82 242.43     0.012     0.000     0.000 0.000
!!$ 6  10.0 37.1 21821.     26592.     224.53 230.18     0.014     0.601     0.000 0.000
!!$ 7  12.0 35.6 14895.     18358.     215.41 219.97     0.017     0.784     0.000 0.000
!!$ 8  14.0 31.1 10175.     12535.     209.40 212.40     0.019     1.083     0.000 0.000
!!$ 9  16.0 23.4 7137.7     8656.1     207.18 208.29     0.021     1.596    -0.007 0.002
!!$10  18.0 16.8 5143.9     6140.8     207.34 207.26     0.022     2.337    -0.121 0.013
!!$11  20.0 11.6 3829.4     4486.7     209.54 208.44     0.023     3.251    -0.822 0.019
!!$12  22.0  8.3 2913.3     3371.4     212.67 211.11     0.023     2.930    -1.683 -0.009
!!$13  24.0  6.4 2247.6     2580.4     216.15 214.41     0.023     1.008    -1.404 -0.037
!!$14  26.0  5.4 1742.3     1994.9     219.44 217.79     0.023     0.428    -0.485 -0.027
!!$15  28.0  4.9 1362.8     1552.5     222.80 221.12     0.023     0.507    -0.058 -0.008
!!$16  30.0  4.6 1075.2     1219.0     226.23 224.52     0.022     0.599    -0.002 -0.001
!!$17  32.0  5.0 857.62     966.41     229.85 228.04     0.022     0.634     0.000 0.000
!!$18  34.0  6.1 693.74     775.68     233.80 231.82     0.022     0.617     0.000 0.000
!!$19  36.0  8.3 577.96     635.85     238.78 236.29     0.023     0.560     0.000 0.000
!!$20  38.0 11.1 492.21     535.09     244.43 241.60     0.023     0.513     0.000 0.000
!!$21  40.0 14.6 431.35     461.78     251.06 247.74     0.022     0.472     0.000 0.000
!!$22  42.0 18.0 374.17     402.76     256.90 253.98     0.022     0.449     0.000 0.000
!!$23  44.0 21.3 321.09     347.63     261.96 259.43     0.021     0.438     0.000 0.000
!!$24  46.0 24.4 264.04     292.57     264.84 263.40     0.020     0.439     0.000 0.000
!!$25  48.0 27.4 207.09     235.56     265.49 265.17     0.019     0.451     0.000 0.000
!!$26  50.0 30.9 151.66     179.37     263.29 264.39     0.018     0.477     0.000 0.000
!!$27  52.0 35.1 105.17     128.42     259.20 261.24     0.017     0.519     0.000 0.000
!!$28  54.0 40.1 68.655     86.913     253.41 256.30     0.016     0.586     0.000 0.000
!!$29  56.0 45.4 43.909     56.282     247.60 250.50     0.017     0.685     0.000 0.000
!!$30  58.0 51.1 27.777     35.843     242.10 244.85     0.017     0.811     0.000 0.000
!!$31  60.0 55.9 17.520     22.648     237.11 239.60     0.018     0.978     0.000 0.000
!!$32  62.0 59.5 11.042     14.281     232.60 234.85     0.018     1.196     0.000 0.000
!!$33  64.0 61.4 6.9473     8.9946     228.48 230.54     0.018     1.487     0.000 0.000
!!$34  66.0 61.9 4.3881     5.6677     224.83 226.66     0.019     1.869     0.000 0.000
!!$35  68.0 60.8 2.7871     3.5876     221.62 223.22     0.019     2.379     0.000 0.000
!!$36  70.0 58.7 1.8084     2.2977     219.10 220.36     0.020     3.036     0.000 0.000
!!$37  72.0 55.6 1.2236     1.5160     217.58 218.34     0.020     3.818     0.000 0.000
!!$38  74.0 52.0 .82916     1.0264     216.18 216.88     0.020     4.801     0.000 0.000
!!$39  76.0 48.0 .56180     .69548     214.88 215.53     0.020     6.076     0.000 0.000
!!$40  78.0 43.9 .37807     .46993     213.54 214.21     0.020     7.738    -0.005 0.246
!!$41  80.0 39.6 .25150     .31479     212.09 212.81     0.021     9.990    -3.407 3.825
!!$42  82.0 35.3 .16749     .20950     210.74 211.42     0.020    12.790   -67.846 5.742
!!$43  84.0 30.3 .10596     .13672     208.70 209.72     0.020    13.535  -177.432 -3.586
!!$44  86.0 24.2 .62234E-01 .84096E-01 205.71 207.21     0.020     7.332  -173.394 -12.177
!!$45  88.0 18.3 .33599E-01 .47917E-01 201.79 203.75     0.019     3.187   -71.052 -8.503
!!$46  90.0 12.9 .16822E-01 .25211E-01 197.22 199.51     0.019     3.194   -13.446 -2.335
!!$47  92.0  8.7 .81617E-02 .12492E-01 192.67 194.95     0.020     1.321    -3.462 -0.307
!!$48  94.0  5.6 .41835E-02 .61726E-02 189.12 190.90     0.021     0.409    -0.713 -0.054
!!$49  96.0  3.6 .25822E-02 .33829E-02 187.81 188.46     0.022     0.532    -0.060 -0.008
!!$50  98.0  2.1 .16933E-02 .21377E-02 187.20 187.50     0.022     0.000     0.000 0.000


  !r print*,(omeg(l,levgws),l=1,nhar)
  !r print*,(omeg(l,43),l=1,nhar)
  !r print*,(usq(l,levgws),l=1,nhar)
  !r print*,(usq(l,43),l=1,nhar)
  !r 
  !r Regards,
  !r Alex
  !r
  !r Here is the data from the above mail :
  !r
  !r -1.8456874E-3 -1.8185588E-3 -1.7848272E-3 -1.7428858E-3 -1.6907362E-3
  !r  -1.6258937E-3 -1.5452693E-3 -1.4450212E-3 -1.320374E-3 -1.1653885E-3
  !r -9.7268086E-4 -7.330697E-4 -4.351394E-4 -6.469514E-5 3.9591197E-4
  !r 
  !r  -1.7923444E-3 -1.7652158E-3 -1.7314842E-3 -1.6895428E-3 0.0E+0 
  !r  0 .0E+0 0.0E+0
  !r  0.0E+0 0.0E+0 0.0E+0 0.0E+0 0.0E+0 0.0E+0 0.0E+0 0.0E+0
  !r 
  !r  0.056128866 0.05821094 0.05036641 0.037937816 0.026352897 0.017589593
  !r  0.011531283 7.501145E-3 4.863483E-3 3.1489492E-3 2.0376597E-3 
  !r  1.3182312E-3 8.527224E-4 5.5157573E-4 3.5677535E-4
  !r 
  !r  183.13501 0.061388954 5.4582706E-6 1.0200035E-19 0.0E+0 0.0E+0 
  !r  0.0E+0 0.0E+0
  !r  0.0E+0 0.0E+0 0.0E+0 0.0E+0 0.0E+0 0.0E+0 0.0E+0
  !r 
 


! use output ph
!!$ DATA vct / .10000E+06, 78181., 59505., 43887., 31363., 21821.,&
!!$    14895., 10175., 7137.7 , 5143.9 , 3829.4 , 2913.3 , 2247.6 ,&
!!$    1742.3 , 1362.8 , 1075.2 , 857.62 , 693.74 , 577.96 , 492.21 ,&
!!$    431.35 , 374.17 , 321.09 , 264.04 , 207.09 , 151.66 , 105.17 ,&
!!$    68.655 , 43.909 , 27.777 , 17.520 , 11.042 , 6.9473 , 4.3881 ,&
!!$    2.7871 , 1.8084 , 1.2236 , .82916 , .56180 , .37807 , .25150 ,&
!!$    .16749 , .10596 , .62234E-01, .33599E-01, .16822E-01, .81617E-02,&
!!$    .41835E-02, .25822E-02, .16933E-02, &
!!$    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,&
!!$    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,&
!!$    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,&
!!$    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,&
!!$    0, 0, 0, 0, 0, 0, 0, 0, 0, 0 /

DATA hybm / &
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,&
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,&
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,&
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,&
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0/


DATA hyam / .10000E+06, 78181., 59505., 43887., 31363., 21821.,&
    14895., 10175., 7137.7 , 5143.9 , 3829.4 , 2913.3 , 2247.6 ,&
    1742.3 , 1362.8 , 1075.2 , 857.62 , 693.74 , 577.96 , 492.21 ,&
    431.35 , 374.17 , 321.09 , 264.04 , 207.09 , 151.66 , 105.17 ,&
    68.655 , 43.909 , 27.777 , 17.520 , 11.042 , 6.9473 , 4.3881 ,&
    2.7871 , 1.8084 , 1.2236 , .82916 , .56180 , .37807 , .25150 ,&
    .16749 , .10596 , .62234E-01, .33599E-01, .16822E-01, .81617E-02,&
    .41835E-02, .25822E-02, .16933E-02 /   

DATA aphm1_init /.10000E+06, &
 89091.     ,  68843.     ,  51696.     ,  37625.     ,  26592.     , &
 18358.     ,  12535.     ,  8656.1     ,  6140.8     ,  4486.7     , &
 3371.4     ,  2580.4     ,  1994.9     ,  1552.5     ,  1219.0     , &
 966.41     ,  775.68     ,  635.85     ,  535.09     ,  461.78     , &
 402.76     ,  347.63     ,  292.57     ,  235.56     ,  179.37     , &
 128.42     ,  86.913     ,  56.282     ,  35.843     ,  22.648     , &
 14.281     ,  8.9946     ,  5.6677     ,  3.5876     ,  2.2977     , &
 1.5160     ,  1.0264     ,  .69548     ,  .46993     ,  .31479     , &
 .20950     ,  .13672     ,  .84096E-01 ,  .47917E-01 ,  .25211E-01 , &
 .12492E-01 ,  .61726E-02 ,  .33829E-02 ,  .21377E-02 /

DATA geopot_init /&
    0.0, 2.0, 4.0, 6.0, 8.0,  10.0,  12.0,  14.0 ,  16.0,  18.0,&
    20.0,  22.0,  24.0,  26.0,  28.0,  30.0,  32.0,  34.0,  36.0,&
    38.0,  40.0,  42.0,  44.0,  46.0,  48.0,  50.0,  52.0,  54.0,&
    56.0,  58.0,  60.0,  62.0,  64.0,  66.0,  68.0,  70.0,  72.0,&
    74.0,  76.0,  78.0,  80.0,  82.0,  84.0,  86.0,  88.0,  90.0,&
    92.0,  94.0,  96.0,  98.0 /

DATA tm1_init /& 
     291.70 ,&
    277.74 , 263.38 , 249.03 , 235.82 , 224.53 , 215.41 , 209.40 ,&
    207.18 , 207.34 , 209.54 , 212.67 , 216.15 , 219.44 , 222.80 ,&
    226.23 , 229.85 , 233.80 , 238.78 , 244.43 , 251.06 , 256.90 ,&
    261.96 , 264.84 , 265.49 , 263.29 , 259.20 , 253.41 , 247.60 ,&
    242.10 , 237.11 , 232.60 , 228.48 , 224.83 , 221.62 , 219.10 ,&
    217.58 , 216.18 , 214.88 , 213.54 , 212.09 , 210.74 , 208.70 ,&
    205.71 , 201.79 , 197.22 , 192.67 , 189.12 , 187.81 , 187.20 /

DATA um1_init /  1.1 ,  6.9 , 14.0 , 22.1 , 31.1 , 37.1 , 35.6 ,&
    31.1 , 23.4 , 16.8 , 11.6 ,  8.3 ,  6.4 ,  5.4 ,  4.9 ,  4.6 ,&
    5.0 ,  6.1 ,  8.3 , 11.1 , 14.6 , 18.0 , 21.3 , 24.4 , 27.4 , 30.9, &
    35.1 , 40.1 , 45.4 , 51.1 , 55.9 , 59.5 , 61.4 , 61.9 , 60.8 ,&
    58.7 , 55.6 , 52.0 , 48.0 , 43.9 , 39.6 , 35.3 , 30.3 , 24.2 ,&
    18.3 , 12.9 ,  8.7 ,  5.6 ,  3.6 ,  2.1 /

DATA vm1_init / 1.1 ,  6.9 , 14.0 , 22.1 , 31.1 , 37.1 , 35.6 ,&
    31.1 , 23.4 , 16.8 , 11.6 ,  8.3 ,  6.4 ,  5.4 ,  4.9 ,  4.6 ,&
    5.0 ,  6.1 ,  8.3 , 11.1 , 14.6 , 18.0 , 21.3 , 24.4 , 27.4 , 30.9, &
    35.1 , 40.1 , 45.4 , 51.1 , 55.9 , 59.5 , 61.4 , 61.9 , 60.8 ,&
    58.7 , 55.6 , 52.0 , 48.0 , 43.9 , 39.6 , 35.3 , 30.3 , 24.2 ,&
    18.3 , 12.9 ,  8.7 ,  5.6 ,  3.6 ,  2.1/

   
